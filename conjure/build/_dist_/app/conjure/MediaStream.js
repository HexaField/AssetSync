export default async function h(){try{const a=320,o=240,t=document.createElement("video");t.width=a,t.height=o;const e=document.createElement("canvas");e.width=a,e.height=o;const c=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),u=c.getAudioTracks();"srcObject"in t?t.srcObject=c:t.src=window.URL.createObjectURL(c),t.play(),t.volume=0;const m=await bodyPix.load({architecture:"MobileNetV1",outputStride:16,multiplier:1,quantBytes:2}),r=e.captureStream(60);console.log(r.getTracks()),d();async function d(){const n=await m.segmentPerson(t,{flipHorizontal:!0,internalResolution:"low",segmentationThreshold:.33});g(n),requestAnimationFrame(d)}function g(n){e.getContext("2d").clearRect(0,0,a,o),e.getContext("2d").drawImage(t,0,0,a,o);for(var s=e.getContext("2d").getImageData(0,0,a,o),l=s.data,i=0;i<l.length;i+=4)n.data[i/4]==0&&(l[i+3]=0);e.getContext("2d").imageSmoothingEnabled=!0,e.getContext("2d").putImageData(s,0,0)}return u.forEach(n=>{r.addTrack(n)}),r}catch(a){console.log(a)}}
