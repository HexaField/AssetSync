import*as s from" https://cdn.skypack.dev/pin/three@v0.123.0-STd7XeVUbImsNuMmqKGL/min/three.js";import"../util/iterateRecursive.js";export default class i{constructor(e,t){this.conjure=e.conjure,this.controlManager=e,this.controls=t,this.storageBodyType=null,this.translationSnap=.5}input(e){e.input.isPressed("q",!0)&&this.controls.setSpace(this.controls.space==="local"?"world":"local"),e.input.isPressed("SHIFT",!0)&&(this.controls.setTranslationSnap(this.translationSnap),this.controls.setRotationSnap(s.MathUtils.degToRad(15)),this.controls.setScaleSnap(.25)),e.input.isReleased("SHIFT",!0)&&(this.controls.setTranslationSnap(null),this.controls.setRotationSnap(null),this.controls.setScaleSnap(null)),e.input.isPressed("w",!0)&&this.controls.setMode("translate"),e.input.isPressed("e",!0)&&this.controls.setMode("rotate"),e.input.isPressed("r",!0)&&this.controls.setMode("scale"),e.input.isPressed("g",!0)&&this.createGroup(),(e.input.isPressed("+",!0)||e.input.isPressed("=",!0))&&this.controls.setSize(this.controls.size+.1),(e.input.isPressed("-",!0)||e.input.isPressed("_",!0))&&this.controls.setSize(Math.max(this.controls.size-.1,.1)),e.input.isPressed("x",!0)&&(this.controls.showX=!this.controls.showX),e.input.isPressed("y",!0)&&(this.controls.showY=!this.controls.showY),e.input.isPressed("z",!0)&&(this.controls.showZ=!this.controls.showZ),e.input.isPressed("SPACEBAR",!0)&&(this.controls.enabled=!this.controls.enabled)}createGroup(){if(this.controls.objects.length>1){let e=new s.Group;for(let t of this.controls.objects)t.parent.remove(t),e.add(t);this.conjure.scene.add(e),this.detachAll()}}attach(e,t={}){console.log(e),t.detachOthers&&this.detachAll(),this.controls.attach(e),this.conjure.postProcessing.addSelectedObject(e),t.ignoreScreenUpdate||this.conjure.getScreens().screenObjectsHierarchy.selectObject(!0,e),this.conjure.getScreens().showScreen(this.conjure.getScreens().screenObjectEdit),this.conjure.getScreens().screenObjectEdit.setObject(e)}detachAll(e={}){if(e.isDeleting)for(let t of this.controls.objects)this.conjure.getWorld().destroyObject(t);else for(let t of this.controls.objects)e.ignoreScreenUpdate||this.conjure.getScreens().screenObjectsHierarchy.selectObject(!1,t),t.userData.needsUpdate=!0;this.controls.detachAll(),this.conjure.postProcessing.clearSelectedObjects(),this.conjure.getScreens().hideScreen(this.conjure.getScreens().screenObjectEdit)}detach(e,t={}){this.controls.detach(e),e.userData.needsUpdate=!0,this.conjure.postProcessing.removeSelectedObject(e),t.ignoreScreenUpdate||this.conjure.getScreens().screenObjectsHierarchy.selectObject(!1,e),this.conjure.getScreens().hideScreen(this.conjure.getScreens().screenObjectEdit)}update(e){}}
