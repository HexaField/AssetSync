import*as t from"https://cdn.skypack.dev/pin/three@v0.117.1-NetLzdTnw9ga3y6o633U/min/three.js";import s from"../../../web_modules/three-typeable-text.js";export default class c{constructor(e){this.conjure=e,this.passcodeLoseFocus=this.passcodeLoseFocus.bind(this),this.active=!1,this.passcodeCallback=void 0,this.renderer=e.renderer,this.camera=new t.PerspectiveCamera(80,window.clientWidth/window.clientHeight,.1,100),this.scene=new t.Scene,document.addEventListener("keydown",i=>{if(this.active&&this.passcodeCallback){var a=i.key;a==="Escape"&&(this.passcodeCallback(),this.active=!1)}},!1)}setPasscodeCallback(e){this.passcodeCallback=e}passcodeLoseFocus(e){!e&&this.active&&(this.passcodeCallback&&this.passcodeCallback(this.passcodeTextEntry.getText()),this.passcodeTextEntry.actionFocus(!0))}setPasscodeVisible(e){this.passcodeText.getObject().visible=e,this.passcodeTextEntry.getObject().visible=e,this.passcodeTextEntry.actionFocus(e)}create(){this.passcodeTextEntry=new s({onFocus:this.passcodeLoseFocus,camera:this.camera,font:this.conjure.getFont("System"),align:"left",string:"",material:new t.MeshBasicMaterial({color:65280})}),this.passcodeText=new s({useDocumentListeners:!1,font:this.conjure.getFont("System"),align:"right",string:"Enter Passcode > ",material:new t.MeshBasicMaterial({color:65280})}),this.textObj=new s({useDocumentListeners:!1,font:this.conjure.getFont("System"),string:"",material:new t.MeshBasicMaterial({color:65280})}),this.passcodeText.getObject().position.set(.25,-4,0),this.passcodeTextEntry.getObject().position.set(-.25,-4,0),this.setPasscodeVisible(!1),this.camera.position.set(0,0,50),this.camera.lookAt(0,0,0),this.scene.add(this.passcodeTextEntry.getObject()),this.scene.add(this.passcodeText.getObject()),this.scene.add(this.textObj.getObject())}setText(e){this.textObj.setText(e),e.includes(`
`)?this.textObj.getObject().position.setY(this.textObj._line_height*e.match(/\n/g).length):this.textObj.getObject().position.setY(0),this.update()}async awaitInput(){return new Promise((e,i)=>{document.addEventListener("click",()=>e())})}update(){this.passcodeTextEntry.updateCursor(),this.renderer.render(this.scene,this.camera)}}
