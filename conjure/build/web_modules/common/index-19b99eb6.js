function T(e,{className:t,symbolName:r}){const n=Symbol.for(r),s={[t]:class extends e{constructor(...a){super(...a);Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return t}}}[t];return s[`is${t}`]=a=>!!(a&&a[n]),s}function D(e,{className:t,symbolName:r,withoutNew:n}){const s=Symbol.for(r),a={[t]:function(...l){if(n&&!(this instanceof a))return new a(...l);const c=e.call(this,...l)||this;return c&&!c[s]&&Object.defineProperty(c,s,{value:!0}),c}}[t];return a.prototype=Object.create(e.prototype),a.prototype.constructor=a,Object.defineProperty(a.prototype,Symbol.toStringTag,{get(){return t}}),a[`is${t}`]=l=>!!(l&&l[s]),a}var h=T,I=D;h.proto=I;function w(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function U(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=void 0),t!=null&&(r.code=t);try{return w(e,r)}catch(n){r.message=e.message,r.stack=e.stack;const s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(e)),w(new s,r)}}var y=U;let F="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",v=e=>crypto.getRandomValues(new Uint8Array(e)),_=(e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,s=-~(1.6*n*t/e.length);return()=>{let a="";for(;;){let l=r(s),c=s;for(;c--;)if(a+=e[l[c]&n]||"",a.length===+t)return a}}},z=(e,t)=>_(e,t,v),J=(e=21)=>{let t="",r=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let n=r[e]&63;n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n<63?t+="_":t+="-"}return t};var k=Object.freeze({__proto__:null,nanoid:J,customAlphabet:z,customRandom:_,urlAlphabet:F,random:v});const{nanoid:W}=k,N=(e=t=>t)=>e(W());var L=N;(function(){if(typeof globalThis=="object")return;Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__})();var A=globalThis,$=A.TextEncoder,K=A.TextDecoder,q=new $("utf8"),B=new K("utf8"),V=(e,t)=>async function*(){for await(const r of e){const n=await t(r);if(!n)continue;yield r}}(),Z=(e,t)=>async function*(){let r=[];for await(const n of e)r.push(n);r=await t(r);for(const n of r)yield n}(),G=(e,t)=>async function*(){if(t<=0)return;let r=0;for await(const n of e)if(yield n,r++,r>=t)return}(),Q=(e,t)=>async function*(){for await(const r of e)yield t(r)}(),Y=function(e,t){const r=new RegExp("^"+t);return e.replace(r,"")},H=L,p={utf8Encoder:q,utf8Decoder:B,filter:V,sortAll:Z,take:G,map:Q,replaceStartWith:Y,tmpdir:H};const{nanoid:X}=k,{utf8Encoder:C,utf8Decoder:ee}=p,o="/",E=C.encode(o),u=E[0];class d{constructor(e,t){if(typeof e=="string")this._buf=C.encode(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==u)throw new Error("Invalid key")}toString(e="utf8"){return e==="utf8"||e==="utf-8"?ee.decode(this._buf):new K(e).decode(this._buf)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new i(e.join(o))}static random(){return new i(X().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=E),this._buf[0]!==u){const e=new Uint8Array(this._buf.byteLength+1);e.fill(u,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===u;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;const s=t[n],a=r[n];if(s<a)return!0;if(s>a)return!1}return t.length<r.length}reverse(){return d.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(o).slice(1)}type(){return te(this.baseNamespace())}name(){return re(this.baseNamespace())}instance(e){return new i(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(o)||(e+=o),e+=this.type(),new i(e)}parent(){const e=this.list();return e.length===1?new i(o):new i(e.slice(0,-1).join(o))}child(e){return this.toString()===o?e:e.toString()===o?this:new i(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return d.withNamespaces([...this.namespaces(),...ne(e.map(t=>t.namespaces()))])}}function te(e){const t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function re(e){const t=e.split(":");return t[t.length-1]}function ne(e){return[].concat(...e)}const i=h(d,{className:"Key",symbolName:"@ipfs/interface-datastore/key"});var S=i;const ae=async e=>{for await(const t of e);};var x=ae;const{filter:f,sortAll:se,take:oe,map:ie}=p;class le{async open(){}async close(){}async put(e,t,r={}){}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async get(e,t={}){}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async has(e){}async delete(e,t={}){}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(r,n){e.push({key:r,value:n})},delete(r){t.push(r)},commit:async r=>{await x(this.putMany(e,r)),e=[],await x(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){}async*query(e,t){let r=this._all(e,t);if(e.prefix!=null&&(r=f(r,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(r=e.filters.reduce((n,s)=>f(n,s),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((n,s)=>se(n,s),r)),e.offset!=null){let n=0;r=f(r,()=>n++>=e.offset)}e.limit!=null&&(r=oe(r,e.limit)),e.keysOnly===!0&&(r=ie(r,n=>({key:n.key}))),yield*r}}var R=le,ce=e=>(e=e||new Error("Cannot open database"),y(e,"ERR_DB_OPEN_FAILED")),ye=e=>(e=e||new Error("Delete failed"),y(e,"ERR_DB_DELETE_FAILED")),ue=e=>(e=e||new Error("Write failed"),y(e,"ERR_DB_WRITE_FAILED")),he=e=>(e=e||new Error("Not Found"),y(e,"ERR_NOT_FOUND")),pe=e=>(e=e||new Error("Aborted"),y(e,"ERR_ABORTED")),j={dbOpenFailedError:ce,dbDeleteFailedError:ye,dbWriteFailedError:ue,notFoundError:he,abortedError:pe};class de extends R{constructor(){super();this.data={}}async put(e,t){this.data[e.toString()]=t}async get(e){const t=await this.has(e);if(!t)throw j.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new S(e),value:t}))}}var fe=de,m=S,b=fe,O=p,P=j,M=R,g={Key:m,MemoryDatastore:b,utils:O,Errors:P,Adapter:M},me=Object.freeze(Object.assign(Object.create(null),g,{default:g,Key:m,MemoryDatastore:b,utils:O,Errors:P,Adapter:M}));export{m as K,b as M,h as c,y as e,me as i,g as s};
