import{AmmoPhysics as b}from"../../../web_modules/@enable3d/ammo-physics.js";import*as o from"https://cdn.skypack.dev/pin/three@v0.117.1-NetLzdTnw9ga3y6o633U/min/three.js";import{OrbitControls as v}from"./OrbitControls.js";import j from"./havesomefun.js";import k from"./lib/ammo.worker.js";k();export default async function(d,e){d.networkPlugin.joinNetwork("test-network-worldsync").then(t=>{t.on("onMessage",(n,r)=>{console.log(r,"says",n)}),t.on("onPeerJoin",n=>{console.log(n,"has joined"),d.networkPlugin.sendTo("test-network-worldsync","Hello peer!",n)}),t.on("onPeerLeave",n=>{console.log(n,"has left")})});const i=new o.Scene;i.background=new o.Color(15790320);const c=new o.PerspectiveCamera(50,e.clientWidth/e.clientHeight,.1,1e5);c.position.set(10,10,20);const a=new o.WebGLRenderer({antialias:!0,canvas:e.canvas});a.setSize(e.clientWidth,e.clientHeight,!1);const u=e.devicePixelRatio;a.setPixelRatio(Math.min(2,u));const P=new v(c,e);i.add(new o.HemisphereLight(16777147,526368,1)),i.add(new o.AmbientLight(6710886));const h=new o.DirectionalLight(14674943,1);h.position.set(50,200,100),h.position.multiplyScalar(1.3);const s=new b(i),{factory:y}=s;s.add.ground({width:20,height:20});let l=[];e.addEventListener("clear",()=>{for(let t of l)s.destroy(t.body),i.remove(t);l=[]}),e.addEventListener("drop",t=>{l.push(...j(t.detail,s))}),e.dispatchEvent({type:"drop",detail:100});const w=new o.Clock;function p(t){const n=t.domElement,r=e.clientWidth,f=e.clientHeight,g=n.width!==r||n.height!==f;return g&&t.setSize(r,f,!1),g}const m=()=>{p(a)&&(c.aspect=e.clientWidth/e.clientHeight,c.updateProjectionMatrix()),s.update(w.getDelta()*1e3),s.updateDebugger(),a.render(i,c),requestAnimationFrame(m)};requestAnimationFrame(m)}
