import*as s from"https://cdn.skypack.dev/pin/three@v0.117.1-NetLzdTnw9ga3y6o633U/min/three.js";import r from"../elements/ScreenElementText.js";import{NETWORKING_OPCODES as i}from"../../world/realm/NetworkingSchemas.js";export const INTERACT_TYPES={NONE:"none",USER:"user",OBJECT:"object",VIDEO:"video"};export default class n{constructor(e){this.screen=e,this.active=!1,this.object=void 0,this.group=new s.Group,this.textElement=new r(e,this,{y:.75,width:.4,height:.125,background:!0,backgroundOpacity:.2,autoUpdateSize:!0}),this.textElement.setText("Interact (G)"),this.group.visible=!1,this.screen.registerElement(this.textElement),this.type=INTERACT_TYPES.NONE,this.screen.screenManager.conjure.input.addKey("INTERACT","g")}setObject(e,t){if(t===INTERACT_TYPES.VIDEO?this.textElement.setText(e.userData.media.paused?"Play":"Pause"):this.textElement.setText("Interact (G)"),e===this.object)return;if(!e){this.object=void 0,this.type=INTERACT_TYPES.NONE,this.group.visible=!1;return}this.object=e,this.type=t,this.group.visible=!0}update(e){this.object&&e.input.isPressed("INTERACT")&&(this.type===INTERACT_TYPES.USER&&(this.screen.screenManager.screenUserPay.setUser(this.object),this.screen.screenManager.showScreen(this.screen.screenManager.screenUserPay),this.screen.screenManager.conjure.getWorld().realm.sendTo(i.PROFILE.SERVICE.PAYID.REQUESTID,"",this.object.peerID)),this.type===INTERACT_TYPES.OBJECT&&this.object.userData.payID&&(this.screen.screenManager.screenUserPay.setObject(this.object),this.screen.screenManager.showScreen(this.screen.screenManager.screenUserPay)),this.type===INTERACT_TYPES.VIDEO&&(this.object.userData.media.paused?this.object.userData.media.play():this.object.userData.media.pause(),this.object.userData.media.volume=1))}}
