import{c as w,a as E}from"./common/_commonjsHelpers-c99fd594.js";import{b as l,l as N,t as G,f as I,d as U,p as A,c as V,e as H,a as z,g as Y}from"./common/index-3e3a558e.js";var W=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */var u=E&&E.__awaiter||function(t,i,n,c){function h(e){return e instanceof n?e:new n(function(s){s(e)})}return new(n||(n=Promise))(function(e,s){function a(p){try{f(c.next(p))}catch(m){s(m)}}function d(p){try{f(c.throw(p))}catch(m){s(m)}}function f(p){p.done?e(p.value):h(p.value).then(a,d)}f((c=c.apply(t,i||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0});class o{constructor(t,i){this.cache=t,this.textureAnisotropy=i}get fileLoader(){return this._fileLoader||(this._fileLoader=new l.FileLoader),this._fileLoader}get imageLoader(){return this._imgLoader||(this._imgLoader=new l.ImageLoader),this._imgLoader}get svgLoader(){return this._svgLoader||(this._svgLoader=new l.SVGLoader),this._svgLoader}get textureLoader(){return this._textureLoader||(this._textureLoader=new l.TextureLoader),this._textureLoader}get objectLoader(){return this._objectLoader||(this._objectLoader=new l.ObjectLoader),this._objectLoader}get gltfLoader(){return this._gltfLoader||(this._gltfLoader=new l.GLTFLoader),this._gltfLoader}get fbxLoader(){return this._fbxLoader||(this._fbxLoader=new l.FBXLoader),this._fbxLoader}preload(t,i){return u(this,void 0,void 0,function*(){return this.cache.add(t,i),new Promise(n=>{const c=/\.fbx$|\.glb$|\.gltf$/.test(i),h=/\.jpe?g$|\.png$/.test(i);h?this.textureLoader.load(i,e=>n(e)):(c&&this.fileLoader.setResponseType("arraybuffer"),this.fileLoader.load(i,e=>n(e)))})})}file(t){const i=this.cache.get(t);return t=i||t,new Promise(n=>{this.fileLoader.load(t,c=>n(c))})}svg(t){const i=this.cache.get(t);return t=i||t,new Promise(n=>{this.svgLoader.load(t,c=>n(c))})}texture(t){const i=/^data:image\/[\S]+;base64,/gm.test(t);if(!i){const n=this.cache.get(t);t=n||t}return new Promise(n=>{this.textureLoader.load(t,c=>{c.anisotropy=this.textureAnisotropy,c.format=l.RGBAFormat,c.needsUpdate=!0,n(c)})})}object(t){const i=this.cache.get(t);return t=i||t,new Promise(n=>{this.objectLoader.load(t,c=>{n(c)})})}gltf(t){const i=this.cache.get(t);return t=i||t,new Promise(n=>{this.gltfLoader.load(t,c=>{n(c)})})}fbx(t){const i=this.cache.get(t);return t=i||t,new Promise(n=>{this.fbxLoader.load(t,c=>{n(c)})})}}r.default=o}),$=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0});const u=l,o=l;class t extends l.Object3D{constructor(n,c,h,e){super();this.scene=n,this.light=c,this.size=h,this.color=e,this.geo=new l.SphereBufferGeometry(h||.2,16,8),this.mat=new l.MeshBasicMaterial({color:e||c.color}),this.mesh=new l.Mesh(this.geo,this.mat),this.add(this.mesh),c.add(this)}dispose(){this.mesh.geometry.dispose(),Array.isArray(this.mesh.material)?this.mesh.material.forEach(n=>n.dispose()):this.mesh.material.dispose(),this.remove(this.mesh)}update(){}}class i{constructor(n){this.scene=n}get helper(){return{directionalLightHelper:(n,c,h)=>{const e=new o.DirectionalLightHelper(n,c,h);return this.scene.add(e),e},spotLightHelper:(n,c)=>{const h=new o.SpotLightHelper(n,c);return this.scene.add(h),h},pointLightHelper:(n,c,h)=>new t(this.scene,n,c,h)}}directionalLight(n={}){const{color:c=16777215,intensity:h=1}=n,e=new u.DirectionalLight(c,h);return e.castShadow=!0,this.scene.add(e),e}hemisphereLight(n={}){const{skyColor:c=16777215,groundColor:h=16777215,intensity:e=1}=n,s=new u.HemisphereLight(c,h,e);return this.scene.add(s),s}ambientLight(n={}){const{color:c=16777215,intensity:h=1}=n,e=new u.AmbientLight(c,h);return this.scene.add(e),e}pointLight(n={}){const{color:c=16777215,intensity:h=1,distance:e=0,decay:s=1}=n,a=new u.PointLight(c,h,e,s);return a.castShadow=!0,this.scene.add(a),a}spotLight(n={}){const{color:c=16777215,intensity:h=1,distance:e=0,angle:s=Math.PI/8,penumbra:a=0,decay:d=1}=n,f=new u.SpotLight(c,h,e,s,a,d);return f.castShadow=!0,this.scene.add(f),f}rectAreaLight(n={}){const{color:c=16777215,intensity:h=1,width:e=10,height:s=10}=n,a=new u.RectAreaLight(c,h,e,s);return this.scene.add(a),a}}r.default=i}),X=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0});class u{constructor(e,s){this.scene=e,this.transform=s}toGeometry(e,s){e.geometry=this.transform.bufferGeometryToGeometry(e.geometry),s.geometry=this.transform.bufferGeometryToGeometry(s.geometry)}toBufferGeometry(e){e.geometry=this.transform.geometryToBufferGeometry(e.geometry)}union(e,s){this.toGeometry(e,s);const a=this.doCSG(e,s,"union");return this.toBufferGeometry(a),a}subtract(e,s){this.toGeometry(e,s);const a=this.doCSG(e,s,"subtract");return this.toBufferGeometry(a),a}intersect(e,s){this.toGeometry(e,s);const a=this.doCSG(e,s,"intersect");return this.toBufferGeometry(a),a}doCSG(e,s,a){e.updateMatrix(),s.updateMatrix();const d=o.fromMesh(e),f=o.fromMesh(s),p=d[a](f),m=o.toMesh(p,e.matrix);return m}}r.default=u;class o{constructor(){this.polygons=[]}static fromPolygons(e){const s=new o;return s.polygons=e,s}static fromGeometry(e){e.isBufferGeometry&&(e=new l.Geometry().fromBufferGeometry(e));const s=e.faces,a=e.vertices,d=[],f=["a","b","c"];for(let p=0;p<s.length;p++){const m=s[p],g=[];for(let y=0;y<3;y++){const b=e.faceVertexUvs[0][p]!==void 0&&e.faceVertexUvs[0][p][y]!==void 0?e.faceVertexUvs[0][p][y]:void 0;g.push(new i(a[m[f[y]]],m.vertexNormals[y],b))}d.push(new c(g))}return o.fromPolygons(d)}static fromMesh(e){const s=o.fromGeometry(e.geometry);o._tmpm3.getNormalMatrix(e.matrix);for(const a of s.polygons)for(const d of a.vertices)d.pos.applyMatrix4(e.matrix),d.normal.applyMatrix3(o._tmpm3);return s}static toMesh(e,s){const a=new l.Geometry,d=e.polygons,f=a.vertices,p=a.faceVertexUvs[0];for(const y of d){const b=y.vertices,_=f.length,M=b.length;for(const v of b)f.push(new l.Vector3().copy(v.pos));for(let v=3;v<=M;v++){const L=new l.Face3(_,_+v-2,_+v-1),k=[];p.push(k);const C=L.vertexNormals;C.push(new l.Vector3().copy(b[0].normal)),C.push(new l.Vector3().copy(b[v-2].normal)),C.push(new l.Vector3().copy(b[v-1].normal)),b[0].uv&&b[v-2].uv&&b[v-1].uv&&(k.push(new l.Vector3().copy(b[0].uv)),k.push(new l.Vector3().copy(b[v-2].uv)),k.push(new l.Vector3().copy(b[v-1].uv))),L.normal=new l.Vector3().copy(y.plane.normal),a.faces.push(L)}}const m=+l.REVISION>=123?new l.Matrix4().copy(s).invert():new l.Matrix4().getInverse(s);a.applyMatrix4(m),a.verticesNeedUpdate=a.elementsNeedUpdate=a.normalsNeedUpdate=!0,a.computeBoundingSphere(),a.computeBoundingBox();const g=new l.Mesh(a);return g.matrix.copy(s),g.matrix.decompose(g.position,g.rotation,g.scale),g.updateMatrixWorld(),g}static iEval(e,s=0){var a;if(typeof e=="string")o.currentOp=e;else if(e instanceof Array)for(const d of e)o.iEval(d,0);else if(typeof e=="object"){const d=o.currentOp;e.updateMatrix(),e.updateMatrixWorld(),o.sourceMesh?(o.nextPrim=o.fromMesh(e),o.currentPrim=o.currentPrim[d](o.nextPrim)):o.currentPrim=o.fromMesh(o.sourceMesh=e),o.doRemove&&((a=e==null?void 0:e.parent)===null||a===void 0||a.remove(e))}}static eval(e,s){delete o.currentOp,delete o.sourceMesh,o.doRemove=s,o.iEval(e);const a=o.toMesh(o.currentPrim,o.sourceMesh.matrix);return a.material=o.sourceMesh.material,a.castShadow=a.receiveShadow=!0,a}clone(){const e=new o;return e.polygons=this.polygons.map(s=>s.clone()),e}toPolygons(){return this.polygons}union(e){const s=new h(this.clone().polygons),a=new h(e.clone().polygons);return s.clipTo(a),a.clipTo(s),a.invert(),a.clipTo(s),a.invert(),s.build(a.allPolygons()),o.fromPolygons(s.allPolygons())}subtract(e){const s=new h(this.clone().polygons),a=new h(e.clone().polygons);return s.invert(),s.clipTo(a),a.clipTo(s),a.invert(),a.clipTo(s),a.invert(),s.build(a.allPolygons()),s.invert(),o.fromPolygons(s.allPolygons())}intersect(e){const s=new h(this.clone().polygons),a=new h(e.clone().polygons);return s.invert(),a.clipTo(s),a.invert(),s.clipTo(a),a.clipTo(s),s.build(a.allPolygons()),s.invert(),o.fromPolygons(s.allPolygons())}inverse(){const e=this.clone();return e.polygons.map(s=>{s.flip()}),e}}o._tmpm3=new l.Matrix3;class t extends l.Vector3{constructor(e,s,a){if(arguments.length===3)super(e,s,a);else if(Array.isArray(e))super(e[0],e[1],e[2]);else if(typeof e=="object")this.copy(e);else throw new Error("Invalid constructor to vector")}clone(){return new t(this.x,this.y,this.z)}negated(){return this.clone().multiplyScalar(-1)}plus(e){return this.clone().add(e)}minus(e){return this.clone().sub(e)}times(e){return this.clone().multiplyScalar(e)}dividedBy(e){return this.clone().divideScalar(e)}lerp(e,s){return this.plus(e.minus(this).times(s))}unit(){return this.dividedBy(this.length())}cross(e,s){return l.Vector3.prototype.cross.call(this.clone(),e)}}class i{constructor(e,s,a){this.pos=new t(e.x,e.y,e.z),this.normal=new t(s.x,s.y,s.z),a&&(this.uv=new t(a.x,a.y,a.z))}clone(){return new i(this.pos.clone(),this.normal.clone(),this.uv?this.uv.clone():void 0)}flip(){this.normal=this.normal.negated()}interpolate(e,s){return new i(this.pos.lerp(e.pos,s),this.normal.lerp(e.normal,s),this.uv?this.uv.lerp(e.uv,s):void 0)}}class n{constructor(e,s){this.normal=e,this.w=s}static fromPoints(e,s,a){const d=s.minus(e).cross(a.minus(e)).unit();return new n(d,d.dot(e))}clone(){return new n(this.normal.clone(),this.w)}flip(){this.normal=this.normal.negated(),this.w=-this.w}splitPolygon(e,s,a,d,f){const p=0,m=1,g=2,y=3;let b=0;const _=[];for(const M of e.vertices){const v=this.normal.dot(M.pos)-this.w,L=v<-n.EPSILON?g:v>n.EPSILON?m:p;b|=L,_.push(L)}switch(b){case p:(this.normal.dot(e.plane.normal)>0?s:a).push(e);break;case m:d.push(e);break;case g:f.push(e);break;case y:const M=[],v=[];for(let L=0;L<e.vertices.length;L++){const k=(L+1)%e.vertices.length,C=_[L],B=_[k],S=e.vertices[L],T=e.vertices[k];if(C!==g&&M.push(S),C!==m&&v.push(C!==g?S.clone():S),(C|B)===y){const F=(this.w-this.normal.dot(S.pos))/this.normal.dot(T.pos.minus(S.pos)),j=S.interpolate(T,F);M.push(j),v.push(j.clone())}}M.length>=3&&d.push(new c(M,e.shared)),v.length>=3&&f.push(new c(v,e.shared));break}}}n.EPSILON=1e-5;class c{constructor(e,s=null){this.vertices=e,this.shared=s,this.plane=n.fromPoints(e[0].pos,e[1].pos,e[2].pos)}clone(){const e=this.vertices.map(s=>s.clone());return new c(e,this.shared)}flip(){this.vertices.reverse().map(e=>{e.flip()}),this.plane.flip()}}class h{constructor(e){delete this.plane,delete this.front,delete this.back,this.polygons=[],e&&this.build(e)}clone(){const e=new h;return e.plane=this.plane&&this.plane.clone(),e.front=this.front&&this.front.clone(),e.back=this.back&&this.back.clone(),e.polygons=this.polygons.map(s=>s.clone()),e}invert(){for(const s of this.polygons)s.flip();this.plane.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();const e=this.front;this.front=this.back,this.back=e}clipPolygons(e){if(!this.plane)return e.slice();let s=[],a=[];for(const d of e)this.plane.splitPolygon(d,s,a,s,a);return this.front&&(s=this.front.clipPolygons(s)),a=this.back?this.back.clipPolygons(a):[],s.concat(a)}clipTo(e){this.polygons=e.clipPolygons(this.polygons),this.front&&this.front.clipTo(e),this.back&&this.back.clipTo(e)}allPolygons(){let e=this.polygons.slice();return this.front&&(e=e.concat(this.front.allPolygons())),this.back&&(e=e.concat(this.back.allPolygons())),e}build(e){if(!e.length)return;this.plane||(this.plane=e[0].plane.clone());const s=[],a=[];for(const d of e)this.plane.splitPolygon(d,this.polygons,this.polygons,s,a);s.length&&(this.front||(this.front=new h),this.front.build(s)),a.length&&(this.back||(this.back=new h),this.back.build(a))}}}),q=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0});class u{constructor(o){this.scene=o}add(o,t={}){const i=this.make(o,t);return i?this.scene.add(i):N.default("Could not make heightmap"),i}make(o,t={}){const{image:i}=o,{width:n,height:c}=i,{colorScale:h}=t,e=document.createElement("canvas");e.width=n,e.height=c;const s=e.getContext("2d");if(!s)return;s.drawImage(o.image,0,0);const a=s.getImageData(0,0,n,c),d=new l.PlaneGeometry(10,10,n-1,c-1);let f={color:13421772,side:l.DoubleSide};h&&(f=Object.assign(Object.assign({},f),{vertexColors:l.FaceColors}));const p=new l.MeshPhongMaterial(f),m=new G.ExtendedMesh(d,p);m.receiveShadow=m.castShadow=!0,m.shape="concave";const g=m.geometry;for(let b=0;b<g.vertices.length;b++)g.vertices[b].z=a.data[b*4]/120;const y=(b,_)=>{var M=b.vertices[_.a].z,v=b.vertices[_.b].z,L=b.vertices[_.c].z;return Math.max(M,v,L)};return h&&g.faces.forEach(b=>b.color=new l.Color(h(y(g,b)).hex())),m.rotateX(-Math.PI/2),m.updateMatrix(),d.computeFaceNormals(),d.computeVertexNormals(),m.name="heightmap",m}}r.default=u}),J=w(function(P,r){var u=E&&E.__awaiter||function(i,n,c,h){function e(s){return s instanceof c?s:new c(function(a){a(s)})}return new(c||(c=Promise))(function(s,a){function d(m){try{p(h.next(m))}catch(g){a(g)}}function f(m){try{p(h.throw(m))}catch(g){a(g)}}function p(m){m.done?s(m.value):e(m.value).then(d,f)}p((h=h.apply(i,n||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0});const o=l;class t{constructor(i,n,c,h,e,s,a){this.scene=i,this.renderer=n,this.camera=c,this.lights=h,this.physics=e,this.load=s,this.factories=a}warpSpeed(...i){return u(this,void 0,void 0,function*(){let n={};const c=i.filter(d=>/^-\w+/.test(d)),h=c.length>0;if((i.length===0||h)&&(i=["light","camera","lookAtCenter","ground","grid","orbitControls","fog","sky"]),h){const d=c.map(f=>f.substr(1));d.forEach(f=>{const p=i.indexOf(f);i.splice(p,1)})}if(i.includes("fog"),i.includes("sky")){const d=["varying vec3 vWorldPosition;","","void main() {","","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","","}"].join(`
`),f=["uniform vec3 topColor;","uniform vec3 bottomColor;","uniform float offset;","uniform float exponent;","","varying vec3 vWorldPosition;","","void main() {","","float h = normalize( vWorldPosition + offset ).y;","gl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max( h , 0.0), exponent ), 0.0 ) ), 1.0 );","","}"].join(`
`),p={topColor:{value:new o.Color(30719)},bottomColor:{value:new o.Color(15595007)},offset:{value:33},exponent:{value:.6}};var e=new o.SphereBufferGeometry(500,32,15),s=new o.ShaderMaterial({uniforms:p,vertexShader:d,fragmentShader:f,side:o.BackSide}),a=new o.Mesh(e,s);this.scene.add(a)}if(i.includes("camera")&&(this.camera.position.set(0,6,12),n=Object.assign({camera:this.camera},n)),i.includes("light")){const d=.4,f=this.lights.hemisphereLight({skyColor:16777215,groundColor:0,intensity:d}),p=this.lights.ambientLight({color:16777215,intensity:d}),m=this.lights.directionalLight({color:16777215,intensity:d});m.position.set(100,200,50);const g=20;m.shadow.camera.top=g,m.shadow.camera.bottom=-g,m.shadow.camera.left=-g,m.shadow.camera.right=g,m.shadow.mapSize.set(1024,1024);const y={ambientLight:p,directionalLight:m,hemisphereLight:f};n=Object.assign({lights:y},n)}if(i.includes("lookAtCenter")&&this.camera.lookAt(this.scene.position),i.includes("ground")){const d=i.includes("grid"),f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOnAAADusBZ+q87AAAAJtJREFUeJzt0EENwDAAxLDbNP6UOxh+NEYQ5dl2drFv286598GrA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAa4AO0BqgA7QG6ACtATpAu37AD8eaBH5JQdVbAAAAAElFTkSuQmCC",p=yield this.load.texture(f);p.wrapS=p.wrapT=o.RepeatWrapping,p.repeat.set(21,21);const m={name:"ground",width:21,height:21,depth:1,y:-.5},g={phong:{map:d?p:null,transparent:!0,opacity:.8,color:16777215}};let y;window.__loadPhysics?(y=this.physics.add.ground(m,g),y.body.setRestitution(1)):y=this.factories.add.ground(m,g),y.receiveShadow=!0,n=Object.assign({ground:y},n)}if(i.includes("orbitControls")){const d=new l.OrbitControls(this.camera,document.getElementById("enable3d-phaser-canvas")||this.renderer.domElement);n=Object.assign({orbitControls:d},n)}return n})}}r.default=t}),K=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0});class u{constructor(){this._mixers=[]}animationMixer(o){const t=new G.AnimationMixer(o);return this.mixers.add(t),t}get mixers(){return{create:o=>this.animationMixer(o),add:o=>this._mixers.push(o),get:()=>this._mixers,update:o=>{var t;return(t=this._mixers)===null||t===void 0?void 0:t.forEach(i=>i.update(o/1e3))}}}}r.default=u}),Q=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0}),r.addWater=void 0;const u=(o,t,i={})=>{const{width:n=20,height:c=20,x:h=0,y:e=0,z:s=0,color:a="#ffffff",scale:d=4,flowX:f=1,flowY:p=1,normalMap0:m=void 0,normalMap1:g=void 0}=i,y=new l.PlaneBufferGeometry(n,c),b=new l.MeshStandardMaterial({color:30654,transparent:!0,opacity:.8}),_=new l.Mesh(y,b);_.position.set(h,e,s),_.rotation.x=Math.PI*-.5,o.add(_);const M=new l.PlaneBufferGeometry(n,c),v=new l.Water(M,{color:a,scale:d,flowDirection:new l.Vector2(f,p),textureWidth:1024,textureHeight:1024,normalMap0:m,normalMap1:g,encoding:t.outputEncoding});return v.position.set(h,e+.1,s),v.rotation.x=Math.PI*-.5,o.add(v),{ground:_,water:v}};r.addWater=u}),D=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TextureCube=void 0;class u{constructor(t,i,n){this.scene=t,this.renderer=i,this.factories=n}water(t={}){Q.addWater(this.scene,this.renderer,t)}textureCube(t){t.length!==6&&console.log("[enable3d] You need to pass 6 urls to textureCube()");const i=new o;return t.forEach((n,c)=>{n.wrapS=n.wrapT=l.RepeatWrapping;const h=this.factories.add.material({phong:{map:n}});i.materials[c]=h}),i}}r.default=u;class o{constructor(){this.materials=new Array(6)}get texture(){return{left:this.getTexture(0),right:this.getTexture(1),up:this.getTexture(2),down:this.getTexture(3),front:this.getTexture(4),back:this.getTexture(5)}}getTexture(t){return this.materials[t].map}}r.TextureCube=o}),Z=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0});const u=l;/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class o{constructor(t,i){this.camera=t,this.renderer=i}geometryToBufferGeometry(t){return t.isGeometry?new l.BufferGeometry().fromGeometry(t):t}bufferGeometryToGeometry(t){return t.isBufferGeometry?new l.Geometry().fromBufferGeometry(t):t}fromSVGtoShape(t,i=!1,n){if(t){const c=new u.SVGLoader,h=[];return c.parse(t).paths.forEach(e=>{e.toShapes(i,n).forEach(s=>{h.push(s)})}),h}return[]}from3dto2d(t){const i=new l.Vector3(t.x,t.y,t.z),n=this.renderer.domElement;this.camera.updateMatrixWorld(),i.project(this.camera);const c=Math.round((i.x+1)*(n.width/2)),h=Math.round((-i.y+1)*(n.height/2));return new l.Vector2(c,h)}from2dto3d(t,i,n){var c;if(!this.tmpPlane){const a=new l.PlaneBufferGeometry(1e4,1e4),d=new l.MeshBasicMaterial({transparent:!0,opacity:.25});this.tmpPlane=new l.Mesh(a,d),this.tmpPlane.name="_tmp_raycast_plane"}this.tmpRaycaster||(this.tmpRaycaster=new l.Raycaster),this.tmpVector3||(this.tmpVector3=new l.Vector3);let h;this.tmpPlane.setRotationFromEuler(this.camera.rotation);const e=this.camera.position;this.tmpPlane.position.set(e.x,e.y,e.z),this.camera.getWorldDirection(this.tmpVector3),this.tmpPlane.position.add(this.tmpVector3.clone().multiplyScalar(n)),this.tmpPlane.updateMatrix(),this.tmpPlane.updateMatrixWorld(!0),this.tmpRaycaster.setFromCamera({x:t,y:i},this.camera);const s=this.tmpRaycaster.intersectObjects([this.tmpPlane]);return((c=s[0])===null||c===void 0?void 0:c.object.name)==="_tmp_raycast_plane"&&(h=s[0].point),h}}r.default=o}),ee=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0});class u{constructor(o,t,i){this._renderer=o,this._scene=t,this._camera=i,this.controllerModelFactory=new l.XRControllerModelFactory,this.cameraGroup=new l.Group,this.cameraGroup.add(i),t.add(this.cameraGroup),o.xr.enabled=!0;const n=l.VRButton.createButton(o);n.style.cssText+="background: rgba(0, 0, 0, 0.8); ",document.body.appendChild(n)}get isPresenting(){var o,t;return!!((t=(o=this._renderer)===null||o===void 0?void 0:o.xr)===null||t===void 0?void 0:t.isPresenting)}getController(o){const t=this._renderer.xr.getController(o);return this.cameraGroup.add(t),t}getControllerGrip(o){const t=this._renderer.xr.getControllerGrip(o),i=this.controllerModelFactory.createControllerModel(t);return t.add(i),this.cameraGroup.add(t),t}getControllerRay(o){const{targetRayMode:t}=o;if(t==="tracked-pointer"){let i=new l.BufferGeometry;i.setAttribute("position",new l.Float32BufferAttribute([0,0,0,0,0,-1],3)),i.setAttribute("color",new l.Float32BufferAttribute([1,0,0,1,1,1],3));let n=new l.LineBasicMaterial({vertexColors:!0});return new l.Line(i,n)}if(t==="gaze"){let i=new l.RingBufferGeometry(.02,.04,32).translate(0,0,-1),n=new l.MeshBasicMaterial({color:"red",opacity:.5,transparent:!0});return new l.Mesh(i,n)}return}get camera(){return this.WebXRCamera}get WebXRCamera(){var o;return{group:this.cameraGroup,position:(o=this.cameraGroup)===null||o===void 0?void 0:o.position,rotation:this.isPresenting?this._renderer.xr.getCamera(this._camera).rotation:void 0,getWorldDirection:t=>this.isPresenting?this._renderer.xr.getCamera(this._camera).getWorldDirection(t):void 0}}}r.default=u}),te=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0});const u=(o=20,t)=>{if(!window.__loadPhysics){console.log("There is not much fun without physics enabled!");return}for(let i=0;i<o;i++){const n=["standard","basic","normal","phong","line","points"],c=(e,s)=>Math.floor(Math.random()*(s-e+1)+e),h=e=>e[Math.floor(Math.random()*e.length)];Math.random()>.5?t.add.box({x:c(-10,10),y:c(10,20),z:c(-10,10),width:c(1,2)/10,height:c(1,2)/10,depth:c(1,2)/10,mass:1},{[h(n)]:{color:Math.floor(Math.random()*16777215)}}).body.setRestitution(Math.floor(Math.random()*10)/20):t.add.sphere({x:c(-10,10),y:c(10,20),z:c(-10,10),radius:c(1,2)/10,mass:1},{[h(n)]:{color:Math.floor(Math.random()*16777215)}}).body.setRestitution(Math.floor(Math.random()*10)/20)}};r.default=u}),R=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0});class u{perspectiveCamera(o={}){return u.Perspective(o)}orthographicCamera(o={}){return u.Orthographic(o)}static Perspective(o={}){const{fov:t=50,aspect:i=window.innerWidth/window.innerHeight,near:n=.1,far:c=2e3,x:h=0,y:e=0,z:s=0}=o,a=new l.PerspectiveCamera(t,i,n,c);return a.position.set(h,e,s),a}static Orthographic(o={}){const t=window.innerWidth,i=window.innerHeight,{left:n=t/-100,right:c=t/100,top:h=i/100,bottom:e=i/-100,near:s=1,far:a=1e3,x:d=0,y:f=0,z:p=0}=o,m=new l.OrthographicCamera(n,c,h,e,s,a);return m.position.set(d,f,p),m}}r.default=u}),x=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Cameras=r.HaveSomeFun=r.WebXR=r.Transform=r.TextureCube=r.Misc=r.Mixers=r.WarpSpeed=r.HeightMap=r.CSG=r.Factories=r.Lights=r.Loaders=void 0,r.Loaders=W.default,r.Lights=$.default,r.Factories=I.default,r.CSG=X.default,r.HeightMap=q.default,r.WarpSpeed=J.default,r.Mixers=K.default,r.Misc=D.default,Object.defineProperty(r,"TextureCube",{enumerable:!0,get:function(){return D.TextureCube}}),r.Transform=Z.default,r.WebXR=ee.default,r.HaveSomeFun=te.default,r.Cameras=R.default}),oe=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */var u=E&&E.__awaiter||function(t,i,n,c){function h(e){return e instanceof n?e:new n(function(s){s(e)})}return new(n||(n=Promise))(function(e,s){function a(p){try{f(c.next(p))}catch(m){s(m)}}function d(p){try{f(c.throw(p))}catch(m){s(m)}}function f(p){p.done?e(p.value):h(p.value).then(a,d)}f((c=c.apply(t,i||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0});class o{constructor(t={}){this.sceneConfig=t,this.scenes=new Map,this.__config={},this._isRunning=!1,this._deconstructorFunctions=[];const{key:i=Math.random().toString(),enableXR:n=!1}=t;this.__config.sceneKey=i,this.__config.enableXR=n}get deconstructor(){return{add:t=>{this._deconstructorFunctions.push(t)}}}initializeScene(t){const{renderer:i,parent:n,canvas:c,scene:h,scenes:e,camera:s,cache:a,physics:d,sceneConfig:f}=t;this.scene=h,this.scenes=e,this.camera=s,this.cache=a,this.physics=d,this.renderer=i,this.parent=n,this.canvas=c;const{autoStart:p,textureAnisotropy:m}=f;this.load=new x.Loaders(this.cache,m),this.lights=new x.Lights(this.scene),this.transform=new x.Transform(this.camera,this.renderer),this.csg=new x.CSG(this.scene,this.transform),this.heightMap=new x.HeightMap(this.scene),this.factories=new x.Factories(this.scene),this.misc=new x.Misc(this.scene,this.renderer,this.factories),this.ws=new x.WarpSpeed(h,i,s,this.lights,this.physics,this.load,this.factories),this.mixers=new x.Mixers,this.cameras=new x.Cameras,this.clock=new l.Clock,this.__config.enableXR&&(this.webXR=new x.WebXR(this.renderer,this.scene,this.camera)),p&&this.start(this.__config.sceneKey)}get sceneKey(){return this.__config.sceneKey}destroy(t){var i;(i=this.physics)===null||i===void 0||i.destroy(t.body),this.scene.remove(t),t=null}warpSpeed(...t){return u(this,void 0,void 0,function*(){return yield this.ws.warpSpeed(...t)})}get animationMixers(){return this.mixers.mixers}get make(){return this.factories.make}get add(){return this.factories.add}haveSomeFun(t=20){x.HaveSomeFun(t,this.physics)}isRunning(){return this._isRunning}start(t,i){var n;return u(this,void 0,void 0,function*(){t&&t!==this.__config.sceneKey?(this.stop(),(n=this.scenes.get(t))===null||n===void 0||n._start(i)):this._start(i)})}_start(t){var i,n;return u(this,void 0,void 0,function*(){yield(n=(i=this).init)===null||n===void 0?void 0:n.call(i,t),yield this._preload(),yield this._create(),this.renderer.setAnimationLoop(()=>{this._update()}),this._isRunning=!0})}restart(t){return u(this,void 0,void 0,function*(){this.stop(),this.start(this.__config.sceneKey,t)})}stop(){return u(this,void 0,void 0,function*(){this._isRunning=!1,this.renderer.setAnimationLoop(null),this.clock.start();for(let t=0;t<this._deconstructorFunctions.length;t++)yield this._deconstructorFunctions[t]();this._deconstructorFunctions=[];for(let t=this.physics.rigidBodies.length-1;t>=0;t--)this.physics.destroy(this.physics.rigidBodies[t]);for(let t=this.scene.children.length-1;t>=0;t--)this.scene.remove(this.scene.children[t])})}setSize(t,i){this.renderer.setSize(t,i),typeof this.camera.aspect!="undefined"&&(this.camera.aspect=t/i),this.camera.updateProjectionMatrix()}setPixelRatio(t){this.renderer.setPixelRatio(t)}init(t={}){}preload(){}create(){}update(t,i){}_preload(){var t,i;return u(this,void 0,void 0,function*(){yield(i=(t=this).preload)===null||i===void 0?void 0:i.call(t)})}_create(){var t,i;return u(this,void 0,void 0,function*(){yield(i=(t=this).create)===null||i===void 0?void 0:i.call(t)})}_update(){var t,i,n,c;const h=this.clock.getDelta()*1e3,e=this.clock.getElapsedTime();(i=(t=this).update)===null||i===void 0||i.call(t,parseFloat(e.toFixed(3)),parseInt(h.toString())),(n=this.physics)===null||n===void 0||n.update(h),(c=this.physics)===null||c===void 0||c.updateDebugger(),this.animationMixers.update(h),this.composer?this.composer.render():this.renderer.render(this.scene,this.camera)}}r.Scene3D=o}),ie=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0}),r.ThreeGraphics=void 0;class u{constructor(o={}){this.threeGraphicsConfig=o;const{anisotropy:t=1,camera:i=R.default.Perspective({z:25,y:5}),antialias:n=!1,usePhysics:c=!0,renderer:h}=o;this.textureAnisotropy=t,this.camera=i,this.scene=new l.Scene,this.renderer=h||new l.WebGLRenderer({antialias:n}),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=l.PCFSoftShadowMap,this.cache=l.Cache,this.cache.enabled=!0,c&&(typeof Ammo!="undefined"?this.physics=new U.AmmoPhysics(this.scene,o):console.log("[enable3d]: Are you sure you included ammo.js?"))}}r.ThreeGraphics=u}),ne=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0}),r.VERSION=void 0,r.VERSION="0.21.0"}),se=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MathUtils=r.Vector3=r.Vector2=r.Object3D=r.FBXLoader=r.GLTFLoader=r.RGBAFormat=r.Texture=r.WebGLRenderer=r.Types=r.THREE=r.PhysicsLoader=r.ThreeGraphics=void 0,Object.defineProperty(r,"ThreeGraphics",{enumerable:!0,get:function(){return ie.ThreeGraphics}}),Object.defineProperty(r,"PhysicsLoader",{enumerable:!0,get:function(){return A.PhysicsLoader}}),r.THREE=l,r.Types=G;var u=l;Object.defineProperty(r,"WebGLRenderer",{enumerable:!0,get:function(){return u.WebGLRenderer}}),Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return u.Texture}}),Object.defineProperty(r,"RGBAFormat",{enumerable:!0,get:function(){return u.RGBAFormat}}),Object.defineProperty(r,"GLTFLoader",{enumerable:!0,get:function(){return u.GLTFLoader}}),Object.defineProperty(r,"FBXLoader",{enumerable:!0,get:function(){return u.FBXLoader}}),Object.defineProperty(r,"Object3D",{enumerable:!0,get:function(){return u.Object3D}}),Object.defineProperty(r,"Vector2",{enumerable:!0,get:function(){return u.Vector2}}),Object.defineProperty(r,"Vector3",{enumerable:!0,get:function(){return u.Vector3}}),Object.defineProperty(r,"MathUtils",{enumerable:!0,get:function(){return u.MathUtils}});const o=`Powered by enable3d v${ne.VERSION}`;console.log(`%c %c %c %c %c ${o} %c https://enable3d.io/`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}),re=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0});class u extends se.ThreeGraphics{constructor(o){var t;super(o);this.projectConfig=o,this.scenes=new Map,this.renderer.setSize(window.innerWidth,window.innerHeight),this.projectConfig.parent?this.parent=document.getElementById(this.projectConfig.parent):this.parent=document.body,this.parent||(console.warn(`[enable3d] parent "${this.projectConfig.parent}" not found! Will add it to the body.`),this.parent=document.body),this.parent.appendChild(this.renderer.domElement),this.canvas=this.renderer.domElement;let i="";this.projectConfig.scenes.forEach((n,c)=>{const h=new n;c===0&&(i=h.sceneKey);const e={sceneConfig:{textureAnisotropy:this.textureAnisotropy,autoStart:!1},renderer:this.renderer,parent:this.parent,canvas:this.canvas,scene:this.scene,scenes:this.scenes,camera:this.camera,cache:this.cache,physics:this.physics};h.initializeScene(e),c===0&&(h.setSize(this.parent.clientWidth,this.parent.clientHeight),h.setPixelRatio(Math.max(1,window.devicePixelRatio/2))),this.scenes.set(h.sceneKey,h)}),(t=this.scenes.get(i))===null||t===void 0||t.start(i)}}r.Project=u}),ae=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0}),r.JoyStick=void 0;class u extends V.EventEmitter{constructor(){super(...arguments);this.id=-1}get add(){return{axis:(o={})=>this.addAxis(o),button:(o={})=>this.addButton(o)}}addAxis(o={}){this.id++;const{styles:t={left:35,bottom:35,size:100}}=o,i=this.circle({styles:t}),n=this.thumb({styles:t});i.appendChild(n),document.body.appendChild(i);const{maxRadius:c=40,rotationDamping:h=.06,moveDamping:e=.01}=o,s={id:this.id,domElement:n,maxRadius:c,maxRadiusSquared:c*c,origin:{left:n.offsetLeft,top:n.offsetTop},offset:{x:0,y:0},rotationDamping:h,moveDamping:e};if(s==null?void 0:s.domElement){const{domElement:a}=s;"ontouchstart"in window?a.addEventListener("touchstart",d=>{d.preventDefault(),this.tap(d,s),d.stopPropagation()}):a.addEventListener("mousedown",d=>{d.preventDefault(),this.tap(d,s),d.stopPropagation()})}return{onMove:a=>{this.on(`axis_onmove_${s.id}`,d=>{a(d)})}}}addButton(o={}){this.id++;const{styles:t={right:35,bottom:35,size:80},letter:i="A"}=o,n=this.circle({styles:t}),c=this.letter({letter:i});n.appendChild(c),document.body.appendChild(n);const h={id:this.id,domElement:n,offset:{x:0,y:0}};return(h==null?void 0:h.domElement)&&this.click(h),{onClick:e=>{this.on(`button_onclick_${h.id}`,s=>{e(s)})},onRelease:e=>{this.on(`button_onrelease_${h.id}`,s=>{e(s)})}}}circle(o={}){const{styles:t}=o,{top:i,right:n,bottom:c,left:h,size:e}=t,s=document.createElement("div");let a=`position:absolute; width:${e}px; height:${e}px; background:rgba(126, 126, 126, 0.5); border:#444 solid medium; border-radius:50%; cursor: pointer; `;return i&&(a+=`top:${i}px; `),n&&(a+=`right:${n}px; `),c&&(a+=`bottom:${c}px; `),h&&(a+=`left:${h}px; `),s.style.cssText=a,s}thumb(o={}){const{styles:t}=o,{size:i}=t,n=document.createElement("div");return n.style.cssText=`position: absolute; left: ${i/4}px; top: ${i/4}px; width: ${i/2}px; height: ${i/2}px; border-radius: 50%; background: #fff; `,n}letter(o={}){const{letter:t}=o,i=document.createElement("span");return i.innerText=t,i.style.cssText="position: absolute; text-align: center; top: 4px; width: 80px; height: 80px; font-size: 64px; color: #fff; ",i}click(o){const{id:t,domElement:i}=o;"ontouchstart"in window?(i.addEventListener("touchstart",n=>{n.preventDefault(),this.emit(`button_onclick_${t}`)}),i.addEventListener("touchend",n=>{n.preventDefault(),this.emit(`button_onrelease_${t}`)})):(i.addEventListener("mousedown",n=>{n.preventDefault(),this.emit(`button_onclick_${t}`),n.stopPropagation()}),i.addEventListener("mouseup",n=>{n.preventDefault(),this.emit(`button_onrelease_${t}`),n.stopPropagation()}))}tap(o,t){o=o||window.event,t.offset=this.getMousePosition(o),"ontouchstart"in window?(document.ontouchmove=i=>{i.target===t.domElement&&this.move(i,t)},document.ontouchend=i=>{i.target===t.domElement&&this.up(t)}):(document.onmousemove=i=>{i.target===t.domElement&&this.move(i,t)},document.onmouseup=i=>{this.up(t)})}move(o,t){const{domElement:i,maxRadius:n,maxRadiusSquared:c,origin:h,offset:e,id:s}=t;o=o||window.event;const a=this.getMousePosition(o);let d=a.x-e.x,f=a.y-e.y;const p=d*d+f*f;if(p>c){const y=Math.sqrt(p);d/=y,f/=y,d*=n,f*=n}i.style.top=`${f+i.clientHeight/2}px`,i.style.left=`${d+i.clientWidth/2}px`;const m=-(f-h.top+i.clientHeight/2)/n,g=(d-h.left+i.clientWidth/2)/n;this.emit(`axis_onmove_${s}`,{top:m,right:g})}up(o){const{domElement:t,origin:i,id:n}=o;"ontouchstart"in window?(document.ontouchmove=null,document.touchend=null):(document.onmousemove=null,document.onmouseup=null),t.style.top=`${i.top}px`,t.style.left=`${i.left}px`,this.emit(`axis_onmove_${n}`,{top:0,right:0})}getMousePosition(o){let t=o.targetTouches?o.targetTouches[0].pageX:o.clientX,i=o.targetTouches?o.targetTouches[0].pageY:o.clientY;return{x:t,y:i}}}r.JoyStick=u}),ce=w(function(P,r){/**
 * @description  This code has originally been copied from Sketchbook
 *
 * @author       swift502 <blaha.j502@gmail.com> (http://jblaha.art/)
 * @copyright    Copyright (c) 2018 swift502; Project Url: https://github.com/swift502/Sketchbook
 * @license      {@link https://github.com/swift502/Sketchbook/blob/master/LICENSE|GPL-3.0}
 *
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0}),r.ThirdPersonControls=void 0;class u{constructor(o,t,i){this.camera=o,this.target=t,this.config=i;const{offset:n=new l.Vector3(0,0,0),sensitivity:c=new l.Vector2(1,1),radius:h=8,targetRadius:e=10,interpolationFactor:s=.05,pointerLock:a=!0,autoUpdate:d=!0,theta:f=0,phi:p=0,maxPhi:m=85,minPhi:g=-85}=i;this.offset=n,this.sensitivity=c,this.radius=h,this.targetRadius=e,this.interpolationFactor=s,this.theta=f,this.phi=p,this.maxPhi=m,this.minPhi=g}update(o,t){const i=this.target.position.clone().add(this.offset);this.theta-=o*(this.sensitivity.x/2),this.theta%=360,this.phi+=t*(this.sensitivity.y/2),this.phi=Math.min(this.maxPhi,Math.max(this.minPhi,this.phi)),this.radius=l.MathUtils.lerp(this.radius,this.targetRadius,this.interpolationFactor),this.camera.position.x=i.x+this.radius*Math.sin(this.theta*Math.PI/180)*Math.cos(this.phi*Math.PI/180),this.camera.position.y=i.y+this.radius*Math.sin(this.phi*Math.PI/180),this.camera.position.z=i.z+this.radius*Math.cos(this.theta*Math.PI/180)*Math.cos(this.phi*Math.PI/180),this.camera.updateMatrix(),this.camera.lookAt(i)}}r.ThirdPersonControls=u}),he=w(function(P,r){/**
 * @description  This code has originally been copied from Sketchbook
 *
 * @author       swift502 <blaha.j502@gmail.com> (http://jblaha.art/)
 * @copyright    Copyright (c) 2018 swift502; Project Url: https://github.com/swift502/Sketchbook
 * @license      {@link https://github.com/swift502/Sketchbook/blob/master/LICENSE|GPL-3.0}
 *
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0}),r.FirstPersonControls=void 0;class u{constructor(o,t,i){this.camera=o,this.target=t,this.config=i;const{offset:n=new l.Vector3(0,0,0),sensitivity:c=new l.Vector2(1,1),radius:h=8,targetRadius:e=10,interpolationFactor:s=.05,pointerLock:a=!0,autoUpdate:d=!0}=i;this.offset=n,this.sensitivity=c,this.radius=h,this.targetRadius=e,this.interpolationFactor=s,this.theta=0,this.phi=0}update(o,t){const i=this.target.position.clone().add(this.offset);this.camera.position.copy(i),this.theta-=o*(this.sensitivity.x/2),this.theta%=360,this.phi+=t*(-this.sensitivity.y/2),this.phi=Math.min(85,Math.max(-85,this.phi));const n=new l.Vector3;n.x=i.x+this.radius*Math.sin(this.theta*Math.PI/180)*Math.cos(this.phi*Math.PI/180),n.y=i.y+this.radius*Math.sin(this.phi*Math.PI/180),n.z=i.z+this.radius*Math.cos(this.theta*Math.PI/180)*Math.cos(this.phi*Math.PI/180),this.camera.updateMatrix(),this.camera.lookAt(n)}}r.FirstPersonControls=u}),le=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PointerLock=void 0;class u{constructor(o,t=!0){this._element=o,this._isRunning=!1,t&&this.request()}isLocked(){return!!document.pointerLockElement}exit(){this._isRunning=!1,document.exitPointerLock(),this.removeListeners()}removeListeners(){document.removeEventListener("pointerlockchange",()=>this.pointerLockChangeHandler()),this._element.removeEventListener("pointerdown",()=>this.pointerDownHandlerHandler())}pointerLockChangeHandler(){if(!this._isRunning)return;this._request()}pointerDownHandlerHandler(){if(!this._isRunning)return;this._element.requestPointerLock()}request(){this._isRunning=!0,this._request()}_request(){if(document.addEventListener("pointerlockchange",()=>this.pointerLockChangeHandler(),{once:!0}),document.pointerLockElement)return;this._element.addEventListener("pointerdown",()=>this.pointerDownHandlerHandler(),{once:!0})}}r.PointerLock=u}),de=w(function(P,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PointerDrag=void 0;class u{constructor(o,t=!0){this._element=o,this._isRunning=!1,this._position={x:0,y:0},this._delta={x:0,y:0},this._onMoveCallback=()=>{},this._isPointerDown=!1,t&&this.start()}get isTouchDevice(){return"ontouchstart"in window}get isPointerDown(){return this._isPointerDown}start(){if(this._isRunning)return;this._isRunning=!0,this.isTouchDevice?(this._element.addEventListener("touchstart",o=>this.onTouchStart(o)),this._element.addEventListener("touchend",o=>this.onTouchEnd(o)),this._element.addEventListener("touchmove",o=>this.onTouchMove(o))):(this._element.addEventListener("mousedown",o=>this.onPointerDown(o)),this._element.addEventListener("mouseup",o=>this.onPointerUp(o)),this._element.addEventListener("mouseleave",o=>this.onPointerLeave(o)),this._element.addEventListener("mouseover",o=>this.onPointerOver(o)),this._element.addEventListener("mousemove",o=>this.onPointerMove(o)))}stop(){this.isTouchDevice?(this._element.removeEventListener("touchstart",o=>this.onTouchStart(o)),this._element.removeEventListener("touchend",o=>this.onTouchEnd(o)),this._element.removeEventListener("touchmove",o=>this.onTouchMove(o))):(this._element.removeEventListener("mousedown",o=>this.onPointerDown(o)),this._element.removeEventListener("mouseleave",o=>this.onPointerLeave(o)),this._element.removeEventListener("mouseup",o=>this.onPointerUp(o)),this._element.removeEventListener("mouseover",o=>this.onPointerOver(o)),this._element.removeEventListener("mousemove",o=>this.onPointerMove(o))),this._isRunning=!1}removeListeners(){this.stop()}onMove(o){this._onMoveCallback=o}onPointerDown(o){this._isPointerDown=!0}onPointerUp(o){this._isPointerDown=!1}onPointerLeave(o){this._isPointerDown=!1}onPointerMove(o){const t=o.movementX,i=o.movementY;this._delta={x:t,y:i},this._onMoveCallback(this._delta)}onPointerOver(o){}onTouchStart(o){const t=o.touches[0].clientX,i=o.touches[0].clientY;this._position={x:t,y:i}}onTouchEnd(o){this._position={x:0,y:0},this._delta={x:0,y:0},this._onMoveCallback(this._delta)}onTouchMove(o){const t=o.touches[0].clientX,i=o.touches[0].clientY;this._delta={x:t-this._position.x,y:i-this._position.y},this._onMoveCallback(this._delta),this._position={x:t,y:i}}}r.PointerDrag=u}),O=w(function(P,r){/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */Object.defineProperty(r,"__esModule",{value:!0}),r.Scene3D=oe.Scene3D,r.Project=re.Project,r.PhysicsLoader=A.PhysicsLoader,r.ExtendedMesh=H.ExtendedMesh,r.ExtendedObject3D=z.ExtendedObject3D,r.ExtendedGroup=Y.ExtendedGroup,r.THREE=l,r.Types=G,r.JoyStick=ae.JoyStick,r.ThirdPersonControls=ce.ThirdPersonControls,r.FirstPersonControls=he.FirstPersonControls,r.PointerLock=le.PointerLock,r.PointerDrag=de.PointerDrag;var u=l;r.EffectComposer=u.EffectComposer,r.RenderPass=u.RenderPass,r.ShaderPass=u.ShaderPass,r.GlitchPass=u.GlitchPass,r.DotScreenShader=u.DotScreenShader}),ue=O.ExtendedObject3D,pe=O.JoyStick;export{ue as ExtendedObject3D,pe as JoyStick};
