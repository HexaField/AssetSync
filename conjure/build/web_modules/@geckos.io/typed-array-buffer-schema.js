import{c as E,a as F,b as he}from"../common/_commonjsHelpers-c99fd594.js";import{_ as Q,i as G,a as le,b as fe,c as de,d as X,e as ee}from"../common/isObjectLike-d91d764a.js";var ve=E(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Schema=void 0;var r=function(){function i(h,f,n){this._id=h,this._name=f,this._struct=n,this._bytes=0,i.Validation(n),this.calcBytes()}return i.Validation=function(h){},Object.defineProperty(i.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),i.prototype.calcBytes=function(){var h=this,f=function(n){var s,a;for(var l in n){var o=(n==null?void 0:n._type)||((s=n==null?void 0:n.type)===null||s===void 0?void 0:s._type),k=n._bytes||((a=n.type)===null||a===void 0?void 0:a._bytes);if(!o&&n.hasOwnProperty(l))typeof n[l]=="object"&&f(n[l]);else{if(l!=="_type"&&l!=="type")return;if(!k)return;if(o==="String8"||o==="String16"){var c=n.length||12;h._bytes+=k*c}else h._bytes+=k}}};f(this._struct)},Object.defineProperty(i.prototype,"struct",{get:function(){return this._struct},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"bytes",{get:function(){return this._bytes},enumerable:!1,configurable:!0}),i}();e.Schema=r}),K=E(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Lib=void 0;var r=function(){function i(){}return i.newHash=function(h,f){var n=function(a){for(var l=0,o=0;o<a.length;o++){var k=a.charCodeAt(o);l=(l<<5)-l+k,l|=0}return l*=254785,Math.abs(l).toString(32).slice(2,6)},s=n(JSON.stringify(f)+h);if(s.length!==4)throw new Error("Hash has not length of 4");return"#"+s},i.schema=function(h,f){var n=i.newHash(h,f),s=new ve.Schema(n,h,f);return this._schemas.set(n,s),s},i._schemas=new Map,i}();e.Lib=r}),me=Q["__core-js_shared__"],J=me,te=function(){var t=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ye(t){return!!te&&te in t}var pe=ye,_e=Function.prototype,be=_e.toString;function ge(t){if(t!=null){try{return be.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var we=ge,Oe=/[\\^$.*+?()[\]{}|]/g,ke=/^\[object .+?Constructor\]$/,Se=Function.prototype,je=Object.prototype,Ce=Se.toString,Te=je.hasOwnProperty,Ae=RegExp("^"+Ce.call(Te).replace(Oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Pe(t){if(!G(t)||pe(t))return!1;var e=le(t)?Ae:ke;return e.test(we(t))}var Ie=Pe;function Ue(t,e){return t==null?void 0:t[e]}var Re=Ue;function ze(t,e){var r=Re(t,e);return Ie(r)?r:void 0}var Z=ze,Me=function(){try{var t=Z(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),re=Me;function Ee(t,e,r){e=="__proto__"&&re?re(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Fe=Ee;function Be(t,e){return t===e||t!==t&&e!==e}var ae=Be,Ne=Object.prototype,Ve=Ne.hasOwnProperty;function De(t,e,r){var i=t[e];(!(Ve.call(t,e)&&ae(i,r))||r===void 0&&!(e in t))&&Fe(t,e,r)}var He=De,$e="[object Symbol]";function Le(t){return typeof t=="symbol"||fe(t)&&de(t)==$e}var W=Le,xe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qe=/^\w*$/;function Ge(t,e){if(X(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||W(t)?!0:qe.test(t)||!xe.test(t)||e!=null&&t in Object(e)}var Xe=Ge,Ke=Z(Object,"create"),$=Ke;function Je(){this.__data__=$?$(null):{},this.size=0}var Ze=Je;function We(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Ye=We,Qe="__lodash_hash_undefined__",et=Object.prototype,tt=et.hasOwnProperty;function rt(t){var e=this.__data__;if($){var r=e[t];return r===Qe?void 0:r}return tt.call(e,t)?e[t]:void 0}var at=rt,nt=Object.prototype,it=nt.hasOwnProperty;function st(t){var e=this.__data__;return $?e[t]!==void 0:it.call(e,t)}var ot=st,ct="__lodash_hash_undefined__";function ut(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=$&&e===void 0?ct:e,this}var ht=ut;function B(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}B.prototype.clear=Ze,B.prototype.delete=Ye,B.prototype.get=at,B.prototype.has=ot,B.prototype.set=ht;var ne=B;function lt(){this.__data__=[],this.size=0}var ft=lt;function dt(t,e){for(var r=t.length;r--;)if(ae(t[r][0],e))return r;return-1}var x=dt,vt=Array.prototype,mt=vt.splice;function yt(t){var e=this.__data__,r=x(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():mt.call(e,r,1),--this.size,!0}var pt=yt;function _t(t){var e=this.__data__,r=x(e,t);return r<0?void 0:e[r][1]}var bt=_t;function gt(t){return x(this.__data__,t)>-1}var wt=gt;function Ot(t,e){var r=this.__data__,i=x(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}var kt=Ot;function N(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}N.prototype.clear=ft,N.prototype.delete=pt,N.prototype.get=bt,N.prototype.has=wt,N.prototype.set=kt;var St=N,jt=Z(Q,"Map"),Ct=jt;function Tt(){this.size=0,this.__data__={hash:new ne,map:new(Ct||St),string:new ne}}var At=Tt;function Pt(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var It=Pt;function Ut(t,e){var r=t.__data__;return It(e)?r[typeof e=="string"?"string":"hash"]:r.map}var q=Ut;function Rt(t){var e=q(this,t).delete(t);return this.size-=e?1:0,e}var zt=Rt;function Mt(t){return q(this,t).get(t)}var Et=Mt;function Ft(t){return q(this,t).has(t)}var Bt=Ft;function Nt(t,e){var r=q(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}var Vt=Nt;function V(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}V.prototype.clear=At,V.prototype.delete=zt,V.prototype.get=Et,V.prototype.has=Bt,V.prototype.set=Vt;var ie=V,Dt="Expected a function";function Y(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Dt);var r=function(){var i=arguments,h=e?e.apply(this,i):i[0],f=r.cache;if(f.has(h))return f.get(h);var n=t.apply(this,i);return r.cache=f.set(h,n)||f,n};return r.cache=new(Y.Cache||ie),r}Y.Cache=ie;var Ht=Y,$t=500;function Lt(t){var e=Ht(t,function(i){return r.size===$t&&r.clear(),i}),r=e.cache;return e}var xt=Lt,qt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gt=/\\(\\)?/g,Xt=xt(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(qt,function(r,i,h,f){e.push(h?f.replace(Gt,"$1"):i||r)}),e}),Kt=Xt;function Jt(t,e){for(var r=-1,i=t==null?0:t.length,h=Array(i);++r<i;)h[r]=e(t[r],r,t);return h}var Zt=Jt,Wt=1/0,se=ee?ee.prototype:void 0,oe=se?se.toString:void 0;function ce(t){if(typeof t=="string")return t;if(X(t))return Zt(t,ce)+"";if(W(t))return oe?oe.call(t):"";var e=t+"";return e=="0"&&1/t==-Wt?"-0":e}var Yt=ce;function Qt(t){return t==null?"":Yt(t)}var er=Qt;function tr(t,e){return X(t)?t:Xe(t,e)?[t]:Kt(er(t))}var rr=tr,ar=9007199254740991,nr=/^(?:0|[1-9]\d*)$/;function ir(t,e){var r=typeof t;return e=e??ar,!!e&&(r=="number"||r!="symbol"&&nr.test(t))&&(t>-1&&t%1==0)&&t<e}var sr=ir,or=1/0;function cr(t){if(typeof t=="string"||W(t))return t;var e=t+"";return e=="0"&&1/t==-or?"-0":e}var ur=cr;function hr(t,e,r,i){if(!G(t))return t;e=rr(e,t);for(var h=-1,f=e.length,n=f-1,s=t;s!=null&&++h<f;){var a=ur(e[h]),l=r;if(a==="__proto__"||a==="constructor"||a==="prototype")return t;if(h!=n){var o=s[a];l=i?i(o,a,s):void 0,l===void 0&&(l=G(o)?o:sr(e[h+1])?[]:{})}He(s,a,l),s=s[a]}return t}var lr=hr;function fr(t,e,r){return t==null?t:lr(t,e,r)}var dr=fr,vr=E(function(t,e){var r=F&&F.__assign||function(){return r=Object.assign||function(n){for(var s,a=1,l=arguments.length;a<l;a++){s=arguments[a];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(n[o]=s[o])}return n},r.apply(this,arguments)},i=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.Serialize=void 0;var h=i(dr),f=function(){function n(s){this.schema=s,this._buffer=new ArrayBuffer(0),this._dataView=new DataView(this._buffer),this._bytes=0}return n.prototype.refresh=function(){this._buffer=new ArrayBuffer(8*1024),this._dataView=new DataView(this._buffer),this._bytes=0},n.prototype.cropString=function(s,a){return s.padEnd(a," ").slice(0,a)},n.prototype.flatten=function(s,a){var l=this,o=[],k=function(c,p){var u,d,g,D,z,R,M;(c==null?void 0:c._id)?o.push({d:c._id,t:"String8"}):((u=c==null?void 0:c[0])===null||u===void 0?void 0:u._id)&&o.push({d:c[0]._id,t:"String8"}),(c==null?void 0:c._struct)?c=c._struct:((d=c==null?void 0:c[0])===null||d===void 0?void 0:d._struct)&&(c=c[0]._struct);for(var y in p)if(p.hasOwnProperty(y))if(typeof p[y]=="object")Array.isArray(p)?k(c,p[parseInt(y)]):k(c[y],p[y]);else if((D=(g=c[y])===null||g===void 0?void 0:g.type)===null||D===void 0?void 0:D._type){if(((z=c[y])===null||z===void 0?void 0:z.digits)&&(p[y]*=Math.pow(10,c[y].digits),p[y]=parseInt(p[y].toFixed(0))),(R=c[y])===null||R===void 0?void 0:R.length){var v=(M=c[y])===null||M===void 0?void 0:M.length;p[y]=l.cropString(p[y],v)}o.push({d:p[y],t:c[y].type._type})}else(c[y]._type==="String8"||c[y]._type==="String16")&&(p[y]=l.cropString(p[y],12)),o.push({d:p[y],t:c[y]._type})};return k(s,a),o},n.prototype.toBuffer=function(s){var a=this,l=JSON.parse(JSON.stringify(s));this.refresh();var o=this.flatten(this.schema,l);o.forEach(function(u,d){if(u.t==="String8")for(var g=0;g<u.d.length;g++)a._dataView.setUint8(a._bytes,u.d[g].charCodeAt(0)),a._bytes++;if(u.t==="String16")for(var g=0;g<u.d.length;g++)a._dataView.setUint16(a._bytes,u.d[g].charCodeAt(0)),a._bytes+=2;u.t==="Int8Array"&&(a._dataView.setInt8(a._bytes,u.d),a._bytes++),u.t==="Uint8Array"&&(a._dataView.setUint8(a._bytes,u.d),a._bytes++),u.t==="Int16Array"&&(a._dataView.setInt16(a._bytes,u.d),a._bytes+=2),u.t==="Uint16Array"&&(a._dataView.setUint16(a._bytes,u.d),a._bytes+=2),u.t==="Int32Array"&&(a._dataView.setInt32(a._bytes,u.d),a._bytes+=4),u.t==="Uint32Array"&&(a._dataView.setUint32(a._bytes,u.d),a._bytes+=4),u.t==="BigInt64Array"&&(a._dataView.setBigInt64(a._bytes,BigInt(u.d)),a._bytes+=8),u.t==="BigUint64Array"&&(a._dataView.setBigUint64(a._bytes,BigInt(u.d)),a._bytes+=8),u.t==="Float32Array"&&(a._dataView.setFloat32(a._bytes,u.d),a._bytes+=4),u.t==="Float64Array"&&(a._dataView.setFloat64(a._bytes,u.d),a._bytes+=8)});for(var k=new ArrayBuffer(this._bytes),c=new DataView(k),p=0;p<this._bytes;p++)c.setUint8(p,this._dataView.getUint8(p));return k},n.prototype.fromBuffer=function(s){for(var a=0,l=[],o=new DataView(s),k=Array.from(new Int8Array(s));a>-1;)a=k.indexOf(35,a),a!==-1&&(l.push(a),a++);var c=[];l.forEach(function(v){for(var j="",b=0;b<5;b++){var S=String.fromCharCode(k[v+b]);j+=S}c.push(j)});var p=[];c.forEach(function(v,j){var b=K.Lib._schemas.get(v);b&&p.push({id:v,schema:K.Lib._schemas.get(v),startsAt:l[j]+5})});var u={},d=0,g={},D=function(v){var j,b,S,A={};if(typeof v=="object"){for(var P in v)if(v.hasOwnProperty(P)){var m=v[P],I=void 0;if(((b=m==null?void 0:m.type)===null||b===void 0?void 0:b._type)&&((S=m==null?void 0:m.type)===null||S===void 0?void 0:S._bytes)&&(I=m,m._type=m.type._type,m._bytes=m.type._bytes),m&&m._type&&m._bytes){var w=m._type,C=m._bytes,_=void 0;if(w==="String8"){_="";for(var H=m.length||12,U=0;U<H;U++){var L=String.fromCharCode(o.getUint8(d));_+=L,d++}}if(w==="String16"){_="";for(var ue=m.length||12,U=0;U<ue;U++){var L=String.fromCharCode(o.getUint16(d));_+=L,d+=2}}w==="Int8Array"&&(_=o.getInt8(d),d+=C),w==="Uint8Array"&&(_=o.getUint8(d),d+=C),w==="Int16Array"&&(_=o.getInt16(d),d+=C),w==="Uint16Array"&&(_=o.getUint16(d),d+=C),w==="Int32Array"&&(_=o.getInt32(d),d+=C),w==="Uint32Array"&&(_=o.getUint32(d),d+=C),w==="BigInt64Array"&&(_=parseInt(o.getBigInt64(d).toString()),d+=C),w==="BigUint64Array"&&(_=parseInt(o.getBigUint64(d).toString()),d+=C),w==="Float32Array"&&(_=o.getFloat32(d),d+=C),w==="Float64Array"&&(_=o.getFloat64(d),d+=C),typeof _=="number"&&(I==null?void 0:I.digits)&&(_*=Math.pow(10,-I.digits),_=parseFloat(_.toFixed(I.digits))),A=r(r({},A),(j={},j[P]=_,j))}}}return A};p.forEach(function(v,j){var b,S,A,P=(b=v.schema)===null||b===void 0?void 0:b.struct,m=v.startsAt,I=s.byteLength,w=((S=v.schema)===null||S===void 0?void 0:S.id)||"XX";w==="XX"&&console.error("ERROR: Something went horribly wrong!");try{I=p[j+1].startsAt-5}catch(L){}for(var C=((A=v.schema)===null||A===void 0?void 0:A.bytes)||1,_=(I-m)/C,H=0;H<_;H++){d=m+H*C;var U=D(P);_<=1?g[w]=r({},U):(typeof g[w]=="undefined"&&(g[w]=[]),g[w].push(U))}}),u={};for(var z=function(v,j,b,S,A){if(S===void 0&&(S=""),A===void 0&&(A=!1),v&&v._id&&v._id===j){var P=S.replace(/_struct\./,"").replace(/\.$/,"");A&&!Array.isArray(b)&&(b=[b]),P===""?u=r(r({},u),b):h.default(u,P,b)}else for(var m in v)if(v.hasOwnProperty(m)&&typeof v[m]=="object"){var P=Array.isArray(v)?"":m+".";z(v[m],j,b,S+P,Array.isArray(v))}},R=0;R<Object.keys(g).length;R++){var M=Object.keys(g)[R],y=g[M];z(this.schema,M,y,"")}return u},n}();e.Serialize=f}),mr=E(function(t,e){var r=F&&F.__extends||function(){var h=function(f,n){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var l in a)a.hasOwnProperty(l)&&(s[l]=a[l])},h(f,n)};return function(f,n){h(f,n);function s(){this.constructor=f}f.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var i=function(h){r(f,h);function f(n){var s=h.call(this,n)||this;return s.schema=n,s}return f}(vr.Serialize);e.Model=i}),T=E(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.string16=e.string8=e.float64=e.float32=e.uint64=e.int64=e.uint32=e.int32=e.uint16=e.int16=e.uint8=e.int8=void 0,e.int8={_type:"Int8Array",_bytes:1},e.uint8={_type:"Uint8Array",_bytes:1},e.int16={_type:"Int16Array",_bytes:2},e.uint16={_type:"Uint16Array",_bytes:2},e.int32={_type:"Int32Array",_bytes:4},e.uint32={_type:"Uint32Array",_bytes:4},e.int64={_type:"BigInt64Array",_bytes:8},e.uint64={_type:"BigUint64Array",_bytes:8},e.float32={_type:"Float32Array",_bytes:4},e.float64={_type:"Float64Array",_bytes:8},e.string8={_type:"String8",_bytes:1},e.string16={_type:"String16",_bytes:2}}),O=E(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"BufferSchema",{enumerable:!0,get:function(){return K.Lib}}),Object.defineProperty(e,"Model",{enumerable:!0,get:function(){return mr.Model}}),Object.defineProperty(e,"int8",{enumerable:!0,get:function(){return T.int8}}),Object.defineProperty(e,"uint8",{enumerable:!0,get:function(){return T.uint8}}),Object.defineProperty(e,"int16",{enumerable:!0,get:function(){return T.int16}}),Object.defineProperty(e,"uint16",{enumerable:!0,get:function(){return T.uint16}}),Object.defineProperty(e,"int32",{enumerable:!0,get:function(){return T.int32}}),Object.defineProperty(e,"uint32",{enumerable:!0,get:function(){return T.uint32}}),Object.defineProperty(e,"int64",{enumerable:!0,get:function(){return T.int64}}),Object.defineProperty(e,"uint64",{enumerable:!0,get:function(){return T.uint64}}),Object.defineProperty(e,"float32",{enumerable:!0,get:function(){return T.float32}}),Object.defineProperty(e,"float64",{enumerable:!0,get:function(){return T.float64}}),Object.defineProperty(e,"string8",{enumerable:!0,get:function(){return T.string8}}),Object.defineProperty(e,"string16",{enumerable:!0,get:function(){return T.string16}})}),yr=he(O),pr=O.BufferSchema,_r=O.Model;export default yr;var br=O.float32,gr=O.float64,wr=O.int16,Or=O.int32,kr=O.int64,Sr=O.int8,jr=O.string16,Cr=O.string8,Tr=O.uint16,Ar=O.uint32,Pr=O.uint64,Ir=O.uint8;export{pr as BufferSchema,_r as Model,O as __moduleExports,br as float32,gr as float64,wr as int16,Or as int32,kr as int64,Sr as int8,jr as string16,Cr as string8,Tr as uint16,Ar as uint32,Pr as uint64,Ir as uint8};
