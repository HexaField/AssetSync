const a=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;export default class i{constructor(){this.realState={keyStates:new Array(256),mouseStates:new Array(3),mousePosition:{x:0,y:0},mouseMovement:{x:0,y:0}},this.keyStates=new Array(256),this.previousKeyStates=new Array(256),this.mouseStates=new Array(3),this.previousMouseStates=new Array(3),this.useRealState=!1,this.mousePosition={x:0,y:0},this.mouseMovement={x:0,y:0},this.lastMousePosition={x:0,y:0};for(var e=0;e<this.keyStates.length;e++)this.keyStates[e]=!1,this.previousKeyStates[e]=!1;for(var e=0;e<this.mouseStates.length;e++)this.mouseStates[e]=!1,this.previousMouseStates[e]=!1;window.addEventListener("keydown",t=>{t.which==18&&t.preventDefault(),this.realState.keyStates[t.which]=!0}),window.addEventListener("keyup",t=>{this.realState.keyStates[t.which]=!1}),window.addEventListener("mousedown",t=>{this.realState.mouseStates[t.button]=!0}),window.addEventListener("mouseup",t=>{this.realState.mouseStates[t.button]=!1}),window.addEventListener("mousemove",t=>{this.realState.mousePosition.x=t.clientX,this.realState.mousePosition.y=t.clientY,this.realState.mouseMovement.x=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.realState.mouseMovement.y=t.movementY||t.mozMovementY||t.webkitMovementY||0}),this.isFireFox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1}removeWhiteSpace(e){var t=t+"";return e.replace(/\s+/,"")}stripWhiteSpace(e){var t=t+"";return e.replace(/\s+/," ")}convertStringToKeycode(e){var e=this.removeWhiteSpace(e);e=e.toUpperCase();switch(e){case"BACKSPACE":return["key",8];case"SPACEBAR":return["key",32];case"TAB":return["key",9];case"ENTER":return["key",13];case"SHIFT":return["key",16];case"CONTROL":return["key",17];case"ALT":return["key",18];case"CAPSLOCK":return["key",20];case"ESCAPE":return["key",27];case"PAGEUP":return["key",33];case"PAGEDOWN":return["key",34];case"ARROWLEFT":return["key",37];case"ARROWUP":return["key",38];case"ARROWRIGHT":return["key",38];case"ARROWDOWN":return["key",40];case"INSERT":return["key",45];case"DELETE":return["key",46];case"GRAVE":return["key",192];case"+":return["key",a?61:187];case"=":return["key",a?61:187];case"-":return["key",a?173:189];case"[":return["key",219];case"]":return["key",221];case"/":return["key",191];case"\\":return["key",220];default:return["key",e.charCodeAt(0)]}}convertStringToKeyCombo(e){for(var t=this.stripWhiteSpace(e),s=t.split(" "),o=0;o<s.length;o++)s[o]=this.convertStringToKeycode(s[o]);return s}convertStringToButtonCode(e){var t=this.removeWhiteSpace(e);t=t.toUpperCase();switch(e){case"MOUSELEFT":return["mouse",0];case"MOUSEMIDDLE":return["mouse",1];case"MOUSERIGHT":return["mouse",2];default:return null}}convertStringToCombo(e){for(var e=this.stripWhiteSpace(e),t=e.split(" "),s=[],o=0;o<t.length;o++){var r=this.convertStringToButtonCode(t[o]);r!=null?s.push(r):s.push(this.convertStringToKeycode(t[o]))}return s}checkCombo(e,t,s){for(var o=this.convertStringToCombo(e),r=0;r<o.length;r++)if(o[r][0]==="mouse"){if(!t[o[r][1]])return!1}else if(!s[o[r][1]])return!1;return!0}init(){for(var e=0;e<this.realState.keyStates.length;e++)this.realState.keyStates[e]=!1;for(var e=0;e<this.realState.mouseStates.length;e++)this.realState.mouseStates[e]=!1}isKeyDown(e,t){var s=this.convertStringToKeycode(e);return t[s]}isButtonDown(e,t){var s=this.convertStringToButtonCode(e);return t[s]}isKeyClicked(e,t,s){return this.isKeyDown(e,t)&&!this.isKeyDown(e,s)}isButtonClicked(e,t,s){return this.isButtonDown(e,t)&&!this.isButtonDown(e,s)}isReleased(e){return!this.checkCombo(e,this.mouseStates,this.keyStates)&&this.checkCombo(e,this.previousMouseStates,this.previousKeyStates)}isPressed(e){return this.checkCombo(e,this.mouseStates,this.keyStates)&&!this.checkCombo(e,this.previousMouseStates,this.previousKeyStates)}isDown(e){return this.useRealState?(this.mousePosition.x=this.realState.mousePosition.x,this.mousePosition.y=this.realState.mousePosition.y,this.checkCombo(e,this.realState.mouseStates,this.realState.keyStates)):this.checkCombo(e,this.mouseStates,this.keyStates)}update(){this.previousKeyStates=this.keyStates.slice(0),this.keyStates=this.realState.keyStates.slice(0),this.previousMouseStates=this.mouseStates.slice(0),this.mouseStates=this.realState.mouseStates.slice(0),this.lastMousePosition.x=this.mousePosition.x,this.lastMousePosition.y=this.mousePosition.y,this.mousePosition.x=this.realState.mousePosition.x,this.mousePosition.y=this.realState.mousePosition.y,this.mouseMovement.x=this.realState.mouseMovement.x,this.mouseMovement.y=this.realState.mouseMovement.y,this.realState.mouseMovement.x=0,this.realState.mouseMovement.y=0}}
