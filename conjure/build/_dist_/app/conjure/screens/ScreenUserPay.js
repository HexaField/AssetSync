import h from"./ScreenBase.js";import e from"./elements/ScreenElementText.js";import n from"./elements/ScreenElementTextBox.js";import i from"./elements/ScreenElementButton.js";import{NETWORKING_OPCODES as a}from"../../backend/Constants.js";import r from"./elements/ScreenElementLabelled.js";export default class d extends h{constructor(t,s){super(t,s);this.background.position.setZ(-.1),this.group.add(this.background),this.payidservice=this.screenManager.conjure.getProfile().getServiceManager().getService("PayID"),this.user=void 0,this.pay=this.pay.bind(this),this.textMyPayidTitle=new e(this,this,{x:-this.width/4,y:this.height/2-.1,width:this.buttonWidth,height:this.buttonHeight,text:"My Payid"}),this.registerElement(this.textMyPayidTitle),this.textOtherPayidTitle=new e(this,this,{x:this.width/4,y:this.height/2-.1,width:this.buttonWidth,height:this.buttonHeight,text:"<other's> Payid"}),this.registerElement(this.textOtherPayidTitle),this.textMyPayidAddress=new e(this,this,{x:-this.width/4,y:this.height/2-.2,width:this.buttonWidth,height:this.buttonHeight,text:"Loading..."}),this.registerElement(this.textMyPayidAddress),this.textOtherPayidAddress=new e(this,this,{x:this.width/4,y:this.height/2-.2,width:this.buttonWidth,height:this.buttonHeight,text:"Loading..."}),this.registerElement(this.textOtherPayidAddress),this.textMyPayidBalance=new e(this,this,{x:-this.width/4,y:this.height/2-.3,width:this.buttonWidth,height:this.buttonHeight,text:"Loading..."}),this.registerElement(this.textMyPayidBalance),this.amountBox=new n(this,this,{x:this.width/8,y:this.height/2-.3,width:this.buttonWidth/2,height:this.buttonHeight}),this.amountBox.setValue(0),this.amountLabel=new r(this,this,{x:this.width/4,y:this.height/2-.3,width:this.buttonWidth/2,height:this.buttonHeight,element:this.amountBox}),this.amountLabel.setText("Amount: "),this.registerElement(this.amountLabel),this.buttonCancel=new i(this,this,{x:-this.width/4,y:-this.height/4,width:this.buttonWidth,height:this.buttonHeight,text:"Cancel"}),this.buttonCancel.setOnClickCallback(()=>{this.screenManager.showScreen(this.screenManager.screenUserInteract)}),this.registerElement(this.buttonCancel),this.buttonPay=new i(this,this,{x:this.width/4,y:-this.height/4,width:this.buttonWidth,height:this.buttonHeight,text:"Pay"}),this.buttonPay.setOnClickCallback(this.pay),this.registerElement(this.buttonPay),this.noOtherPayid="User has no PayID selected",this.noMyPayid="No PayID selected",this.noBal="Could not load balance"}setUser(t){this.screenTitle.setText("Trading with user "+t.username),this.textOtherPayidTitle.setText(t.username+"'s Payid"),this.textOtherPayidAddress.setText("ponderjaunt$xpring.money"),this.textMyPayidAddress.setText("hexafield$xpring.money"),this.textMyPayidBalance.setText("Loading..."),this.amountBox.setValue(3),this.onPayCallback=void 0}setObject(t){this.screenTitle.setText("Trading with object "+t.name),this.amountBox.setValue(10),this.textOtherPayidTitle.setText(t.name+"'s Payid"),this.textOtherPayidAddress.setText(t.userData.payID),this.textMyPayidAddress.setText("Loading..."),this.textMyPayidBalance.setText("Loading..."),this.onPayCallback=()=>{console.log("here we gooooooo!!!!!"),this.screen.screenManager.conjure.getWorld().realm.sendData(a.REALM.TRONIFY),this.screen.screenManager.conjure.getWorld().realm.tron(),t.visible=!1}}setOthersPayID(t){}async setMyPayID(){}pay(){this.screenManager.hideAllScreens(),this.onPayCallback&&this.onPayCallback()}showScreen(t){super.showScreen(t),t&&this.setMyPayID()}update(t){super.update(t)}}
