import{e as Rr}from"./events-18451fd5.js";import{p as Y}from"./process-e9e98960.js";import{b as At}from"./buffer-es6-e6024076.js";import{c as Z,a as pe,d as xb,g as al}from"./_commonjsHelpers-c99fd594.js";import{d as Yt,p as bn}from"./__node-resolve:empty-d7309c3b.js";import{u as Sb}from"./util-8448a06b.js";import{n as Ab}from"./empty-add391ca.js";import{a as Ib}from"./assert-f47f8510.js";import{r as kb}from"./_node-fetch_commonjs-proxy-271b4446.js";var ki=1e3,Ti=ki*60,Ci=Ti*60,Wn=Ci*24,Tb=Wn*7,Cb=Wn*365.25,sl=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return _b(t);if(r==="number"&&isFinite(t))return e.long?Nb(t):Rb(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function _b(t){if(t=String(t),t.length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Cb;case"weeks":case"week":case"w":return r*Tb;case"days":case"day":case"d":return r*Wn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ci;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ti;case"seconds":case"second":case"secs":case"sec":case"s":return r*ki;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}function Rb(t){var e=Math.abs(t);return e>=Wn?Math.round(t/Wn)+"d":e>=Ci?Math.round(t/Ci)+"h":e>=Ti?Math.round(t/Ti)+"m":e>=ki?Math.round(t/ki)+"s":t+"ms"}function Nb(t){var e=Math.abs(t);return e>=Wn?bs(t,e,Wn,"day"):e>=Ci?bs(t,e,Ci,"hour"):e>=Ti?bs(t,e,Ti,"minute"):e>=ki?bs(t,e,ki,"second"):t+" ms"}function bs(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}function Pb(t){r.debug=r,r.default=r,r.coerce=u,r.disable=a,r.enable=i,r.enabled=s,r.humanize=sl,r.destroy=c,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function e(d){let h=0;for(let y=0;y<d.length;y++)h=(h<<5)-h+d.charCodeAt(y),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(d){let h,y=null;function p(...m){if(!p.enabled)return;const _=p,I=Number(new Date),f=I-(h||I);_.diff=f,_.prev=h,_.curr=I,h=I,m[0]=r.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let k=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(g,x)=>{if(g==="%%")return"%";k++;const N=r.formatters[x];if(typeof N=="function"){const w=m[k];g=N.call(_,w),m.splice(k,1),k--}return g}),r.formatArgs.call(_,m);const R=_.log||r.log;R.apply(_,m)}return p.namespace=d,p.useColors=r.useColors(),p.color=r.selectColor(d),p.extend=n,p.destroy=r.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>y===null?r.enabled(d):y,set:m=>{y=m}}),typeof r.init=="function"&&r.init(p),p}function n(d,h){const y=r(this.namespace+(typeof h=="undefined"?":":h)+d);return y.log=this.log,y}function i(d){r.save(d),r.names=[],r.skips=[];let h;const y=(typeof d=="string"?d:"").split(/[\s,]+/),p=y.length;for(h=0;h<p;h++){if(!y[h])continue;d=y[h].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.substr(1)+"$")):r.names.push(new RegExp("^"+d+"$"))}}function a(){const d=[...r.names.map(o),...r.skips.map(o).map(h=>"-"+h)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let h,y;for(h=0,y=r.skips.length;h<y;h++)if(r.skips[h].test(d))return!1;for(h=0,y=r.names.length;h<y;h++)if(r.names[h].test(d))return!0;return!1}function o(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function u(d){return d instanceof Error?d.stack||d.message:d}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var Db=Pb,J=Z(function(t,e){e.formatArgs=n,e.save=i,e.load=a,e.useColors=r,e.storage=s(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;u.splice(1,0,c,"color: inherit");let d=0,h=0;u[0].replace(/%[a-zA-Z%]/g,y=>{if(y==="%%")return;d++,y==="%c"&&(h=d)}),u.splice(h,0,c)}e.log=console.debug||console.log||(()=>{});function i(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch(c){}}function a(){let u;try{u=e.storage.getItem("debug")}catch(c){}return!u&&typeof Y!="undefined"&&"env"in Y&&(u=Y.env.DEBUG),u}function s(){try{return localStorage}catch(u){}}t.exports=Db(e);const{formatters:o}=t.exports;o.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}}),Ob=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ic=Math.ceil,Nr=Math.floor,zt="[BigNumber Error] ",ol=zt+"Number primitive has more than 15 significant digits: ",pr=1e14,ce=14,ac=9007199254740991,sc=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],yn=1e7,It=1e9;function cl(t){var e,r,n,i=f.prototype={constructor:f,toString:null,valueOf:null},a=new f(1),s=20,o=4,u=-7,c=21,d=-1e7,h=1e7,y=!1,p=1,m=0,_={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},I="0123456789abcdefghijklmnopqrstuvwxyz";function f(w,T){var D,v,l,b,A,C,P,O,L=this;if(!(L instanceof f))return new f(w,T);if(T==null){if(w&&w._isBigNumber===!0){L.s=w.s,!w.c||w.e>h?L.c=L.e=null:w.e<d?L.c=[L.e=0]:(L.e=w.e,L.c=w.c.slice());return}if((C=typeof w=="number")&&w*0==0){if(L.s=1/w<0?(w=-w,-1):1,w===~~w){for(b=0,A=w;A>=10;A/=10,b++);b>h?L.c=L.e=null:(L.e=b,L.c=[w]);return}O=String(w)}else{if(!Ob.test(O=String(w)))return n(L,O,C);L.s=O.charCodeAt(0)==45?(O=O.slice(1),-1):1}(b=O.indexOf("."))>-1&&(O=O.replace(".","")),(A=O.search(/e/i))>0?(b<0&&(b=A),b+=+O.slice(A+1),O=O.substring(0,A)):b<0&&(b=O.length)}else{if(Le(T,2,I.length,"Base"),T==10)return L=new f(w),x(L,s+L.e+1,o);if(O=String(w),C=typeof w=="number"){if(w*0!=0)return n(L,O,C,T);if(L.s=1/w<0?(O=O.slice(1),-1):1,f.DEBUG&&O.replace(/^0\.0*|\./,"").length>15)throw Error(ol+w)}else L.s=O.charCodeAt(0)===45?(O=O.slice(1),-1):1;for(D=I.slice(0,T),b=A=0,P=O.length;A<P;A++)if(D.indexOf(v=O.charAt(A))<0){if(v=="."){if(A>b){b=P;continue}}else if(!l&&(O==O.toUpperCase()&&(O=O.toLowerCase())||O==O.toLowerCase()&&(O=O.toUpperCase()))){l=!0,A=-1,b=0;continue}return n(L,String(w),C,T)}C=!1,O=r(O,T,10,L.s),(b=O.indexOf("."))>-1?O=O.replace(".",""):b=O.length}for(A=0;O.charCodeAt(A)===48;A++);for(P=O.length;O.charCodeAt(--P)===48;);if(O=O.slice(A,++P)){if(P-=A,C&&f.DEBUG&&P>15&&(w>ac||w!==Nr(w)))throw Error(ol+L.s*w);if((b=b-A-1)>h)L.c=L.e=null;else if(b<d)L.c=[L.e=0];else{if(L.e=b,L.c=[],A=(b+1)%ce,b<0&&(A+=ce),A<P){for(A&&L.c.push(+O.slice(0,A)),P-=ce;A<P;)L.c.push(+O.slice(A,A+=ce));A=ce-(O=O.slice(A)).length}else A-=P;for(;A--;O+="0");L.c.push(+O)}}else L.c=[L.e=0]}f.clone=cl,f.ROUND_UP=0,f.ROUND_DOWN=1,f.ROUND_CEIL=2,f.ROUND_FLOOR=3,f.ROUND_HALF_UP=4,f.ROUND_HALF_DOWN=5,f.ROUND_HALF_EVEN=6,f.ROUND_HALF_CEIL=7,f.ROUND_HALF_FLOOR=8,f.EUCLID=9,f.config=f.set=function(w){var T,D;if(w!=null)if(typeof w=="object"){if(w.hasOwnProperty(T="DECIMAL_PLACES")&&(D=w[T],Le(D,0,It,T),s=D),w.hasOwnProperty(T="ROUNDING_MODE")&&(D=w[T],Le(D,0,8,T),o=D),w.hasOwnProperty(T="EXPONENTIAL_AT")&&(D=w[T],D&&D.pop?(Le(D[0],-It,0,T),Le(D[1],0,It,T),u=D[0],c=D[1]):(Le(D,-It,It,T),u=-(c=D<0?-D:D))),w.hasOwnProperty(T="RANGE"))if(D=w[T],D&&D.pop)Le(D[0],-It,-1,T),Le(D[1],1,It,T),d=D[0],h=D[1];else if(Le(D,-It,It,T),D)d=-(h=D<0?-D:D);else throw Error(zt+T+" cannot be zero: "+D);if(w.hasOwnProperty(T="CRYPTO"))if(D=w[T],D===!!D)if(D)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))y=D;else throw y=!D,Error(zt+"crypto unavailable");else y=D;else throw Error(zt+T+" not true or false: "+D);if(w.hasOwnProperty(T="MODULO_MODE")&&(D=w[T],Le(D,0,9,T),p=D),w.hasOwnProperty(T="POW_PRECISION")&&(D=w[T],Le(D,0,It,T),m=D),w.hasOwnProperty(T="FORMAT"))if(D=w[T],typeof D=="object")_=D;else throw Error(zt+T+" not an object: "+D);if(w.hasOwnProperty(T="ALPHABET"))if(D=w[T],typeof D=="string"&&!/^.$|[+-.\s]|(.).*\1/.test(D))I=D;else throw Error(zt+T+" invalid: "+D)}else throw Error(zt+"Object expected: "+w);return{DECIMAL_PLACES:s,ROUNDING_MODE:o,EXPONENTIAL_AT:[u,c],RANGE:[d,h],CRYPTO:y,MODULO_MODE:p,POW_PRECISION:m,FORMAT:_,ALPHABET:I}},f.isBigNumber=function(w){if(!w||w._isBigNumber!==!0)return!1;if(!f.DEBUG)return!0;var T,D,v=w.c,l=w.e,b=w.s;e:if({}.toString.call(v)=="[object Array]"){if((b===1||b===-1)&&l>=-It&&l<=It&&l===Nr(l)){if(v[0]===0){if(l===0&&v.length===1)return!0;break e}if(T=(l+1)%ce,T<1&&(T+=ce),String(v[0]).length==T){for(T=0;T<v.length;T++)if(D=v[T],D<0||D>=pr||D!==Nr(D))break e;if(D!==0)return!0}}}else if(v===null&&l===null&&(b===null||b===1||b===-1))return!0;throw Error(zt+"Invalid BigNumber: "+w)},f.maximum=f.max=function(){return R(arguments,i.lt)},f.minimum=f.min=function(){return R(arguments,i.gt)},f.random=function(){var w=9007199254740992,T=Math.random()*w&2097151?function(){return Nr(Math.random()*w)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(D){var v,l,b,A,C,P=0,O=[],L=new f(a);if(D==null?D=s:Le(D,0,It),A=ic(D/ce),y)if(crypto.getRandomValues){for(v=crypto.getRandomValues(new Uint32Array(A*=2));P<A;)C=v[P]*131072+(v[P+1]>>>11),C>=9e15?(l=crypto.getRandomValues(new Uint32Array(2)),v[P]=l[0],v[P+1]=l[1]):(O.push(C%1e14),P+=2);P=A/2}else if(crypto.randomBytes){for(v=crypto.randomBytes(A*=7);P<A;)C=(v[P]&31)*281474976710656+v[P+1]*1099511627776+v[P+2]*4294967296+v[P+3]*16777216+(v[P+4]<<16)+(v[P+5]<<8)+v[P+6],C>=9e15?crypto.randomBytes(7).copy(v,P):(O.push(C%1e14),P+=7);P=A/7}else throw y=!1,Error(zt+"crypto unavailable");if(!y)for(;P<A;)C=T(),C<9e15&&(O[P++]=C%1e14);for(A=O[--P],D%=ce,A&&D&&(C=sc[ce-D],O[P]=Nr(A/C)*C);O[P]===0;O.pop(),P--);if(P<0)O=[b=0];else{for(b=-1;O[0]===0;O.splice(0,1),b-=ce);for(P=1,C=O[0];C>=10;C/=10,P++);P<ce&&(b-=ce-P)}return L.e=b,L.c=O,L}}(),f.sum=function(){for(var w=1,T=arguments,D=new f(T[0]);w<T.length;)D=D.plus(T[w++]);return D},r=function(){var w="0123456789";function T(D,v,l,b){for(var A,C=[0],P,O=0,L=D.length;O<L;){for(P=C.length;P--;C[P]*=v);for(C[0]+=b.indexOf(D.charAt(O++)),A=0;A<C.length;A++)C[A]>l-1&&(C[A+1]==null&&(C[A+1]=0),C[A+1]+=C[A]/l|0,C[A]%=l)}return C.reverse()}return function(D,v,l,b,A){var C,P,O,L,B,S,M,q,z=D.indexOf("."),G=s,j=o;for(z>=0&&(L=m,m=0,D=D.replace(".",""),q=new f(v),S=q.pow(D.length-z),m=L,q.c=T(en(er(S.c),S.e,"0"),10,l,w),q.e=q.c.length),M=T(D,v,l,A?(C=I,w):(C=w,I)),O=L=M.length;M[--L]==0;M.pop());if(!M[0])return C.charAt(0);if(z<0?--O:(S.c=M,S.e=O,S.s=b,S=e(S,q,G,j,l),M=S.c,B=S.r,O=S.e),P=O+G+1,z=M[P],L=l/2,B=B||P<0||M[P+1]!=null,B=j<4?(z!=null||B)&&(j==0||j==(S.s<0?3:2)):z>L||z==L&&(j==4||B||j==6&&M[P-1]&1||j==(S.s<0?8:7)),P<1||!M[0])D=B?en(C.charAt(1),-G,C.charAt(0)):C.charAt(0);else{if(M.length=P,B)for(--l;++M[--P]>l;)M[P]=0,P||(++O,M=[1].concat(M));for(L=M.length;!M[--L];);for(z=0,D="";z<=L;D+=C.charAt(M[z++]));D=en(D,O,C.charAt(0))}return D}}(),e=function(){function w(v,l,b){var A,C,P,O,L=0,B=v.length,S=l%yn,M=l/yn|0;for(v=v.slice();B--;)P=v[B]%yn,O=v[B]/yn|0,A=M*P+O*S,C=S*P+A%yn*yn+L,L=(C/b|0)+(A/yn|0)+M*O,v[B]=C%b;return L&&(v=[L].concat(v)),v}function T(v,l,b,A){var C,P;if(b!=A)P=b>A?1:-1;else for(C=P=0;C<b;C++)if(v[C]!=l[C]){P=v[C]>l[C]?1:-1;break}return P}function D(v,l,b,A){for(var C=0;b--;)v[b]-=C,C=v[b]<l[b]?1:0,v[b]=C*A+v[b]-l[b];for(;!v[0]&&v.length>1;v.splice(0,1));}return function(v,l,b,A,C){var P,O,L,B,S,M,q,z,G,j,H,V,we,ee,ne,Ee,ie,te=v.s==l.s?1:-1,ge=v.c,X=l.c;if(!ge||!ge[0]||!X||!X[0])return new f(!v.s||!l.s||(ge?X&&ge[0]==X[0]:!X)?NaN:ge&&ge[0]==0||!X?te*0:te/0);for(z=new f(te),G=z.c=[],O=v.e-l.e,te=b+O+1,C||(C=pr,O=Zt(v.e/ce)-Zt(l.e/ce),te=te/ce|0),L=0;X[L]==(ge[L]||0);L++);if(X[L]>(ge[L]||0)&&O--,te<0)G.push(1),B=!0;else{for(ee=ge.length,Ee=X.length,L=0,te+=2,S=Nr(C/(X[0]+1)),S>1&&(X=w(X,S,C),ge=w(ge,S,C),Ee=X.length,ee=ge.length),we=Ee,j=ge.slice(0,Ee),H=j.length;H<Ee;j[H++]=0);ie=X.slice(),ie=[0].concat(ie),ne=X[0],X[1]>=C/2&&ne++;do{if(S=0,P=T(X,j,Ee,H),P<0){if(V=j[0],Ee!=H&&(V=V*C+(j[1]||0)),S=Nr(V/ne),S>1)for(S>=C&&(S=C-1),M=w(X,S,C),q=M.length,H=j.length;T(M,j,q,H)==1;)S--,D(M,Ee<q?ie:X,q,C),q=M.length,P=1;else S==0&&(P=S=1),M=X.slice(),q=M.length;if(q<H&&(M=[0].concat(M)),D(j,M,H,C),H=j.length,P==-1)for(;T(X,j,Ee,H)<1;)S++,D(j,Ee<H?ie:X,H,C),H=j.length}else P===0&&(S++,j=[0]);G[L++]=S,j[0]?j[H++]=ge[we]||0:(j=[ge[we]],H=1)}while((we++<ee||j[0]!=null)&&te--);B=j[0]!=null,G[0]||G.splice(0,1)}if(C==pr){for(L=1,te=G[0];te>=10;te/=10,L++);x(z,b+(z.e=L+O*ce-1)+1,A,B)}else z.e=O,z.r=+B;return z}}();function k(w,T,D,v){var l,b,A,C,P;if(D==null?D=o:Le(D,0,8),!w.c)return w.toString();if(l=w.c[0],A=w.e,T==null)P=er(w.c),P=v==1||v==2&&(A<=u||A>=c)?gs(P,A):en(P,A,"0");else if(w=x(new f(w),T,D),b=w.e,P=er(w.c),C=P.length,v==1||v==2&&(T<=b||b<=u)){for(;C<T;P+="0",C++);P=gs(P,b)}else if(T-=A,P=en(P,b,"0"),b+1>C){if(--T>0)for(P+=".";T--;P+="0");}else if(T+=b-C,T>0)for(b+1==C&&(P+=".");T--;P+="0");return w.s<0&&l?"-"+P:P}function R(w,T){for(var D,v=1,l=new f(w[0]);v<w.length;v++)if(D=new f(w[v]),D.s)T.call(l,D)&&(l=D);else{l=D;break}return l}function g(w,T,D){for(var v=1,l=T.length;!T[--l];T.pop());for(l=T[0];l>=10;l/=10,v++);return(D=v+D*ce-1)>h?w.c=w.e=null:D<d?w.c=[w.e=0]:(w.e=D,w.c=T),w}n=function(){var w=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,D=/^\.([^.]+)$/,v=/^-?(Infinity|NaN)$/,l=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(b,A,C,P){var O,L=C?A:A.replace(l,"");if(v.test(L))b.s=isNaN(L)?null:L<0?-1:1;else{if(!C&&(L=L.replace(w,function(B,S,M){return O=(M=M.toLowerCase())=="x"?16:M=="b"?2:8,!P||P==O?S:B}),P&&(O=P,L=L.replace(T,"$1").replace(D,"0.$1")),A!=L))return new f(L,O);if(f.DEBUG)throw Error(zt+"Not a"+(P?" base "+P:"")+" number: "+A);b.s=null}b.c=b.e=null}}();function x(w,T,D,v){var l,b,A,C,P,O,L,B=w.c,S=sc;if(B){e:{for(l=1,C=B[0];C>=10;C/=10,l++);if(b=T-l,b<0)b+=ce,A=T,P=B[O=0],L=P/S[l-A-1]%10|0;else if(O=ic((b+1)/ce),O>=B.length)if(v){for(;B.length<=O;B.push(0));P=L=0,l=1,b%=ce,A=b-ce+1}else break e;else{for(P=C=B[O],l=1;C>=10;C/=10,l++);b%=ce,A=b-ce+l,L=A<0?0:P/S[l-A-1]%10|0}if(v=v||T<0||B[O+1]!=null||(A<0?P:P%S[l-A-1]),v=D<4?(L||v)&&(D==0||D==(w.s<0?3:2)):L>5||L==5&&(D==4||v||D==6&&(b>0?A>0?P/S[l-A]:0:B[O-1])%10&1||D==(w.s<0?8:7)),T<1||!B[0])return B.length=0,v?(T-=w.e+1,B[0]=S[(ce-T%ce)%ce],w.e=-T||0):B[0]=w.e=0,w;if(b==0?(B.length=O,C=1,O--):(B.length=O+1,C=S[ce-b],B[O]=A>0?Nr(P/S[l-A]%S[A])*C:0),v)for(;;)if(O==0){for(b=1,A=B[0];A>=10;A/=10,b++);for(A=B[0]+=C,C=1;A>=10;A/=10,C++);b!=C&&(w.e++,B[0]==pr&&(B[0]=1));break}else{if(B[O]+=C,B[O]!=pr)break;B[O--]=0,C=1}for(b=B.length;B[--b]===0;B.pop());}w.e>h?w.c=w.e=null:w.e<d&&(w.c=[w.e=0])}return w}function N(w){var T,D=w.e;return D===null?w.toString():(T=er(w.c),T=D<=u||D>=c?gs(T,D):en(T,D,"0"),w.s<0?"-"+T:T)}return i.absoluteValue=i.abs=function(){var w=new f(this);return w.s<0&&(w.s=1),w},i.comparedTo=function(w,T){return _i(this,new f(w,T))},i.decimalPlaces=i.dp=function(w,T){var D,v,l,b=this;if(w!=null)return Le(w,0,It),T==null?T=o:Le(T,0,8),x(new f(b),w+b.e+1,T);if(!(D=b.c))return null;if(v=((l=D.length-1)-Zt(this.e/ce))*ce,l=D[l])for(;l%10==0;l/=10,v--);return v<0&&(v=0),v},i.dividedBy=i.div=function(w,T){return e(this,new f(w,T),s,o)},i.dividedToIntegerBy=i.idiv=function(w,T){return e(this,new f(w,T),0,1)},i.exponentiatedBy=i.pow=function(w,T){var D,v,l,b,A,C,P,O,L,B=this;if(w=new f(w),w.c&&!w.isInteger())throw Error(zt+"Exponent not an integer: "+N(w));if(T!=null&&(T=new f(T)),C=w.e>14,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!w.c||!w.c[0])return L=new f(Math.pow(+N(B),C?2-ys(w):+N(w))),T?L.mod(T):L;if(P=w.s<0,T){if(T.c?!T.c[0]:!T.s)return new f(NaN);v=!P&&B.isInteger()&&T.isInteger(),v&&(B=B.mod(T))}else{if(w.e>9&&(B.e>0||B.e<-1||(B.e==0?B.c[0]>1||C&&B.c[1]>=24e7:B.c[0]<8e13||C&&B.c[0]<=9999975e7)))return b=(B.s<0&&ys(w),-0),B.e>-1&&(b=1/b),new f(P?1/b:b);m&&(b=ic(m/ce+2))}for(C?(D=new f(.5),P&&(w.s=1),O=ys(w)):(l=Math.abs(+N(w)),O=l%2),L=new f(a);;){if(O){if(L=L.times(B),!L.c)break;b?L.c.length>b&&(L.c.length=b):v&&(L=L.mod(T))}if(l){if(l=Nr(l/2),l===0)break;O=l%2}else if(w=w.times(D),x(w,w.e+1,1),w.e>14)O=ys(w);else{if(l=+N(w),l===0)break;O=l%2}B=B.times(B),b?B.c&&B.c.length>b&&(B.c.length=b):v&&(B=B.mod(T))}return v?L:(P&&(L=a.div(L)),T?L.mod(T):b?x(L,m,o,A):L)},i.integerValue=function(w){var T=new f(this);return w==null?w=o:Le(w,0,8),x(T,T.e+1,w)},i.isEqualTo=i.eq=function(w,T){return _i(this,new f(w,T))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(w,T){return _i(this,new f(w,T))>0},i.isGreaterThanOrEqualTo=i.gte=function(w,T){return(T=_i(this,new f(w,T)))===1||T===0},i.isInteger=function(){return!!this.c&&Zt(this.e/ce)>this.c.length-2},i.isLessThan=i.lt=function(w,T){return _i(this,new f(w,T))<0},i.isLessThanOrEqualTo=i.lte=function(w,T){return(T=_i(this,new f(w,T)))===-1||T===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(w,T){var D,v,l,b,A=this,C=A.s;if(w=new f(w,T),T=w.s,!C||!T)return new f(NaN);if(C!=T)return w.s=-T,A.plus(w);var P=A.e/ce,O=w.e/ce,L=A.c,B=w.c;if(!P||!O){if(!L||!B)return L?(w.s=-T,w):new f(B?A:NaN);if(!L[0]||!B[0])return B[0]?(w.s=-T,w):new f(L[0]?A:(o==3,-0))}if(P=Zt(P),O=Zt(O),L=L.slice(),C=P-O){for((b=C<0)?(C=-C,l=L):(O=P,l=B),l.reverse(),T=C;T--;l.push(0));l.reverse()}else for(v=(b=(C=L.length)<(T=B.length))?C:T,C=T=0;T<v;T++)if(L[T]!=B[T]){b=L[T]<B[T];break}if(b&&(l=L,L=B,B=l,w.s=-w.s),T=(v=B.length)-(D=L.length),T>0)for(;T--;L[D++]=0);for(T=pr-1;v>C;){if(L[--v]<B[v]){for(D=v;D&&!L[--D];L[D]=T);--L[D],L[v]+=pr}L[v]-=B[v]}for(;L[0]==0;L.splice(0,1),--O);return L[0]?g(w,L,O):(w.s=o==3?-1:1,w.c=[w.e=0],w)},i.modulo=i.mod=function(w,T){var D,v,l=this;return w=new f(w,T),!l.c||!w.s||w.c&&!w.c[0]?new f(NaN):!w.c||l.c&&!l.c[0]?new f(l):(p==9?(v=w.s,w.s=1,D=e(l,w,0,3),w.s=v,D.s*=v):D=e(l,w,0,p),w=l.minus(D.times(w)),!w.c[0]&&p==1&&(w.s=l.s),w)},i.multipliedBy=i.times=function(w,T){var D,v,l,b,A,C,P,O,L,B,S,M,q,z,G,j=this,H=j.c,V=(w=new f(w,T)).c;if(!H||!V||!H[0]||!V[0])return!j.s||!w.s||H&&!H[0]&&!V||V&&!V[0]&&!H?w.c=w.e=w.s=null:(w.s*=j.s,!H||!V?w.c=w.e=null:(w.c=[0],w.e=0)),w;for(v=Zt(j.e/ce)+Zt(w.e/ce),w.s*=j.s,P=H.length,B=V.length,P<B&&(q=H,H=V,V=q,l=P,P=B,B=l),l=P+B,q=[];l--;q.push(0));for(z=pr,G=yn,l=B;--l>=0;){for(D=0,S=V[l]%G,M=V[l]/G|0,A=P,b=l+A;b>l;)O=H[--A]%G,L=H[A]/G|0,C=M*O+L*S,O=S*O+C%G*G+q[b]+D,D=(O/z|0)+(C/G|0)+M*L,q[b--]=O%z;q[b]=D}return D?++v:q.splice(0,1),g(w,q,v)},i.negated=function(){var w=new f(this);return w.s=-w.s||null,w},i.plus=function(w,T){var D,v=this,l=v.s;if(w=new f(w,T),T=w.s,!l||!T)return new f(NaN);if(l!=T)return w.s=-T,v.minus(w);var b=v.e/ce,A=w.e/ce,C=v.c,P=w.c;if(!b||!A){if(!C||!P)return new f(l/0);if(!C[0]||!P[0])return P[0]?w:new f(C[0]?v:l*0)}if(b=Zt(b),A=Zt(A),C=C.slice(),l=b-A){for(l>0?(A=b,D=P):(l=-l,D=C),D.reverse();l--;D.push(0));D.reverse()}for(l=C.length,T=P.length,l-T<0&&(D=P,P=C,C=D,T=l),l=0;T;)l=(C[--T]=C[T]+P[T]+l)/pr|0,C[T]=pr===C[T]?0:C[T]%pr;return l&&(C=[l].concat(C),++A),g(w,C,A)},i.precision=i.sd=function(w,T){var D,v,l,b=this;if(w!=null&&w!==!!w)return Le(w,1,It),T==null?T=o:Le(T,0,8),x(new f(b),w,T);if(!(D=b.c))return null;if(l=D.length-1,v=l*ce+1,l=D[l]){for(;l%10==0;l/=10,v--);for(l=D[0];l>=10;l/=10,v++);}return w&&b.e+1>v&&(v=b.e+1),v},i.shiftedBy=function(w){return Le(w,-ac,ac),this.times("1e"+w)},i.squareRoot=i.sqrt=function(){var w,T,D,v,l,b=this,A=b.c,C=b.s,P=b.e,O=s+4,L=new f("0.5");if(C!==1||!A||!A[0])return new f(!C||C<0&&(!A||A[0])?NaN:A?b:1/0);if(C=Math.sqrt(+N(b)),C==0||C==1/0?(T=er(A),(T.length+P)%2==0&&(T+="0"),C=Math.sqrt(+T),P=Zt((P+1)/2)-(P<0||P%2),C==1/0?T="5e"+P:(T=C.toExponential(),T=T.slice(0,T.indexOf("e")+1)+P),D=new f(T)):D=new f(C+""),D.c[0]){for(P=D.e,C=P+O,C<3&&(C=0);;)if(l=D,D=L.times(l.plus(e(b,l,O,1))),er(l.c).slice(0,C)===(T=er(D.c)).slice(0,C))if(D.e<P&&--C,T=T.slice(C-3,C+1),T=="9999"||!v&&T=="4999"){if(!v&&(x(l,l.e+s+2,0),l.times(l).eq(b))){D=l;break}O+=4,C+=4,v=1}else{(!+T||!+T.slice(1)&&T.charAt(0)=="5")&&(x(D,D.e+s+2,1),w=!D.times(D).eq(b));break}}return x(D,D.e+s+1,o,w)},i.toExponential=function(w,T){return w!=null&&(Le(w,0,It),w++),k(this,w,T,1)},i.toFixed=function(w,T){return w!=null&&(Le(w,0,It),w=w+this.e+1),k(this,w,T)},i.toFormat=function(w,T,D){var v,l=this;if(D==null)w!=null&&T&&typeof T=="object"?(D=T,T=null):w&&typeof w=="object"?(D=w,w=T=null):D=_;else if(typeof D!="object")throw Error(zt+"Argument not an object: "+D);if(v=l.toFixed(w,T),l.c){var b,A=v.split("."),C=+D.groupSize,P=+D.secondaryGroupSize,O=D.groupSeparator||"",L=A[0],B=A[1],S=l.s<0,M=S?L.slice(1):L,q=M.length;if(P&&(b=C,C=P,P=b,q-=b),C>0&&q>0){for(b=q%C||C,L=M.substr(0,b);b<q;b+=C)L+=O+M.substr(b,C);P>0&&(L+=O+M.slice(b)),S&&(L="-"+L)}v=B?L+(D.decimalSeparator||"")+((P=+D.fractionGroupSize)?B.replace(new RegExp("\\d{"+P+"}\\B","g"),"$&"+(D.fractionGroupSeparator||"")):B):L}return(D.prefix||"")+v+(D.suffix||"")},i.toFraction=function(w){var T,D,v,l,b,A,C,P,O,L,B,S,M=this,q=M.c;if(w!=null&&(C=new f(w),!C.isInteger()&&(C.c||C.s!==1)||C.lt(a)))throw Error(zt+"Argument "+(C.isInteger()?"out of range: ":"not an integer: ")+N(C));if(!q)return new f(M);for(T=new f(a),O=D=new f(a),v=P=new f(a),S=er(q),b=T.e=S.length-M.e-1,T.c[0]=sc[(A=b%ce)<0?ce+A:A],w=!w||C.comparedTo(T)>0?b>0?T:O:C,A=h,h=1/0,C=new f(S),P.c[0]=0;!(L=e(C,T,0,1),l=D.plus(L.times(v)),l.comparedTo(w)==1);)D=v,v=l,O=P.plus(L.times(l=O)),P=l,T=C.minus(L.times(l=T)),C=l;return l=e(w.minus(D),v,0,1),P=P.plus(l.times(O)),D=D.plus(l.times(v)),P.s=O.s=M.s,b=b*2,B=e(O,v,b,o).minus(M).abs().comparedTo(e(P,D,b,o).minus(M).abs())<1?[O,v]:[P,D],h=A,B},i.toNumber=function(){return+N(this)},i.toPrecision=function(w,T){return w!=null&&Le(w,1,It),k(this,w,T,2)},i.toString=function(w){var T,D=this,v=D.s,l=D.e;return l===null?v?(T="Infinity",v<0&&(T="-"+T)):T="NaN":(w==null?T=l<=u||l>=c?gs(er(D.c),l):en(er(D.c),l,"0"):w===10?(D=x(new f(D),s+l+1,o),T=en(er(D.c),D.e,"0")):(Le(w,2,I.length,"Base"),T=r(en(er(D.c),l,"0"),10,w,v,!0)),v<0&&D.c[0]&&(T="-"+T)),T},i.valueOf=i.toJSON=function(){return N(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,t!=null&&f.set(t),f}function Zt(t){var e=t|0;return t>0||t===e?e:e-1}function er(t){for(var e,r,n=1,i=t.length,a=t[0]+"";n<i;){for(e=t[n++]+"",r=ce-e.length;r--;e="0"+e);a+=e}for(i=a.length;a.charCodeAt(--i)===48;);return a.slice(0,i+1||1)}function _i(t,e){var r,n,i=t.c,a=e.c,s=t.s,o=e.s,u=t.e,c=e.e;if(!s||!o)return null;if(r=i&&!i[0],n=a&&!a[0],r||n)return r?n?0:-o:s;if(s!=o)return s;if(r=s<0,n=u==c,!i||!a)return n?0:!i^r?1:-1;if(!n)return u>c^r?1:-1;for(o=(u=i.length)<(c=a.length)?u:c,s=0;s<o;s++)if(i[s]!=a[s])return i[s]>a[s]^r?1:-1;return u==c?0:u>c^r?1:-1}function Le(t,e,r,n){if(t<e||t>r||t!==Nr(t))throw Error(zt+(n||"Argument")+(typeof t=="number"?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function ys(t){var e=t.c.length-1;return Zt(t.e/ce)==e&&t.c[e]%2!=0}function gs(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function en(t,e,r){var n,i;if(e<0){for(i=r+".";++e;i+=r);t=i+t}else if(n=t.length,++e>n){for(i=r,e-=n;--e;i+=r);t+=i}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}var ul=cl(),Bb=Object.freeze({__proto__:null,BigNumber:ul,default:ul});function dl(t,e){for(const r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Mb(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=void 0),e!=null&&(r.code=e);try{return dl(t,r)}catch(n){r.message=t.message,r.stack=t.stack;const i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),dl(new i,r)}}var K=Mb;/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */var oc=qb,Lb=ll,Ub=fl,Kb=/\B(?=(\d{3})+(?!\d))/g,Fb=/(?:\.0*|(\.[^0]+)0+)$/,gn={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},jb=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function qb(t,e){return typeof t=="string"?fl(t):typeof t=="number"?ll(t,e):null}function ll(t,e){if(!Number.isFinite(t))return null;var r=Math.abs(t),n=e&&e.thousandsSeparator||"",i=e&&e.unitSeparator||"",a=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,s=Boolean(e&&e.fixedDecimals),o=e&&e.unit||"";(!o||!gn[o.toLowerCase()])&&(r>=gn.pb?o="PB":r>=gn.tb?o="TB":r>=gn.gb?o="GB":r>=gn.mb?o="MB":r>=gn.kb?o="KB":o="B");var u=t/gn[o.toLowerCase()],c=u.toFixed(a);return s||(c=c.replace(Fb,"$1")),n&&(c=c.replace(Kb,n)),c+i+o}function fl(t){if(typeof t=="number"&&!isNaN(t))return t;if(typeof t!="string")return null;var e=jb.exec(t),r,n="b";return e?(r=parseFloat(e[1]),n=e[4].toLowerCase()):(r=parseInt(t,10),n="b"),Math.floor(gn[n]*r)}oc.format=Lb,oc.parse=Ub;function Vb(...t){return t.length===0?".":t.join("/")}var zb=Vb,$b=function(e,r,n){const i=n.storageBackends[e],a=Object.assign({},n.storageBackendOptions[e]||{});return new i(r,a)},hl={create:$b};let Gb="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",pl=t=>crypto.getRandomValues(new Uint8Array(t)),ml=(t,e,r)=>{let n=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*n*e/t.length);return()=>{let a="";for(;;){let s=r(i),o=i;for(;o--;)if(a+=t[s[o]&n]||"",a.length===e)return a}}},Hb=(t,e)=>ml(t,e,pl),Wb=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let n=r[t]&63;n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n<63?e+="_":e+="-"}return e};var bl=Object.freeze({__proto__:null,nanoid:Wb,customAlphabet:Hb,customRandom:ml,urlAlphabet:Gb,random:pl});function Yb(t,{className:e,symbolName:r}){const n=Symbol.for(r),i={[e]:class extends t{constructor(...a){super(...a);Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return i[`is${e}`]=a=>!!(a&&a[n]),i}function Xb(t,{className:e,symbolName:r,withoutNew:n}){const i=Symbol.for(r),a={[e]:function(...s){if(n&&!(this instanceof a))return new a(...s);const o=t.call(this,...s)||this;return o&&!o[i]&&Object.defineProperty(o,i,{value:!0}),o}}[e];return a.prototype=Object.create(t.prototype),a.prototype.constructor=a,Object.defineProperty(a.prototype,Symbol.toStringTag,{get(){return e}}),a[`is${e}`]=s=>!!(s&&s[i]),a}var vn=Yb,Qb=Xb;vn.proto=Qb;const{nanoid:Jb}=bl,Zb=(t=e=>e)=>t(Jb());var ey=Zb;(function(){if(typeof globalThis=="object")return;Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__})();var yl=globalThis,ty=yl.TextEncoder,gl=yl.TextDecoder,ry=new ty("utf8"),ny=new gl("utf8"),iy=(t,e)=>async function*(){for await(const r of t){const n=await e(r);if(!n)continue;yield r}}(),ay=(t,e)=>async function*(){let r=[];for await(const n of t)r.push(n);r=await e(r);for(const n of r)yield n}(),sy=(t,e)=>async function*(){if(e<=0)return;let r=0;for await(const n of t)if(yield n,r++,r>=e)return}(),oy=(t,e)=>async function*(){for await(const r of t)yield e(r)}(),cy=function(t,e){const r=new RegExp("^"+e);return t.replace(r,"")},uy=ey,cc={utf8Encoder:ry,utf8Decoder:ny,filter:iy,sortAll:ay,take:sy,map:oy,replaceStartWith:cy,tmpdir:uy};const{nanoid:dy}=bl,{utf8Encoder:vl,utf8Decoder:ly}=cc,tn="/",wl=vl.encode(tn),vs=wl[0];class uc{constructor(t,e){if(typeof t=="string")this._buf=vl.encode(t);else if(t instanceof Uint8Array)this._buf=t;else throw new Error("Invalid key, should be String of Uint8Array");if(e==null&&(e=!0),e&&this.clean(),this._buf.byteLength===0||this._buf[0]!==vs)throw new Error("Invalid key")}toString(t="utf8"){return t==="utf8"||t==="utf-8"?ly.decode(this._buf):new gl(t).decode(this._buf)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(t){return new wn(t.join(tn))}static random(){return new wn(dy().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=wl),this._buf[0]!==vs){const t=new Uint8Array(this._buf.byteLength+1);t.fill(vs,0,1),t.set(this._buf,1),this._buf=t}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===vs;)this._buf=this._buf.subarray(0,-1)}less(t){const e=this.list(),r=t.list();for(let n=0;n<e.length;n++){if(r.length<n+1)return!1;const i=e[n],a=r[n];if(i<a)return!0;if(i>a)return!1}return e.length<r.length}reverse(){return uc.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const t=this.namespaces();return t[t.length-1]}list(){return this.toString().split(tn).slice(1)}type(){return fy(this.baseNamespace())}name(){return hy(this.baseNamespace())}instance(t){return new wn(this.toString()+":"+t)}path(){let t=this.parent().toString();return t.endsWith(tn)||(t+=tn),t+=this.type(),new wn(t)}parent(){const t=this.list();return t.length===1?new wn(tn):new wn(t.slice(0,-1).join(tn))}child(t){return this.toString()===tn?t:t.toString()===tn?this:new wn(this.toString()+t.toString(),!1)}isAncestorOf(t){return t.toString()===this.toString()?!1:t.toString().startsWith(this.toString())}isDecendantOf(t){return t.toString()===this.toString()?!1:this.toString().startsWith(t.toString())}isTopLevel(){return this.list().length===1}concat(...t){return uc.withNamespaces([...this.namespaces(),...py(t.map(e=>e.namespaces()))])}}function fy(t){const e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function hy(t){const e=t.split(":");return e[e.length-1]}function py(t){return[].concat(...t)}const wn=vn(uc,{className:"Key",symbolName:"@ipfs/interface-datastore/key"});var El=wn;const my=async t=>{for await(const e of t);};var xl=my;const{filter:dc,sortAll:by,take:yy,map:gy}=cc;class vy{async open(){}async close(){}async put(t,e,r={}){}async*putMany(t,e={}){for await(const{key:r,value:n}of t)await this.put(r,n,e),yield{key:r,value:n}}async get(t,e={}){}async*getMany(t,e={}){for await(const r of t)yield this.get(r,e)}async has(t){}async delete(t,e={}){}async*deleteMany(t,e={}){for await(const r of t)await this.delete(r,e),yield r}batch(){let t=[],e=[];return{put(r,n){t.push({key:r,value:n})},delete(r){e.push(r)},commit:async r=>{await xl(this.putMany(t,r)),t=[],await xl(this.deleteMany(e,r)),e=[]}}}async*_all(t,e){}async*query(t,e){let r=this._all(t,e);if(t.prefix!=null&&(r=dc(r,n=>n.key.toString().startsWith(t.prefix))),Array.isArray(t.filters)&&(r=t.filters.reduce((n,i)=>dc(n,i),r)),Array.isArray(t.orders)&&(r=t.orders.reduce((n,i)=>by(n,i),r)),t.offset!=null){let n=0;r=dc(r,()=>n++>=t.offset)}t.limit!=null&&(r=yy(r,t.limit)),t.keysOnly===!0&&(r=gy(r,n=>({key:n.key}))),yield*r}}var Sl=vy,wy=t=>(t=t||new Error("Cannot open database"),K(t,"ERR_DB_OPEN_FAILED")),Ey=t=>(t=t||new Error("Delete failed"),K(t,"ERR_DB_DELETE_FAILED")),xy=t=>(t=t||new Error("Write failed"),K(t,"ERR_DB_WRITE_FAILED")),Sy=t=>(t=t||new Error("Not Found"),K(t,"ERR_NOT_FOUND")),Ay=t=>(t=t||new Error("Aborted"),K(t,"ERR_ABORTED")),Al={dbOpenFailedError:wy,dbDeleteFailedError:Ey,dbWriteFailedError:xy,notFoundError:Sy,abortedError:Ay};class Iy extends Sl{constructor(){super();this.data={}}async put(t,e){this.data[t.toString()]=e}async get(t){const e=await this.has(t);if(!e)throw Al.notFoundError();return this.data[t.toString()]}async has(t){return this.data[t.toString()]!==void 0}async delete(t){delete this.data[t.toString()]}*_all(){yield*Object.entries(this.data).map(([t,e])=>({key:new El(t),value:e}))}}var ky=Iy,Ty=El,Cy=ky,_y=cc,Ry=Al,Ny=Sl,En={Key:Ty,MemoryDatastore:Cy,utils:_y,Errors:Ry,Adapter:Ny};function Py(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),r=0;r<e.length;r++)e[r]=255;for(var n=0;n<t.length;n++){var i=t.charAt(n),a=i.charCodeAt(0);if(e[a]!==255)throw new TypeError(i+" is ambiguous");e[a]=n}var s=t.length,o=t.charAt(0),u=Math.log(s)/Math.log(256),c=Math.log(256)/Math.log(s);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,_=0,I=0,f=p.length;I!==f&&p[I]===0;)I++,m++;for(var k=(f-I)*c+1>>>0,R=new Uint8Array(k);I!==f;){for(var g=p[I],x=0,N=k-1;(g!==0||x<_)&&N!==-1;N--,x++)g+=256*R[N]>>>0,R[N]=g%s>>>0,g=g/s>>>0;if(g!==0)throw new Error("Non-zero carry");_=x,I++}for(var w=k-_;w!==k&&R[w]===0;)w++;for(var T=o.repeat(m);w<k;++w)T+=t.charAt(R[w]);return T}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]===" ")return;for(var _=0,I=0;p[m]===o;)_++,m++;for(var f=(p.length-m)*u+1>>>0,k=new Uint8Array(f);p[m];){var R=e[p.charCodeAt(m)];if(R===255)return;for(var g=0,x=f-1;(R!==0||g<I)&&x!==-1;x--,g++)R+=s*k[x]>>>0,k[x]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");I=g,m++}if(p[m]===" ")return;for(var N=f-I;N!==f&&k[N]===0;)N++;for(var w=new Uint8Array(_+(f-N)),T=_;N!==f;)w[T++]=k[N++];return w}function y(p){var m=h(p);if(m)return m;throw new Error("Non-base"+s+" character")}return{encode:d,decodeUnsafe:h,decode:y}}var ga=Py;const Dy=TextEncoder,Oy=TextDecoder;var va=Object.freeze({__proto__:null,TextEncoder:Dy,TextDecoder:Oy});const{TextEncoder:By,TextDecoder:My}=va,Ly=new My,Uy=t=>Ly.decode(t),Ky=new By,Fy=t=>Ky.encode(t);function jy(t,e){const r=new Uint8Array(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}var lc={decodeText:Uy,encodeText:Fy,concat:jy};const{encodeText:qy}=lc;class Vy{constructor(t,e,r,n){this.name=t,this.code=e,this.codeBuf=qy(this.code),this.alphabet=n,this.codec=r(n)}encode(t){return this.codec.encode(t)}decode(t){for(const e of t)if(this.alphabet&&this.alphabet.indexOf(e)<0)throw new Error(`invalid character '${e}' in '${t}'`);return this.codec.decode(t)}}var zy=Vy;const $y=(t,e,r)=>{const n={};for(let c=0;c<e.length;++c)n[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const a=new Uint8Array(i*r/8|0);let s=0,o=0,u=0;for(let c=0;c<i;++c){const d=n[t[c]];if(d===void 0)throw new SyntaxError("Invalid character "+t[c]);o=o<<r|d,s+=r,s>=8&&(s-=8,a[u++]=255&o>>s)}if(s>=r||255&o<<8-s)throw new SyntaxError("Unexpected end of data");return a},Gy=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let a="",s=0,o=0;for(let u=0;u<t.length;++u)for(o=o<<8|t[u],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},Hy=t=>e=>({encode(r){return Gy(r,e,t)},decode(r){return $y(r,e,t)}});var Wy={rfc4648:Hy};const{rfc4648:Rt}=Wy,{decodeText:Yy,encodeText:Xy}=lc,Qy=()=>({encode:Yy,decode:Xy}),Il=[["identity","\0",Qy,""],["base2","0",Rt(1),"01"],["base8","7",Rt(3),"01234567"],["base10","9",ga,"0123456789"],["base16","f",Rt(4),"0123456789abcdef"],["base16upper","F",Rt(4),"0123456789ABCDEF"],["base32hex","v",Rt(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",Rt(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",Rt(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",Rt(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",Rt(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",Rt(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",Rt(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",Rt(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",Rt(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",ga,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",ga,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",ga,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",ga,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",Rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",Rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",Rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",Rt(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],kl=Il.reduce((t,e)=>(t[e[0]]=new zy(e[0],e[1],e[2],e[3]),t),{}),Jy=Il.reduce((t,e)=>(t[e[1]]=kl[e[0]],t),{});var Pr={names:kl,codes:Jy};const{names:Zy}=Pr,{TextDecoder:eg}=va,tg=new eg("utf8");function rg(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}function ng(t,e="utf8"){if(e==="utf8"||e==="utf-8")return tg.decode(t);if(e==="ascii")return rg(t);const r=Zy[e];if(!r)throw new Error("Unknown base");return r.encode(t)}var se=ng;const{names:ig}=Pr,{TextEncoder:ag}=va,sg=new ag;function og(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function cg(t,e="utf8"){if(e==="utf8"||e==="utf-8")return sg.encode(t);if(e==="ascii")return og(t);const r=ig[e];if(!r)throw new Error("Unknown base");return r.decode(t)}var le=cg;const ug=En.Key,dg=J("ipfs:repo:version"),fc=new ug("version");var lg=t=>({async exists(){return t.has(fc)},async get(){const e=await t.get(fc);return parseInt(se(e),10)},async set(e){return t.put(fc,le(String(e)))},async check(e){const r=await this.get();dg("comparing version: %s and %s",r,e);const n=r===6&&e===7||e===6&&r===7;return r===e||n}}),fg=Z(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(u,c,d){this.fn=u,this.context=c,this.once=d||!1}function a(u,c,d,h,y){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,h||u,y),m=r?r+c:c;return u._events[m]?u._events[m].fn?u._events[m]=[u._events[m],p]:u._events[m].push(p):(u._events[m]=p,u._eventsCount++),u}function s(u,c){--u._eventsCount===0?u._events=new n:delete u._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],d,h;if(this._eventsCount===0)return c;for(h in d=this._events)e.call(d,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},o.prototype.listeners=function(c){var d=r?r+c:c,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var y=0,p=h.length,m=new Array(p);y<p;y++)m[y]=h[y].fn;return m},o.prototype.listenerCount=function(c){var d=r?r+c:c,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,d,h,y,p,m){var _=r?r+c:c;if(!this._events[_])return!1;var I=this._events[_],f=arguments.length,k,R;if(I.fn){I.once&&this.removeListener(c,I.fn,void 0,!0);switch(f){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,d),!0;case 3:return I.fn.call(I.context,d,h),!0;case 4:return I.fn.call(I.context,d,h,y),!0;case 5:return I.fn.call(I.context,d,h,y,p),!0;case 6:return I.fn.call(I.context,d,h,y,p,m),!0}for(R=1,k=new Array(f-1);R<f;R++)k[R-1]=arguments[R];I.fn.apply(I.context,k)}else{var g=I.length,x;for(R=0;R<g;R++){I[R].once&&this.removeListener(c,I[R].fn,void 0,!0);switch(f){case 1:I[R].fn.call(I[R].context);break;case 2:I[R].fn.call(I[R].context,d);break;case 3:I[R].fn.call(I[R].context,d,h);break;case 4:I[R].fn.call(I[R].context,d,h,y);break;default:if(!k)for(x=1,k=new Array(f-1);x<f;x++)k[x-1]=arguments[x];I[R].fn.apply(I[R].context,k)}}}return!0},o.prototype.on=function(c,d,h){return a(this,c,d,h,!1)},o.prototype.once=function(c,d,h){return a(this,c,d,h,!0)},o.prototype.removeListener=function(c,d,h,y){var p=r?r+c:c;if(!this._events[p])return this;if(!d)return s(this,p),this;var m=this._events[p];if(m.fn)m.fn===d&&(!y||m.once)&&(!h||m.context===h)&&s(this,p);else{for(var _=0,I=[],f=m.length;_<f;_++)(m[_].fn!==d||y&&!m[_].once||h&&m[_].context!==h)&&I.push(m[_]);I.length?this._events[p]=I.length===1?I[0]:I:s(this,p)}return this},o.prototype.removeAllListeners=function(c){var d;return c?(d=r?r+c:c,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o}),hg=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})));class Tl extends Error{constructor(t){super(t);this.name="TimeoutError"}}const Cl=(t,e,r)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===Infinity){n(t);return}const a=setTimeout(()=>{if(typeof r=="function"){try{n(r())}catch(u){i(u)}return}const s=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,o=r instanceof Error?r:new Tl(s);typeof t.cancel=="function"&&t.cancel(),i(o)},e);hg(t.then(n,i),()=>{clearTimeout(a)})});var ws=Cl,pg=Cl,mg=Tl;ws.default=pg,ws.TimeoutError=mg;var bg=Z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});function r(n,i,a){let s=0,o=n.length;for(;o>0;){const u=o/2|0;let c=s+u;a(n[c],i)<=0?(s=++c,o-=u+1):o=u}return s}e.default=r}),yg=Z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(){this._queue=[]}enqueue(n,i){i=Object.assign({priority:0},i);const a={priority:i.priority,run:n};if(this.size&&this._queue[this.size-1].priority>=i.priority){this._queue.push(a);return}const s=bg.default(this._queue,a,(o,u)=>u.priority-o.priority);this._queue.splice(s,0,a)}dequeue(){const n=this._queue.shift();return n==null?void 0:n.run}filter(n){return this._queue.filter(i=>i.priority===n.priority).map(i=>i.run)}get size(){return this._queue.length}}e.default=r}),gg=Z(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const r=()=>{},n=new ws.TimeoutError;class i extends fg{constructor(a){var s,o,u,c;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r,this._resolveIdle=r,a=Object.assign({carryoverConcurrencyCount:!1,intervalCap:Infinity,interval:0,concurrency:Infinity,autoStart:!0,queueClass:yg.default},a),!(typeof a.intervalCap=="number"&&a.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(o=(s=a.intervalCap)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""}\` (${typeof a.intervalCap})`);if(a.interval===void 0||!(Number.isFinite(a.interval)&&a.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(c=(u=a.interval)===null||u===void 0?void 0:u.toString())!==null&&c!==void 0?c:""}\` (${typeof a.interval})`);this._carryoverConcurrencyCount=a.carryoverConcurrencyCount,this._isIntervalIgnored=a.intervalCap===Infinity||a.interval===0,this._intervalCap=a.intervalCap,this._interval=a.interval,this._queue=new a.queueClass,this._queueClass=a.queueClass,this.concurrency=a.concurrency,this._timeout=a.timeout,this._throwOnTimeout=a.throwOnTimeout===!0,this._isPaused=a.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const a=Date.now();if(this._intervalId===void 0){const s=this._intervalEnd-a;if(s<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},s)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const a=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const s=this._queue.dequeue();return s?(this.emit("active"),s(),a&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){if(this._isIntervalIgnored||this._intervalId!==void 0)return;this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(a){if(!(typeof a=="number"&&a>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${a}\` (${typeof a})`);this._concurrency=a,this._processQueue()}async add(a,s={}){return new Promise((o,u)=>{const c=async()=>{this._pendingCount++,this._intervalCount++;try{const d=this._timeout===void 0&&s.timeout===void 0?a():ws.default(Promise.resolve(a()),s.timeout===void 0?this._timeout:s.timeout,()=>{(s.throwOnTimeout===void 0?this._throwOnTimeout:s.throwOnTimeout)&&u(n);return});o(await d)}catch(d){u(d)}this._next()};this._queue.enqueue(c,s),this._tryToStartAnother(),this.emit("add")})}async addAll(a,s){return Promise.all(a.map(async o=>this.add(o,s)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){return this._queue.size===0?void 0:new Promise(a=>{const s=this._resolveEmpty;this._resolveEmpty=()=>{s(),a()}})}async onIdle(){return this._pendingCount===0&&this._queue.size===0?void 0:new Promise(a=>{const s=this._resolveIdle;this._resolveIdle=()=>{s(),a()}})}get size(){return this._queue.size}sizeBy(a){return this._queue.filter(a).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(a){this._timeout=a}}e.default=i}),_l=vg;function vg(t,e,r){if(!t)return r;var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;){if(i=n.shift(),!t)return r;if(t=t[i],t===void 0)return r}return t}var wg=Eg;function Eg(t,e,r){typeof e=="string"&&(e=e.split(".")),typeof e=="symbol"&&(e=[e]);var n=e.pop();if(!n)return!1;for(var i;i=e.shift();)if(typeof t[i]=="undefined"&&(t[i]={}),t=t[i],!t||typeof t!="object")return!1;return t[n]=r,!0}class hc extends Error{constructor(t){super(t);this.name="LockExistsError",this.code=hc.code}}hc.code="ERR_LOCK_EXISTS";var xg=hc;class pc extends Error{constructor(t){super(t);this.name="NotFoundError",this.code=pc.code}}pc.code="ERR_NOT_FOUND";var Sg=pc;class mc extends Error{constructor(t){super(t);this.name="InvalidRepoVersionError",this.code=mc.code}}mc.code="ERR_INVALID_REPO_VERSION";var Ag=mc,Ig="ERR_REPO_NOT_INITIALIZED",kg="ERR_REPO_ALREADY_OPEN",Tg="ERR_REPO_ALREADY_CLOSED",mr={LockExistsError:xg,NotFoundError:Sg,InvalidRepoVersionError:Ag,ERR_REPO_NOT_INITIALIZED:Ig,ERR_REPO_ALREADY_OPEN:kg,ERR_REPO_ALREADY_CLOSED:Tg};const Cg=En.Key,{default:_g}=gg,bc=new Cg("config");var Rg=t=>{const e=new _g({concurrency:1}),r={async getAll(a={}){return r.get(void 0,a)},async get(a,s={}){a||(a=void 0);const o=await t.get(bc);if(s.signal&&s.signal.aborted)return;const u=JSON.parse(se(o));if(a!==void 0&&_l(u,a)===void 0)throw new mr.NotFoundError(`Key ${a} does not exist in config`);const c=a!==void 0?_l(u,a):u;return c},async set(a,s,o={}){if(arguments.length===1)s=a,a=void 0;else if(!a||typeof a!="string")throw K(new Error("Invalid key type: "+typeof a),"ERR_INVALID_KEY");if(s===void 0||s instanceof Uint8Array)throw K(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>n({key:a,value:s},o.signal))},async replace(a,s={}){if(!a||a instanceof Uint8Array)throw K(new Error("Invalid value type: "+typeof a),"ERR_INVALID_VALUE");return e.add(()=>n({key:void 0,value:a},s.signal))},async exists(){return t.has(bc)}};return r;async function n(a,s){if(s&&s.aborted)return;const o=a.key,u=a.value;if(o){const c=await r.get();return wg(c,o,u),i(c)}return i(u)}function i(a){const s=le(JSON.stringify(a,null,2));return t.put(bc,s)}},Yn=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype},Ng=(t,e={})=>{if(!Yn(t)&&!Array.isArray(t))throw new TypeError("Expected a plain object or array");const{deep:r}=e,n=[],i=[],a=o=>{const u=n.indexOf(o);if(u!==-1)return i[u];const c=[];return n.push(o),i.push(c),c.push(...o.map(d=>Array.isArray(d)?a(d):Yn(d)?s(d):d)),c},s=o=>{const u=n.indexOf(o);if(u!==-1)return i[u];const c={},d=Object.keys(o).sort(e.compare);n.push(o),i.push(c);for(const h of d){const y=o[h];if(r&&Array.isArray(y)){c[h]=a(y);continue}c[h]=r&&Yn(y)?s(y):y}return c};return Array.isArray(t)?r?a(t):t.slice():s(t)};const Pg=En.Key,yc=new Pg("datastore_spec");var Dg=t=>({async exists(){return t.has(yc)},async get(){const e=await t.get(yc);return JSON.parse(se(e))},async set(e){return t.put(yc,le(JSON.stringify(Ng(e,{deep:!0}))))}});const Og=En.Key,gc=new Og("api");var Bg=t=>({async get(){const e=await t.get(gc);return e&&e.toString()},async set(e){return t.put(gc,le(e.toString()))},async delete(){return t.delete(gc)}}),rn=Lg,Mg=Object.prototype.hasOwnProperty;function Lg(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var n in r)Mg.call(r,n)&&(t[n]=r[n])}return t}var Ug=Fg,Kg=Object.prototype.hasOwnProperty;function Fg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Kg.call(r,n)&&(t[n]=r[n])}return t}var vc=function(){var e=rn.apply(null,arguments);return Ug(e,{bufferKeys:e.bufferKeys||!1,snapshots:e.snapshots||!1,permanence:e.permanence||!1,seek:e.seek||!1,clear:e.clear||!1,status:e.status||!1,createIfMissing:e.createIfMissing||!1,errorIfExists:e.errorIfExists||!1,deferredOpen:e.deferredOpen||!1,openCallback:e.openCallback||!1,promises:e.promises||!1,streams:e.streams||!1,encodings:e.encodings||!1,additionalMethods:rn(e.additionalMethods)})},jg=function(){return typeof pe.queueMicrotask=="function"},qg=function(t){return function(){pe.queueMicrotask(t)}},Vg={test:jg,install:qg},Rl=pe.MutationObserver||pe.WebKitMutationObserver,zg=function(){return Rl},$g=function(t){var e=0,r=new Rl(t),n=pe.document.createTextNode("");return r.observe(n,{characterData:!0}),function(){n.data=e=++e%2}},Gg={test:zg,install:$g},Hg=function(){return pe.setImmediate?!1:typeof pe.MessageChannel!="undefined"},Wg=function(t){var e=new pe.MessageChannel;return e.port1.onmessage=t,function(){e.port2.postMessage(0)}},Yg={test:Hg,install:Wg},Xg=function(){return"document"in pe&&"onreadystatechange"in pe.document.createElement("script")},Qg=function(t){return function(){var e=pe.document.createElement("script");return e.onreadystatechange=function(){t(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},pe.document.documentElement.appendChild(e),t}},Jg={test:Xg,install:Qg},Zg=function(){return!0},e1=function(t){return function(){setTimeout(t,0)}},t1={test:Zg,install:e1},wa=[Yt,Vg,Gg,Yg,Jg,t1],Ri,Xn,Ea=-1,xn=[],wc=!1;function r1(){if(!Ri||!Xn)return;Ri=!1,Xn.length?xn=Xn.concat(xn):Ea=-1,xn.length&&Nl()}function Nl(){if(Ri)return;wc=!1,Ri=!0;for(var t=xn.length,e=setTimeout(r1);t;){for(Xn=xn,xn=[];Xn&&++Ea<t;)Xn[Ea].run();Ea=-1,t=xn.length}Xn=null,Ea=-1,Ri=!1,clearTimeout(e)}for(var Pl,xa=-1,n1=wa.length;++xa<n1;)if(wa[xa]&&wa[xa].test&&wa[xa].test()){Pl=wa[xa].install(Nl);break}function Dl(t,e){this.fun=t,this.array=e}Dl.prototype.run=function(){var t=this.fun,e=this.array;switch(e.length){case 0:return t();case 1:return t(e[0]);case 2:return t(e[0],e[1]);case 3:return t(e[0],e[1],e[2]);default:return t.apply(null,e)}};var i1=a1;function a1(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];xn.push(new Dl(t,e)),!wc&&!Ri&&(wc=!0,Pl())}var Ue=i1;function Sn(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}Sn.prototype.next=function(t){var e=this;if(typeof t!="function")throw new Error("next() requires a callback argument");return e._ended?(Ue(t,new Error("cannot call next() after end()")),e):e._nexting?(Ue(t,new Error("cannot call next() before previous next() has completed")),e):(e._nexting=!0,e._next(function(){e._nexting=!1,t.apply(null,arguments)}),e)},Sn.prototype._next=function(t){Ue(t)},Sn.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)},Sn.prototype._seek=function(t){},Sn.prototype.end=function(t){if(typeof t!="function")throw new Error("end() requires a callback argument");if(this._ended)return Ue(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)},Sn.prototype._end=function(t){Ue(t)},Sn.prototype._nextTick=Ue;var Ol=Sn;function br(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}br.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},br.prototype.put=function(t,e){this._checkWritten();var r=this.db._checkKey(t)||this.db._checkValue(e);if(r)throw r;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e),this},br.prototype._put=function(t,e){this._operations.push({type:"put",key:t,value:e})},br.prototype.del=function(t){this._checkWritten();var e=this.db._checkKey(t);if(e)throw e;return t=this.db._serializeKey(t),this._del(t),this},br.prototype._del=function(t){this._operations.push({type:"del",key:t})},br.prototype.clear=function(){return this._checkWritten(),this._clear(),this},br.prototype._clear=function(){this._operations=[]},br.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)},br.prototype._write=function(t,e){this.db._batch(this._operations,t,e)},br.prototype._nextTick=Ue;var Bl=br,s1=At.Buffer,o1=Object.prototype.hasOwnProperty,c1="start end gt gte lt lte".split(" ");function Be(t){this.status="new",this.supports=vc(t,{status:!0})}Be.prototype.open=function(t,e){var r=this,n=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,function(i){if(i)return r.status=n,e(i);r.status="open",e()})},Be.prototype._open=function(t,e){Ue(e)},Be.prototype.close=function(t){var e=this,r=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(function(n){if(n)return e.status=r,t(n);e.status="closed",t()})},Be.prototype._close=function(t){Ue(t)},Be.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");var n=this._checkKey(t);if(n)return Ue(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)},Be.prototype._get=function(t,e,r){Ue(function(){r(new Error("NotFound"))})},Be.prototype.put=function(t,e,r,n){if(typeof r=="function"&&(n=r),typeof n!="function")throw new Error("put() requires a callback argument");var i=this._checkKey(t)||this._checkValue(e);if(i)return Ue(n,i);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,n)},Be.prototype._put=function(t,e,r,n){Ue(n)},Be.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");var n=this._checkKey(t);if(n)return Ue(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)},Be.prototype._del=function(t,e,r){Ue(r)},Be.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return Ue(r,new Error("batch(array) requires an array argument"));if(t.length===0)return Ue(r);(typeof e!="object"||e===null)&&(e={});for(var n=new Array(t.length),i=0;i<t.length;i++){if(typeof t[i]!="object"||t[i]===null)return Ue(r,new Error("batch(array) element must be an object and not `null`"));var a=rn(t[i]);if(a.type!=="put"&&a.type!=="del")return Ue(r,new Error("`type` must be 'put' or 'del'"));var s=this._checkKey(a.key);if(s)return Ue(r,s);if(a.key=this._serializeKey(a.key),a.type==="put"){var o=this._checkValue(a.value);if(o)return Ue(r,o);a.value=this._serializeValue(a.value)}n[i]=a}this._batch(n,e,r)},Be.prototype._batch=function(t,e,r){Ue(r)},Be.prototype.clear=function(t,e){if(typeof t=="function")e=t;else if(typeof e!="function")throw new Error("clear() requires a callback argument");t=Ml(this,t),t.reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)},Be.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;var r=this._iterator(t),n={},i=this,a=function(s){if(s)return r.end(function(){e(s)});r.next(function(o,u){if(o)return a(o);if(u===void 0)return r.end(e);i._del(u,n,a)})};a()},Be.prototype._setupIteratorOptions=function(t){return t=Ml(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function Ml(t,e){var r={};for(var n in e){if(!o1.call(e,n))continue;var i=e[n];u1(n)&&(i=t._serializeKey(i)),r[n]=i}return r}function u1(t){return c1.indexOf(t)!==-1}Be.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)},Be.prototype._iterator=function(t){return new Ol(this)},Be.prototype._chainedBatch=function(){return new Bl(this)},Be.prototype._serializeKey=function(t){return t},Be.prototype._serializeValue=function(t){return t},Be.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(s1.isBuffer(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")},Be.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")},Be.prototype._nextTick=Ue;var d1=Be,l1=d1,f1=Ol,h1=Bl,Ll={AbstractLevelDOWN:l1,AbstractIterator:f1,AbstractChainedBatch:h1},je=Z(function(t){typeof Object.create=="function"?t.exports=function(r,n){n&&(r.super_=n,r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(r,n){if(n){r.super_=n;var i=function(){};i.prototype=n.prototype,r.prototype=new i,r.prototype.constructor=r}}}),Ul=Ll.AbstractIterator;function Ni(t,e){Ul.call(this,t),this._options=e,this._iterator=null,this._operations=[]}je(Ni,Ul),Ni.prototype.setDb=function(t){var e=this._iterator=t.iterator(this._options);this._operations.forEach(function(r){e[r.method].apply(e,r.args)})},Ni.prototype._operation=function(t,e){if(this._iterator)return this._iterator[t].apply(this._iterator,e);this._operations.push({method:t,args:e})},"next end".split(" ").forEach(function(t){Ni.prototype["_"+t]=function(){this._operation(t,arguments)}}),Ni.prototype.seek=function(){this._operation("seek",arguments)};var Kl=Ni,Fl=Ll.AbstractLevelDOWN,jl="put get del batch clear".split(" "),p1="approximateSize compactRange".split(" ");function Qn(t){Fl.call(this,t.supports||{}),p1.forEach(function(e){typeof t[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0)},this),this._db=t,this._operations=[],ql(this)}je(Qn,Fl),Qn.prototype.type="deferred-leveldown",Qn.prototype._open=function(t,e){var r=this;this._db.open(t,function(n){if(n)return e(n);r._operations.forEach(function(i){i.iterator?i.iterator.setDb(r._db):r._db[i.method].apply(r._db,i.args)}),r._operations=[],m1(r),e()})},Qn.prototype._close=function(t){var e=this;this._db.close(function(r){if(r)return t(r);ql(e),t()})};function m1(t){jl.concat("iterator").forEach(function(e){t["_"+e]=function(){return this._db[e].apply(this._db,arguments)}}),Object.keys(t.supports.additionalMethods).forEach(function(e){t[e]=function(){return this._db[e].apply(this._db,arguments)}})}function ql(t){jl.forEach(function(e){t["_"+e]=function(){this._operations.push({method:e,args:arguments})}}),Object.keys(t.supports.additionalMethods).forEach(function(e){t[e]=function(){this._operations.push({method:e,args:arguments})}}),t._iterator=function(e){var r=new Kl(t,e);return this._operations.push({iterator:r}),r}}Qn.prototype._serializeKey=function(t){return t},Qn.prototype._serializeValue=function(t){return t};var Ec=Qn,b1=Kl;Ec.DeferredIterator=b1;var Jn=Rr.EventEmitter;function Vl(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function y1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vl(Object(r),!0).forEach(function(n){g1(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vl(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g1(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w1(t,e,r){return e&&zl(t.prototype,e),r&&zl(t,r),t}var Es=At.Buffer,xc=Yt.inspect,E1=xc&&xc.custom||"inspect";function x1(t,e,r){Es.prototype.copy.call(t,e,r)}var S1=function(){function t(){v1(this,t),this.head=null,this.tail=null,this.length=0}return w1(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length===0)return;var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return Es.alloc(0);for(var n=Es.allocUnsafe(r>>>0),i=this.head,a=0;i;)x1(i.data,n,a),a+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,a=n.data;for(r-=a.length;n=n.next;){var s=n.data,o=r>s.length?s.length:r;if(o===s.length?a+=s:a+=s.slice(0,r),r-=o,r===0){o===s.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=s.slice(o));break}++i}return this.length-=i,a}},{key:"_getBuffer",value:function(r){var n=Es.allocUnsafe(r),i=this.head,a=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var s=i.data,o=r>s.length?s.length:r;if(s.copy(n,n.length-r,0,o),r-=o,r===0){o===s.length?(++a,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=s.slice(o));break}++a}return this.length-=a,n}},{key:E1,value:function(r,n){return xc(this,y1({},n,{depth:0,customInspect:!1}))}}]),t}();function A1(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Y.nextTick(Sc,this,t)):Y.nextTick(Sc,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(a){!e&&a?r._writableState?r._writableState.errorEmitted?Y.nextTick(xs,r):(r._writableState.errorEmitted=!0,Y.nextTick($l,r,a)):Y.nextTick($l,r,a):e?(Y.nextTick(xs,r),e(a)):Y.nextTick(xs,r)}),this)}function $l(t,e){Sc(t,e),xs(t)}function xs(t){if(t._writableState&&!t._writableState.emitClose)return;if(t._readableState&&!t._readableState.emitClose)return;t.emit("close")}function I1(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Sc(t,e){t.emit("error",e)}function k1(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}var Pi={destroy:A1,undestroy:I1,errorOrDestroy:k1};function T1(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Gl={};function tr(t,e,r){r||(r=Error);function n(a,s,o){return typeof e=="string"?e:e(a,s,o)}var i=function(a){T1(s,a);function s(o,u,c){return a.call(this,n(o,u,c))||this}return s}(r);i.prototype.name=r.name,i.prototype.code=t,Gl[t]=i}function Hl(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function C1(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function _1(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function R1(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}tr("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError),tr("ERR_INVALID_ARG_TYPE",function(t,e,r){var n;typeof e=="string"&&C1(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var i;if(_1(t," argument"))i="The ".concat(t," ").concat(n," ").concat(Hl(e,"type"));else{var a=R1(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(a," ").concat(n," ").concat(Hl(e,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError),tr("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),tr("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"}),tr("ERR_STREAM_PREMATURE_CLOSE","Premature close"),tr("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"}),tr("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),tr("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),tr("ERR_STREAM_WRITE_AFTER_END","write after end"),tr("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),tr("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError),tr("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");var N1=Gl,Di={codes:N1},P1=Di.codes.ERR_INVALID_OPT_VALUE;function D1(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function O1(t,e,r,n){var i=D1(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var a=n?r:"highWaterMark";throw new P1(a,i)}return Math.floor(i)}return t.objectMode?16:16*1024}var Wl={getHighWaterMark:O1},B1=M1;function M1(t,e){if(Ac("noDeprecation"))return t;var r=!1;function n(){if(!r){if(Ac("throwDeprecation"))throw new Error(e);Ac("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return n}function Ac(t){try{if(!pe.localStorage)return!1}catch(r){return!1}var e=pe.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}var Ss=Fe;function Yl(t){var e=this;this.next=null,this.entry=null,this.finish=function(){cv(e,t)}}var Oi;Fe.WritableState=Sa;var L1={deprecate:B1},As=At.Buffer,U1=pe.Uint8Array||function(){};function K1(t){return As.from(t)}function F1(t){return As.isBuffer(t)||t instanceof U1}var j1=Wl.getHighWaterMark,An=Di.codes,q1=An.ERR_INVALID_ARG_TYPE,V1=An.ERR_METHOD_NOT_IMPLEMENTED,z1=An.ERR_MULTIPLE_CALLBACK,$1=An.ERR_STREAM_CANNOT_PIPE,G1=An.ERR_STREAM_DESTROYED,H1=An.ERR_STREAM_NULL_VALUES,W1=An.ERR_STREAM_WRITE_AFTER_END,Y1=An.ERR_UNKNOWN_ENCODING,Bi=Pi.errorOrDestroy;je(Fe,Jn);function X1(){}function Sa(t,e,r){Oi=Oi||nn,t=t||{},typeof r!="boolean"&&(r=e instanceof Oi),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=j1(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){nv(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Yl(this)}Sa.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r},function(){try{Object.defineProperty(Sa.prototype,"buffer",{get:L1.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}();var Is;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Is=Function.prototype[Symbol.hasInstance],Object.defineProperty(Fe,Symbol.hasInstance,{value:function(e){return Is.call(this,e)?!0:this!==Fe?!1:e&&e._writableState instanceof Sa}})):Is=function(e){return e instanceof this};function Fe(t){Oi=Oi||nn;var e=this instanceof Oi;if(!e&&!Is.call(Fe,this))return new Fe(t);this._writableState=new Sa(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),Jn.call(this)}Fe.prototype.pipe=function(){Bi(this,new $1)};function Q1(t,e){var r=new W1;Bi(t,r),Y.nextTick(e,r)}function J1(t,e,r,n){var i;return r===null?i=new H1:typeof r!="string"&&!e.objectMode&&(i=new q1("chunk",["string","Buffer"],r)),i?(Bi(t,i),Y.nextTick(n,i),!1):!0}Fe.prototype.write=function(t,e,r){var n=this._writableState,i=!1,a=!n.objectMode&&F1(t);return a&&!As.isBuffer(t)&&(t=K1(t)),typeof e=="function"&&(r=e,e=null),a?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=X1),n.ending?Q1(this,r):(a||J1(this,n,t,r))&&(n.pendingcb++,i=ev(this,n,a,t,e,r)),i},Fe.prototype.cork=function(){this._writableState.corked++},Fe.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Ql(this,t))},Fe.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new Y1(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Fe.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Z1(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=As.from(e,r)),e}Object.defineProperty(Fe.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ev(t,e,r,n,i,a){if(!r){var s=Z1(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var o=e.objectMode?1:n.length;e.length+=o;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Ic(t,e,!1,o,n,i,a);return u}function Ic(t,e,r,n,i,a,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new G1("write")):r?t._writev(i,e.onwrite):t._write(i,a,e.onwrite),e.sync=!1}function tv(t,e,r,n,i){--e.pendingcb,r?(Y.nextTick(i,n),Y.nextTick(Aa,t,e),t._writableState.errorEmitted=!0,Bi(t,n)):(i(n),t._writableState.errorEmitted=!0,Bi(t,n),Aa(t,e))}function rv(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function nv(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new z1;if(rv(r),e)tv(t,r,n,e,i);else{var a=Jl(r)||t.destroyed;!a&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Ql(t,r),n?Y.nextTick(Xl,t,r,a,i):Xl(t,r,a,i)}}function Xl(t,e,r,n){r||iv(t,e),e.pendingcb--,n(),Aa(t,e)}function iv(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function Ql(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),a=e.corkedRequestsFree;a.entry=r;for(var s=0,o=!0;r;)i[s]=r,r.isBuf||(o=!1),r=r.next,s+=1;i.allBuffers=o,Ic(t,e,!0,e.length,i,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new Yl(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,c=r.encoding,d=r.callback,h=e.objectMode?1:u.length;if(Ic(t,e,!1,h,u,c,d),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Fe.prototype._write=function(t,e,r){r(new V1("_write()"))},Fe.prototype._writev=null,Fe.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||ov(this,n,r),this},Object.defineProperty(Fe.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Jl(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function av(t,e){t._final(function(r){e.pendingcb--,r&&Bi(t,r),e.prefinished=!0,t.emit("prefinish"),Aa(t,e)})}function sv(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,Y.nextTick(av,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Aa(t,e){var r=Jl(e);if(r&&(sv(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function ov(t,e,r){e.ending=!0,Aa(t,e),r&&(e.finished?Y.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function cv(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(Fe.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){if(!this._writableState)return;this._writableState.destroyed=e}}),Fe.prototype.destroy=Pi.destroy,Fe.prototype._undestroy=Pi.undestroy,Fe.prototype._destroy=function(t,e){e(t)};var uv=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e},nn=Dr;je(Dr,Pc);for(var Zl=uv(Ss.prototype),kc=0;kc<Zl.length;kc++){var Tc=Zl[kc];Dr.prototype[Tc]||(Dr.prototype[Tc]=Ss.prototype[Tc])}function Dr(t){if(!(this instanceof Dr))return new Dr(t);Pc.call(this,t),Ss.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",dv)))}Object.defineProperty(Dr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Dr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Dr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function dv(){if(this._writableState.ended)return;Y.nextTick(lv,this)}function lv(t){t.end()}Object.defineProperty(Dr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){if(this._readableState===void 0||this._writableState===void 0)return;this._readableState.destroyed=e,this._writableState.destroyed=e}});var fv=Z(function(t,e){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var r=At.Buffer;function n(a,s){for(var o in a)s[o]=a[o]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=At:(n(At,e),e.Buffer=i);function i(a,s,o){return r(a,s,o)}i.prototype=Object.create(r.prototype),n(r,i),i.from=function(a,s,o){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,s,o)},i.alloc=function(a,s,o){if(typeof a!="number")throw new TypeError("Argument must be a number");var u=r(a);return s!==void 0?typeof o=="string"?u.fill(s,o):u.fill(s):u.fill(0),u},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return At.SlowBuffer(a)}}),Cc=fv.Buffer,ef=Cc.isEncoding||function(t){t=""+t;switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function hv(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function pv(t){var e=hv(t);if(typeof e!="string"&&(Cc.isEncoding===ef||!ef(t)))throw new Error("Unknown encoding: "+t);return e||t}var mv=Ia;function Ia(t){this.encoding=pv(t);var e;switch(this.encoding){case"utf16le":this.text=Ev,this.end=xv,e=4;break;case"utf8":this.fillLast=gv,e=4;break;case"base64":this.text=Sv,this.end=Av,e=3;break;default:this.write=Iv,this.end=kv;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Cc.allocUnsafe(e)}Ia.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},Ia.prototype.end=wv,Ia.prototype.text=vv,Ia.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function _c(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function bv(t,e,r){var n=e.length-1;if(n<r)return 0;var i=_c(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=_c(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=_c(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function yv(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function gv(t){var e=this.lastTotal-this.lastNeed,r=yv(this,t);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function vv(t,e){var r=bv(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function wv(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function Ev(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function xv(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function Sv(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function Av(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Iv(t){return t.toString(this.encoding)}function kv(t){return t&&t.length?this.write(t):""}var tf={StringDecoder:mv},rf=Di.codes.ERR_STREAM_PREMATURE_CLOSE;function Tv(t){var e=!1;return function(){if(e)return;e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}function Cv(){}function _v(t){return t.setHeader&&typeof t.abort=="function"}function nf(t,e,r){if(typeof e=="function")return nf(t,null,e);e||(e={}),r=Tv(r||Cv);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,a=function(){t.writable||o()},s=t._writableState&&t._writableState.finished,o=function(){i=!1,s=!0,n||r.call(t)},u=t._readableState&&t._readableState.endEmitted,c=function(){n=!1,u=!0,i||r.call(t)},d=function(m){r.call(t,m)},h=function(){var m;if(n&&!u)return(!t._readableState||!t._readableState.ended)&&(m=new rf),r.call(t,m);if(i&&!s)return(!t._writableState||!t._writableState.ended)&&(m=new rf),r.call(t,m)},y=function(){t.req.on("finish",o)};return _v(t)?(t.on("complete",o),t.on("abort",h),t.req?y():t.on("request",y)):i&&!t._writableState&&(t.on("end",a),t.on("close",a)),t.on("end",c),t.on("finish",o),e.error!==!1&&t.on("error",d),t.on("close",h),function(){t.removeListener("complete",o),t.removeListener("abort",h),t.removeListener("request",y),t.req&&t.req.removeListener("finish",o),t.removeListener("end",a),t.removeListener("close",a),t.removeListener("finish",o),t.removeListener("end",c),t.removeListener("error",d),t.removeListener("close",h)}}var Rc=nf,ks;function In(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kn=Symbol("lastResolve"),Zn=Symbol("lastReject"),ka=Symbol("error"),Ts=Symbol("ended"),ei=Symbol("lastPromise"),Nc=Symbol("handlePromise"),ti=Symbol("stream");function Tn(t,e){return{value:t,done:e}}function Rv(t){var e=t[kn];if(e!==null){var r=t[ti].read();r!==null&&(t[ei]=null,t[kn]=null,t[Zn]=null,e(Tn(r,!1)))}}function Nv(t){Y.nextTick(Rv,t)}function Pv(t,e){return function(r,n){t.then(function(){if(e[Ts]){r(Tn(void 0,!0));return}e[Nc](r,n)},n)}}var Dv=Object.getPrototypeOf(function(){}),Ov=Object.setPrototypeOf((ks={get stream(){return this[ti]},next:function(){var e=this,r=this[ka];if(r!==null)return Promise.reject(r);if(this[Ts])return Promise.resolve(Tn(void 0,!0));if(this[ti].destroyed)return new Promise(function(s,o){Y.nextTick(function(){e[ka]?o(e[ka]):s(Tn(void 0,!0))})});var n=this[ei],i;if(n)i=new Promise(Pv(n,this));else{var a=this[ti].read();if(a!==null)return Promise.resolve(Tn(a,!1));i=new Promise(this[Nc])}return this[ei]=i,i}},In(ks,Symbol.asyncIterator,function(){return this}),In(ks,"return",function(){var e=this;return new Promise(function(r,n){e[ti].destroy(null,function(i){if(i){n(i);return}r(Tn(void 0,!0))})})}),ks),Dv),Bv=function(e){var r,n=Object.create(Ov,(r={},In(r,ti,{value:e,writable:!0}),In(r,kn,{value:null,writable:!0}),In(r,Zn,{value:null,writable:!0}),In(r,ka,{value:null,writable:!0}),In(r,Ts,{value:e._readableState.endEmitted,writable:!0}),In(r,Nc,{value:function(a,s){var o=n[ti].read();o?(n[ei]=null,n[kn]=null,n[Zn]=null,a(Tn(o,!1))):(n[kn]=a,n[Zn]=s)},writable:!0}),r));return n[ei]=null,Rc(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var a=n[Zn];a!==null&&(n[ei]=null,n[kn]=null,n[Zn]=null,a(i)),n[ka]=i;return}var s=n[kn];s!==null&&(n[ei]=null,n[kn]=null,n[Zn]=null,s(Tn(void 0,!0))),n[Ts]=!0}),e.on("readable",Nv.bind(null,n)),n},Mv=Bv,Lv=function(){throw new Error("Readable.from is not available in the browser")},Pc=Se,Mi;Se.ReadableState=sf;var k9=Rr.EventEmitter,af=function(e,r){return e.listeners(r).length},Cs=At.Buffer,Uv=pe.Uint8Array||function(){};function Kv(t){return Cs.from(t)}function Fv(t){return Cs.isBuffer(t)||t instanceof Uv}var fe;Yt&&Yt.debuglog?fe=Yt.debuglog("stream"):fe=function(){};var jv=Wl.getHighWaterMark,_s=Di.codes,qv=_s.ERR_INVALID_ARG_TYPE,Vv=_s.ERR_STREAM_PUSH_AFTER_EOF,zv=_s.ERR_METHOD_NOT_IMPLEMENTED,$v=_s.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Li,Dc,Oc;je(Se,Jn);var Ta=Pi.errorOrDestroy,Bc=["error","close","destroy","pause","resume"];function Gv(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function sf(t,e,r){Mi=Mi||nn,t=t||{},typeof r!="boolean"&&(r=e instanceof Mi),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=jv(this,t,"readableHighWaterMark",r),this.buffer=new S1,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(Li||(Li=tf.StringDecoder),this.decoder=new Li(t.encoding),this.encoding=t.encoding)}function Se(t){if(Mi=Mi||nn,!(this instanceof Se))return new Se(t);var e=this instanceof Mi;this._readableState=new sf(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Jn.call(this)}Object.defineProperty(Se.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){if(!this._readableState)return;this._readableState.destroyed=e}}),Se.prototype.destroy=Pi.destroy,Se.prototype._undestroy=Pi.undestroy,Se.prototype._destroy=function(t,e){e(t)},Se.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=Cs.from(t,e),e=""),n=!0),of(this,t,e,!1,n)},Se.prototype.unshift=function(t){return of(this,t,null,!0,!1)};function of(t,e,r,n,i){fe("readableAddChunk",e);var a=t._readableState;if(e===null)a.reading=!1,Yv(t,a);else{var s;if(i||(s=Hv(a,e)),s)Ta(t,s);else if(a.objectMode||e&&e.length>0)if(typeof e!="string"&&!a.objectMode&&Object.getPrototypeOf(e)!==Cs.prototype&&(e=Kv(e)),n)a.endEmitted?Ta(t,new $v):Mc(t,a,e,!0);else if(a.ended)Ta(t,new Vv);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(e=a.decoder.write(e),a.objectMode||e.length!==0?Mc(t,a,e,!1):Lc(t,a)):Mc(t,a,e,!1)}else n||(a.reading=!1,Lc(t,a))}return!a.ended&&(a.length<a.highWaterMark||a.length===0)}function Mc(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Rs(t)),Lc(t,e)}function Hv(t,e){var r;return!Fv(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new qv("chunk",["string","Buffer","Uint8Array"],e)),r}Se.prototype.isPaused=function(){return this._readableState.flowing===!1},Se.prototype.setEncoding=function(t){Li||(Li=tf.StringDecoder);var e=new Li(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var cf=1073741824;function Wv(t){return t>=cf?t=cf:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function uf(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=Wv(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Se.prototype.read=function(t){fe("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return fe("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Kc(this):Rs(this),null;if(t=uf(t,e),t===0&&e.ended)return e.length===0&&Kc(this),null;var n=e.needReadable;fe("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,fe("length less than watermark",n)),e.ended||e.reading?(n=!1,fe("reading or ended",n)):n&&(fe("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=uf(r,e)));var i;return t>0?i=ff(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&Kc(this)),i!==null&&this.emit("data",i),i};function Yv(t,e){if(fe("onEofChunk"),e.ended)return;if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?Rs(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,df(t)))}function Rs(t){var e=t._readableState;fe("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(fe("emitReadable",e.flowing),e.emittedReadable=!0,Y.nextTick(df,t))}function df(t){var e=t._readableState;fe("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Uc(t)}function Lc(t,e){e.readingMore||(e.readingMore=!0,Y.nextTick(Xv,t,e))}function Xv(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(fe("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Se.prototype._read=function(t){Ta(this,new zv("_read()"))},Se.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,fe("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==Y.stdout&&t!==Y.stderr,a=i?o:_;n.endEmitted?Y.nextTick(a):r.once("end",a),t.on("unpipe",s);function s(I,f){fe("onunpipe"),I===r&&(f&&f.hasUnpiped===!1&&(f.hasUnpiped=!0,d()))}function o(){fe("onend"),t.end()}var u=Qv(r);t.on("drain",u);var c=!1;function d(){fe("cleanup"),t.removeListener("close",p),t.removeListener("finish",m),t.removeListener("drain",u),t.removeListener("error",y),t.removeListener("unpipe",s),r.removeListener("end",o),r.removeListener("end",_),r.removeListener("data",h),c=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&u()}r.on("data",h);function h(I){fe("ondata");var f=t.write(I);fe("dest.write",f),f===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&hf(n.pipes,t)!==-1)&&!c&&(fe("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function y(I){fe("onerror",I),_(),t.removeListener("error",y),af(t,"error")===0&&Ta(t,I)}Gv(t,"error",y);function p(){t.removeListener("finish",m),_()}t.once("close",p);function m(){fe("onfinish"),t.removeListener("close",p),_()}t.once("finish",m);function _(){fe("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(fe("pipe resume"),r.resume()),t};function Qv(t){return function(){var r=t._readableState;fe("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&af(t,"data")&&(r.flowing=!0,Uc(t))}}Se.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=hf(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)},Se.prototype.on=function(t,e){var r=Jn.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&(!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,fe("on readable",n.length,n.reading),n.length?Rs(this):n.reading||Y.nextTick(Jv,this))),r},Se.prototype.addListener=Se.prototype.on,Se.prototype.removeListener=function(t,e){var r=Jn.prototype.removeListener.call(this,t,e);return t==="readable"&&Y.nextTick(lf,this),r},Se.prototype.removeAllListeners=function(t){var e=Jn.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&Y.nextTick(lf,this),e};function lf(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function Jv(t){fe("readable nexttick read 0"),t.read(0)}Se.prototype.resume=function(){var t=this._readableState;return t.flowing||(fe("resume"),t.flowing=!t.readableListening,Zv(this,t)),t.paused=!1,this};function Zv(t,e){e.resumeScheduled||(e.resumeScheduled=!0,Y.nextTick(e2,t,e))}function e2(t,e){fe("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Uc(t),e.flowing&&!e.reading&&t.read(0)}Se.prototype.pause=function(){return fe("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(fe("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Uc(t){var e=t._readableState;for(fe("flow",e.flowing);e.flowing&&t.read()!==null;);}Se.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(fe("wrapped end"),r.decoder&&!r.ended){var s=r.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(fe("wrapped data"),r.decoder&&(s=r.decoder.write(s)),r.objectMode&&s==null)return;if(!r.objectMode&&(!s||!s.length))return;var o=e.push(s);o||(n=!0,t.pause())});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(o){return function(){return t[o].apply(t,arguments)}}(i));for(var a=0;a<Bc.length;a++)t.on(Bc[a],this.emit.bind(this,Bc[a]));return this._read=function(s){fe("wrapped _read",s),n&&(n=!1,t.resume())},this},typeof Symbol=="function"&&(Se.prototype[Symbol.asyncIterator]=function(){return Dc===void 0&&(Dc=Mv),Dc(this)}),Object.defineProperty(Se.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Se.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Se.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),Se._fromList=ff,Object.defineProperty(Se.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ff(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function Kc(t){var e=t._readableState;fe("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,Y.nextTick(t2,e,t))}function t2(t,e){if(fe("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(Se.from=function(t,e){return Oc===void 0&&(Oc=Lv),Oc(Se,t,e)});function hf(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}var Fc=an,Ns=Di.codes,r2=Ns.ERR_METHOD_NOT_IMPLEMENTED,n2=Ns.ERR_MULTIPLE_CALLBACK,i2=Ns.ERR_TRANSFORM_ALREADY_TRANSFORMING,a2=Ns.ERR_TRANSFORM_WITH_LENGTH_0;je(an,nn);function s2(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new n2);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function an(t){if(!(this instanceof an))return new an(t);nn.call(this,t),this._transformState={afterTransform:s2.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",o2)}function o2(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){pf(t,e,r)}):pf(this,null,null)}an.prototype.push=function(t,e){return this._transformState.needTransform=!1,nn.prototype.push.call(this,t,e)},an.prototype._transform=function(t,e,r){r(new r2("_transform()"))},an.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},an.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},an.prototype._destroy=function(t,e){nn.prototype._destroy.call(this,t,function(r){e(r)})};function pf(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new a2;if(t._transformState.transforming)throw new i2;return t.push(null)}var c2=Ca;je(Ca,Fc);function Ca(t){if(!(this instanceof Ca))return new Ca(t);Fc.call(this,t)}Ca.prototype._transform=function(t,e,r){r(null,t)};var jc;function u2(t){var e=!1;return function(){if(e)return;e=!0,t.apply(void 0,arguments)}}var mf=Di.codes,d2=mf.ERR_MISSING_ARGS,l2=mf.ERR_STREAM_DESTROYED;function bf(t){if(t)throw t}function f2(t){return t.setHeader&&typeof t.abort=="function"}function h2(t,e,r,n){n=u2(n);var i=!1;t.on("close",function(){i=!0}),jc===void 0&&(jc=Rc),jc(t,{readable:e,writable:r},function(s){if(s)return n(s);i=!0,n()});var a=!1;return function(s){if(i)return;if(a)return;if(a=!0,f2(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(s||new l2("pipe"))}}function yf(t){t()}function p2(t,e){return t.pipe(e)}function m2(t){return t.length?typeof t[t.length-1]!="function"?bf:t.pop():bf}function b2(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=m2(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new d2("streams");var i,a=e.map(function(s,o){var u=o<e.length-1,c=o>0;return h2(s,u,c,function(d){if(i||(i=d),d&&a.forEach(yf),u)return;a.forEach(yf),n(i)})});return e.reduce(p2)}var y2=b2,g2=Z(function(t,e){e=t.exports=Pc,e.Stream=e,e.Readable=e,e.Writable=Ss,e.Duplex=nn,e.Transform=Fc,e.PassThrough=c2,e.finished=Rc,e.pipeline=y2}),gf=g2.Readable,v2=Ui;je(Ui,gf);function Ui(t,e){if(!(this instanceof Ui))return new Ui(t,e);e=e||{},gf.call(this,rn(e,{objectMode:!0})),this._iterator=t,this._options=e,this.on("end",this.destroy.bind(this,null,null))}Ui.prototype._read=function(){var t=this,e=this._options;if(this.destroyed)return;this._iterator.next(function(r,n,i){if(t.destroyed)return;if(r)return t.destroy(r);n===void 0&&i===void 0?t.push(null):e.keys!==!1&&e.values===!1?t.push(n):e.keys===!1&&e.values!==!1?t.push(i):t.push({key:n,value:i})})},Ui.prototype._destroy=function(t,e){this._iterator.end(function(r){e(t||r)})};var w2=Z(function(t){/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */(function(e,r,n){t.exports?t.exports=n():r[e]=n()})("prr",pe,function(){var e=typeof Object.defineProperty=="function"?function(i,a,s){return Object.defineProperty(i,a,s),i}:function(i,a,s){return i[a]=s.value,i},r=function(i,a){var s=typeof a=="object",o=!s&&typeof a=="string",u=function(c){return s?!!a[c]:o?a.indexOf(c[0])>-1:!1};return{enumerable:u("enumerable"),configurable:u("configurable"),writable:u("writable"),value:i}},n=function(i,a,s,o){var u;if(o=r(s,o),typeof a=="object"){for(u in a)Object.hasOwnProperty.call(a,u)&&(o.value=a[u],e(i,u,o));return i}return e(i,a,o)};return n})});function vf(t,e,r){!!e&&typeof e!="string"&&(e=e.message||e.name),w2(this,{type:t,name:t,cause:typeof e!="string"?e:r,message:e},"ewr")}function qc(t,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),vf.call(this,"CustomError",t,e)}qc.prototype=new Error;function E2(t,e,r){var n=function(i,a){vf.call(this,e,i,a),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(t.errno[this.cause.errno]?t.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,n)};return n.prototype=r?new r:new qc,n}var x2=function(t){var e=function(r,n){return E2(t,r,n)};return{CustomError:qc,FilesystemError:e("FilesystemError"),createError:e}},S2=Z(function(t){var e=t.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];t.exports.errno={},t.exports.code={},e.forEach(function(r){t.exports.errno[r.errno]=r,t.exports.code[r.code]=r}),t.exports.custom=x2(t.exports),t.exports.create=t.exports.custom.createError}),ri=S2.create,ni=ri("LevelUPError"),Vc=ri("NotFoundError",ni);Vc.prototype.notFound=!0,Vc.prototype.status=404;var Cn={LevelUPError:ni,InitializationError:ri("InitializationError",ni),OpenError:ri("OpenError",ni),ReadError:ri("ReadError",ni),WriteError:ri("WriteError",ni),NotFoundError:Vc,EncodingError:ri("EncodingError",ni)};function A2(){var t,e=new Promise(function(r,n){t=function(a,s){a?n(a):r(s)}});return t.promise=e,t}var _n=A2,I2=function(t,e){return typeof t=="function"?t:e},k2=function(t){return typeof t=="object"&&t!==null?t:{}},Ps={getCallback:I2,getOptions:k2},_a=Cn.WriteError,T2=Ps.getCallback,C2=Ps.getOptions;function Ra(t){this.db=this._levelup=t,this.batch=t.db.batch(),this.ops=[],this.length=0}Ra.prototype.put=function(t,e){try{this.batch.put(t,e)}catch(r){throw new _a(r)}return this.ops.push({type:"put",key:t,value:e}),this.length++,this},Ra.prototype.del=function(t){try{this.batch.del(t)}catch(e){throw new _a(e)}return this.ops.push({type:"del",key:t}),this.length++,this},Ra.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new _a(t)}return this.ops=[],this.length=0,this},Ra.prototype.write=function(t,e){var r=this._levelup,n=this.ops,i;e=T2(t,e),e||(e=_n(),i=e.promise),t=C2(t);try{this.batch.write(t,function(a){if(a)return e(new _a(a));r.emit("batch",n),e()})}catch(a){throw new _a(a)}return i};var _2=Ra,Ds=Rr.EventEmitter,R2=Sb.inherits,Na=Ps.getCallback,Ki=Ps.getOptions,Os=Cn.WriteError,wf=Cn.ReadError,N2=Cn.NotFoundError,P2=Cn.OpenError,D2=Cn.InitializationError;function Ce(t,e,r){if(!(this instanceof Ce))return new Ce(t,e,r);var n,i=this;if(Ds.call(this),this.setMaxListeners(Infinity),typeof e=="function"&&(r=e,e={}),e=e||{},!t||typeof t!="object"){if(n=new D2("First argument must be an abstract-leveldown compliant store"),typeof r=="function")return Y.nextTick(r,n);throw n}Ib.strictEqual(typeof t.status,"string",".status required, old abstract-leveldown"),this.options=Ki(e),this._db=t,this.db=new Ec(t),this.open(r||function(a){a&&i.emit("error",a)}),this.supports=vc(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0}),Object.keys(this.supports.additionalMethods).forEach(function(a){if(this[a]!=null)return;this[a]=function(){return this.db[a].apply(this.db,arguments)}},this)}Ce.prototype.emit=Ds.prototype.emit,Ce.prototype.once=Ds.prototype.once,R2(Ce,Ds),Ce.prototype.open=function(t,e){var r=this,n;return typeof t=="function"&&(e=t,t=null),e||(e=_n(),n=e.promise),t||(t=this.options),this.isOpen()?(Y.nextTick(e,null,r),n):this._isOpening()?(this.once("open",function(){e(null,r)}),n):(this.emit("opening"),this.db.open(t,function(i){if(i)return e(new P2(i));r.db=r._db,e(null,r),r.emit("open"),r.emit("ready")}),n)},Ce.prototype.close=function(t){var e=this,r;return t||(t=_n(),r=t.promise),this.isOpen()?(this.db.close(function(){e.emit("closed"),t.apply(null,arguments)}),this.emit("closing"),this.db=new Ec(this._db)):this.isClosed()?Y.nextTick(t):this.db.status==="closing"?this.once("closed",t):this._isOpening()&&this.once("open",function(){e.close(t)}),r},Ce.prototype.isOpen=function(){return this.db.status==="open"},Ce.prototype._isOpening=function(){return this.db.status==="opening"},Ce.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},Ce.prototype.get=function(t,e,r){var n;return r=Na(e,r),r||(r=_n(),n=r.promise),Pa(this,r)||(e=Ki(e),this.db.get(t,e,function(i,a){if(i)return/notfound/i.test(i)||i.notFound?i=new N2("Key not found in database ["+t+"]",i):i=new wf(i),r(i);r(null,a)})),n},Ce.prototype.put=function(t,e,r,n){var i=this,a;return n=Na(r,n),n||(n=_n(),a=n.promise),Pa(this,n)||(r=Ki(r),this.db.put(t,e,r,function(s){if(s)return n(new Os(s));i.emit("put",t,e),n()})),a},Ce.prototype.del=function(t,e,r){var n=this,i;return r=Na(e,r),r||(r=_n(),i=r.promise),Pa(this,r)||(e=Ki(e),this.db.del(t,e,function(a){if(a)return r(new Os(a));n.emit("del",t),r()})),i},Ce.prototype.batch=function(t,e,r){if(!arguments.length)return new _2(this);var n=this,i;return typeof t=="function"?r=t:r=Na(e,r),r||(r=_n(),i=r.promise),Pa(this,r)||(e=Ki(e),this.db.batch(t,e,function(a){if(a)return r(new Os(a));n.emit("batch",t),r()})),i},Ce.prototype.iterator=function(t){return this.db.iterator(t)},Ce.prototype.clear=function(t,e){var r=this,n;return e=Na(t,e),t=Ki(t),e||(e=_n(),n=e.promise),Pa(this,e)||this.db.clear(t,function(i){if(i)return e(new Os(i));r.emit("clear",t),e()}),n},Ce.prototype.readStream=Ce.prototype.createReadStream=function(t){return t=rn({keys:!0,values:!0},t),typeof t.limit!="number"&&(t.limit=-1),new v2(this.db.iterator(t),t)},Ce.prototype.keyStream=Ce.prototype.createKeyStream=function(t){return this.createReadStream(rn(t,{keys:!0,values:!1}))},Ce.prototype.valueStream=Ce.prototype.createValueStream=function(t){return this.createReadStream(rn(t,{keys:!1,values:!0}))},Ce.prototype.toString=function(){return"LevelUP"},Ce.prototype.type="levelup";function Pa(t,e){if(!t._isOpening()&&!t.isOpen())return Y.nextTick(e,new wf("Database is not open")),!0}Ce.errors=Cn;var Ef=Ce.default=Ce,O2=function(){return typeof pe.queueMicrotask=="function"},B2=function(t){return function(){pe.queueMicrotask(t)}},M2={test:O2,install:B2},xf=pe.MutationObserver||pe.WebKitMutationObserver,L2=function(){return xf},U2=function(t){var e=0,r=new xf(t),n=pe.document.createTextNode("");return r.observe(n,{characterData:!0}),function(){n.data=e=++e%2}},K2={test:L2,install:U2},F2=function(){return pe.setImmediate?!1:typeof pe.MessageChannel!="undefined"},j2=function(t){var e=new pe.MessageChannel;return e.port1.onmessage=t,function(){e.port2.postMessage(0)}},q2={test:F2,install:j2},V2=function(){return"document"in pe&&"onreadystatechange"in pe.document.createElement("script")},z2=function(t){return function(){var e=pe.document.createElement("script");return e.onreadystatechange=function(){t(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},pe.document.documentElement.appendChild(e),t}},$2={test:V2,install:z2},G2=function(){return!0},H2=function(t){return function(){setTimeout(t,0)}},W2={test:G2,install:H2},Da=[Yt,M2,K2,q2,$2,W2],Fi,ii,Oa=-1,Rn=[],zc=!1;function Y2(){if(!Fi||!ii)return;Fi=!1,ii.length?Rn=ii.concat(Rn):Oa=-1,Rn.length&&Sf()}function Sf(){if(Fi)return;zc=!1,Fi=!0;for(var t=Rn.length,e=setTimeout(Y2);t;){for(ii=Rn,Rn=[];ii&&++Oa<t;)ii[Oa].run();Oa=-1,t=Rn.length}ii=null,Oa=-1,Fi=!1,clearTimeout(e)}for(var Af,Ba=-1,X2=Da.length;++Ba<X2;)if(Da[Ba]&&Da[Ba].test&&Da[Ba].test()){Af=Da[Ba].install(Sf);break}function If(t,e){this.fun=t,this.array=e}If.prototype.run=function(){var t=this.fun,e=this.array;switch(e.length){case 0:return t();case 1:return t(e[0]);case 2:return t(e[0],e[1]);case 3:return t(e[0],e[1],e[2]);default:return t.apply(null,e)}};var Q2=J2;function J2(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Rn.push(new If(t,e)),!zc&&!Fi&&(zc=!0,Af())}var Ke=Q2;function Nn(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}Nn.prototype.next=function(t){var e=this;if(typeof t!="function")throw new Error("next() requires a callback argument");return e._ended?(Ke(t,new Error("cannot call next() after end()")),e):e._nexting?(Ke(t,new Error("cannot call next() before previous next() has completed")),e):(e._nexting=!0,e._next(function(){e._nexting=!1,t.apply(null,arguments)}),e)},Nn.prototype._next=function(t){Ke(t)},Nn.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)},Nn.prototype._seek=function(t){},Nn.prototype.end=function(t){if(typeof t!="function")throw new Error("end() requires a callback argument");if(this._ended)return Ke(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)},Nn.prototype._end=function(t){Ke(t)},Nn.prototype._nextTick=Ke;var kf=Nn;function yr(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}yr.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},yr.prototype.put=function(t,e){this._checkWritten();var r=this.db._checkKey(t)||this.db._checkValue(e);if(r)throw r;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e),this},yr.prototype._put=function(t,e){this._operations.push({type:"put",key:t,value:e})},yr.prototype.del=function(t){this._checkWritten();var e=this.db._checkKey(t);if(e)throw e;return t=this.db._serializeKey(t),this._del(t),this},yr.prototype._del=function(t){this._operations.push({type:"del",key:t})},yr.prototype.clear=function(){return this._checkWritten(),this._clear(),this},yr.prototype._clear=function(){this._operations=[]},yr.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)},yr.prototype._write=function(t,e){this.db._batch(this._operations,t,e)},yr.prototype._nextTick=Ke;var Tf=yr,Z2=At.Buffer,ew=Object.prototype.hasOwnProperty,tw="start end gt gte lt lte".split(" ");function Me(t){this.status="new",this.supports=vc(t,{status:!0})}Me.prototype.open=function(t,e){var r=this,n=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,function(i){if(i)return r.status=n,e(i);r.status="open",e()})},Me.prototype._open=function(t,e){Ke(e)},Me.prototype.close=function(t){var e=this,r=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(function(n){if(n)return e.status=r,t(n);e.status="closed",t()})},Me.prototype._close=function(t){Ke(t)},Me.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");var n=this._checkKey(t);if(n)return Ke(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)},Me.prototype._get=function(t,e,r){Ke(function(){r(new Error("NotFound"))})},Me.prototype.put=function(t,e,r,n){if(typeof r=="function"&&(n=r),typeof n!="function")throw new Error("put() requires a callback argument");var i=this._checkKey(t)||this._checkValue(e);if(i)return Ke(n,i);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,n)},Me.prototype._put=function(t,e,r,n){Ke(n)},Me.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");var n=this._checkKey(t);if(n)return Ke(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)},Me.prototype._del=function(t,e,r){Ke(r)},Me.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return Ke(r,new Error("batch(array) requires an array argument"));if(t.length===0)return Ke(r);(typeof e!="object"||e===null)&&(e={});for(var n=new Array(t.length),i=0;i<t.length;i++){if(typeof t[i]!="object"||t[i]===null)return Ke(r,new Error("batch(array) element must be an object and not `null`"));var a=rn(t[i]);if(a.type!=="put"&&a.type!=="del")return Ke(r,new Error("`type` must be 'put' or 'del'"));var s=this._checkKey(a.key);if(s)return Ke(r,s);if(a.key=this._serializeKey(a.key),a.type==="put"){var o=this._checkValue(a.value);if(o)return Ke(r,o);a.value=this._serializeValue(a.value)}n[i]=a}this._batch(n,e,r)},Me.prototype._batch=function(t,e,r){Ke(r)},Me.prototype.clear=function(t,e){if(typeof t=="function")e=t;else if(typeof e!="function")throw new Error("clear() requires a callback argument");t=Cf(this,t),t.reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)},Me.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;var r=this._iterator(t),n={},i=this,a=function(s){if(s)return r.end(function(){e(s)});r.next(function(o,u){if(o)return a(o);if(u===void 0)return r.end(e);i._del(u,n,a)})};a()},Me.prototype._setupIteratorOptions=function(t){return t=Cf(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function Cf(t,e){var r={};for(var n in e){if(!ew.call(e,n))continue;var i=e[n];rw(n)&&(i=t._serializeKey(i)),r[n]=i}return r}function rw(t){return tw.indexOf(t)!==-1}Me.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)},Me.prototype._iterator=function(t){return new kf(this)},Me.prototype._chainedBatch=function(){return new Tf(this)},Me.prototype._serializeKey=function(t){return t},Me.prototype._serializeValue=function(t){return t},Me.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(Z2.isBuffer(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")},Me.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")},Me.prototype._nextTick=Ke;var nw=Me,iw=nw,aw=kf,sw=Tf,$c={AbstractLevelDOWN:iw,AbstractIterator:aw,AbstractChainedBatch:sw},Gc=Z(function(t,e){var r=At.Buffer;e.utf8=e["utf-8"]={encode:function(s){return a(s)?s:String(s)},decode:i,buffer:!1,type:"utf8"},e.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},e.binary={encode:function(s){return a(s)?s:r.from(s)},decode:i,buffer:!0,type:"binary"},e.none={encode:i,decode:i,buffer:!1,type:"id"},e.id=e.none;var n=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];n.forEach(function(s){e[s]={encode:function(o){return a(o)?o:r.from(o,s)},decode:function(o){return o.toString(s)},buffer:!0,type:s}});function i(s){return s}function a(s){return s==null||r.isBuffer(s)}}),ow=Kt;function Kt(t){if(!(this instanceof Kt))return new Kt(t);this.opts=t||{},this.encodings=Gc}Kt.prototype._encoding=function(t){return typeof t=="string"&&(t=Gc[t]),t||(t=Gc.id),t},Kt.prototype._keyEncoding=function(t,e){return this._encoding(e&&e.keyEncoding||t&&t.keyEncoding||this.opts.keyEncoding)},Kt.prototype._valueEncoding=function(t,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||t&&(t.valueEncoding||t.encoding)||this.opts.valueEncoding||this.opts.encoding)},Kt.prototype.encodeKey=function(t,e,r){return this._keyEncoding(e,r).encode(t)},Kt.prototype.encodeValue=function(t,e,r){return this._valueEncoding(e,r).encode(t)},Kt.prototype.decodeKey=function(t,e){return this._keyEncoding(e).decode(t)},Kt.prototype.decodeValue=function(t,e){return this._valueEncoding(e).decode(t)},Kt.prototype.encodeBatch=function(t,e){var r=this;return t.map(function(n){var i={type:n.type,key:r.encodeKey(n.key,e,n)};return r.keyAsBuffer(e,n)&&(i.keyEncoding="binary"),n.prefix&&(i.prefix=n.prefix),"value"in n&&(i.value=r.encodeValue(n.value,e,n),r.valueAsBuffer(e,n)&&(i.valueEncoding="binary")),i})};var cw=["lt","gt","lte","gte","start","end"];Kt.prototype.encodeLtgt=function(t){var e=this,r={};return Object.keys(t).forEach(function(n){r[n]=cw.indexOf(n)>-1?e.encodeKey(t[n],t):t[n]}),r},Kt.prototype.createStreamDecoder=function(t){var e=this;return t.keys&&t.values?function(r,n){return{key:e.decodeKey(r,t),value:e.decodeValue(n,t)}}:t.keys?function(r){return e.decodeKey(r,t)}:t.values?function(r,n){return e.decodeValue(n,t)}:function(){}},Kt.prototype.keyAsBuffer=function(t){return this._keyEncoding(t).buffer},Kt.prototype.valueAsBuffer=function(t){return this._valueEncoding(t).buffer};var _f=$c.AbstractLevelDOWN,Rf=$c.AbstractChainedBatch,Nf=$c.AbstractIterator,Pf=Cn.EncodingError,uw=["approximateSize","compactRange"],dw=Nt.default=Nt;function Nt(t,e){if(!(this instanceof Nt))return new Nt(t,e);var r=t.supports||{},n=r.additionalMethods||{};_f.call(this,r),this.supports.encodings=!0,this.supports.additionalMethods={},uw.forEach(function(i){var a=typeof t[i]=="function";(n[i]||a)&&(this.supports.additionalMethods[i]=!0,this[i]=function(s,o,u,c){return s=this.codec.encodeKey(s,u),o=this.codec.encodeKey(o,u),this.db[i](s,o,u,c)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=t,this.codec=new ow(e)}je(Nt,_f),Nt.prototype.type="encoding-down",Nt.prototype._serializeKey=Nt.prototype._serializeValue=function(t){return t},Nt.prototype._open=function(t,e){this.db.open(t,e)},Nt.prototype._close=function(t){this.db.close(t)},Nt.prototype._put=function(t,e,r,n){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.db.put(t,e,r,n)},Nt.prototype._get=function(t,e,r){var n=this;t=this.codec.encodeKey(t,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(t,e,function(i,a){if(i)return r(i);try{a=n.codec.decodeValue(a,e)}catch(s){return r(new Pf(s))}r(null,a)})},Nt.prototype._del=function(t,e,r){t=this.codec.encodeKey(t,e),this.db.del(t,e,r)},Nt.prototype._chainedBatch=function(){return new ji(this)},Nt.prototype._batch=function(t,e,r){t=this.codec.encodeBatch(t,e),this.db.batch(t,e,r)},Nt.prototype._iterator=function(t){return t.keyAsBuffer=this.codec.keyAsBuffer(t),t.valueAsBuffer=this.codec.valueAsBuffer(t),new Ma(this,t)},Nt.prototype._clear=function(t,e){t=this.codec.encodeLtgt(t),this.db.clear(t,e)};function Ma(t,e){Nf.call(this,t),this.codec=t.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=t.db.iterator(this.opts)}je(Ma,Nf),Ma.prototype._next=function(t){var e=this;this.it.next(function(r,n,i){if(r)return t(r);try{e.keys&&typeof n!="undefined"?n=e.codec.decodeKey(n,e.opts):n=void 0,e.values&&typeof i!="undefined"?i=e.codec.decodeValue(i,e.opts):i=void 0}catch(a){return t(new Pf(a))}t(null,n,i)})},Ma.prototype._seek=function(t){t=this.codec.encodeKey(t,this.opts),this.it.seek(t)},Ma.prototype._end=function(t){this.it.end(t)};function ji(t,e){Rf.call(this,t),this.codec=t.codec,this.batch=t.db.batch()}je(ji,Rf),ji.prototype._put=function(t,e){t=this.codec.encodeKey(t),e=this.codec.encodeValue(e),this.batch.put(t,e)},ji.prototype._del=function(t){t=this.codec.encodeKey(t),this.batch.del(t)},ji.prototype._clear=function(){this.batch.clear()},ji.prototype._write=function(t,e){this.batch.write(t,e)};function lw(t){function e(n,i,a){return typeof n=="function"?a=n:typeof i=="function"&&(a=i),r(i)||(i=r(n)?n:{}),Ef(dw(t(n,i),i),i,a)}function r(n){return typeof n=="object"&&n!==null}return["destroy","repair"].forEach(function(n){typeof t[n]=="function"&&(e[n]=function(){t[n].apply(t,arguments)})}),e.errors=Ef.errors,e}var fw=lw;function ai(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}ai.prototype.next=function(t){var e=this;if(typeof t!="function")throw new Error("next() requires a callback argument");return e._ended?(Y.nextTick(t,new Error("cannot call next() after end()")),e):e._nexting?(Y.nextTick(t,new Error("cannot call next() before previous next() has completed")),e):(e._nexting=!0,e._next(function(){e._nexting=!1,t.apply(null,arguments)}),e)},ai.prototype._next=function(t){Y.nextTick(t)},ai.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)},ai.prototype._seek=function(t){},ai.prototype.end=function(t){if(typeof t!="function")throw new Error("end() requires a callback argument");if(this._ended)return Y.nextTick(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)},ai.prototype._end=function(t){Y.nextTick(t)};var Df=ai;function Or(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}Or.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},Or.prototype.put=function(t,e){this._checkWritten();var r=this.db._checkKey(t)||this.db._checkValue(e);if(r)throw r;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e),this},Or.prototype._put=function(t,e){this._operations.push({type:"put",key:t,value:e})},Or.prototype.del=function(t){this._checkWritten();var e=this.db._checkKey(t);if(e)throw e;return t=this.db._serializeKey(t),this._del(t),this},Or.prototype._del=function(t){this._operations.push({type:"del",key:t})},Or.prototype.clear=function(){return this._checkWritten(),this._clear(),this},Or.prototype._clear=function(){this._operations=[]},Or.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)},Or.prototype._write=function(t,e){this.db._batch(this._operations,t,e)};var Of=Or,hw=Object.prototype.hasOwnProperty,pw="start end gt gte lt lte".split(" ");function qe(){this.status="new"}qe.prototype.open=function(t,e){var r=this,n=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,function(i){if(i)return r.status=n,e(i);r.status="open",e()})},qe.prototype._open=function(t,e){Y.nextTick(e)},qe.prototype.close=function(t){var e=this,r=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(function(n){if(n)return e.status=r,t(n);e.status="closed",t()})},qe.prototype._close=function(t){Y.nextTick(t)},qe.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");var n=this._checkKey(t);if(n)return Y.nextTick(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)},qe.prototype._get=function(t,e,r){Y.nextTick(function(){r(new Error("NotFound"))})},qe.prototype.put=function(t,e,r,n){if(typeof r=="function"&&(n=r),typeof n!="function")throw new Error("put() requires a callback argument");var i=this._checkKey(t)||this._checkValue(e);if(i)return Y.nextTick(n,i);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,n)},qe.prototype._put=function(t,e,r,n){Y.nextTick(n)},qe.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");var n=this._checkKey(t);if(n)return Y.nextTick(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)},qe.prototype._del=function(t,e,r){Y.nextTick(r)},qe.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return Y.nextTick(r,new Error("batch(array) requires an array argument"));if(t.length===0)return Y.nextTick(r);(typeof e!="object"||e===null)&&(e={});for(var n=new Array(t.length),i=0;i<t.length;i++){if(typeof t[i]!="object"||t[i]===null)return Y.nextTick(r,new Error("batch(array) element must be an object and not `null`"));var a=rn(t[i]);if(a.type!=="put"&&a.type!=="del")return Y.nextTick(r,new Error("`type` must be 'put' or 'del'"));var s=this._checkKey(a.key);if(s)return Y.nextTick(r,s);if(a.key=this._serializeKey(a.key),a.type==="put"){var o=this._checkValue(a.value);if(o)return Y.nextTick(r,o);a.value=this._serializeValue(a.value)}n[i]=a}this._batch(n,e,r)},qe.prototype._batch=function(t,e,r){Y.nextTick(r)},qe.prototype._setupIteratorOptions=function(t){return t=mw(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function mw(t,e){var r={};for(var n in e){if(!hw.call(e,n))continue;var i=e[n];bw(n)&&(i=t._serializeKey(i)),r[n]=i}return r}function bw(t){return pw.indexOf(t)!==-1}qe.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)},qe.prototype._iterator=function(t){return new Df(this)},qe.prototype._chainedBatch=function(){return new Of(this)},qe.prototype._serializeKey=function(t){return t},qe.prototype._serializeValue=function(t){return t},qe.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(Buffer.isBuffer(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")},qe.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")};var yw=qe,gw=yw,vw=Df,ww=Of,Bf={AbstractLevelDOWN:gw,AbstractIterator:vw,AbstractChainedBatch:ww},Bs=Z(function(t,e){e.compare=function(m,_){if(Buffer.isBuffer(m)){for(var I=Math.min(m.length,_.length),f=0;f<I;f++){var k=m[f]-_[f];if(k)return k}return m.length-_.length}return m<_?-1:m>_?1:0};function r(m){return m!==void 0&&m!==""}function n(m,_){return Object.hasOwnProperty.call(m,_)}function i(m,_){return Object.hasOwnProperty.call(m,_)&&_}var a=e.lowerBoundKey=function(m){return i(m,"gt")||i(m,"gte")||i(m,"min")||(m.reverse?i(m,"end"):i(m,"start"))||void 0},s=e.lowerBound=function(m,_){var I=a(m);return I?m[I]:_},o=e.lowerBoundInclusive=function(m){return!n(m,"gt")},u=e.upperBoundInclusive=function(m){return!n(m,"lt")},c=e.lowerBoundExclusive=function(m){return!o(m)},d=e.upperBoundExclusive=function(m){return!u(m)},h=e.upperBoundKey=function(m){return i(m,"lt")||i(m,"lte")||i(m,"max")||(m.reverse?i(m,"start"):i(m,"end"))||void 0},y=e.upperBound=function(m,_){var I=h(m);return I?m[I]:_};e.start=function(m,_){return m.reverse?y(m,_):s(m,_)},e.end=function(m,_){return m.reverse?s(m,_):y(m,_)},e.startInclusive=function(m){return m.reverse?u(m):o(m)},e.endInclusive=function(m){return m.reverse?o(m):u(m)};function p(m){return m}e.toLtgt=function(m,_,I,f,k){_=_||{},I=I||p;var R=arguments.length>3,g=e.lowerBoundKey(m),x=e.upperBoundKey(m);return g?g==="gt"?_.gt=I(m.gt,!1):_.gte=I(m[g],!1):R&&(_.gte=I(f,!1)),x?x==="lt"?_.lt=I(m.lt,!0):_.lte=I(m[x],!0):R&&(_.lte=I(k,!0)),m.reverse!=null&&(_.reverse=!!m.reverse),n(_,"max")&&delete _.max,n(_,"min")&&delete _.min,n(_,"start")&&delete _.start,n(_,"end")&&delete _.end,_},e.contains=function(m,_,I){I=I||e.compare;var f=s(m);if(r(f)){var k=I(_,f);if(k<0||k===0&&c(m))return!1}var R=y(m);if(r(R)){var k=I(_,R);if(k>0||k===0&&d(m))return!1}return!0},e.filter=function(m,_){return function(I){return e.contains(m,I,_)}}}),Ew=Hc;Hc.strict=Mf,Hc.loose=Lf;var xw=Object.prototype.toString,Sw={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function Hc(t){return Mf(t)||Lf(t)}function Mf(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function Lf(t){return Sw[xw.call(t)]}var Aw=Ew.strict,Iw=function(e){if(Aw(e)){var r=Buffer.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(r=r.slice(e.byteOffset,e.byteOffset+e.byteLength)),r}else return Buffer.from(e)},Wc=function(t){return t instanceof Uint8Array?Iw(t):t instanceof ArrayBuffer?Buffer.from(t):Buffer.from(String(t))},La=La,Uf=Bf.AbstractIterator,kw=function(){},Tw=Br;function Br(t,e,r){if(Uf.call(this,t),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,this._limit===0){this._completed=!0;return}try{var n=this.createKeyRange(r)}catch(i){this._completed=!0;return}this.createIterator(e,n,r.reverse)}je(Br,Uf),Br.prototype.createKeyRange=function(t){var e=Bs.lowerBound(t),r=Bs.upperBound(t),n=Bs.lowerBoundExclusive(t),i=Bs.upperBoundExclusive(t);return e!==void 0&&r!==void 0?IDBKeyRange.bound(e,r,n,i):e!==void 0?IDBKeyRange.lowerBound(e,n):r!==void 0?IDBKeyRange.upperBound(r,i):null},Br.prototype.createIterator=function(t,e,r){var n=this,i=this.db.db.transaction([t],"readonly"),a=i.objectStore(t),s=a.openCursor(e,r?"prev":"next");s.onsuccess=function(o){var u=o.target.result;u&&n.onItem(u)},this._transaction=i,i.onabort=function(){n.onAbort(n._transaction.error||new Error("aborted by user"))},i.oncomplete=function(){n.onComplete()}},Br.prototype.onItem=function(t){this._cache.push(t.key,t.value),(this._limit<=0||++this._count<this._limit)&&t.continue(),this.maybeNext()},Br.prototype.onAbort=function(t){this._aborted=!0,this._error=t,this.maybeNext()},Br.prototype.onComplete=function(){this._completed=!0,this.maybeNext()},Br.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)},Br.prototype._next=function(t){if(this._aborted){var e=this._error;this._error=null}else if(this._cache.length>0){var r=this._cache.shift(),n=this._cache.shift();this._keyAsBuffer&&(r=Wc(r)),this._valueAsBuffer&&(n=Wc(n))}else this._completed||(this._callback=t)},Br.prototype._end=function(t){if(this._aborted||this._completed){var e=this._error;return}this.onItem=kw,this.onAbort=t,this.onComplete=t};var Kf=Z(function(t,e){e.test=function(r){return function(i){try{return i.cmp(r,0),!0}catch(a){return!1}}},e.binaryKeys=e.test(new Uint8Array(0)),e.arrayKeys=e.test([1])}),Cw=Et,Ff=Bf.AbstractLevelDOWN,jf="level-js-";function Et(t,e){if(!(this instanceof Et))return new Et(t,e);if(Ff.call(this),e=e||{},typeof t!="string")throw new Error("constructor requires a location string argument");this.location=t,this.prefix=e.prefix==null?jf:e.prefix,this.version=parseInt(e.version||1,10)}je(Et,Ff),Et.binaryKeys=Kf.binaryKeys(indexedDB),Et.arrayKeys=Kf.arrayKeys(indexedDB),Et.prototype._open=function(t,e){var r=indexedDB.open(this.prefix+this.location,this.version),n=this;r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=function(){n.db=r.result,e()},r.onupgradeneeded=function(i){var a=i.target.result;a.objectStoreNames.contains(n.location)||a.createObjectStore(n.location)}},Et.prototype.store=function(t){var e=this.db.transaction([this.location],t);return e.objectStore(this.location)},Et.prototype.await=function(t,e){var r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}},Et.prototype._get=function(t,e,r){var n=this.store("readonly");try{var i=n.get(t)}catch(a){return La(function(){r(a)})}this.await(i,function(a,s){if(a)return r(a);if(s===void 0)return r(new Error("NotFound"));e.asBuffer&&(s=Wc(s)),r(null,s)})},Et.prototype._del=function(t,e,r){var n=this.store("readwrite");try{var i=n.delete(t)}catch(a){return La(function(){r(a)})}this.await(i,r)},Et.prototype._put=function(t,e,r,n){var i=this.store("readwrite");try{var a=i.put(e,t)}catch(s){return La(function(){n(s)})}this.await(a,n)},Et.prototype._serializeKey=function(t){return Buffer.isBuffer(t)?Et.binaryKeys?t:t.toString():Array.isArray(t)?Et.arrayKeys?t.map(this._serializeKey,this):String(t):t},Et.prototype._serializeValue=function(t){return t},Et.prototype._iterator=function(t){return new Tw(this,this.location,t)},Et.prototype._batch=function(t,e,r){if(t.length===0)return La(r);var n=this.store("readwrite"),i=n.transaction,a=0,s;i.onabort=function(){r(s||i.error||new Error("aborted by user"))},i.oncomplete=function(){r()};function o(){var u=t[a++],c=u.key;try{var d=u.type==="del"?n.delete(c):n.put(u.value,c)}catch(h){s=h,i.abort();return}a<t.length&&(d.onsuccess=o)}o()},Et.prototype._close=function(t){this.db.close()},Et.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=jf);var n=indexedDB.deleteDatabase(e+t);n.onsuccess=function(){r()},n.onerror=function(i){r(i)}};var _w=fw(Cw);const{Key:Rw,Errors:Ua,Adapter:Nw,utils:{filter:qf,map:Pw,take:Dw,sortAll:Ow}}=En;class Bw extends Nw{constructor(t,e){super();let r;e&&e.db?(r=e.db,delete e.db):r=_w,this.db=this._initDb(r,t,e)}_initDb(t,e,r){return t(e,{...r,valueEncoding:"binary",compression:!1})}async open(){try{await this.db.open()}catch(t){throw Ua.dbOpenFailedError(t)}}async put(t,e){try{await this.db.put(t.toString(),e)}catch(r){throw Ua.dbWriteFailedError(r)}}async get(t){let e;try{e=await this.db.get(t.toString())}catch(r){throw r.notFound?Ua.notFoundError(r):Ua.dbWriteFailedError(r)}return e}async has(t){try{await this.db.get(t.toString())}catch(e){if(e.notFound)return!1;throw e}return!0}async delete(t){try{await this.db.del(t.toString())}catch(e){throw Ua.dbDeleteFailedError(e)}}close(){return this.db.close()}batch(){const t=[];return{put:(e,r)=>{t.push({type:"put",key:e.toString(),value:r})},delete:e=>{t.push({type:"del",key:e.toString()})},commit:()=>this.db.batch(t)}}query(t){let e=!0;t.keysOnly!=null&&(e=!t.keysOnly);const r={keys:!0,values:e,keyAsBuffer:!0};if(t.prefix!=null){const i=t.prefix.toString();r.gte=i,r.lt=i+"\xFF"}let n=Mw(this.db.iterator(r));if(n=Pw(n,({key:i,value:a})=>{const s={key:new Rw(i,!1)};return e&&(s.value=a),s}),Array.isArray(t.filters)&&(n=t.filters.reduce((i,a)=>qf(i,a),n)),Array.isArray(t.orders)&&(n=t.orders.reduce((i,a)=>Ow(i,a),n)),t.offset!=null){let i=0;n=qf(n,()=>i++>=t.offset)}return t.limit!=null&&(n=Dw(n,t.limit)),n}}function Mw(t){return{next:()=>new Promise((e,r)=>{t.next((n,i,a)=>{if(n)return r(n);if(i==null)return t.end(s=>{if(s)return r(s);e({done:!0})});e({done:!1,value:{key:i,value:a}})})}),return:()=>new Promise((e,r)=>{t.end(n=>{if(n)return r(n);e({done:!0})})}),[Symbol.asyncIterator](){return this}}}var Yc=Bw,Xc={repoVersion:0,lock:"memory",storageBackends:{root:Yc},storageBackendOptions:{root:{extension:"",prefix:"",version:2}}};function Lw(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof Y!="undefined"&&typeof Y.versions=="object"&&!!Y.versions.electron?!0:typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}var Uw=Lw;const Ms=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Ka=Uw(),Kw=Ms&&!Ka,Fw=Ka&&!Ms,jw=Ka&&Ms,qw=typeof xb=="function"&&typeof Y!="undefined"&&typeof Y.release!="undefined"&&Y.release.name==="node"&&!Ka,Vw=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,zw=typeof Y!="undefined"&&typeof Y.env!="undefined"&&!1;var $w={isTest:zw,isElectron:Ka,isElectronMain:Fw,isElectronRenderer:jw,isNode:qw,isBrowser:Kw,isWebWorker:Vw,isEnvWithDom:Ms};const Vf=J("ipfs:repo:lock"),zf="repo.lock",Fa={};var Gw=async t=>{const e=t+"/"+zf;if(Vf("locking %s",e),Fa[e]===!0)throw new mr.LockExistsError(`Lock already being held for file: ${e}`);Fa[e]=!0;const r={async close(){Fa[e]&&delete Fa[e]}};return r},Hw=async t=>{const e=t+"/"+zf;return Vf(`checking lock: ${e}`),Boolean(Fa[e])},$f={lock:Gw,locked:Hw},Ww=(t={})=>{const e=t.path;let r=null;const n=(i,a,s)=>{i!==r&&(r=i,console.info(`Migrating repo from v${i-1} to v${i}`)),console.info(`${a.toString().padStart(6," ")}% ${s}`)};return new ms(e,{autoMigrate:t.autoMigrate,onMigrationProgress:t.silent?null:n})},Mr=Z(function(t,e){const{encodeText:r,decodeText:n,concat:i}=lc;function a(y,p){if(!p)throw new Error("requires an encoded Uint8Array");const{name:m,codeBuf:_}=d(y);return c(m,p),i([_,p],_.length+p.length)}function s(y,p){const m=d(y),_=r(m.encode(p));return i([m.codeBuf,_],m.codeBuf.length+_.length)}function o(y){y instanceof Uint8Array&&(y=n(y));const p=y[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(p)&&(y=y.toLowerCase());const m=d(y[0]);return m.decode(y.substring(1))}function u(y){if(y instanceof Uint8Array&&(y=n(y)),Object.prototype.toString.call(y)!=="[object String]")return!1;try{const p=d(y[0]);return p.name}catch(p){return!1}}function c(y,p){const m=d(y);m.decode(n(p))}function d(y){if(Pr.names[y])return Pr.names[y];if(Pr.codes[y])return Pr.codes[y];throw new Error(`Unsupported encoding: ${y}`)}function h(y){return y instanceof Uint8Array&&(y=n(y)),d(y[0])}e=t.exports=a,e.encode=s,e.decode=o,e.isEncoded=u,e.encoding=d,e.encodingFromData=h,e.names=Object.freeze(Pr.names),e.codes=Object.freeze(Pr.codes)}),Yw=Qc,Gf=128,Xw=127,Qw=~Xw,Jw=Math.pow(2,31);function Qc(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw Qc.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=Jw;)e[r++]=t&255|Gf,t/=128;for(;t&Qw;)e[r++]=t&255|Gf,t>>>=7;return e[r]=t|0,Qc.bytes=r-n+1,e}var Zw=Jc,eE=128,Hf=127;function Jc(t,e){var r=0,e=e||0,n=0,i=e,a,s=t.length;do{if(i>=s||n>49)throw Jc.bytes=0,new RangeError("Could not decode varint");a=t[i++],r+=n<28?(a&Hf)<<n:(a&Hf)*Math.pow(2,n),n+=7}while(a>=eE);return Jc.bytes=i-e,r}var tE=Math.pow(2,7),rE=Math.pow(2,14),nE=Math.pow(2,21),iE=Math.pow(2,28),aE=Math.pow(2,35),sE=Math.pow(2,42),oE=Math.pow(2,49),cE=Math.pow(2,56),uE=Math.pow(2,63),dE=function(t){return t<tE?1:t<rE?2:t<nE?3:t<iE?4:t<aE?5:t<sE?6:t<oE?7:t<cE?8:t<uE?9:10},qi={encode:Yw,decode:Zw,encodingLength:dE};const lE=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});var fE={names:lE};function hE(t,e){e||(e=t.reduce((i,a)=>i+a.length,0));const r=new Uint8Array(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}var Bt=hE;const{names:ja}=fE,qa={};for(const t in ja)qa[ja[t]]=t;function pE(t){if(!(t instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return se(t,"base16")}function mE(t){return le(t,"base16")}function bE(t){if(!(t instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return se(Mr.encode("base58btc",t)).slice(1)}function yE(t){const e=t instanceof Uint8Array?se(t):t;return Mr.decode("z"+e)}function Wf(t){if(!(t instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(t.length<2)throw new Error("multihash too short. must be > 2 bytes.");const e=qi.decode(t);if(!Xf(e))throw new Error(`multihash unknown function code: 0x${e.toString(16)}`);t=t.slice(qi.decode.bytes);const r=qi.decode(t);if(r<0)throw new Error(`multihash invalid length: ${r}`);if(t=t.slice(qi.decode.bytes),t.length!==r)throw new Error(`multihash length inconsistent: 0x${se(t,"base16")}`);return{code:e,name:qa[e],length:r,digest:t}}function gE(t,e,r){if(!t||e===void 0)throw new Error("multihash encode requires at least two args: digest, code");const n=Yf(e);if(!(t instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(r==null&&(r=t.length),r&&t.length!==r)throw new Error("digest length should be equal to specified length.");const i=qi.encode(n),a=qi.encode(r);return Bt([i,a,t],i.length+a.length+t.length)}function Yf(t){let e=t;if(typeof t=="string"){if(ja[t]===void 0)throw new Error(`Unrecognized hash function named: ${t}`);e=ja[t]}if(typeof e!="number")throw new Error(`Hash function code should be a number. Got: ${e}`);if(qa[e]===void 0&&!Zc(e))throw new Error(`Unrecognized function code: ${e}`);return e}function Zc(t){return t>0&&t<16}function Xf(t){return Zc(t)?!0:!!qa[t]}function Qf(t){Wf(t)}function vE(t){return Qf(t),t.subarray(0,2)}var Xt={names:ja,codes:Object.freeze(qa),toHexString:pE,fromHexString:mE,toB58String:bE,fromB58String:yE,decode:Wf,encode:gE,coerceCode:Yf,isAppCode:Zc,validate:Qf,prefix:vE,isValidCode:Xf},wE=Zf,Jf=128,EE=127,xE=~EE,SE=Math.pow(2,31);function Zf(t,e,r){e=e||[],r=r||0;for(var n=r;t>=SE;)e[r++]=t&255|Jf,t/=128;for(;t&xE;)e[r++]=t&255|Jf,t>>>=7;return e[r]=t|0,Zf.bytes=r-n+1,e}var AE=eu,IE=128,eh=127;function eu(t,e){var r=0,e=e||0,n=0,i=e,a,s=t.length;do{if(i>=s)throw eu.bytes=0,new RangeError("Could not decode varint");a=t[i++],r+=n<28?(a&eh)<<n:(a&eh)*Math.pow(2,n),n+=7}while(a>=IE);return eu.bytes=i-e,r}var kE=Math.pow(2,7),TE=Math.pow(2,14),CE=Math.pow(2,21),_E=Math.pow(2,28),RE=Math.pow(2,35),NE=Math.pow(2,42),PE=Math.pow(2,49),DE=Math.pow(2,56),OE=Math.pow(2,63),BE=function(t){return t<kE?1:t<TE?2:t<CE?3:t<_E?4:t<RE?5:t<NE?6:t<PE?7:t<DE?8:t<OE?9:10},W={encode:wE,decode:AE,encodingLength:BE};const ME=0,LE=4,UE=6,KE=17,FE=30,jE=33,qE=41,VE=42,zE=47,$E=48,GE=49,HE=50,WE=51,YE=53,XE=54,QE=55,JE=56,ZE=80,e4=81,t4=85,r4=96,n4=99,i4=132,a4=212,s4=213,o4=214,c4=230,u4=273,d4=301,l4=302,f4=400,h4=421,p4=421,m4=443,b4=444,y4=445,g4=446,v4=447,w4=448,E4=460,x4=477,S4=478,A4=480,I4=512,k4=513,T4=4352;var Lr={identity:ME,ip4:LE,tcp:UE,sha1:KE,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:FE,dccp:jE,"murmur3-128":34,"murmur3-32":35,ip6:qE,ip6zone:VE,path:zE,multicodec:$E,multihash:GE,multiaddr:HE,multibase:WE,dns:YE,dns4:XE,dns6:QE,dnsaddr:JE,protobuf:ZE,cbor:e4,raw:t4,"dbl-sha2-256":86,rlp:r4,bencode:n4,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:i4,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,"stellar-block":208,"stellar-tx":209,md4:a4,md5:s4,bmt:o4,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:c4,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:u4,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:d4,utp:l4,unix:f4,p2p:h4,ipfs:p4,https:m4,onion:b4,onion3:y4,garlic64:g4,garlic32:v4,tls:w4,quic:E4,ws:x4,wss:S4,"p2p-websocket-star":479,http:A4,json:I4,messagepack:k4,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:T4,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332};const th=new Map;for(const t in Lr){const e=Lr[t];th.set(e,t)}var rh=Object.freeze(th);const{names:C4}=Pr,{TextDecoder:_4}=va,R4=new _4("utf8");function N4(t,e="utf8"){if(e==="utf8"||e==="utf-8")return R4.decode(t);const r=C4[e];if(!r)throw new Error("Unknown base");return r.encode(t)}var P4=N4;const{names:D4}=Pr,{TextEncoder:O4}=va,B4=new O4;function M4(t,e="utf8"){if(e==="utf8"||e==="utf-8")return B4.encode(t);const r=D4[e];if(!r)throw new Error("Unknown base");return r.decode(t)}var L4=M4,nh={numberToUint8Array:U4,uint8ArrayToNumber:ih,varintUint8ArrayEncode:K4,varintEncode:F4};function ih(t){return parseInt(P4(t,"base16"),16)}function U4(t){let e=t.toString(16);return e.length%2===1&&(e="0"+e),L4(e,"base16")}function K4(t){return Uint8Array.from(W.encode(ih(t)))}function F4(t){return Uint8Array.from(W.encode(t))}const j4=nh.varintEncode,ah={};for(const t in Lr){const e=Lr[t];ah[t]=j4(e)}var Ls=Object.freeze(ah);function q4(t,e){e||(e=t.reduce((i,a)=>i+a.length,0));const r=new Uint8Array(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}var V4=q4;const sh={};for(const[t,e]of Object.entries(Lr))sh[t.toUpperCase().replace(/-/g,"_")]=e;var z4=Object.freeze(sh);const tu={};for(const[t,e]of Object.entries(Lr))tu[e]===void 0&&(tu[e]=t);var $4=Object.freeze(tu),Pn=Z(function(t,e){e=t.exports,e.addPrefix=(r,n)=>{let i;if(r instanceof Uint8Array)i=nh.varintUint8ArrayEncode(r);else if(Ls[r])i=Ls[r];else throw new Error("multicodec not recognized");return V4([i,n],i.length+n.length)},e.rmPrefix=r=>(W.decode(r),r.slice(W.decode.bytes)),e.getCodec=r=>{const n=W.decode(r),i=rh.get(n);if(i===void 0)throw new Error(`Code ${n} not found`);return i},e.getName=r=>rh.get(r),e.getNumber=r=>{const n=Ls[r];if(n===void 0)throw new Error("Codec `"+r+"` not found");return W.decode(n)},e.getCode=r=>W.decode(r),e.getCodeVarint=r=>{const n=Ls[r];if(n===void 0)throw new Error("Codec `"+r+"` not found");return n},e.getVarint=r=>W.encode(r),Object.assign(e,z4),e.print=$4});const G4={checkCIDComponents:function(t){if(t==null)return"null values are not valid CIDs";if(!(t.version===0||t.version===1))return"Invalid version, must be a number equal to 1 or 0";if(typeof t.codec!="string")return"codec must be string";if(t.version===0){if(t.codec!=="dag-pb")return"codec must be 'dag-pb' for CIDv0";if(t.multibaseName!=="base58btc")return"multibaseName must be 'base58btc' for CIDv0"}if(!(t.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{Xt.validate(t.multihash)}catch(e){let r=e.message;return r||(r="Multihash validation failed"),r}}};var H4=G4;function W4(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Ve=W4;const Y4=Object.keys(Lr).reduce((t,e)=>(t[Lr[e]]=e,t),{});class Us{constructor(t,e,r,n){if(Va.isCID(t)){const i=t;this.version=i.version,this.codec=i.codec,this.multihash=i.multihash,this.multibaseName=i.multibaseName||(i.version===0?"base58btc":"base32");return}if(typeof t=="string"){const i=Mr.isEncoded(t);if(i){const a=Mr.decode(t);this.version=parseInt(a.slice(0,1).toString("hex"),16),this.codec=Pn.getCodec(a.slice(1)),this.multihash=Pn.rmPrefix(a.slice(1)),this.multibaseName=i}else this.version=0,this.codec="dag-pb",this.multihash=Xt.fromB58String(t),this.multibaseName="base58btc";Us.validateCID(this),Object.defineProperty(this,"string",{value:t});return}if(t instanceof Uint8Array){const i=t.slice(0,1),a=parseInt(i.toString("hex"),16);if(a===1){const s=t;this.version=a,this.codec=Pn.getCodec(s.slice(1)),this.multihash=Pn.rmPrefix(s.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=t,this.multibaseName="base58btc";Us.validateCID(this);return}this.version=t,typeof e=="number"&&(e=Y4[e]),this.codec=e,this.multihash=r,this.multibaseName=n||(t===0?"base58btc":"base32"),Us.validateCID(this)}get bytes(){let t=this._bytes;if(!t){if(this.version===0)t=this.multihash;else if(this.version===1){const e=Pn.getCodeVarint(this.codec);t=Bt([[1],e,this.multihash],1+e.byteLength+this.multihash.byteLength)}else throw new Error("unsupported version");Object.defineProperty(this,"_bytes",{value:t})}return t}get prefix(){const t=Pn.getCodeVarint(this.codec),e=Xt.prefix(this.multihash),r=Bt([[this.version],t,e],1+t.byteLength+e.byteLength);return r}get code(){return Lr[this.codec]}toV0(){if(this.codec!=="dag-pb")throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:t,length:e}=Xt.decode(this.multihash);if(t!=="sha2-256")throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(e!==32)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new Va(0,this.codec,this.multihash)}toV1(){return new Va(1,this.codec,this.multihash)}toBaseEncodedString(t=this.multibaseName){if(this.string&&t===this.multibaseName)return this.string;let e=null;if(this.version===0){if(t!=="base58btc")throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");e=Xt.toB58String(this.multihash)}else if(this.version===1)e=se(Mr.encode(t,this.bytes));else throw new Error("unsupported version");return t===this.multibaseName&&Object.defineProperty(this,"string",{value:e}),e}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(t){return this.toBaseEncodedString(t)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(t){return this.codec===t.codec&&this.version===t.version&&Ve(this.multihash,t.multihash)}static validateCID(t){const e=H4.checkCIDComponents(t);if(e)throw new Error(e)}}const Va=vn(Us,{className:"CID",symbolName:"@ipld/js-cid/CID"});Va.codecs=Lr;var za=Va,X4=function(t){var e=function(i){var a=i.indexOf("//");return a>-1?i.slice(0,a):i},r=function(){var i=!1;return function(a){return a==="/*"?(i=!0,!1):a==="*/"?(i=!1,!1):!i}},n=function(i){return i.trim()};return t.replace(/([;,{}()=:[\]<>]|\/\*|\*\/)/g," $1 ").split(/\n/).map(n).filter(Boolean).map(e).map(n).filter(Boolean).join(`
`).split(/\s+|\n+/gm).filter(r())},Q4=536870911,J4=["int32","int64","uint32","uint64","sint32","sint64","bool","fixed64","sfixed64","double","fixed32","sfixed32","float"],oh=function(t){for(var e={};t.length;)switch(t[0]){case"[":case",":t.shift();var r=t.shift();if(r==="("&&(r=t.shift(),t.shift()),t[0]!=="=")throw new Error("Unexpected token in field options: "+t[0]);if(t.shift(),t[0]==="]")throw new Error("Unexpected ] in field option");e[r]=t.shift();break;case"]":return t.shift(),e;default:throw new Error("Unexpected token in field options: "+t[0])}throw new Error("No closing tag for field options")},ru=function(t){for(var e={name:null,type:null,tag:-1,map:null,oneof:null,required:!1,repeated:!1,options:{}};t.length;)switch(t[0]){case"=":t.shift(),e.tag=Number(t.shift());break;case"map":if(e.type="map",e.map={from:null,to:null},t.shift(),t[0]!=="<")throw new Error("Unexpected token in map type: "+t[0]);if(t.shift(),e.map.from=t.shift(),t[0]!==",")throw new Error("Unexpected token in map type: "+t[0]);if(t.shift(),e.map.to=t.shift(),t[0]!==">")throw new Error("Unexpected token in map type: "+t[0]);t.shift(),e.name=t.shift();break;case"repeated":case"required":case"optional":var r=t.shift();e.required=r==="required",e.repeated=r==="repeated",e.type=t.shift(),e.name=t.shift();break;case"[":e.options=oh(t);break;case";":if(e.name===null)throw new Error("Missing field name");if(e.type===null)throw new Error("Missing type in message field: "+e.name);if(e.tag===-1)throw new Error("Missing tag number in message field: "+e.name);return t.shift(),e;default:throw new Error("Unexpected token in message field: "+t[0])}throw new Error("No ; found for message field")},Z4=function(t){for(var e={enums:[],options:{},messages:[],fields:[],extends:[],extensions:null};t.length;)switch(t[0]){case"map":case"repeated":case"optional":case"required":e.fields.push(ru(t));break;case"enum":e.enums.push(uh(t));break;case"message":e.messages.push(nu(t));break;case"extensions":e.extensions=ex(t);break;case"oneof":t.shift();var r=t.shift();if(t[0]!=="{")throw new Error("Unexpected token in oneof: "+t[0]);for(t.shift();t[0]!=="}";){t.unshift("optional");var n=ru(t);n.oneof=r,e.fields.push(n)}t.shift();break;case"extend":e.extends.push(ch(t));break;case";":t.shift();break;case"reserved":for(t.shift();t[0]!==";";)t.shift();break;case"option":var i=$a(t);if(e.options[i.name]!==void 0)throw new Error("Duplicate option "+i.name);e.options[i.name]=i.value;break;default:t.unshift("optional"),e.fields.push(ru(t))}return e},ch=function(t){var e={name:t[1],message:nu(t)};return e},ex=function(t){t.shift();var e=Number(t.shift());if(isNaN(e))throw new Error("Invalid from in extensions definition");if(t.shift()!=="to")throw new Error("Expected keyword 'to' in extensions definition");var r=t.shift();if(r==="max"&&(r=Q4),r=Number(r),isNaN(r))throw new Error("Invalid to in extensions definition");if(t.shift()!==";")throw new Error("Missing ; in extensions definition");return{from:e,to:r}},nu=function(t){t.shift();var e=1,r=[],n={name:t.shift(),options:{},enums:[],extends:[],messages:[],fields:[]};if(t[0]!=="{")throw new Error("Expected { but found "+t[0]);for(t.shift();t.length;){if(t[0]==="{"?e++:t[0]==="}"&&e--,!e)return t.shift(),r=Z4(r),n.enums=r.enums,n.messages=r.messages,n.fields=r.fields,n.extends=r.extends,n.extensions=r.extensions,n.options=r.options,n;r.push(t.shift())}if(e)throw new Error("No closing tag for message")},tx=function(t){t.shift();var e=t.shift();if(t[0]!==";")throw new Error("Expected ; but found "+t[0]);return t.shift(),e},rx=function(t){if(t.shift(),t[0]!=="=")throw new Error("Expected = but found "+t[0]);t.shift();var e=t.shift();switch(e){case'"proto2"':e=2;break;case'"proto3"':e=3;break;default:throw new Error("Expected protobuf syntax version but found "+e)}if(t[0]!==";")throw new Error("Expected ; but found "+t[0]);return t.shift(),e},nx=function(t){if(t.length<4)throw new Error("Invalid enum value: "+t.slice(0,3).join(" "));if(t[1]!=="=")throw new Error("Expected = but found "+t[1]);if(t[3]!==";"&&t[3]!=="[")throw new Error("Expected ; or [ but found "+t[1]);var e=t.shift();t.shift();var r={value:null,options:{}};return r.value=Number(t.shift()),t[0]==="["&&(r.options=oh(t)),t.shift(),{name:e,val:r}},uh=function(t){t.shift();var e={},r={name:t.shift(),values:{},options:{}};if(t[0]!=="{")throw new Error("Expected { but found "+t[0]);for(t.shift();t.length;){if(t[0]==="}")return t.shift(),t[0]===";"&&t.shift(),r;if(t[0]==="option"){e=$a(t),r.options[e.name]=e.value;continue}var n=nx(t);r.values[n.name]=n.val}throw new Error("No closing tag for enum")},$a=function(t){for(var e=null,r=null,n=function(a){return a==="true"?!0:a==="false"?!1:a.replace(/^"+|"+$/gm,"")};t.length;){if(t[0]===";")return t.shift(),{name:e,value:r};switch(t[0]){case"option":t.shift();var i=t[0]==="(";if(i&&t.shift(),e=t.shift(),i){if(t[0]!==")")throw new Error("Expected ) but found "+t[0]);t.shift()}t[0][0]==="."&&(e+=t.shift());break;case"=":if(t.shift(),e===null)throw new Error("Expected key for option with value: "+t[0]);if(r=n(t.shift()),e==="optimize_for"&&!/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(r))throw new Error("Unexpected value for option optimize_for: "+r);r==="{"&&(r=iu(t));break;default:throw new Error("Unexpected token in option: "+t[0])}}},iu=function(t){for(var e=function(s){return s==="true"?!0:s==="false"?!1:s.replace(/^"+|"+$/gm,"")},r={};t.length;){if(t[0]==="}")return t.shift(),r;var n=t[0]==="(";n&&t.shift();var i=t.shift();if(n){if(t[0]!==")")throw new Error("Expected ) but found "+t[0]);t.shift()}var a=null;switch(t[0]){case":":if(r[i]!==void 0)throw new Error("Duplicate option map key "+i);t.shift(),a=e(t.shift()),a==="{"&&(a=iu(t)),r[i]=a,t[0]===";"&&t.shift();break;case"{":if(t.shift(),a=iu(t),r[i]===void 0&&(r[i]=[]),!Array.isArray(r[i]))throw new Error("Duplicate option map key "+i);r[i].push(a);break;default:throw new Error("Unexpected token in option map: "+t[0])}}throw new Error("No closing tag for option map")},ix=function(t){t.shift();var e=t.shift().replace(/^"+|"+$/gm,"");if(t[0]!==";")throw new Error("Unexpected token: "+t[0]+'. Expected ";"');return t.shift(),e},ax=function(t){t.shift();var e={name:t.shift(),methods:[],options:{}};if(t[0]!=="{")throw new Error("Expected { but found "+t[0]);for(t.shift();t.length;){if(t[0]==="}")return t.shift(),t[0]===";"&&t.shift(),e;switch(t[0]){case"option":var r=$a(t);if(e.options[r.name]!==void 0)throw new Error("Duplicate option "+r.name);e.options[r.name]=r.value;break;case"rpc":e.methods.push(sx(t));break;default:throw new Error("Unexpected token in service: "+t[0])}}throw new Error("No closing tag for service")},sx=function(t){t.shift();var e={name:t.shift(),input_type:null,output_type:null,client_streaming:!1,server_streaming:!1,options:{}};if(t[0]!=="(")throw new Error("Expected ( but found "+t[0]);if(t.shift(),t[0]==="stream"&&(t.shift(),e.client_streaming=!0),e.input_type=t.shift(),t[0]!==")")throw new Error("Expected ) but found "+t[0]);if(t.shift(),t[0]!=="returns")throw new Error("Expected returns but found "+t[0]);if(t.shift(),t[0]!=="(")throw new Error("Expected ( but found "+t[0]);if(t.shift(),t[0]==="stream"&&(t.shift(),e.server_streaming=!0),e.output_type=t.shift(),t[0]!==")")throw new Error("Expected ) but found "+t[0]);if(t.shift(),t[0]===";")return t.shift(),e;if(t[0]!=="{")throw new Error("Expected { but found "+t[0]);for(t.shift();t.length;){if(t[0]==="}")return t.shift(),t[0]===";"&&t.shift(),e;if(t[0]==="option"){var r=$a(t);if(e.options[r.name]!==void 0)throw new Error("Duplicate option "+r.name);e.options[r.name]=r.value}else throw new Error("Unexpected token in rpc options: "+t[0])}throw new Error("No closing tag for rpc")},ox=function(t){for(var e=X4(t.toString()),r=0;r<e.length;r++)if(/^("|')([^'"]*)$/.test(e[r])){var n;for(e[r].length===1?n=r+1:n=r,n;n<e.length;n++)if(/^[^'"\\]*(?:\\.[^'"\\]*)*("|')$/.test(e[n])){e=e.slice(0,r).concat(e.slice(r,n+1).join("")).concat(e.slice(n+1));break}}for(var i={syntax:3,package:null,imports:[],enums:[],messages:[],options:{},extends:[]},a=!0;e.length;){switch(e[0]){case"package":i.package=tx(e);break;case"syntax":if(!a)throw new Error("Protobuf syntax version should be first thing in file");i.syntax=rx(e);break;case"message":i.messages.push(nu(e));break;case"enum":i.enums.push(uh(e));break;case"option":var s=$a(e);if(i.options[s.name])throw new Error("Duplicate option "+s.name);i.options[s.name]=s.value;break;case"import":i.imports.push(ix(e));break;case"extend":i.extends.push(ch(e));break;case"service":i.services||(i.services=[]),i.services.push(ax(e));break;default:throw new Error("Unexpected token: "+e[0])}a=!1}return i.extends.forEach(function(o){i.messages.forEach(function(u){u.name===o.name&&o.message.fields.forEach(function(c){if(!u.extensions||c.tag<u.extensions.from||c.tag>u.extensions.to)throw new Error(u.name+" does not declare "+c.tag+" as an extension number");u.fields.push(c)})})}),i.messages.forEach(function(o){o.fields.forEach(function(u){var c,d,h,y;function p(_){return _.name===u.type}function m(_){return _.name===h}if(u.options&&u.options.packed==="true"&&J4.indexOf(u.type)===-1){if(u.type.indexOf(".")===-1){if(o.enums&&o.enums.some(p))return}else{if(c=u.type.split("."),c.length>2)throw new Error("what is this?");if(d=c[0],h=c[1],i.messages.some(function(_){if(_.name===d)return y=_,_}),y&&y.enums&&y.enums.some(m))return}throw new Error("Fields of type "+u.type+' cannot be declared [packed=true]. Only repeated fields of primitive numeric types (types which use the varint, 32-bit, or 64-bit wire types) can be declared "packed". See https://developers.google.com/protocol-buffers/docs/encoding#optional')}})}),i},dh=ox,lh=function(t,e){var r=t.repeated?"repeated":t.required?"required":"optional";t.type==="map"&&(r="map<"+t.map.from+","+t.map.to+">"),t.oneof&&(r="");var n=Object.keys(t.options||{}).map(function(i){return i+" = "+t.options[i]}).join(",");return n&&(n=" ["+n+"]"),e.push((r?r+" ":"")+(t.map==="map"?"":t.type+" ")+t.name+" = "+t.tag+n+";"),e},fh=function(t,e){e.push("message "+t.name+" {"),t.options||(t.options={}),Ga(t.options,e),t.enums||(t.enums=[]),t.enums.forEach(function(n){e.push(hh(n,[]))}),t.messages||(t.messages=[]),t.messages.forEach(function(n){e.push(fh(n,[]))});var r={};return t.fields||(t.fields=[]),t.fields.forEach(function(n){n.oneof?(r[n.oneof]||(r[n.oneof]=[]),r[n.oneof].push(lh(n,[]))):e.push(lh(n,[]))}),Object.keys(r).forEach(function(n){r[n].unshift("oneof "+n+" {"),r[n].push("}"),e.push(r[n])}),e.push("}",""),e},hh=function(t,e){e.push("enum "+t.name+" {"),t.options||(t.options={});var r=Ga(t.options,[]);return r.length>1&&e.push(r.slice(0,-1)),Object.keys(t.values).map(function(n){var i=cx(t.values[n]);e.push([n+" = "+i+";"])}),e.push("}",""),e},cx=function(t,e){var r=Object.keys(t.options||{}).map(function(i){return i+" = "+t.options[i]}).join(",");r&&(r=" ["+r+"]");var n=t.value+r;return n},Ga=function(t,e){var r=Object.keys(t);return r.forEach(function(n){var i=t[n];~n.indexOf(".")&&(n="("+n+")");var a=typeof i;a==="object"?(i=au(i,[]),i.length&&e.push("option "+n+" = {",i,"};")):(a==="string"&&n!=="optimize_for"&&(i='"'+i+'"'),e.push("option "+n+" = "+i+";"))}),r.length>0&&e.push(""),e},au=function(t,e){var r=Object.keys(t);return r.forEach(function(n){var i=t[n],a=typeof i;a==="object"?Array.isArray(i)?i.forEach(function(s){s=au(s,[]),s.length&&e.push(n+" {",s,"}")}):(i=au(i,[]),i.length&&e.push(n+" {",i,"}")):(a==="string"&&(i='"'+i+'"'),e.push(n+": "+i))}),e},ux=function(t,e){return e.push("service "+t.name+" {"),t.options||(t.options={}),Ga(t.options,e),t.methods||(t.methods=[]),t.methods.forEach(function(r){e.push(dx(r,[]))}),e.push("}",""),e},dx=function(t,e){var r="rpc "+t.name+"(";t.client_streaming&&(r+="stream "),r+=t.input_type+") returns (",t.server_streaming&&(r+="stream "),r+=t.output_type+")",t.options||(t.options={});var n=Ga(t.options,[]);return n.length>1?e.push(r+" {",n.slice(0,-1),"}"):e.push(r+";"),e},ph=function(t){return function(e){return Array.isArray(e)?e.map(ph(t+"  ")).join(`
`):t+e}},lx=function(t){var e=[];return e.push('syntax = "proto'+t.syntax+'";',""),t.package&&e.push("package "+t.package+";",""),t.options||(t.options={}),Ga(t.options,e),t.enums||(t.enums=[]),t.enums.forEach(function(r){hh(r,e)}),t.messages||(t.messages=[]),t.messages.forEach(function(r){fh(r,e)}),t.services&&t.services.forEach(function(r){ux(r,e)}),e.map(ph("")).join(`
`)},Ks=dh,fx=dh,hx=lx;Ks.parse=fx,Ks.stringify=hx;function px(t,e,r,n){return e.bytes=r.bytes=0,{type:t,encode:e,decode:r,encodingLength:n}}var Qt=px;function mh(t){return t.byteLength}function mx(t){const e=mh(t);return W.encodingLength(e)+e}function bh(t,e,r,n){const i=n,a=mh(t);W.encode(a,e,n),n+=W.encode.bytes,e.set(t,n),n+=a,bh.bytes=n-i}function yh(t,e,r){const n=r,i=W.decode(t,r);r+=W.decode.bytes;const a=t.slice(r,r+i);return r+=a.length,yh.bytes=r-n,a}var bx=Qt(2,bh,yh,mx);function yx(t){const e=le(t).byteLength;return W.encodingLength(e)+e}function gh(t,e,r,n){const i=n,a=le(t).byteLength;W.encode(a,e,n,"utf-8"),n+=W.encode.bytes;const s=le(t);e.set(s,n),n+=s.length,gh.bytes=n-i}function vh(t,e,r){const n=r,i=W.decode(t,r);r+=W.decode.bytes;const a=se(t.subarray(r,r+i));return r+=i,vh.bytes=r-n,a}var gx=Qt(2,gh,vh,yx);function vx(){return 1}function wh(t,e,r,n){e[n]=t?1:0,wh.bytes=1}function Eh(t,e,r){const n=t[r]>0;return Eh.bytes=1,n}var wx=Qt(0,wh,Eh,vx);function xh(t,e,r,n){W.encode(t<0?t+4294967296:t,e,n),xh.bytes=W.encode.bytes}function Sh(t,e,r){const n=W.decode(t,r);return Sh.bytes=W.decode.bytes,n>2147483647?n-4294967296:n}function Ex(t){return W.encodingLength(t<0?t+4294967296:t)}var xx=Qt(0,xh,Sh,Ex);function su(t,e,r,n){if(t<0){const i=n+9;for(W.encode(t*-1,e,n),n+=W.encode.bytes-1,e[n]=e[n]|128;n<i-1;)n++,e[n]=255;e[i]=1,su.bytes=10}else W.encode(t,e,n),su.bytes=W.encode.bytes}function ou(t,e,r){let n=W.decode(t,r);if(n>=Math.pow(2,63)){let i=9;for(;t[r+i-1]===255;)i--;i=i||9;const a=t.subarray(r,r+i);a[i-1]=a[i-1]&127,n=-1*W.decode(a,0),ou.bytes=10}else ou.bytes=W.decode.bytes;return n}function Sx(t){return t<0?10:W.encodingLength(t)}var Ax=Qt(0,su,ou,Sx),Ix=function t(e,r,n){e=e>=0?e*2:e*-2-1;var i=W.encode(e,r,n);return t.bytes=W.encode.bytes,i},kx=function t(e,r){var n=W.decode(e,r);return t.bytes=W.decode.bytes,n&1?(n+1)/-2:n/2},Tx=function(t){return W.encodingLength(t>=0?t*2:t*-2-1)},Ha={encode:Ix,decode:kx,encodingLength:Tx};function Ah(t,e,r,n){Ha.encode(t,e,n),Ah.bytes=Ha.encode.bytes}function Ih(t,e,r){const n=Ha.decode(t,r);return Ih.bytes=Ha.decode.bytes,n}var Cx=Qt(0,Ah,Ih,Ha.encodingLength);function kh(t,e,r,n){W.encode(t,e,n),kh.bytes=W.encode.bytes}function Th(t,e,r){const n=W.decode(t,r);return Th.bytes=W.decode.bytes,n}var _x=Qt(0,kh,Th,W.encodingLength);function Rx(){return 8}function Ch(t,e,r,n){for(const i of t)e[n]=i,n++;Ch.bytes=8}function _h(t,e,r){const n=t.slice(r,r+8);return _h.bytes=8,n}var Nx=Qt(1,Ch,_h,Rx);function Px(){return 8}function Rh(t,e,r,n){r.setFloat64(n,t,!0),Rh.bytes=8}function Nh(t,e,r){const n=e.getFloat64(r,!0);return Nh.bytes=8,n}var Dx=Qt(1,Rh,Nh,Px);function Ox(t){return 4}function Ph(t,e,r,n){r.setUint32(n,t,!0),Ph.bytes=4}function Dh(t,e,r){const n=e.getUint32(r,!0);return Dh.bytes=4,n}var Bx=Qt(5,Ph,Dh,Ox);function Mx(t){return 4}function Oh(t,e,r,n){r.setInt32(n,t,!0),Oh.bytes=4}function Bh(t,e,r){const n=e.getInt32(r,!0);return Bh.bytes=4,n}var Lx=Qt(5,Oh,Bh,Mx);function Ux(){return 4}function Mh(t,e,r,n){r.setFloat32(n,t,!0),Mh.bytes=4}function Lh(t,e,r){const n=e.getFloat32(r,!0);return Lh.bytes=4,n}var Kx=Qt(5,Mh,Lh,Ux),cu=Z(function(t,e){e.make=Qt,e.bytes=bx,e.string=gx,e.bool=wx,e.int32=xx,e.int64=Ax,e.sint32=e.sint64=Cx,e.uint32=e.uint64=e.enum=e.varint=_x,e.fixed64=e.sfixed64=Nx,e.double=Dx,e.fixed32=Bx,e.sfixed32=Lx,e.float=Kx}),Fx=function(t){return t!=null&&(typeof t!="number"||!isNaN(t))},uu={defined:Fx};const jx=uu.defined;function Uh(t){return`${t.substring(0,1).toUpperCase()}${t.substring(1)}`}function Kh(t,e,r,n){if(Object.prototype.hasOwnProperty.call(t,e))return;const i=Uh(e);Object.defineProperties(t,{[e]:{enumerable:!0,configurable:!0,set:a=>{r=a},get:()=>r===void 0?n:r},[`has${i}`]:{configurable:!0,value:()=>r!==void 0},[`set${i}`]:{configurable:!0,value:a=>{r=a}},[`get${i}`]:{configurable:!0,value:()=>r},[`clear${i}`]:{configurable:!0,value:()=>{r=void 0,t[e]=void 0}}})}function qx(t,e,r){const n=[],i={},a=[],s=[];for(var o=0;o<r.length;o++){const c=t.fields[o];i[c.tag]=o;const d=c.options&&c.options.default,h=e(c.type,t.id,!1);s[o]=[d,h&&h.values],t.fields[o].packed=c.repeated&&c.options&&c.options.packed&&c.options.packed!=="false",c.required&&n.push(c.name),c.oneof&&a.push(c.name)}function u(c,d,h,y,p,m,_){const I=d.name;if(d.oneof){const R=Object.keys(h);for(var f=0;f<R.length;f++)if(a.indexOf(R[f])>-1){const g=Uh(R[f]);delete h[`has${g}`],delete h[`get${g}`],delete h[`set${g}`],delete h[`clear${g}`],delete h[R[f]]}}let k;if(c.message){const R=W.decode(y,m);m+=W.decode.bytes;const g=c.decode(y,p,m,m+R);d.map?(k=h[I]||{},k[g.key]=g.value):d.repeated?(k=h[I]||[],k.push(g)):k=g}else d.repeated?(k=h[I]||[],k.push(c.decode(y,p,m))):k=c.decode(y,p,m);return Kh(h,I,k),m+=c.decode.bytes,m}return function c(d,h,y,p){if(y==null&&(y=0),p==null&&(p=d.length),!(p<=d.length&&y<=d.length))throw new Error("Decoded message is not valid");h||(h=new DataView(d.buffer,d.byteOffset,d.byteLength));for(var m=y,_={},I;;){if(p<=y){var f="",k=0;for(k=0;k<n.length;k++)if(f=n[k],!jx(_[f]))throw new Error("Decoded message is not valid, missing required field: "+f);var R,g;for(k=0;k<r.length;k++){I=t.fields[k],g=s[k][0],R=s[k][1],f=I.name;let A;if(Object.prototype.hasOwnProperty.call(_,f))continue;var x=!1;if(I.oneof){for(var N=Object.keys(_),w=0;w<N.length;w++)if(a.indexOf(N[w])>-1){x=!0;break}}if(x)continue;R?I.repeated?g=[]:(g=g&&R[g]?R[g].value:R[Object.keys(R)[0]].value,g=parseInt(g||0,10)):(A=zx(I),g=$x(I,g)),Kh(_,f,g,A)}return c.bytes=y-m,_}var T=W.decode(d,y);y+=W.decode.bytes;var D=T>>3,v=i[D];if(v==null){y=Vx(T&7,d,h,y);continue}var l=r[v];if(I=t.fields[v],I.packed){var b=W.decode(d,y);for(y+=W.decode.bytes,b+=y;y<b;)y=u(l,I,_,d,h,y)}else y=u(l,I,_,d,h,y)}}}var Vx=function(t,e,r,n){switch(t){case 0:return W.decode(e,n),n+W.decode.bytes;case 1:return n+8;case 2:var i=W.decode(e,n);return n+W.decode.bytes+i;case 3:case 4:throw new Error("Groups are not supported");case 5:return n+4;default:throw new Error("Unknown wire type: "+t)}},zx=function(t){if(t.map)return{};if(t.repeated)return[];switch(t.type){case"string":return"";case"bool":return!1;case"float":case"double":case"sfixed32":case"fixed32":case"varint":case"enum":case"uint64":case"uint32":case"int64":case"int32":case"sint64":case"sint32":return 0;default:return null}},$x=function(t,e){if(e===void 0)return e;switch(t.type){case"bool":return e==="true";case"float":case"double":case"sfixed32":case"fixed32":case"varint":case"enum":case"uint64":case"uint32":case"int64":case"int32":case"sint64":case"sint32":return parseInt(e,10);default:return e}},Gx=qx,Fh=uu.defined;function Hx(t,e,r,n,i){const a=Object.keys(n),s=r.length,o={};for(let c=0;c<s;c++){o[c]={p:W.encode(t.fields[c].tag<<3|2),h:W.encode(t.fields[c].tag<<3|r[c].type)};const d=t.fields[c];t.fields[c].packed=d.repeated&&d.options&&d.options.packed&&d.options.packed!=="false"}function u(c,d,h,y,p,m,_){let I=0;if(!m)for(I=0;I<y.length;I++)c[h++]=y[I];return p.message&&(W.encode(p.encodingLength(_),c,h),h+=W.encode.bytes),p.encode(_,c,d,h),h+p.encode.bytes}return function c(d,h,y,p=0){h==null&&(h=new Uint8Array(i(d))),y==null&&(y=new DataView(h.buffer,h.byteOffset,h.byteLength));const m=p,_=Object.keys(d);let I=0,f=!1;for(I=0;I<a.length;I++){const k=a[I],R=n[I];if(_.indexOf(R)>-1){if(f)throw new Error("only one of the properties defined in oneof "+k+" can be set");f=!0}}for(I=0;I<s;I++){const k=r[I],R=t.fields[I];let g=d[R.name],x=0;if(!Fh(g)){if(R.required)throw new Error(R.name+" is required");continue}const N=o[I].p,w=o[I].h,T=R.packed;if(R.map){const D=Object.keys(g);for(x=0;x<D.length;x++)D[x]={key:D[x],value:g[D[x]]};g=D}if(T){let D=0;for(x=0;x<g.length;x++){if(!Object.prototype.hasOwnProperty.call(g,x))continue;D+=k.encodingLength(g[x])}if(D){for(x=0;x<w.length;x++)h[p++]=N[x];W.encode(D,h,p),p+=W.encode.bytes}}if(R.repeated){let D;for(x=0;x<g.length;x++){if(D=g[x],!Fh(D))continue;p=u(h,y,p,w,k,T,D)}}else p=u(h,y,p,w,k,T,g)}return c.bytes=p-m,h}}var Wx=Hx,Fs=uu.defined;function Yx(t,e,r){const n=Object.keys(r),i=e.length,a=new Array(i);for(let s=0;s<t.fields.length;s++){a[s]=W.encodingLength(t.fields[s].tag<<3|e[s].type);const o=t.fields[s];t.fields[s].packed=o.repeated&&o.options&&o.options.packed&&o.options.packed!=="false"}return function(o){let u=0,c=0,d=0;for(c=0;c<n.length;c++){const h=n[c],y=r[h];let p=!1;for(d=0;d<y.length;d++)if(Fs(o[y[d]])){if(p)throw new Error("only one of the properties defined in oneof "+h+" can be set");p=!0}}for(c=0;c<i;c++){const h=e[c],y=t.fields[c];let p=o[y.name];const m=a[c];let _;if(!Fs(p)){if(y.required)throw new Error(y.name+" is required");continue}if(y.map){const I=Object.keys(p);for(d=0;d<I.length;d++)I[d]={key:I[d],value:p[I[d]]};p=I}if(y.packed){let I=0;for(d=0;d<p.length;d++){if(!Fs(p[d]))continue;_=h.encodingLength(p[d]),I+=_,h.message&&(I+=W.encodingLength(_))}I&&(u+=m+I+W.encodingLength(I))}else if(y.repeated)for(d=0;d<p.length;d++){if(!Fs(p[d]))continue;_=h.encodingLength(p[d]),u+=m+_+(h.message?W.encodingLength(_):0)}else _=h.encodingLength(p),u+=m+_+(h.message?W.encodingLength(_):0)}return u}}var Xx=Yx;const Qx=function(t){if(!t)return null;const e={};return Object.keys(t).forEach(function(r){e[r]=t[r].value}),e};var Jx=function(t,e){const r={},n={},i={},a=function(c,d){c.enums&&c.enums.forEach(function(h){h.id=d+(d?".":"")+h.name,n[h.id]=h,a(h,h.id)}),c.messages&&c.messages.forEach(function(h){h.id=d+(d?".":"")+h.name,r[h.id]=h,h.fields.forEach(function(y){if(!y.map)return;const p="Map_"+y.map.from+"_"+y.map.to,m={name:p,enums:[],messages:[],fields:[{name:"key",type:y.map.from,tag:1,repeated:!1,required:!0},{name:"value",type:y.map.to,tag:2,repeated:!1,required:!1}],extensions:null,id:d+(d?".":"")+p};r[m.id]||(r[m.id]=m,c.messages.push(m)),y.type=p,y.repeated=!0}),a(h,h.id)})};a(t,"");const s=function(c){const d=Object.keys(c.values||[]).map(function(p){return parseInt(c.values[p].value,10)}),h=function p(m,_,I,f){if(!d.length||d.indexOf(m)===-1)throw new Error("Invalid enum value: "+m);return W.encode(m,_,f),p.bytes=W.encode.bytes,_},y=function p(m,_,I){var f=W.decode(m,I);if(!d.length||d.indexOf(f)===-1)throw new Error("Invalid enum value: "+f);return p.bytes=W.decode.bytes,f};return cu.make(0,h,y,W.encodingLength)},o=function(c,d){c.messages.forEach(function(I){d[I.name]=u(I.name,c.id)}),c.enums.forEach(function(I){d[I.name]=Qx(I.values)}),d.type=2,d.message=!0,d.name=c.name;const h={};c.fields.forEach(function(I){if(!I.oneof)return;h[I.oneof]||(h[I.oneof]=[]),h[I.oneof].push(I.name)});const y=c.fields.map(function(I){return u(I.type,c.id)}),p=Xx(c,y,h),m=Wx(c,u,y,h,p),_=Gx(c,u,y);return m.bytes=_.bytes=0,d.buffer=!0,d.encode=m,d.decode=_,d.encodingLength=p,d},u=function(c,d,h){if(e&&e[c])return e[c];if(cu[c])return cu[c];const y=(d?d+"."+c:c).split(".").map(function(m,_,I){return I.slice(0,_).concat(c).join(".")}).reverse().reduce(function(m,_){return m||r[_]||n[_]},null);if(h===!1)return y;if(!y)throw new Error("Could not resolve "+c);if(y.values)return s(y);const p=i[y.id]||o(y,i[y.id]={});return p};return(t.enums||[]).concat((t.messages||[]).map(function(c){return u(c.id)}))},Zx=function(t){if(!t)return null;var e={};return Object.keys(t).forEach(function(r){e[r]=t[r].value}),e},Ur=function(t,e){if(e||(e={}),!t)throw new Error("Pass in a .proto string or a protobuf-schema parsed object");var r=typeof t=="object"&&!(t instanceof Uint8Array)?t:Ks.parse(t),n=function(){var i=this;Jx(r,e.encodings||{}).forEach(function(a){i[a.name]=Zx(a.values)||a})};return n.prototype.toString=function(){return Ks.stringify(r)},n.prototype.toJSON=function(){return r},new n},du=`enum KeyType {
  RSA = 0;
  Ed25519 = 1;
  Secp256k1 = 2;
}
message PublicKey {
  required KeyType Type = 1;
  required bytes Data = 2;
}
message PrivateKey {
  required KeyType Type = 1;
  required bytes Data = 2;
}`,E={options:{usePureJavaScript:!1}},lu={},jh=lu,qh={};lu.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=e3(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var u=0,c=t[i];u<o.length;++u)c+=o[u]<<8,o[u]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var d=new RegExp(".{1,"+r+"}","g");n=n.match(d).join(`\r
`)}return n},lu.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=qh[e];if(!r){r=qh[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var u=0,c=o;u<s.length;++u)c+=s[u]*i,s[u]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var d=0;t[d]===a&&d<t.length-1;++d)s.push(0);return typeof Buffer!="undefined"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function e3(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var u="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)u+=i;for(r=a.length-1;r>=0;--r)u+=e[a[r]];return u}var t3=Z(function(t){var e=t.exports=E.util=E.util||{};(function(){if(typeof bn!="undefined"&&bn.nextTick&&!bn.browser){e.nextTick=bn.nextTick,typeof setImmediate=="function"?e.setImmediate=setImmediate:e.setImmediate=e.nextTick;return}if(typeof setImmediate=="function"){e.setImmediate=function(){return setImmediate.apply(void 0,arguments)},e.nextTick=function(T){return setImmediate(T)};return}if(e.setImmediate=function(T){setTimeout(T,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){var f="forge.setImmediate",k=[];e.setImmediate=function(T){k.push(T),k.length===1&&window.postMessage(f,"*")};function R(T){if(T.source===window&&T.data===f){T.stopPropagation();var D=k.slice();k.length=0,D.forEach(function(v){v()})}}window.addEventListener("message",R,!0)}if(typeof MutationObserver!="undefined"){var g=Date.now(),x=!0,N=document.createElement("div"),k=[];new MutationObserver(function(){var D=k.slice();k.length=0,D.forEach(function(v){v()})}).observe(N,{attributes:!0});var w=e.setImmediate;e.setImmediate=function(D){Date.now()-g>15?(g=Date.now(),w(D)):(k.push(D),k.length===1&&N.setAttribute("a",x=!x))}}e.nextTick=e.setImmediate})(),e.isNodejs=typeof bn!="undefined"&&bn.versions&&bn.versions.node,e.globalScope=function(){return e.isNodejs?pe:typeof self=="undefined"?window:self}(),e.isArray=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"},e.isArrayBuffer=function(f){return typeof ArrayBuffer!="undefined"&&f instanceof ArrayBuffer},e.isArrayBufferView=function(f){return f&&e.isArrayBuffer(f.buffer)&&f.byteLength!==void 0};function r(f){if(!(f===8||f===16||f===24||f===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+f)}e.ByteBuffer=n;function n(f){if(this.data="",this.read=0,typeof f=="string")this.data=f;else if(e.isArrayBuffer(f)||e.isArrayBufferView(f))if(typeof Buffer!="undefined"&&f instanceof Buffer)this.data=f.toString("binary");else{var k=new Uint8Array(f);try{this.data=String.fromCharCode.apply(null,k)}catch(g){for(var R=0;R<k.length;++R)this.putByte(k[R])}}else(f instanceof n||typeof f=="object"&&typeof f.data=="string"&&typeof f.read=="number")&&(this.data=f.data,this.read=f.read);this._constructedStringLength=0}e.ByteStringBuffer=n;var i=4096;e.ByteStringBuffer.prototype._optimizeConstructedString=function(f){this._constructedStringLength+=f,this._constructedStringLength>i&&(this.data.substr(0,1),this._constructedStringLength=0)},e.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},e.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},e.ByteStringBuffer.prototype.putByte=function(f){return this.putBytes(String.fromCharCode(f))},e.ByteStringBuffer.prototype.fillWithByte=function(f,k){f=String.fromCharCode(f);for(var R=this.data;k>0;)k&1&&(R+=f),k>>>=1,k>0&&(f+=f);return this.data=R,this._optimizeConstructedString(k),this},e.ByteStringBuffer.prototype.putBytes=function(f){return this.data+=f,this._optimizeConstructedString(f.length),this},e.ByteStringBuffer.prototype.putString=function(f){return this.putBytes(e.encodeUtf8(f))},e.ByteStringBuffer.prototype.putInt16=function(f){return this.putBytes(String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},e.ByteStringBuffer.prototype.putInt24=function(f){return this.putBytes(String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},e.ByteStringBuffer.prototype.putInt32=function(f){return this.putBytes(String.fromCharCode(f>>24&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},e.ByteStringBuffer.prototype.putInt16Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255))},e.ByteStringBuffer.prototype.putInt24Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f>>16&255))},e.ByteStringBuffer.prototype.putInt32Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>24&255))},e.ByteStringBuffer.prototype.putInt=function(f,k){r(k);var R="";do k-=8,R+=String.fromCharCode(f>>k&255);while(k>0);return this.putBytes(R)},e.ByteStringBuffer.prototype.putSignedInt=function(f,k){return f<0&&(f+=2<<k-1),this.putInt(f,k)},e.ByteStringBuffer.prototype.putBuffer=function(f){return this.putBytes(f.getBytes())},e.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},e.ByteStringBuffer.prototype.getInt16=function(){var f=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,f},e.ByteStringBuffer.prototype.getInt24=function(){var f=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,f},e.ByteStringBuffer.prototype.getInt32=function(){var f=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,f},e.ByteStringBuffer.prototype.getInt16Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,f},e.ByteStringBuffer.prototype.getInt24Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,f},e.ByteStringBuffer.prototype.getInt32Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,f},e.ByteStringBuffer.prototype.getInt=function(f){r(f);var k=0;do k=(k<<8)+this.data.charCodeAt(this.read++),f-=8;while(f>0);return k},e.ByteStringBuffer.prototype.getSignedInt=function(f){var k=this.getInt(f),R=2<<f-2;return k>=R&&(k-=R<<1),k},e.ByteStringBuffer.prototype.getBytes=function(f){var k;return f?(f=Math.min(this.length(),f),k=this.data.slice(this.read,this.read+f),this.read+=f):f===0?k="":(k=this.read===0?this.data:this.data.slice(this.read),this.clear()),k},e.ByteStringBuffer.prototype.bytes=function(f){return typeof f=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+f)},e.ByteStringBuffer.prototype.at=function(f){return this.data.charCodeAt(this.read+f)},e.ByteStringBuffer.prototype.setAt=function(f,k){return this.data=this.data.substr(0,this.read+f)+String.fromCharCode(k)+this.data.substr(this.read+f+1),this},e.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},e.ByteStringBuffer.prototype.copy=function(){var f=e.createBuffer(this.data);return f.read=this.read,f},e.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},e.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},e.ByteStringBuffer.prototype.truncate=function(f){var k=Math.max(0,this.length()-f);return this.data=this.data.substr(this.read,k),this.read=0,this},e.ByteStringBuffer.prototype.toHex=function(){for(var f="",k=this.read;k<this.data.length;++k){var R=this.data.charCodeAt(k);R<16&&(f+="0"),f+=R.toString(16)}return f},e.ByteStringBuffer.prototype.toString=function(){return e.decodeUtf8(this.bytes())};function a(f,k){k=k||{},this.read=k.readOffset||0,this.growSize=k.growSize||1024;var R=e.isArrayBuffer(f),g=e.isArrayBufferView(f);if(R||g){R?this.data=new DataView(f):this.data=new DataView(f.buffer,f.byteOffset,f.byteLength),this.write="writeOffset"in k?k.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,f!=null&&this.putBytes(f),"writeOffset"in k&&(this.write=k.writeOffset)}e.DataBuffer=a,e.DataBuffer.prototype.length=function(){return this.write-this.read},e.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},e.DataBuffer.prototype.accommodate=function(f,k){if(this.length()>=f)return this;k=Math.max(k||this.growSize,f);var R=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),g=new Uint8Array(this.length()+k);return g.set(R),this.data=new DataView(g.buffer),this},e.DataBuffer.prototype.putByte=function(f){return this.accommodate(1),this.data.setUint8(this.write++,f),this},e.DataBuffer.prototype.fillWithByte=function(f,k){this.accommodate(k);for(var R=0;R<k;++R)this.data.setUint8(f);return this},e.DataBuffer.prototype.putBytes=function(f,k){if(e.isArrayBufferView(f)){var R=new Uint8Array(f.buffer,f.byteOffset,f.byteLength),g=R.byteLength-R.byteOffset;this.accommodate(g);var x=new Uint8Array(this.data.buffer,this.write);return x.set(R),this.write+=g,this}if(e.isArrayBuffer(f)){var R=new Uint8Array(f);this.accommodate(R.byteLength);var x=new Uint8Array(this.data.buffer);return x.set(R,this.write),this.write+=R.byteLength,this}if(f instanceof e.DataBuffer||typeof f=="object"&&typeof f.read=="number"&&typeof f.write=="number"&&e.isArrayBufferView(f.data)){var R=new Uint8Array(f.data.byteLength,f.read,f.length());this.accommodate(R.byteLength);var x=new Uint8Array(f.data.byteLength,this.write);return x.set(R),this.write+=R.byteLength,this}if(f instanceof e.ByteStringBuffer&&(f=f.data,k="binary"),k=k||"binary",typeof f=="string"){var N;if(k==="hex")return this.accommodate(Math.ceil(f.length/2)),N=new Uint8Array(this.data.buffer,this.write),this.write+=e.binary.hex.decode(f,N,this.write),this;if(k==="base64")return this.accommodate(Math.ceil(f.length/4)*3),N=new Uint8Array(this.data.buffer,this.write),this.write+=e.binary.base64.decode(f,N,this.write),this;if(k==="utf8"&&(f=e.encodeUtf8(f),k="binary"),k==="binary"||k==="raw")return this.accommodate(f.length),N=new Uint8Array(this.data.buffer,this.write),this.write+=e.binary.raw.decode(N),this;if(k==="utf16")return this.accommodate(f.length*2),N=new Uint16Array(this.data.buffer,this.write),this.write+=e.text.utf16.encode(N),this;throw new Error("Invalid encoding: "+k)}throw Error("Invalid parameter: "+f)},e.DataBuffer.prototype.putBuffer=function(f){return this.putBytes(f),f.clear(),this},e.DataBuffer.prototype.putString=function(f){return this.putBytes(f,"utf16")},e.DataBuffer.prototype.putInt16=function(f){return this.accommodate(2),this.data.setInt16(this.write,f),this.write+=2,this},e.DataBuffer.prototype.putInt24=function(f){return this.accommodate(3),this.data.setInt16(this.write,f>>8&65535),this.data.setInt8(this.write,f>>16&255),this.write+=3,this},e.DataBuffer.prototype.putInt32=function(f){return this.accommodate(4),this.data.setInt32(this.write,f),this.write+=4,this},e.DataBuffer.prototype.putInt16Le=function(f){return this.accommodate(2),this.data.setInt16(this.write,f,!0),this.write+=2,this},e.DataBuffer.prototype.putInt24Le=function(f){return this.accommodate(3),this.data.setInt8(this.write,f>>16&255),this.data.setInt16(this.write,f>>8&65535,!0),this.write+=3,this},e.DataBuffer.prototype.putInt32Le=function(f){return this.accommodate(4),this.data.setInt32(this.write,f,!0),this.write+=4,this},e.DataBuffer.prototype.putInt=function(f,k){r(k),this.accommodate(k/8);do k-=8,this.data.setInt8(this.write++,f>>k&255);while(k>0);return this},e.DataBuffer.prototype.putSignedInt=function(f,k){return r(k),this.accommodate(k/8),f<0&&(f+=2<<k-1),this.putInt(f,k)},e.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},e.DataBuffer.prototype.getInt16=function(){var f=this.data.getInt16(this.read);return this.read+=2,f},e.DataBuffer.prototype.getInt24=function(){var f=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,f},e.DataBuffer.prototype.getInt32=function(){var f=this.data.getInt32(this.read);return this.read+=4,f},e.DataBuffer.prototype.getInt16Le=function(){var f=this.data.getInt16(this.read,!0);return this.read+=2,f},e.DataBuffer.prototype.getInt24Le=function(){var f=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,f},e.DataBuffer.prototype.getInt32Le=function(){var f=this.data.getInt32(this.read,!0);return this.read+=4,f},e.DataBuffer.prototype.getInt=function(f){r(f);var k=0;do k=(k<<8)+this.data.getInt8(this.read++),f-=8;while(f>0);return k},e.DataBuffer.prototype.getSignedInt=function(f){var k=this.getInt(f),R=2<<f-2;return k>=R&&(k-=R<<1),k},e.DataBuffer.prototype.getBytes=function(f){var k;return f?(f=Math.min(this.length(),f),k=this.data.slice(this.read,this.read+f),this.read+=f):f===0?k="":(k=this.read===0?this.data:this.data.slice(this.read),this.clear()),k},e.DataBuffer.prototype.bytes=function(f){return typeof f=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+f)},e.DataBuffer.prototype.at=function(f){return this.data.getUint8(this.read+f)},e.DataBuffer.prototype.setAt=function(f,k){return this.data.setUint8(f,k),this},e.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},e.DataBuffer.prototype.copy=function(){return new e.DataBuffer(this)},e.DataBuffer.prototype.compact=function(){if(this.read>0){var f=new Uint8Array(this.data.buffer,this.read),k=new Uint8Array(f.byteLength);k.set(f),this.data=new DataView(k),this.write-=this.read,this.read=0}return this},e.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},e.DataBuffer.prototype.truncate=function(f){return this.write=Math.max(0,this.length()-f),this.read=Math.min(this.read,this.write),this},e.DataBuffer.prototype.toHex=function(){for(var f="",k=this.read;k<this.data.byteLength;++k){var R=this.data.getUint8(k);R<16&&(f+="0"),f+=R.toString(16)}return f},e.DataBuffer.prototype.toString=function(f){var k=new Uint8Array(this.data,this.read,this.length());if(f=f||"utf8",f==="binary"||f==="raw")return e.binary.raw.encode(k);if(f==="hex")return e.binary.hex.encode(k);if(f==="base64")return e.binary.base64.encode(k);if(f==="utf8")return e.text.utf8.decode(k);if(f==="utf16")return e.text.utf16.decode(k);throw new Error("Invalid encoding: "+f)},e.createBuffer=function(f,k){return k=k||"raw",f!==void 0&&k==="utf8"&&(f=e.encodeUtf8(f)),new e.ByteBuffer(f)},e.fillString=function(f,k){for(var R="";k>0;)k&1&&(R+=f),k>>>=1,k>0&&(f+=f);return R},e.xorBytes=function(f,k,R){for(var g="",x="",N="",w=0,T=0;R>0;--R,++w)x=f.charCodeAt(w)^k.charCodeAt(w),T>=10&&(g+=N,N="",T=0),N+=String.fromCharCode(x),++T;return g+=N,g},e.hexToBytes=function(f){var k="",R=0;for(f.length&!0&&(R=1,k+=String.fromCharCode(parseInt(f[0],16)));R<f.length;R+=2)k+=String.fromCharCode(parseInt(f.substr(R,2),16));return k},e.bytesToHex=function(f){return e.createBuffer(f).toHex()},e.int32ToBytes=function(f){return String.fromCharCode(f>>24&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255)};var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],u="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";e.encode64=function(f,k){for(var R="",g="",x,N,w,T=0;T<f.length;)x=f.charCodeAt(T++),N=f.charCodeAt(T++),w=f.charCodeAt(T++),R+=s.charAt(x>>2),R+=s.charAt((x&3)<<4|N>>4),isNaN(N)?R+="==":(R+=s.charAt((N&15)<<2|w>>6),R+=isNaN(w)?"=":s.charAt(w&63)),k&&R.length>k&&(g+=R.substr(0,k)+`\r
`,R=R.substr(k));return g+=R,g},e.decode64=function(f){f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var k="",R,g,x,N,w=0;w<f.length;)R=o[f.charCodeAt(w++)-43],g=o[f.charCodeAt(w++)-43],x=o[f.charCodeAt(w++)-43],N=o[f.charCodeAt(w++)-43],k+=String.fromCharCode(R<<2|g>>4),x!==64&&(k+=String.fromCharCode((g&15)<<4|x>>2),N!==64&&(k+=String.fromCharCode((x&3)<<6|N)));return k},e.encodeUtf8=function(f){return unescape(encodeURIComponent(f))},e.decodeUtf8=function(f){return decodeURIComponent(escape(f))},e.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:jh.encode,decode:jh.decode}},e.binary.raw.encode=function(f){return String.fromCharCode.apply(null,f)},e.binary.raw.decode=function(f,k,R){var g=k;g||(g=new Uint8Array(f.length)),R=R||0;for(var x=R,N=0;N<f.length;++N)g[x++]=f.charCodeAt(N);return k?x-R:g},e.binary.hex.encode=e.bytesToHex,e.binary.hex.decode=function(f,k,R){var g=k;g||(g=new Uint8Array(Math.ceil(f.length/2))),R=R||0;var x=0,N=R;for(f.length&1&&(x=1,g[N++]=parseInt(f[0],16));x<f.length;x+=2)g[N++]=parseInt(f.substr(x,2),16);return k?N-R:g},e.binary.base64.encode=function(f,k){for(var R="",g="",x,N,w,T=0;T<f.byteLength;)x=f[T++],N=f[T++],w=f[T++],R+=s.charAt(x>>2),R+=s.charAt((x&3)<<4|N>>4),isNaN(N)?R+="==":(R+=s.charAt((N&15)<<2|w>>6),R+=isNaN(w)?"=":s.charAt(w&63)),k&&R.length>k&&(g+=R.substr(0,k)+`\r
`,R=R.substr(k));return g+=R,g},e.binary.base64.decode=function(f,k,R){var g=k;g||(g=new Uint8Array(Math.ceil(f.length/4)*3)),f=f.replace(/[^A-Za-z0-9\+\/\=]/g,""),R=R||0;for(var x,N,w,T,D=0,v=R;D<f.length;)x=o[f.charCodeAt(D++)-43],N=o[f.charCodeAt(D++)-43],w=o[f.charCodeAt(D++)-43],T=o[f.charCodeAt(D++)-43],g[v++]=x<<2|N>>4,w!==64&&(g[v++]=(N&15)<<4|w>>2,T!==64&&(g[v++]=(w&3)<<6|T));return k?v-R:g.subarray(0,v)},e.binary.base58.encode=function(f,k){return e.binary.baseN.encode(f,u,k)},e.binary.base58.decode=function(f,k){return e.binary.baseN.decode(f,u,k)},e.text={utf8:{},utf16:{}},e.text.utf8.encode=function(f,k,R){f=e.encodeUtf8(f);var g=k;g||(g=new Uint8Array(f.length)),R=R||0;for(var x=R,N=0;N<f.length;++N)g[x++]=f.charCodeAt(N);return k?x-R:g},e.text.utf8.decode=function(f){return e.decodeUtf8(String.fromCharCode.apply(null,f))},e.text.utf16.encode=function(f,k,R){var g=k;g||(g=new Uint8Array(f.length*2));var x=new Uint16Array(g.buffer);R=R||0;for(var N=R,w=R,T=0;T<f.length;++T)x[w++]=f.charCodeAt(T),N+=2;return k?N-R:g},e.text.utf16.decode=function(f){return String.fromCharCode.apply(null,new Uint16Array(f.buffer))},e.deflate=function(f,k,R){if(k=e.decode64(f.deflate(e.encode64(k)).rval),R){var g=2,x=k.charCodeAt(1);x&32&&(g=6),k=k.substring(g,k.length-4)}return k},e.inflate=function(f,k,R){var g=f.inflate(e.encode64(k)).rval;return g===null?null:e.decode64(g)};var c=function(f,k,R){if(!f)throw new Error("WebStorage not available.");var g;if(R===null?g=f.removeItem(k):(R=e.encode64(JSON.stringify(R)),g=f.setItem(k,R)),typeof g!="undefined"&&g.rval!==!0){var x=new Error(g.error.message);throw x.id=g.error.id,x.name=g.error.name,x}},d=function(f,k){if(!f)throw new Error("WebStorage not available.");var R=f.getItem(k);if(f.init)if(R.rval===null){if(R.error){var g=new Error(R.error.message);throw g.id=R.error.id,g.name=R.error.name,g}R=null}else R=R.rval;return R!==null&&(R=JSON.parse(e.decode64(R))),R},h=function(f,k,R,g){var x=d(f,k);x===null&&(x={}),x[R]=g,c(f,k,x)},y=function(f,k,R){var g=d(f,k);return g!==null&&(g=R in g?g[R]:null),g},p=function(f,k,R){var g=d(f,k);if(g!==null&&R in g){delete g[R];var x=!0;for(var N in g){x=!1;break}x&&(g=null),c(f,k,g)}},m=function(f,k){c(f,k,null)},_=function(f,k,R){var g=null;typeof R=="undefined"&&(R=["web","flash"]);var x,N=!1,w=null;for(var T in R){x=R[T];try{if(x==="flash"||x==="both"){if(k[0]===null)throw new Error("Flash local storage not available.");g=f.apply(this,k),N=x==="flash"}(x==="web"||x==="both")&&(k[0]=localStorage,g=f.apply(this,k),N=!0)}catch(D){w=D}if(N)break}if(!N)throw w;return g};e.setItem=function(f,k,R,g,x){_(h,arguments,x)},e.getItem=function(f,k,R,g){return _(y,arguments,g)},e.removeItem=function(f,k,R,g){_(p,arguments,g)},e.clearItems=function(f,k,R){_(m,arguments,R)},e.parseUrl=function(f){var k=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;k.lastIndex=0;var R=k.exec(f),g=R===null?null:{full:f,scheme:R[1],host:R[2],port:R[3],path:R[4]};return g&&(g.fullHost=g.host,g.port?(g.port!==80&&g.scheme==="http"||g.port!==443&&g.scheme==="https")&&(g.fullHost+=":"+g.port):g.scheme==="http"?g.port=80:g.scheme==="https"&&(g.port=443),g.full=g.scheme+"://"+g.fullHost),g};var I=null;e.getQueryVariables=function(f){var k=function(g){for(var x={},N=g.split("&"),w=0;w<N.length;w++){var T=N[w].indexOf("="),D,v;T>0?(D=N[w].substring(0,T),v=N[w].substring(T+1)):(D=N[w],v=null),D in x||(x[D]=[]),!(D in Object.prototype)&&v!==null&&x[D].push(unescape(v))}return x},R;return typeof f=="undefined"?(I===null&&(typeof window!="undefined"&&window.location&&window.location.search?I=k(window.location.search.substring(1)):I={}),R=I):R=k(f),R},e.parseFragment=function(f){var k=f,R="",g=f.indexOf("?");g>0&&(k=f.substring(0,g),R=f.substring(g+1));var x=k.split("/");x.length>0&&x[0]===""&&x.shift();var N=R===""?{}:e.getQueryVariables(R);return{pathString:k,queryString:R,path:x,query:N}},e.makeRequest=function(f){var k=e.parseFragment(f),R={path:k.pathString,query:k.queryString,getPath:function(g){return typeof g=="undefined"?k.path:k.path[g]},getQuery:function(g,x){var N;return typeof g=="undefined"?N=k.query:(N=k.query[g],N&&typeof x!="undefined"&&(N=N[x])),N},getQueryLast:function(g,x){var N,w=R.getQuery(g);return w?N=w[w.length-1]:N=x,N}};return R},e.makeLink=function(f,k,R){f=jQuery.isArray(f)?f.join("/"):f;var g=jQuery.param(k||{});return R=R||"",f+(g.length>0?"?"+g:"")+(R.length>0?"#"+R:"")},e.setPath=function(f,k,R){if(typeof f=="object"&&f!==null)for(var g=0,x=k.length;g<x;){var N=k[g++];if(g==x)f[N]=R;else{var w=N in f;(!w||w&&typeof f[N]!="object"||w&&f[N]===null)&&(f[N]={}),f=f[N]}}},e.getPath=function(f,k,R){for(var g=0,x=k.length,N=!0;N&&g<x&&typeof f=="object"&&f!==null;){var w=k[g++];N=w in f,N&&(f=f[w])}return N?f:R},e.deletePath=function(f,k){if(typeof f=="object"&&f!==null)for(var R=0,g=k.length;R<g;){var x=k[R++];if(R==g)delete f[x];else{if(!(x in f)||typeof f[x]!="object"||f[x]===null)break;f=f[x]}}},e.isEmpty=function(f){for(var k in f)if(f.hasOwnProperty(k))return!1;return!0},e.format=function(f){for(var k=/%./g,R,g,x=0,N=[],w=0;R=k.exec(f);){g=f.substring(w,k.lastIndex-2),g.length>0&&N.push(g),w=k.lastIndex;var T=R[0][1];switch(T){case"s":case"o":x<arguments.length?N.push(arguments[x+++1]):N.push("<?>");break;case"%":N.push("%");break;default:N.push("<%"+T+"?>")}}return N.push(f.substring(w)),N.join("")},e.formatNumber=function(f,k,R,g){var x=f,N=isNaN(k=Math.abs(k))?2:k,w=R===void 0?",":R,T=g===void 0?".":g,D=x<0?"-":"",v=parseInt(x=Math.abs(+x||0).toFixed(N),10)+"",l=v.length>3?v.length%3:0;return D+(l?v.substr(0,l)+T:"")+v.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+T)+(N?w+Math.abs(x-v).toFixed(N).slice(2):"")},e.formatSize=function(f){return f>=1073741824?f=e.formatNumber(f/1073741824,2,".","")+" GiB":f>=1048576?f=e.formatNumber(f/1048576,2,".","")+" MiB":f>=1024?f=e.formatNumber(f/1024,0)+" KiB":f=e.formatNumber(f,0)+" bytes",f},e.bytesFromIP=function(f){return f.indexOf(".")!==-1?e.bytesFromIPv4(f):f.indexOf(":")!==-1?e.bytesFromIPv6(f):null},e.bytesFromIPv4=function(f){if(f=f.split("."),f.length!==4)return null;for(var k=e.createBuffer(),R=0;R<f.length;++R){var g=parseInt(f[R],10);if(isNaN(g))return null;k.putByte(g)}return k.getBytes()},e.bytesFromIPv6=function(f){var k=0;f=f.split(":").filter(function(w){return w.length===0&&++k,!0});for(var R=(8-f.length+k)*2,g=e.createBuffer(),x=0;x<8;++x){if(!f[x]||f[x].length===0){g.fillWithByte(0,R),R=0;continue}var N=e.hexToBytes(f[x]);N.length<2&&g.putByte(0),g.putBytes(N)}return g.getBytes()},e.bytesToIP=function(f){return f.length===4?e.bytesToIPv4(f):f.length===16?e.bytesToIPv6(f):null},e.bytesToIPv4=function(f){if(f.length!==4)return null;for(var k=[],R=0;R<f.length;++R)k.push(f.charCodeAt(R));return k.join(".")},e.bytesToIPv6=function(f){if(f.length!==16)return null;for(var k=[],R=[],g=0,x=0;x<f.length;x+=2){for(var N=e.bytesToHex(f[x]+f[x+1]);N[0]==="0"&&N!=="0";)N=N.substr(1);if(N==="0"){var w=R[R.length-1],T=k.length;!w||T!==w.end+1?R.push({start:T,end:T}):(w.end=T,w.end-w.start>R[g].end-R[g].start&&(g=R.length-1))}k.push(N)}if(R.length>0){var D=R[g];D.end-D.start>0&&(k.splice(D.start,D.end-D.start+1,""),D.start===0&&k.unshift(""),D.end===7&&k.push(""))}return k.join(":")},e.estimateCores=function(f,k){if(typeof f=="function"&&(k=f,f={}),f=f||{},"cores"in e&&!f.update)return k(null,e.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return e.cores=navigator.hardwareConcurrency,k(null,e.cores);if(typeof Worker=="undefined")return e.cores=1,k(null,e.cores);if(typeof Blob=="undefined")return e.cores=2,k(null,e.cores);var R=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(w){var T=Date.now(),D=T+4;self.postMessage({st:T,et:D})})}.toString(),")()"],{type:"application/javascript"}));g([],5,16);function g(w,T,D){if(T===0){var v=Math.floor(w.reduce(function(l,b){return l+b},0)/w.length);return e.cores=Math.max(1,v),URL.revokeObjectURL(R),k(null,e.cores)}x(D,function(l,b){w.push(N(D,b)),g(w,T-1,D)})}function x(w,T){for(var D=[],v=[],l=0;l<w;++l){var b=new Worker(R);b.addEventListener("message",function(A){if(v.push(A.data),v.length===w){for(var C=0;C<w;++C)D[C].terminate();T(null,v)}}),D.push(b)}for(var l=0;l<w;++l)D[l].postMessage(l)}function N(w,T){for(var D=[],v=0;v<w;++v)for(var l=T[v],b=D[v]=[],A=0;A<w;++A){if(v===A)continue;var C=T[A];(l.st>C.st&&l.st<C.et||C.st>l.st&&C.st<l.et)&&b.push(A)}return D.reduce(function(P,O){return Math.max(P,O.length)},0)}}}),T9=Z(function(t){E.pki=E.pki||{};var e=t.exports=E.pki.oids=E.oids=E.oids||{};function r(i,a){e[i]=a,e[a]=i}function n(i,a){e[i]=a}r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.5","serialName"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),n("2.5.29.1","authorityKeyIdentifier"),n("2.5.29.2","keyAttributes"),n("2.5.29.3","certificatePolicies"),n("2.5.29.4","keyUsageRestriction"),n("2.5.29.5","policyMapping"),n("2.5.29.6","subtreesConstraint"),n("2.5.29.7","subjectAltName"),n("2.5.29.8","issuerAltName"),n("2.5.29.9","subjectDirectoryAttributes"),n("2.5.29.10","basicConstraints"),n("2.5.29.11","nameConstraints"),n("2.5.29.12","policyConstraints"),n("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),n("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),n("2.5.29.20","cRLNumber"),n("2.5.29.21","cRLReason"),n("2.5.29.22","expirationDate"),n("2.5.29.23","instructionCode"),n("2.5.29.24","invalidityDate"),n("2.5.29.25","cRLDistributionPoints"),n("2.5.29.26","issuingDistributionPoint"),n("2.5.29.27","deltaCRLIndicator"),n("2.5.29.28","issuingDistributionPoint"),n("2.5.29.29","certificateIssuer"),n("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),n("2.5.29.33","policyMappings"),n("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),n("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),n("2.5.29.46","freshestCRL"),n("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping")}),C9=Z(function(t){var e=t.exports=E.asn1=E.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(s,o,u,c,d){if(E.util.isArray(c)){for(var h=[],y=0;y<c.length;++y)c[y]!==void 0&&h.push(c[y]);c=h}var p={tagClass:s,type:o,constructed:u,composed:u||E.util.isArray(c),value:c};return d&&"bitStringContents"in d&&(p.bitStringContents=d.bitStringContents,p.original=e.copy(p)),p},e.copy=function(s,o){var u;if(E.util.isArray(s)){u=[];for(var c=0;c<s.length;++c)u.push(e.copy(s[c],o));return u}return typeof s=="string"?s:(u={tagClass:s.tagClass,type:s.type,constructed:s.constructed,composed:s.composed,value:e.copy(s.value,o)},o&&!o.excludeBitStringContents&&(u.bitStringContents=s.bitStringContents),u)},e.equals=function(s,o,u){if(E.util.isArray(s)){if(!E.util.isArray(o))return!1;if(s.length!==o.length)return!1;for(var c=0;c<s.length;++c)if(!e.equals(s[c],o[c]))return!1;return!0}if(typeof s!==typeof o)return!1;if(typeof s=="string")return s===o;var d=s.tagClass===o.tagClass&&s.type===o.type&&s.constructed===o.constructed&&s.composed===o.composed&&e.equals(s.value,o.value);return u&&u.includeBitStringContents&&(d=d&&s.bitStringContents===o.bitStringContents),d},e.getBerValueLength=function(s){var o=s.getByte();if(o===128)return;var u,c=o&128;return c?u=s.getInt((o&127)<<3):u=o,u};function r(s,o,u){if(u>o){var c=new Error("Too few bytes to parse DER.");throw c.available=s.length(),c.remaining=o,c.requested=u,c}}var n=function(s,o){var u=s.getByte();if(o--,u===128)return;var c,d=u&128;if(!d)c=u;else{var h=u&127;r(s,o,h),c=s.getInt(h<<3)}if(c<0)throw new Error("Negative length: "+c);return c};e.fromDer=function(s,o){return o===void 0&&(o={strict:!0,decodeBitStrings:!0}),typeof o=="boolean"&&(o={strict:o,decodeBitStrings:!0}),"strict"in o||(o.strict=!0),"decodeBitStrings"in o||(o.decodeBitStrings=!0),typeof s=="string"&&(s=E.util.createBuffer(s)),i(s,s.length(),0,o)};function i(s,o,u,c){var d;r(s,o,2);var h=s.getByte();o--;var y=h&192,p=h&31;d=s.length();var m=n(s,o);if(o-=d-s.length(),m!==void 0&&m>o){if(c.strict){var _=new Error("Too few bytes to read ASN.1 value.");throw _.available=s.length(),_.remaining=o,_.requested=m,_}m=o}var I,f,k=(h&32)===32;if(k)if(I=[],m===void 0)for(;;){if(r(s,o,2),s.bytes(2)===String.fromCharCode(0,0)){s.getBytes(2),o-=2;break}d=s.length(),I.push(i(s,o,u+1,c)),o-=d-s.length()}else for(;m>0;)d=s.length(),I.push(i(s,m,u+1,c)),o-=d-s.length(),m-=d-s.length();if(I===void 0&&y===e.Class.UNIVERSAL&&p===e.Type.BITSTRING&&(f=s.bytes(m)),I===void 0&&c.decodeBitStrings&&y===e.Class.UNIVERSAL&&p===e.Type.BITSTRING&&m>1){var R=s.read,g=o,x=0;if(p===e.Type.BITSTRING&&(r(s,o,1),x=s.getByte(),o--),x===0)try{d=s.length();var N={verbose:c.verbose,strict:!0,decodeBitStrings:!0},w=i(s,o,u+1,N),T=d-s.length();o-=T,p==e.Type.BITSTRING&&T++;var D=w.tagClass;T===m&&(D===e.Class.UNIVERSAL||D===e.Class.CONTEXT_SPECIFIC)&&(I=[w])}catch(l){}I===void 0&&(s.read=R,o=g)}if(I===void 0){if(m===void 0){if(c.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");m=o}if(p===e.Type.BMPSTRING)for(I="";m>0;m-=2)r(s,o,2),I+=String.fromCharCode(s.getInt16()),o-=2;else I=s.getBytes(m)}var v=f===void 0?null:{bitStringContents:f};return e.create(y,p,k,I,v)}e.toDer=function(s){var o=E.util.createBuffer(),u=s.tagClass|s.type,c=E.util.createBuffer(),d=!1;if("bitStringContents"in s&&(d=!0,s.original&&(d=e.equals(s,s.original))),d)c.putBytes(s.bitStringContents);else if(s.composed){s.constructed?u|=32:c.putByte(0);for(var h=0;h<s.value.length;++h)s.value[h]!==void 0&&c.putBuffer(e.toDer(s.value[h]))}else if(s.type===e.Type.BMPSTRING)for(var h=0;h<s.value.length;++h)c.putInt16(s.value.charCodeAt(h));else s.type===e.Type.INTEGER&&s.value.length>1&&(s.value.charCodeAt(0)===0&&(s.value.charCodeAt(1)&128)===0||s.value.charCodeAt(0)===255&&(s.value.charCodeAt(1)&128)===128)?c.putBytes(s.value.substr(1)):c.putBytes(s.value);if(o.putByte(u),c.length()<=127)o.putByte(c.length()&127);else{var y=c.length(),p="";do p+=String.fromCharCode(y&255),y=y>>>8;while(y>0);o.putByte(p.length|128);for(var h=p.length-1;h>=0;--h)o.putByte(p.charCodeAt(h))}return o.putBuffer(c),o},e.oidToDer=function(s){var o=s.split("."),u=E.util.createBuffer();u.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var c,d,h,y,p=2;p<o.length;++p){c=!0,d=[],h=parseInt(o[p],10);do y=h&127,h=h>>>7,c||(y|=128),d.push(y),c=!1;while(h>0);for(var m=d.length-1;m>=0;--m)u.putByte(d[m])}return u},e.derToOid=function(s){var o;typeof s=="string"&&(s=E.util.createBuffer(s));var u=s.getByte();o=Math.floor(u/40)+"."+u%40;for(var c=0;s.length()>0;)u=s.getByte(),c=c<<7,u&128?c+=u&127:(o+="."+(c+u),c=0);return o},e.utcTimeToDate=function(s){var o=new Date,u=parseInt(s.substr(0,2),10);u=u>=50?1900+u:2e3+u;var c=parseInt(s.substr(2,2),10)-1,d=parseInt(s.substr(4,2),10),h=parseInt(s.substr(6,2),10),y=parseInt(s.substr(8,2),10),p=0;if(s.length>11){var m=s.charAt(10),_=10;m!=="+"&&m!=="-"&&(p=parseInt(s.substr(10,2),10),_+=2)}if(o.setUTCFullYear(u,c,d),o.setUTCHours(h,y,p,0),_&&(m=s.charAt(_),m==="+"||m==="-")){var I=parseInt(s.substr(_+1,2),10),f=parseInt(s.substr(_+4,2),10),k=I*60+f;k*=6e4,m==="+"?o.setTime(+o-k):o.setTime(+o+k)}return o},e.generalizedTimeToDate=function(s){var o=new Date,u=parseInt(s.substr(0,4),10),c=parseInt(s.substr(4,2),10)-1,d=parseInt(s.substr(6,2),10),h=parseInt(s.substr(8,2),10),y=parseInt(s.substr(10,2),10),p=parseInt(s.substr(12,2),10),m=0,_=0,I=!1;s.charAt(s.length-1)==="Z"&&(I=!0);var f=s.length-5,k=s.charAt(f);if(k==="+"||k==="-"){var R=parseInt(s.substr(f+1,2),10),g=parseInt(s.substr(f+4,2),10);_=R*60+g,_*=6e4,k==="+"&&(_*=-1),I=!0}return s.charAt(14)==="."&&(m=parseFloat(s.substr(14),10)*1e3),I?(o.setUTCFullYear(u,c,d),o.setUTCHours(h,y,p,m),o.setTime(+o+_)):(o.setFullYear(u,c,d),o.setHours(h,y,p,m)),o},e.dateToUtcTime=function(s){if(typeof s=="string")return s;var o="",u=[];u.push((""+s.getUTCFullYear()).substr(2)),u.push(""+(s.getUTCMonth()+1)),u.push(""+s.getUTCDate()),u.push(""+s.getUTCHours()),u.push(""+s.getUTCMinutes()),u.push(""+s.getUTCSeconds());for(var c=0;c<u.length;++c)u[c].length<2&&(o+="0"),o+=u[c];return o+="Z",o},e.dateToGeneralizedTime=function(s){if(typeof s=="string")return s;var o="",u=[];u.push(""+s.getUTCFullYear()),u.push(""+(s.getUTCMonth()+1)),u.push(""+s.getUTCDate()),u.push(""+s.getUTCHours()),u.push(""+s.getUTCMinutes()),u.push(""+s.getUTCSeconds());for(var c=0;c<u.length;++c)u[c].length<2&&(o+="0"),o+=u[c];return o+="Z",o},e.integerToDer=function(s){var o=E.util.createBuffer();if(s>=-128&&s<128)return o.putSignedInt(s,8);if(s>=-32768&&s<32768)return o.putSignedInt(s,16);if(s>=-8388608&&s<8388608)return o.putSignedInt(s,24);if(s>=-2147483648&&s<2147483648)return o.putSignedInt(s,32);var u=new Error("Integer too large; max is 32-bits.");throw u.integer=s,u},e.derToInteger=function(s){typeof s=="string"&&(s=E.util.createBuffer(s));var o=s.length()*8;if(o>32)throw new Error("Integer too large; max is 32-bits.");return s.getSignedInt(o)},e.validate=function(s,o,u,c){var d=!1;if((s.tagClass===o.tagClass||typeof o.tagClass=="undefined")&&(s.type===o.type||typeof o.type=="undefined"))if(s.constructed===o.constructed||typeof o.constructed=="undefined"){if(d=!0,o.value&&E.util.isArray(o.value))for(var h=0,y=0;d&&y<o.value.length;++y)d=o.value[y].optional||!1,s.value[h]&&(d=e.validate(s.value[h],o.value[y],u,c),d?++h:o.value[y].optional&&(d=!0)),!d&&c&&c.push("["+o.name+'] Tag class "'+o.tagClass+'", type "'+o.type+'" expected value length "'+o.value.length+'", got "'+s.value.length+'"');if(d&&u&&(o.capture&&(u[o.capture]=s.value),o.captureAsn1&&(u[o.captureAsn1]=s),o.captureBitStringContents&&"bitStringContents"in s&&(u[o.captureBitStringContents]=s.bitStringContents),o.captureBitStringValue&&"bitStringContents"in s))if(s.bitStringContents.length<2)u[o.captureBitStringValue]="";else{var p=s.bitStringContents.charCodeAt(0);if(p!==0)throw new Error("captureBitStringValue only supported for zero unused bits");u[o.captureBitStringValue]=s.bitStringContents.slice(1)}}else c&&c.push("["+o.name+'] Expected constructed "'+o.constructed+'", got "'+s.constructed+'"');else c&&(s.tagClass!==o.tagClass&&c.push("["+o.name+'] Expected tag class "'+o.tagClass+'", got "'+s.tagClass+'"'),s.type!==o.type&&c.push("["+o.name+'] Expected type "'+o.type+'", got "'+s.type+'"'));return d};var a=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(s,o,u){var c="";o=o||0,u=u||2,o>0&&(c+=`
`);for(var d="",h=0;h<o*u;++h)d+=" ";c+=d+"Tag: ";switch(s.tagClass){case e.Class.UNIVERSAL:c+="Universal:";break;case e.Class.APPLICATION:c+="Application:";break;case e.Class.CONTEXT_SPECIFIC:c+="Context-Specific:";break;case e.Class.PRIVATE:c+="Private:";break}if(s.tagClass===e.Class.UNIVERSAL){c+=s.type;switch(s.type){case e.Type.NONE:c+=" (None)";break;case e.Type.BOOLEAN:c+=" (Boolean)";break;case e.Type.INTEGER:c+=" (Integer)";break;case e.Type.BITSTRING:c+=" (Bit string)";break;case e.Type.OCTETSTRING:c+=" (Octet string)";break;case e.Type.NULL:c+=" (Null)";break;case e.Type.OID:c+=" (Object Identifier)";break;case e.Type.ODESC:c+=" (Object Descriptor)";break;case e.Type.EXTERNAL:c+=" (External or Instance of)";break;case e.Type.REAL:c+=" (Real)";break;case e.Type.ENUMERATED:c+=" (Enumerated)";break;case e.Type.EMBEDDED:c+=" (Embedded PDV)";break;case e.Type.UTF8:c+=" (UTF8)";break;case e.Type.ROID:c+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:c+=" (Sequence)";break;case e.Type.SET:c+=" (Set)";break;case e.Type.PRINTABLESTRING:c+=" (Printable String)";break;case e.Type.IA5String:c+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:c+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:c+=" (Generalized time)";break;case e.Type.BMPSTRING:c+=" (BMP String)";break}}else c+=s.type;if(c+=`
`,c+=d+"Constructed: "+s.constructed+`
`,s.composed){for(var y=0,p="",h=0;h<s.value.length;++h)s.value[h]!==void 0&&(y+=1,p+=e.prettyPrint(s.value[h],o+1,u),h+1<s.value.length&&(p+=","));c+=d+"Sub values: "+y+p}else{if(c+=d+"Value: ",s.type===e.Type.OID){var m=e.derToOid(s.value);c+=m,E.pki&&E.pki.oids&&(m in E.pki.oids&&(c+=" ("+E.pki.oids[m]+") "))}if(s.type===e.Type.INTEGER)try{c+=e.derToInteger(s.value)}catch(I){c+="0x"+E.util.bytesToHex(s.value)}else if(s.type===e.Type.BITSTRING){if(s.value.length>1?c+="0x"+E.util.bytesToHex(s.value.slice(1)):c+="(none)",s.value.length>0){var _=s.value.charCodeAt(0);_==1?c+=" (1 unused bit shown)":_>1&&(c+=" ("+_+" unused bits shown)")}}else s.type===e.Type.OCTETSTRING?(a.test(s.value)||(c+="("+s.value+") "),c+="0x"+E.util.bytesToHex(s.value)):s.type===e.Type.UTF8?c+=E.util.decodeUtf8(s.value):s.type===e.Type.PRINTABLESTRING||s.type===e.Type.IA5String?c+=s.value:a.test(s.value)?c+="0x"+E.util.bytesToHex(s.value):s.value.length===0?c+="[null]":c+=s.value}return c}}),_9=E.cipher=E.cipher||{};E.cipher.algorithms=E.cipher.algorithms||{},E.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=E.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new E.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})},E.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=E.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new E.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})},E.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),E.cipher.algorithms[t]=e},E.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in E.cipher.algorithms?E.cipher.algorithms[t]:null};var fu=E.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};fu.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=E.util.createBuffer(),this.output=t.output||E.util.createBuffer(),this.mode.start(e)},fu.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},fu.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)?!1:(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e)?!1:!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,e)))};var R9=Z(function(t){E.cipher=E.cipher||{};var e=t.exports=E.cipher.modes=E.cipher.modes||{};e.ecb=function(a){a=a||{},this.name="ECB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(a){},e.ecb.prototype.encrypt=function(a,s,o){if(a.length()<this.blockSize&&!(o&&a.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)s.putInt32(this._outBlock[u])},e.ecb.prototype.decrypt=function(a,s,o){if(a.length()<this.blockSize&&!(o&&a.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)s.putInt32(this._outBlock[u])},e.ecb.prototype.pad=function(a,s){var o=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(o,o),!0},e.ecb.prototype.unpad=function(a,s){if(s.overflow>0)return!1;var o=a.length(),u=a.at(o-1);return u>this.blockSize<<2?!1:(a.truncate(u),!0)},e.cbc=function(a){a=a||{},this.name="CBC",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(a){if(a.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in a)this._iv=r(a.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(a,s,o){if(a.length()<this.blockSize&&!(o&&a.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=this._prev[u]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)s.putInt32(this._outBlock[u]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(a,s,o){if(a.length()<this.blockSize&&!(o&&a.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)s.putInt32(this._prev[u]^this._outBlock[u]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(a,s){var o=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(o,o),!0},e.cbc.prototype.unpad=function(a,s){if(s.overflow>0)return!1;var o=a.length(),u=a.at(o-1);return u>this.blockSize<<2?!1:(a.truncate(u),!0)},e.cfb=function(a){a=a||{},this.name="CFB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=E.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=r(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(a,s,o){var u=a.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var c=0;c<this._ints;++c)this._inBlock[c]=a.getInt32()^this._outBlock[c],s.putInt32(this._inBlock[c]);return}var d=(this.blockSize-u)%this.blockSize;d>0&&(d=this.blockSize-d),this._partialOutput.clear();for(var c=0;c<this._ints;++c)this._partialBlock[c]=a.getInt32()^this._outBlock[c],this._partialOutput.putInt32(this._partialBlock[c]);if(d>0)a.read-=this.blockSize;else for(var c=0;c<this._ints;++c)this._inBlock[c]=this._partialBlock[c];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),d>0&&!o)return s.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=d,!0;s.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(a,s,o){var u=a.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var c=0;c<this._ints;++c)this._inBlock[c]=a.getInt32(),s.putInt32(this._inBlock[c]^this._outBlock[c]);return}var d=(this.blockSize-u)%this.blockSize;d>0&&(d=this.blockSize-d),this._partialOutput.clear();for(var c=0;c<this._ints;++c)this._partialBlock[c]=a.getInt32(),this._partialOutput.putInt32(this._partialBlock[c]^this._outBlock[c]);if(d>0)a.read-=this.blockSize;else for(var c=0;c<this._ints;++c)this._inBlock[c]=this._partialBlock[c];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),d>0&&!o)return s.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=d,!0;s.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb=function(a){a=a||{},this.name="OFB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=E.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=r(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(a,s,o){var u=a.length();if(a.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var c=0;c<this._ints;++c)s.putInt32(a.getInt32()^this._outBlock[c]),this._inBlock[c]=this._outBlock[c];return}var d=(this.blockSize-u)%this.blockSize;d>0&&(d=this.blockSize-d),this._partialOutput.clear();for(var c=0;c<this._ints;++c)this._partialOutput.putInt32(a.getInt32()^this._outBlock[c]);if(d>0)a.read-=this.blockSize;else for(var c=0;c<this._ints;++c)this._inBlock[c]=this._outBlock[c];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),d>0&&!o)return s.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=d,!0;s.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(a){a=a||{},this.name="CTR",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=E.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=r(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(a,s,o){var u=a.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize)for(var c=0;c<this._ints;++c)s.putInt32(a.getInt32()^this._outBlock[c]);else{var d=(this.blockSize-u)%this.blockSize;d>0&&(d=this.blockSize-d),this._partialOutput.clear();for(var c=0;c<this._ints;++c)this._partialOutput.putInt32(a.getInt32()^this._outBlock[c]);if(d>0&&(a.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),d>0&&!o)return s.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=d,!0;s.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}n(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(a){a=a||{},this.name="GCM",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=E.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");var s=E.util.createBuffer(a.iv);this._cipherLength=0;var o;if("additionalData"in a?o=E.util.createBuffer(a.additionalData):o=E.util.createBuffer(),"tagLength"in a?this._tagLength=a.tagLength:this._tagLength=128,this._tag=null,a.decrypt&&(this._tag=E.util.createBuffer(a.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var u=s.length();if(u===12)this._j0=[s.getInt32(),s.getInt32(),s.getInt32(),1];else{for(this._j0=[0,0,0,0];s.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[s.getInt32(),s.getInt32(),s.getInt32(),s.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(i(u*8)))}this._inBlock=this._j0.slice(0),n(this._inBlock),this._partialBytes=0,o=E.util.createBuffer(o),this._aDataLength=i(o.length()*8);var c=o.length()%this.blockSize;for(c&&o.fillWithByte(0,this.blockSize-c),this._s=[0,0,0,0];o.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[o.getInt32(),o.getInt32(),o.getInt32(),o.getInt32()])},e.gcm.prototype.encrypt=function(a,s,o){var u=a.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var c=0;c<this._ints;++c)s.putInt32(this._outBlock[c]^=a.getInt32());this._cipherLength+=this.blockSize}else{var d=(this.blockSize-u)%this.blockSize;d>0&&(d=this.blockSize-d),this._partialOutput.clear();for(var c=0;c<this._ints;++c)this._partialOutput.putInt32(a.getInt32()^this._outBlock[c]);if(d<=0||o){if(o){var h=u%this.blockSize;this._cipherLength+=h,this._partialOutput.truncate(this.blockSize-h)}else this._cipherLength+=this.blockSize;for(var c=0;c<this._ints;++c)this._outBlock[c]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),d>0&&!o)return a.read-=this.blockSize,s.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=d,!0;s.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),n(this._inBlock)},e.gcm.prototype.decrypt=function(a,s,o){var u=a.length();if(u<this.blockSize&&!(o&&u>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),n(this._inBlock),this._hashBlock[0]=a.getInt32(),this._hashBlock[1]=a.getInt32(),this._hashBlock[2]=a.getInt32(),this._hashBlock[3]=a.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var c=0;c<this._ints;++c)s.putInt32(this._outBlock[c]^this._hashBlock[c]);u<this.blockSize?this._cipherLength+=u%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(a,s){var o=!0;s.decrypt&&s.overflow&&a.truncate(this.blockSize-s.overflow),this.tag=E.util.createBuffer();var u=this._aDataLength.concat(i(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,u);var c=[];this.cipher.encrypt(this._j0,c);for(var d=0;d<this._ints;++d)this.tag.putInt32(this._s[d]^c[d]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),s.decrypt&&this.tag.bytes()!==this._tag&&(o=!1),o},e.gcm.prototype.multiply=function(a,s){for(var o=[0,0,0,0],u=s.slice(0),c=0;c<128;++c){var d=a[c/32|0]&1<<31-c%32;d&&(o[0]^=u[0],o[1]^=u[1],o[2]^=u[2],o[3]^=u[3]),this.pow(u,u)}return o},e.gcm.prototype.pow=function(a,s){for(var o=a[3]&1,u=3;u>0;--u)s[u]=a[u]>>>1|(a[u-1]&1)<<31;s[0]=a[0]>>>1,o&&(s[0]^=this._R)},e.gcm.prototype.tableMultiply=function(a){for(var s=[0,0,0,0],o=0;o<32;++o){var u=o/8|0,c=a[u]>>>(7-o%8)*4&15,d=this._m[o][c];s[0]^=d[0],s[1]^=d[1],s[2]^=d[2],s[3]^=d[3]}return s},e.gcm.prototype.ghash=function(a,s,o){return s[0]^=o[0],s[1]^=o[1],s[2]^=o[2],s[3]^=o[3],this.tableMultiply(s)},e.gcm.prototype.generateHashTable=function(a,s){for(var o=8/s,u=4*o,c=16*o,d=new Array(c),h=0;h<c;++h){var y=[0,0,0,0],p=h/u|0,m=(u-1-h%u)*s;y[p]=1<<s-1<<m,d[h]=this.generateSubHashTable(this.multiply(y,a),s)}return d},e.gcm.prototype.generateSubHashTable=function(a,s){var o=1<<s,u=o>>>1,c=new Array(o);c[u]=a.slice(0);for(var d=u>>>1;d>0;)this.pow(c[2*d],c[d]=[]),d>>=1;for(d=2;d<u;){for(var h=1;h<d;++h){var y=c[d],p=c[h];c[d+h]=[y[0]^p[0],y[1]^p[1],y[2]^p[2],y[3]^p[3]]}d*=2}for(c[0]=[0,0,0,0],d=u+1;d<o;++d){var m=c[d^u];c[d]=[a[0]^m[0],a[1]^m[1],a[2]^m[2],a[3]^m[3]]}return c};function r(a,s){if(typeof a=="string"&&(a=E.util.createBuffer(a)),E.util.isArray(a)&&a.length>4){var o=a;a=E.util.createBuffer();for(var u=0;u<o.length;++u)a.putByte(o[u])}if(a.length()<s)throw new Error("Invalid IV length; got "+a.length()+" bytes and expected "+s+" bytes.");if(!E.util.isArray(a)){for(var c=[],d=s/4,u=0;u<d;++u)c.push(a.getInt32());a=c}return a}function n(a){a[a.length-1]=a[a.length-1]+1&4294967295}function i(a){return[a/4294967296|0,a&4294967295]}}),N9=E.aes=E.aes||{};E.aes.startEncrypting=function(t,e,r,n){var i=js({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i},E.aes.createEncryptionCipher=function(t,e){return js({key:t,output:null,decrypt:!1,mode:e})},E.aes.startDecrypting=function(t,e,r,n){var i=js({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i},E.aes.createDecryptionCipher=function(t,e){return js({key:t,output:null,decrypt:!0,mode:e})},E.aes.Algorithm=function(t,e){hu||zh();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return mu(r._w,n,i,!1)},decrypt:function(n,i){return mu(r._w,n,i,!0)}}}),r._init=!1},E.aes.Algorithm.prototype.initialize=function(t){if(this._init)return;var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=E.util.createBuffer(e);else if(E.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=E.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!E.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!E.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=$h(e,t.decrypt&&!s),this._init=!0},E.aes._expandKey=function(t,e){return hu||zh(),$h(t,e)},E.aes._updateBlock=mu,Vi("AES-ECB",E.cipher.modes.ecb),Vi("AES-CBC",E.cipher.modes.cbc),Vi("AES-CFB",E.cipher.modes.cfb),Vi("AES-OFB",E.cipher.modes.ofb),Vi("AES-CTR",E.cipher.modes.ctr),Vi("AES-GCM",E.cipher.modes.gcm);function Vi(t,e){var r=function(){return new E.aes.Algorithm(t,e)};E.cipher.registerAlgorithm(t,r)}var hu=!1,zi=4,Ft,pu,Vh,si,gr;function zh(){hu=!0,Vh=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ft=new Array(256),pu=new Array(256),si=new Array(4),gr=new Array(4);for(var e=0;e<4;++e)si[e]=new Array(256),gr[e]=new Array(256);for(var r=0,n=0,i,a,s,o,u,c,d,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Ft[r]=o,pu[o]=r,u=t[o],i=t[r],a=t[i],s=t[a],c=u<<24^o<<16^o<<8^(o^u),d=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)si[h][r]=c,gr[h][o]=d,c=c<<24|c>>>8,d=d<<24|d>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function $h(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=zi*s,u=a;u<o;++u)n=r[u-1],u%a===0?(n=Ft[n>>>16&255]<<24^Ft[n>>>8&255]<<16^Ft[n&255]<<8^Ft[n>>>24]^Vh[i]<<24,i++):a>6&&u%a===4&&(n=Ft[n>>>24]<<24^Ft[n>>>16&255]<<16^Ft[n>>>8&255]<<8^Ft[n&255]),r[u]=r[u-a]^n;if(e){var c,d=gr[0],h=gr[1],y=gr[2],p=gr[3],m=r.slice(0);o=r.length;for(var u=0,_=o-zi;u<o;u+=zi,_-=zi)if(u===0||u===o-zi)m[u]=r[_],m[u+1]=r[_+3],m[u+2]=r[_+2],m[u+3]=r[_+1];else for(var I=0;I<zi;++I)c=r[_+I],m[u+(3&-I)]=d[Ft[c>>>24]]^h[Ft[c>>>16&255]]^y[Ft[c>>>8&255]]^p[Ft[c&255]];r=m}return r}function mu(t,e,r,n){var i=t.length/4-1,a,s,o,u,c;n?(a=gr[0],s=gr[1],o=gr[2],u=gr[3],c=pu):(a=si[0],s=si[1],o=si[2],u=si[3],c=Ft);var d,h,y,p,m,_,I;d=e[0]^t[0],h=e[n?3:1]^t[1],y=e[2]^t[2],p=e[n?1:3]^t[3];for(var f=3,k=1;k<i;++k)m=a[d>>>24]^s[h>>>16&255]^o[y>>>8&255]^u[p&255]^t[++f],_=a[h>>>24]^s[y>>>16&255]^o[p>>>8&255]^u[d&255]^t[++f],I=a[y>>>24]^s[p>>>16&255]^o[d>>>8&255]^u[h&255]^t[++f],p=a[p>>>24]^s[d>>>16&255]^o[h>>>8&255]^u[y&255]^t[++f],d=m,h=_,y=I;r[0]=c[d>>>24]<<24^c[h>>>16&255]<<16^c[y>>>8&255]<<8^c[p&255]^t[++f],r[n?3:1]=c[h>>>24]<<24^c[y>>>16&255]<<16^c[p>>>8&255]<<8^c[d&255]^t[++f],r[2]=c[y>>>24]<<24^c[p>>>16&255]<<16^c[d>>>8&255]<<8^c[h&255]^t[++f],r[n?1:3]=c[p>>>24]<<24^c[d>>>16&255]<<16^c[h>>>8&255]<<8^c[y&255]^t[++f]}function js(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=E.cipher.createDecipher(r,t.key):n=E.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof E.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}var P9=E.des=E.des||{};E.des.startEncrypting=function(t,e,r,n){var i=qs({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i},E.des.createEncryptionCipher=function(t,e){return qs({key:t,output:null,decrypt:!1,mode:e})},E.des.startDecrypting=function(t,e,r,n){var i=qs({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i},E.des.createDecryptionCipher=function(t,e){return qs({key:t,output:null,decrypt:!0,mode:e})},E.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Gh(r._keys,n,i,!1)},decrypt:function(n,i){return Gh(r._keys,n,i,!0)}}}),r._init=!1},E.des.Algorithm.prototype.initialize=function(t){if(this._init)return;var e=E.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=d3(e),this._init=!0},Kr("DES-ECB",E.cipher.modes.ecb),Kr("DES-CBC",E.cipher.modes.cbc),Kr("DES-CFB",E.cipher.modes.cfb),Kr("DES-OFB",E.cipher.modes.ofb),Kr("DES-CTR",E.cipher.modes.ctr),Kr("3DES-ECB",E.cipher.modes.ecb),Kr("3DES-CBC",E.cipher.modes.cbc),Kr("3DES-CFB",E.cipher.modes.cfb),Kr("3DES-OFB",E.cipher.modes.ofb),Kr("3DES-CTR",E.cipher.modes.ctr);function Kr(t,e){var r=function(){return new E.des.Algorithm(t,e)};E.cipher.registerAlgorithm(t,r)}var r3=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],n3=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],i3=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],a3=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],s3=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],o3=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],c3=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],u3=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function d3(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],y=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],m=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],_=t.length()>8?3:1,I=[],f=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],k=0,R,g=0;g<_;g++){var x=t.getInt32(),N=t.getInt32();R=(x>>>4^N)&252645135,N^=R,x^=R<<4,R=(N>>>-16^x)&65535,x^=R,N^=R<<-16,R=(x>>>2^N)&858993459,N^=R,x^=R<<2,R=(N>>>-16^x)&65535,x^=R,N^=R<<-16,R=(x>>>1^N)&1431655765,N^=R,x^=R<<1,R=(N>>>8^x)&16711935,x^=R,N^=R<<8,R=(x>>>1^N)&1431655765,N^=R,x^=R<<1,R=x<<8|N>>>20&240,x=N<<24|N<<8&16711680|N>>>8&65280|N>>>24&240,N=R;for(var w=0;w<f.length;++w){f[w]?(x=x<<2|x>>>26,N=N<<2|N>>>26):(x=x<<1|x>>>27,N=N<<1|N>>>27),x&=-15,N&=-15;var T=e[x>>>28]|r[x>>>24&15]|n[x>>>20&15]|i[x>>>16&15]|a[x>>>12&15]|s[x>>>8&15]|o[x>>>4&15],D=u[N>>>28]|c[N>>>24&15]|d[N>>>20&15]|h[N>>>16&15]|y[N>>>12&15]|p[N>>>8&15]|m[N>>>4&15];R=(D>>>16^T)&65535,I[k++]=T^R,I[k++]=D^R<<16}}return I}function Gh(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],u=e[1];s=(o>>>4^u)&252645135,u^=s,o^=s<<4,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,o=o<<1|o>>>31,u=u<<1|u>>>31;for(var c=0;c<i;c+=3){for(var d=a[c+1],h=a[c+2],y=a[c];y!=d;y+=h){var p=u^t[y],m=(u>>>4|u<<28)^t[y+1];s=o,o=u,u=s^(n3[p>>>24&63]|a3[p>>>16&63]|o3[p>>>8&63]|u3[p&63]|r3[m>>>24&63]|i3[m>>>16&63]|s3[m>>>8&63]|c3[m&63])}s=o,o=u,u=s}o=o>>>1|o<<31,u=u>>>1|u<<31,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(o>>>4^u)&252645135,u^=s,o^=s<<4,r[0]=o,r[1]=u}function qs(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=E.cipher.createDecipher(r,t.key):n=E.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof E.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}var D9=E.md=E.md||{};E.md.algorithms=E.md.algorithms||{};var O9=Z(function(t){var e=t.exports=E.hmac=E.hmac||{};e.create=function(){var r=null,n=null,i=null,a=null,s={};return s.start=function(o,u){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in E.md.algorithms)n=E.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else n=o;if(u===null)u=r;else{if(typeof u=="string")u=E.util.createBuffer(u);else if(E.util.isArray(u)){var c=u;u=E.util.createBuffer();for(var d=0;d<c.length;++d)u.putByte(c[d])}var h=u.length();h>n.blockLength&&(n.start(),n.update(u.bytes()),u=n.digest()),i=E.util.createBuffer(),a=E.util.createBuffer(),h=u.length();for(var d=0;d<h;++d){var c=u.at(d);i.putByte(54^c),a.putByte(92^c)}if(h<n.blockLength)for(var c=n.blockLength-h,d=0;d<c;++d)i.putByte(54),a.putByte(92);r=u,i=i.bytes(),a=a.bytes()}n.start(),n.update(i)},s.update=function(o){n.update(o)},s.getMac=function(){var o=n.digest().bytes();return n.start(),n.update(a),n.update(o),n.digest()},s.digest=s.getMac,s}}),l3=E.pkcs5=E.pkcs5||{},sn;E.util.isNodejs&&!E.options.usePureJavaScript&&(sn=Yt);var f3=E.pbkdf2=l3.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),E.util.isNodejs&&!E.options.usePureJavaScript&&sn.pbkdf2&&(i===null||typeof i!="object")&&(sn.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?sn.pbkdf2Sync.length===4?sn.pbkdf2(t,e,r,n,function(R,g){if(R)return a(R);a(null,g.toString("binary"))}):sn.pbkdf2(t,e,r,n,i,function(R,g){if(R)return a(R);a(null,g.toString("binary"))}):sn.pbkdf2Sync.length===4?sn.pbkdf2Sync(t,e,r,n).toString("binary"):sn.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in E.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=E.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var u=Math.ceil(n/s),c=n-(u-1)*s,d=E.hmac.create();d.start(i,t);var h="",y,p,m;if(!a){for(var _=1;_<=u;++_){d.start(null,null),d.update(e),d.update(E.util.int32ToBytes(_)),y=m=d.digest().getBytes();for(var I=2;I<=r;++I)d.start(null,null),d.update(m),p=d.digest().getBytes(),y=E.util.xorBytes(y,p,s),m=p;h+=_<u?y:y.substr(0,c)}return h}var _=1,I;function f(){if(_>u)return a(null,h);d.start(null,null),d.update(e),d.update(E.util.int32ToBytes(_)),y=m=d.digest().getBytes(),I=2,k()}function k(){if(I<=r)return d.start(null,null),d.update(m),p=d.digest().getBytes(),y=E.util.xorBytes(y,p,s),m=p,++I,E.util.setImmediate(k);h+=_<u?y:y.substr(0,c),++_,f()}f()},B9=Z(function(t){var e=t.exports=E.pem=E.pem||{};e.encode=function(i,a){a=a||{};var s="-----BEGIN "+i.type+`-----\r
`,o;if(i.procType&&(o={name:"Proc-Type",values:[String(i.procType.version),i.procType.type]},s+=r(o)),i.contentDomain&&(o={name:"Content-Domain",values:[i.contentDomain]},s+=r(o)),i.dekInfo&&(o={name:"DEK-Info",values:[i.dekInfo.algorithm]},i.dekInfo.parameters&&o.values.push(i.dekInfo.parameters),s+=r(o)),i.headers)for(var u=0;u<i.headers.length;++u)s+=r(i.headers[u]);return i.procType&&(s+=`\r
`),s+=E.util.encode64(i.body,a.maxline||64)+`\r
`,s+="-----END "+i.type+`-----\r
`,s},e.decode=function(i){for(var a=[],s=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,o=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,u=/\r?\n/,c;!(c=s.exec(i),!c);){var d={type:c[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:E.util.decode64(c[3])};if(a.push(d),!c[2])continue;for(var h=c[2].split(u),y=0;c&&y<h.length;){for(var p=h[y].replace(/\s+$/,""),m=y+1;m<h.length;++m){var _=h[m];if(!/\s/.test(_[0]))break;p+=_,y=m}if(c=p.match(o),c){for(var I={name:c[1],values:[]},f=c[2].split(","),k=0;k<f.length;++k)I.values.push(n(f[k]));if(d.procType)if(!d.contentDomain&&I.name==="Content-Domain")d.contentDomain=f[0]||"";else if(!d.dekInfo&&I.name==="DEK-Info"){if(I.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');d.dekInfo={algorithm:f[0],parameters:f[1]||null}}else d.headers.push(I);else{if(I.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(I.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');d.procType={version:f[0],type:f[1]}}}++y}if(d.procType==="ENCRYPTED"&&!d.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}if(a.length===0)throw new Error("Invalid PEM formatted message.");return a};function r(i){for(var a=i.name+": ",s=[],o=function(y,p){return" "+p},u=0;u<i.values.length;++u)s.push(i.values[u].replace(/^(\S+\r\n)/,o));a+=s.join(",")+`\r
`;for(var c=0,d=-1,u=0;u<a.length;++u,++c)if(c>65&&d!==-1){var h=a[d];h===","?(++d,a=a.substr(0,d)+`\r
 `+a.substr(d)):a=a.substr(0,d)+`\r
`+h+a.substr(d+1),c=u-d-1,d=-1,++u}else(a[u]===" "||a[u]==="	"||a[u]===",")&&(d=u);return a}function n(i){return i.replace(/^\s+/,"")}}),M9=Z(function(t){var e=t.exports=E.sha256=E.sha256||{};E.md.sha256=E.md.algorithms.sha256=e,e.create=function(){n||a();var o=null,u=E.util.createBuffer(),c=new Array(64),d={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return d.start=function(){d.messageLength=0,d.fullMessageLength=d.messageLength64=[];for(var h=d.messageLengthSize/4,y=0;y<h;++y)d.fullMessageLength.push(0);return u=E.util.createBuffer(),o={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},d},d.start(),d.update=function(h,y){y==="utf8"&&(h=E.util.encodeUtf8(h));var p=h.length;d.messageLength+=p,p=[p/4294967296>>>0,p>>>0];for(var m=d.fullMessageLength.length-1;m>=0;--m)d.fullMessageLength[m]+=p[1],p[1]=p[0]+(d.fullMessageLength[m]/4294967296>>>0),d.fullMessageLength[m]=d.fullMessageLength[m]>>>0,p[0]=p[1]/4294967296>>>0;return u.putBytes(h),s(o,c,u),(u.read>2048||u.length()===0)&&u.compact(),d},d.digest=function(){var h=E.util.createBuffer();h.putBytes(u.bytes());var y=d.fullMessageLength[d.fullMessageLength.length-1]+d.messageLengthSize,p=y&d.blockLength-1;h.putBytes(r.substr(0,d.blockLength-p));for(var m,_,I=d.fullMessageLength[0]*8,f=0;f<d.fullMessageLength.length-1;++f)m=d.fullMessageLength[f+1]*8,_=m/4294967296>>>0,I+=_,h.putInt32(I>>>0),I=m>>>0;h.putInt32(I);var k={h0:o.h0,h1:o.h1,h2:o.h2,h3:o.h3,h4:o.h4,h5:o.h5,h6:o.h6,h7:o.h7};s(k,c,h);var R=E.util.createBuffer();return R.putInt32(k.h0),R.putInt32(k.h1),R.putInt32(k.h2),R.putInt32(k.h3),R.putInt32(k.h4),R.putInt32(k.h5),R.putInt32(k.h6),R.putInt32(k.h7),R},d};var r=null,n=!1,i=null;function a(){r=String.fromCharCode(128),r+=E.util.fillString(String.fromCharCode(0),64),i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=!0}function s(o,u,c){for(var d,h,y,p,m,_,I,f,k,R,g,x,N,w,T,D=c.length();D>=64;){for(I=0;I<16;++I)u[I]=c.getInt32();for(;I<64;++I)d=u[I-2],d=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,h=u[I-15],h=(h>>>7|h<<25)^(h>>>18|h<<14)^h>>>3,u[I]=d+u[I-7]+h+u[I-16]|0;for(f=o.h0,k=o.h1,R=o.h2,g=o.h3,x=o.h4,N=o.h5,w=o.h6,T=o.h7,I=0;I<64;++I)p=(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7),m=w^x&(N^w),y=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),_=f&k|R&(f^k),d=T+p+m+i[I]+u[I],h=y+_,T=w,w=N,N=x,x=g+d>>>0,g=R,R=k,k=f,f=d+h>>>0;o.h0=o.h0+f|0,o.h1=o.h1+k|0,o.h2=o.h2+R|0,o.h3=o.h3+g|0,o.h4=o.h4+x|0,o.h5=o.h5+N|0,o.h6=o.h6+w|0,o.h7=o.h7+T|0,D-=64}}}),L9=Z(function(t){var e=null;E.util.isNodejs&&!E.options.usePureJavaScript&&!bn.versions["node-webkit"]&&(e=Yt);var r=t.exports=E.prng=E.prng||{};r.create=function(n){for(var i={plugin:n,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},a=n.md,s=new Array(32),o=0;o<32;++o)s[o]=a.create();i.pools=s,i.pool=0,i.generate=function(y,p){if(!p)return i.generateSync(y);var m=i.plugin.cipher,_=i.plugin.increment,I=i.plugin.formatKey,f=i.plugin.formatSeed,k=E.util.createBuffer();i.key=null,R();function R(g){if(g)return p(g);if(k.length()>=y)return p(null,k.getBytes(y));if(i.generated>1048575&&(i.key=null),i.key===null)return E.util.nextTick(function(){u(R)});var x=m(i.key,i.seed);i.generated+=x.length,k.putBytes(x),i.key=I(m(i.key,_(i.seed))),i.seed=f(m(i.key,i.seed)),E.util.setImmediate(R)}},i.generateSync=function(y){var p=i.plugin.cipher,m=i.plugin.increment,_=i.plugin.formatKey,I=i.plugin.formatSeed;i.key=null;for(var f=E.util.createBuffer();f.length()<y;){i.generated>1048575&&(i.key=null),i.key===null&&c();var k=p(i.key,i.seed);i.generated+=k.length,f.putBytes(k),i.key=_(p(i.key,m(i.seed))),i.seed=I(p(i.key,i.seed))}return f.getBytes(y)};function u(y){if(i.pools[0].messageLength>=32)return d(),y();var p=32-i.pools[0].messageLength<<5;i.seedFile(p,function(m,_){if(m)return y(m);i.collect(_),d(),y()})}function c(){if(i.pools[0].messageLength>=32)return d();var y=32-i.pools[0].messageLength<<5;i.collect(i.seedFileSync(y)),d()}function d(){i.reseeds=i.reseeds===4294967295?0:i.reseeds+1;var y=i.plugin.md.create();y.update(i.keyBytes);for(var p=1,m=0;m<32;++m)i.reseeds%p===0&&(y.update(i.pools[m].digest().getBytes()),i.pools[m].start()),p=p<<1;i.keyBytes=y.digest().getBytes(),y.start(),y.update(i.keyBytes);var _=y.digest().getBytes();i.key=i.plugin.formatKey(i.keyBytes),i.seed=i.plugin.formatSeed(_),i.generated=0}function h(y){var p=null,m=E.util.globalScope,_=m.crypto||m.msCrypto;_&&_.getRandomValues&&(p=function(T){return _.getRandomValues(T)});var I=E.util.createBuffer();if(p)for(;I.length()<y;){var f=Math.max(1,Math.min(y-I.length(),65536)/4),k=new Uint32Array(Math.floor(f));try{p(k);for(var R=0;R<k.length;++R)I.putInt32(k[R])}catch(T){if(!(typeof QuotaExceededError!="undefined"&&T instanceof QuotaExceededError))throw T}}if(I.length()<y)for(var g,x,N,w=Math.floor(Math.random()*65536);I.length()<y;){x=16807*(w&65535),g=16807*(w>>16),x+=(g&32767)<<16,x+=g>>15,x=(x&2147483647)+(x>>31),w=x&4294967295;for(var R=0;R<3;++R)N=w>>>(R<<3),N^=Math.floor(Math.random()*256),I.putByte(String.fromCharCode(N&255))}return I.getBytes(y)}return e?(i.seedFile=function(y,p){e.randomBytes(y,function(m,_){if(m)return p(m);p(null,_.toString())})},i.seedFileSync=function(y){return e.randomBytes(y).toString()}):(i.seedFile=function(y,p){try{p(null,h(y))}catch(m){p(m)}},i.seedFileSync=h),i.collect=function(y){for(var p=y.length,m=0;m<p;++m)i.pools[i.pool].update(y.substr(m,1)),i.pool=i.pool===31?0:i.pool+1},i.collectInt=function(y,p){for(var m="",_=0;_<p;_+=8)m+=String.fromCharCode(y>>_&255);i.collect(m)},i.registerWorker=function(y){if(y===self)i.seedFile=function(m,_){function I(f){var k=f.data;k.forge&&k.forge.prng&&(self.removeEventListener("message",I),_(k.forge.prng.err,k.forge.prng.bytes))}self.addEventListener("message",I),self.postMessage({forge:{prng:{needed:m}}})};else{var p=function(m){var _=m.data;_.forge&&_.forge.prng&&i.seedFile(_.forge.prng.needed,function(I,f){y.postMessage({forge:{prng:{err:I,bytes:f}}})})};y.addEventListener("message",p)}},i}}),U9=Z(function(t){(function(){if(E.random&&E.random.getBytes){t.exports=E.random;return}(function(e){var r={},n=new Array(4),i=E.util.createBuffer();r.formatKey=function(y){var p=E.util.createBuffer(y);return y=new Array(4),y[0]=p.getInt32(),y[1]=p.getInt32(),y[2]=p.getInt32(),y[3]=p.getInt32(),E.aes._expandKey(y,!1)},r.formatSeed=function(y){var p=E.util.createBuffer(y);return y=new Array(4),y[0]=p.getInt32(),y[1]=p.getInt32(),y[2]=p.getInt32(),y[3]=p.getInt32(),y},r.cipher=function(y,p){return E.aes._updateBlock(y,p,n,!1),i.putInt32(n[0]),i.putInt32(n[1]),i.putInt32(n[2]),i.putInt32(n[3]),i.getBytes()},r.increment=function(y){return++y[3],y},r.md=E.md.sha256;function a(){var y=E.prng.create(r);return y.getBytes=function(p,m){return y.generate(p,m)},y.getBytesSync=function(p){return y.generate(p)},y}var s=a(),o=null,u=E.util.globalScope,c=u.crypto||u.msCrypto;if(c&&c.getRandomValues&&(o=function(y){return c.getRandomValues(y)}),!E.util.isNodejs&&!o){if(s.collectInt(+new Date,32),typeof navigator!="undefined"){var d="";for(var h in navigator)try{typeof navigator[h]=="string"&&(d+=navigator[h])}catch(y){}s.collect(d),d=null}e&&(e().mousemove(function(y){s.collectInt(y.clientX,16),s.collectInt(y.clientY,16)}),e().keypress(function(y){s.collectInt(y.charCode,8)}))}if(!E.random)E.random=s;else for(var h in s)E.random[h]=s[h];E.random.createInstance=a,t.exports=E.random})(typeof jQuery!="undefined"?jQuery:null)})()}),bu=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Hh=[1,2,3,5],h3=function(t,e){return t<<e&65535|(t&65535)>>16-e},p3=function(t,e){return(t&65535)>>e|t<<16-e&65535},K9=E.rc2=E.rc2||{};E.rc2.expandKey=function(t,e){typeof t=="string"&&(t=E.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(bu[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,bu[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,bu[r.at(o+1)^r.at(o+a)]);return r};var Wh=function(t,e,r){var n=!1,i=null,a=null,s=null,o,u,c,d,h=[];for(t=E.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(m){for(c=0;c<4;c++)m[c]+=h[d]+(m[(c+3)%4]&m[(c+2)%4])+(~m[(c+3)%4]&m[(c+1)%4]),m[c]=h3(m[c],Hh[c]),d++},u=function(m){for(c=0;c<4;c++)m[c]+=h[m[(c+3)%4]&63]}):(o=function(m){for(c=3;c>=0;c--)m[c]=p3(m[c],Hh[c]),m[c]-=h[d]+(m[(c+3)%4]&m[(c+2)%4])+(~m[(c+3)%4]&m[(c+1)%4]),d--},u=function(m){for(c=3;c>=0;c--)m[c]-=h[m[(c+3)%4]&63]});var y=function(m){var _=[];for(c=0;c<4;c++){var I=i.getInt16Le();s!==null&&(r?I^=s.getInt16Le():s.putInt16Le(I)),_.push(I&65535)}d=r?0:63;for(var f=0;f<m.length;f++)for(var k=0;k<m[f][0];k++)m[f][1](_);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(_[c]):_[c]^=s.getInt16Le()),a.putInt16Le(_[c])},p=null;return p={start:function(m,_){m&&(typeof m=="string"&&(m=E.util.createBuffer(m))),n=!1,i=E.util.createBuffer(),a=_||new E.util.createBuffer,s=m,p.output=a},update:function(m){for(n||i.putBuffer(m);i.length()>=8;)y([[5,o],[1,u],[6,o],[1,u],[5,o]])},finish:function(m){var _=!0;if(r)if(m)_=m(8,i,!r);else{var I=i.length()===8?8:8-i.length();i.fillWithByte(I,I)}if(_&&(n=!0,p.update()),!r&&(_=i.length()===0,_))if(m)_=m(8,a,!r);else{var f=a.length(),k=a.at(f-1);k>f?_=!1:a.truncate(k)}return _}},p};E.rc2.startEncrypting=function(t,e,r){var n=E.rc2.createEncryptionCipher(t,128);return n.start(e,r),n},E.rc2.createEncryptionCipher=function(t,e){return Wh(t,e,!0)},E.rc2.startDecrypting=function(t,e,r){var n=E.rc2.createDecryptionCipher(t,128);return n.start(e,r),n},E.rc2.createDecryptionCipher=function(t,e){return Wh(t,e,!1)};var F9=E.jsbn=E.jsbn||{},on;function $(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}E.jsbn.BigInteger=$;function Ae(){return new $(null)}function m3(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function b3(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var u=this.data[t]&32767,c=this.data[t++]>>15,d=o*u+c*s;u=s*u+((d&32767)<<15)+r.data[n]+(i&1073741823),i=(u>>>30)+(d>>>15)+o*c+(i>>>30),r.data[n++]=u&1073741823}return i}function Yh(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var u=this.data[t]&16383,c=this.data[t++]>>14,d=o*u+c*s;u=s*u+((d&16383)<<14)+r.data[n]+i,i=(u>>28)+(d>>14)+o*c,r.data[n++]=u&268435455}return i}typeof navigator=="undefined"?($.prototype.am=Yh,on=28):navigator.appName=="Microsoft Internet Explorer"?($.prototype.am=b3,on=30):navigator.appName!="Netscape"?($.prototype.am=m3,on=26):($.prototype.am=Yh,on=28),$.prototype.DB=on,$.prototype.DM=(1<<on)-1,$.prototype.DV=1<<on;var yu=52;$.prototype.FV=Math.pow(2,yu),$.prototype.F1=yu-on,$.prototype.F2=2*on-yu;var y3="0123456789abcdefghijklmnopqrstuvwxyz",Vs=new Array,$i,rr;for($i="0".charCodeAt(0),rr=0;rr<=9;++rr)Vs[$i++]=rr;for($i="a".charCodeAt(0),rr=10;rr<36;++rr)Vs[$i++]=rr;for($i="A".charCodeAt(0),rr=10;rr<36;++rr)Vs[$i++]=rr;function Xh(t){return y3.charAt(t)}function Qh(t,e){var r=Vs[t.charCodeAt(e)];return r??-1}function g3(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function v3(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Dn(t){var e=Ae();return e.fromInt(t),e}function w3(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:Qh(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&$.ZERO.subTo(this,this)}function E3(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function x3(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=Xh(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=Xh(n));return i?a:"0"}function S3(){var t=Ae();return $.ZERO.subTo(this,t),t}function A3(){return this.s<0?this.negate():this}function I3(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function zs(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function k3(){return this.t<=0?0:this.DB*(this.t-1)+zs(this.data[this.t-1]^this.s&this.DM)}function T3(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function C3(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function _3(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function R3(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function N3(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function P3(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&$.ZERO.subTo(e,e)}function D3(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function O3(t,e,r){var n=t.abs();if(n.t<=0)return;var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Ae());var a=Ae(),s=this.s,o=t.s,u=this.DB-zs(n.data[n.t-1]);u>0?(n.lShiftTo(u,a),i.lShiftTo(u,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,d=a.data[c-1];if(d==0)return;var h=d*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),y=this.FV/h,p=(1<<this.F1)/h,m=1<<this.F2,_=r.t,I=_-c,f=e??Ae();for(a.dlShiftTo(I,f),r.compareTo(f)>=0&&(r.data[r.t++]=1,r.subTo(f,r)),$.ONE.dlShiftTo(c,f),f.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--I>=0;){var k=r.data[--_]==d?this.DM:Math.floor(r.data[_]*y+(r.data[_-1]+m)*p);if((r.data[_]+=a.am(0,k,r,I,0,c))<k)for(a.dlShiftTo(I,f),r.subTo(f,r);r.data[_]<--k;)r.subTo(f,r)}e!=null&&(r.drShiftTo(c,e),s!=o&&$.ZERO.subTo(e,e)),r.t=c,r.clamp(),u>0&&r.rShiftTo(u,r),s<0&&$.ZERO.subTo(r,r)}function B3(t){var e=Ae();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo($.ZERO)>0&&t.subTo(e,e),e}function oi(t){this.m=t}function M3(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function L3(t){return t}function U3(t){t.divRemTo(this.m,null,t)}function K3(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function F3(t,e){t.squareTo(e),this.reduce(e)}oi.prototype.convert=M3,oi.prototype.revert=L3,oi.prototype.reduce=U3,oi.prototype.mulTo=K3,oi.prototype.sqrTo=F3;function j3(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function ci(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function q3(t){var e=Ae();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo($.ZERO)>0&&this.m.subTo(e,e),e}function V3(t){var e=Ae();return t.copyTo(e),this.reduce(e),e}function z3(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function $3(t,e){t.squareTo(e),this.reduce(e)}function G3(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ci.prototype.convert=q3,ci.prototype.revert=V3,ci.prototype.reduce=z3,ci.prototype.mulTo=G3,ci.prototype.sqrTo=$3;function H3(){return(this.t>0?this.data[0]&1:this.s)==0}function W3(t,e){if(t>4294967295||t<1)return $.ONE;var r=Ae(),n=Ae(),i=e.convert(this),a=zs(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Y3(t,e){var r;return t<256||e.isEven()?r=new oi(e):r=new ci(e),this.exp(t,r)}$.prototype.copyTo=g3,$.prototype.fromInt=v3,$.prototype.fromString=w3,$.prototype.clamp=E3,$.prototype.dlShiftTo=T3,$.prototype.drShiftTo=C3,$.prototype.lShiftTo=_3,$.prototype.rShiftTo=R3,$.prototype.subTo=N3,$.prototype.multiplyTo=P3,$.prototype.squareTo=D3,$.prototype.divRemTo=O3,$.prototype.invDigit=j3,$.prototype.isEven=H3,$.prototype.exp=W3,$.prototype.toString=x3,$.prototype.negate=S3,$.prototype.abs=A3,$.prototype.compareTo=I3,$.prototype.bitLength=k3,$.prototype.mod=B3,$.prototype.modPowInt=Y3,$.ZERO=Dn(0),$.ONE=Dn(1);function X3(){var t=Ae();return this.copyTo(t),t}function Q3(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function J3(){return this.t==0?this.s:this.data[0]<<24>>24}function Z3(){return this.t==0?this.s:this.data[0]<<16>>16}function eS(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function tS(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function rS(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Dn(r),i=Ae(),a=Ae(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function nS(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var u=Qh(t,o);if(u<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+u,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&$.ZERO.subTo(this,this)}function iS(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo($.ONE.shiftLeft(t-1),gu,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo($.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function aS(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function sS(t){return this.compareTo(t)==0}function oS(t){return this.compareTo(t)<0?this:t}function cS(t){return this.compareTo(t)>0?this:t}function uS(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function dS(t,e){return t&e}function lS(t){var e=Ae();return this.bitwiseTo(t,dS,e),e}function gu(t,e){return t|e}function fS(t){var e=Ae();return this.bitwiseTo(t,gu,e),e}function Jh(t,e){return t^e}function hS(t){var e=Ae();return this.bitwiseTo(t,Jh,e),e}function Zh(t,e){return t&~e}function pS(t){var e=Ae();return this.bitwiseTo(t,Zh,e),e}function mS(){for(var t=Ae(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function bS(t){var e=Ae();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function yS(t){var e=Ae();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function gS(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function vS(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+gS(this.data[t]);return this.s<0?this.t*this.DB:-1}function wS(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function ES(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=wS(this.data[r]^e);return t}function xS(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function SS(t,e){var r=$.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function AS(t){return this.changeBit(t,gu)}function IS(t){return this.changeBit(t,Zh)}function kS(t){return this.changeBit(t,Jh)}function TS(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function CS(t){var e=Ae();return this.addTo(t,e),e}function _S(t){var e=Ae();return this.subTo(t,e),e}function RS(t){var e=Ae();return this.multiplyTo(t,e),e}function NS(t){var e=Ae();return this.divRemTo(t,e,null),e}function PS(t){var e=Ae();return this.divRemTo(t,null,e),e}function DS(t){var e=Ae(),r=Ae();return this.divRemTo(t,e,r),new Array(e,r)}function OS(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function BS(t,e){if(t==0)return;for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}function Wa(){}function ep(t){return t}function MS(t,e,r){t.multiplyTo(e,r)}function LS(t,e){t.squareTo(e)}Wa.prototype.convert=ep,Wa.prototype.revert=ep,Wa.prototype.mulTo=MS,Wa.prototype.sqrTo=LS;function US(t){return this.exp(t,new Wa)}function KS(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function FS(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Gi(t){this.r2=Ae(),this.q3=Ae(),$.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function jS(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Ae();return t.copyTo(e),this.reduce(e),e}function qS(t){return t}function VS(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function zS(t,e){t.squareTo(e),this.reduce(e)}function $S(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Gi.prototype.convert=jS,Gi.prototype.revert=qS,Gi.prototype.reduce=VS,Gi.prototype.mulTo=$S,Gi.prototype.sqrTo=zS;function GS(t,e){var r=t.bitLength(),n,i=Dn(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new oi(e):e.isEven()?a=new Gi(e):a=new ci(e);var s=new Array,o=3,u=n-1,c=(1<<n)-1;if(s[1]=a.convert(this),n>1){var d=Ae();for(a.sqrTo(s[1],d);o<=c;)s[o]=Ae(),a.mulTo(d,s[o-2],s[o]),o+=2}var h=t.t-1,y,p=!0,m=Ae(),_;for(r=zs(t.data[h])-1;h>=0;){for(r>=u?y=t.data[h]>>r-u&c:(y=(t.data[h]&(1<<r+1)-1)<<u-r,h>0&&(y|=t.data[h-1]>>this.DB+r-u)),o=n;(y&1)==0;)y>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),p)s[y].copyTo(i),p=!1;else{for(;o>1;)a.sqrTo(i,m),a.sqrTo(m,i),o-=2;o>0?a.sqrTo(i,m):(_=i,i=m,m=_),a.mulTo(m,s[y],i)}for(;h>=0&&(t.data[h]&1<<r)==0;)a.sqrTo(i,m),_=i,i=m,m=_,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function HS(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function WS(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function YS(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return $.ZERO;for(var r=t.clone(),n=this.clone(),i=Dn(1),a=Dn(0),s=Dn(0),o=Dn(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo($.ONE)!=0)return $.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var vr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],XS=(1<<26)/vr[vr.length-1];function QS(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=vr[vr.length-1]){for(e=0;e<vr.length;++e)if(r.data[0]==vr[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<vr.length;){for(var n=vr[e],i=e+1;i<vr.length&&n<XS;)n*=vr[i++];for(n=r.modInt(n);e<i;)if(n%vr[e++]==0)return!1}return r.millerRabin(t)}function JS(t){var e=this.subtract($.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=ZS(),a,s=0;s<t;++s){do a=new $(this.bitLength(),i);while(a.compareTo($.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo($.ONE)!=0&&o.compareTo(e)!=0){for(var u=1;u++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo($.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function ZS(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}$.prototype.chunkSize=eS,$.prototype.toRadix=rS,$.prototype.fromRadix=nS,$.prototype.fromNumber=iS,$.prototype.bitwiseTo=uS,$.prototype.changeBit=SS,$.prototype.addTo=TS,$.prototype.dMultiply=OS,$.prototype.dAddOffset=BS,$.prototype.multiplyLowerTo=KS,$.prototype.multiplyUpperTo=FS,$.prototype.modInt=WS,$.prototype.millerRabin=JS,$.prototype.clone=X3,$.prototype.intValue=Q3,$.prototype.byteValue=J3,$.prototype.shortValue=Z3,$.prototype.signum=tS,$.prototype.toByteArray=aS,$.prototype.equals=sS,$.prototype.min=oS,$.prototype.max=cS,$.prototype.and=lS,$.prototype.or=fS,$.prototype.xor=hS,$.prototype.andNot=pS,$.prototype.not=mS,$.prototype.shiftLeft=bS,$.prototype.shiftRight=yS,$.prototype.getLowestSetBit=vS,$.prototype.bitCount=ES,$.prototype.testBit=xS,$.prototype.setBit=AS,$.prototype.clearBit=IS,$.prototype.flipBit=kS,$.prototype.add=CS,$.prototype.subtract=_S,$.prototype.multiply=RS,$.prototype.divide=NS,$.prototype.remainder=PS,$.prototype.divideAndRemainder=DS,$.prototype.modPow=GS,$.prototype.modInverse=YS,$.prototype.pow=US,$.prototype.gcd=HS,$.prototype.isProbablePrime=QS;var j9=Z(function(t){var e=t.exports=E.sha1=E.sha1||{};E.md.sha1=E.md.algorithms.sha1=e,e.create=function(){n||i();var s=null,o=E.util.createBuffer(),u=new Array(80),c={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength64=[];for(var d=c.messageLengthSize/4,h=0;h<d;++h)c.fullMessageLength.push(0);return o=E.util.createBuffer(),s={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},c},c.start(),c.update=function(d,h){h==="utf8"&&(d=E.util.encodeUtf8(d));var y=d.length;c.messageLength+=y,y=[y/4294967296>>>0,y>>>0];for(var p=c.fullMessageLength.length-1;p>=0;--p)c.fullMessageLength[p]+=y[1],y[1]=y[0]+(c.fullMessageLength[p]/4294967296>>>0),c.fullMessageLength[p]=c.fullMessageLength[p]>>>0,y[0]=y[1]/4294967296>>>0;return o.putBytes(d),a(s,u,o),(o.read>2048||o.length()===0)&&o.compact(),c},c.digest=function(){var d=E.util.createBuffer();d.putBytes(o.bytes());var h=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,y=h&c.blockLength-1;d.putBytes(r.substr(0,c.blockLength-y));for(var p,m,_=c.fullMessageLength[0]*8,I=0;I<c.fullMessageLength.length-1;++I)p=c.fullMessageLength[I+1]*8,m=p/4294967296>>>0,_+=m,d.putInt32(_>>>0),_=p>>>0;d.putInt32(_);var f={h0:s.h0,h1:s.h1,h2:s.h2,h3:s.h3,h4:s.h4};a(f,u,d);var k=E.util.createBuffer();return k.putInt32(f.h0),k.putInt32(f.h1),k.putInt32(f.h2),k.putInt32(f.h3),k.putInt32(f.h4),k},c};var r=null,n=!1;function i(){r=String.fromCharCode(128),r+=E.util.fillString(String.fromCharCode(0),64),n=!0}function a(s,o,u){for(var c,d,h,y,p,m,_,I,f=u.length();f>=64;){for(d=s.h0,h=s.h1,y=s.h2,p=s.h3,m=s.h4,I=0;I<16;++I)c=u.getInt32(),o[I]=c,_=p^h&(y^p),c=(d<<5|d>>>27)+_+m+1518500249+c,m=p,p=y,y=(h<<30|h>>>2)>>>0,h=d,d=c;for(;I<20;++I)c=o[I-3]^o[I-8]^o[I-14]^o[I-16],c=c<<1|c>>>31,o[I]=c,_=p^h&(y^p),c=(d<<5|d>>>27)+_+m+1518500249+c,m=p,p=y,y=(h<<30|h>>>2)>>>0,h=d,d=c;for(;I<32;++I)c=o[I-3]^o[I-8]^o[I-14]^o[I-16],c=c<<1|c>>>31,o[I]=c,_=h^y^p,c=(d<<5|d>>>27)+_+m+1859775393+c,m=p,p=y,y=(h<<30|h>>>2)>>>0,h=d,d=c;for(;I<40;++I)c=o[I-6]^o[I-16]^o[I-28]^o[I-32],c=c<<2|c>>>30,o[I]=c,_=h^y^p,c=(d<<5|d>>>27)+_+m+1859775393+c,m=p,p=y,y=(h<<30|h>>>2)>>>0,h=d,d=c;for(;I<60;++I)c=o[I-6]^o[I-16]^o[I-28]^o[I-32],c=c<<2|c>>>30,o[I]=c,_=h&y|p&(h^y),c=(d<<5|d>>>27)+_+m+2400959708+c,m=p,p=y,y=(h<<30|h>>>2)>>>0,h=d,d=c;for(;I<80;++I)c=o[I-6]^o[I-16]^o[I-28]^o[I-32],c=c<<2|c>>>30,o[I]=c,_=h^y^p,c=(d<<5|d>>>27)+_+m+3395469782+c,m=p,p=y,y=(h<<30|h>>>2)>>>0,h=d,d=c;s.h0=s.h0+d|0,s.h1=s.h1+h|0,s.h2=s.h2+y|0,s.h3=s.h3+p|0,s.h4=s.h4+m|0,f-=64}}}),q9=Z(function(t){var e=t.exports=E.pkcs1=E.pkcs1||{};e.encode_rsa_oaep=function(n,i,a){var s,o,u,c;typeof a=="string"?(s=a,o=arguments[3]||void 0,u=arguments[4]||void 0):a&&(s=a.label||void 0,o=a.seed||void 0,u=a.md||void 0,a.mgf1&&a.mgf1.md&&(c=a.mgf1.md)),u?u.start():u=E.md.sha1.create(),c||(c=u);var d=Math.ceil(n.n.bitLength()/8),h=d-2*u.digestLength-2;if(i.length>h){var y=new Error("RSAES-OAEP input message length is too long.");throw y.length=i.length,y.maxLength=h,y}s||(s=""),u.update(s,"raw");for(var p=u.digest(),m="",_=h-i.length,I=0;I<_;I++)m+="\0";var f=p.getBytes()+m+""+i;if(!o)o=E.random.getBytes(u.digestLength);else if(o.length!==u.digestLength){var y=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw y.seedLength=o.length,y.digestLength=u.digestLength,y}var k=r(o,d-u.digestLength-1,c),R=E.util.xorBytes(f,k,f.length),g=r(R,u.digestLength,c),x=E.util.xorBytes(o,g,o.length);return"\0"+x+R},e.decode_rsa_oaep=function(n,i,a){var s,o,u;typeof a=="string"?(s=a,o=arguments[3]||void 0):a&&(s=a.label||void 0,o=a.md||void 0,a.mgf1&&a.mgf1.md&&(u=a.mgf1.md));var c=Math.ceil(n.n.bitLength()/8);if(i.length!==c){var R=new Error("RSAES-OAEP encoded message length is invalid.");throw R.length=i.length,R.expectedLength=c,R}if(o===void 0?o=E.md.sha1.create():o.start(),u||(u=o),c<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");s||(s=""),o.update(s,"raw");for(var d=o.digest().getBytes(),h=i.charAt(0),y=i.substring(1,o.digestLength+1),p=i.substring(1+o.digestLength),m=r(p,o.digestLength,u),_=E.util.xorBytes(y,m,y.length),I=r(_,c-o.digestLength-1,u),f=E.util.xorBytes(p,I,p.length),k=f.substring(0,o.digestLength),R=h!=="\0",g=0;g<o.digestLength;++g)R|=d.charAt(g)!==k.charAt(g);for(var x=1,N=o.digestLength,w=o.digestLength;w<f.length;w++){var T=f.charCodeAt(w),D=T&1^1,v=x?65534:0;R|=T&v,x=x&D,N+=x}if(R||f.charCodeAt(N)!==1)throw new Error("Invalid RSAES-OAEP padding.");return f.substring(N+1)};function r(n,i,a){a||(a=E.md.sha1.create());for(var s="",o=Math.ceil(i/a.digestLength),u=0;u<o;++u){var c=String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255);a.start(),a.update(n+c),s+=a.digest().getBytes()}return s.substring(0,i)}}),V9=Z(function(t){(function(){if(E.prime){t.exports=E.prime;return}var e=t.exports=E.prime=E.prime||{},r=E.jsbn.BigInteger,n=[6,4,2,4,2,4,6,2],i=new r(null);i.fromInt(30);var a=function(y,p){return y|p};e.generateProbablePrime=function(y,p,m){typeof p=="function"&&(m=p,p={}),p=p||{};var _=p.algorithm||"PRIMEINC";typeof _=="string"&&(_={name:_}),_.options=_.options||{};var I=p.prng||E.random,f={nextBytes:function(k){for(var R=I.getBytesSync(k.length),g=0;g<k.length;++g)k[g]=R.charCodeAt(g)}};if(_.name==="PRIMEINC")return s(y,f,_.options,m);throw new Error("Invalid prime generation algorithm: "+_.name)};function s(y,p,m,_){return"workers"in m?c(y,p,m,_):o(y,p,m,_)}function o(y,p,m,_){var I=d(y,p),f=0,k=h(I.bitLength());"millerRabinTests"in m&&(k=m.millerRabinTests);var R=10;"maxBlockTime"in m&&(R=m.maxBlockTime),u(I,y,p,f,k,R,_)}function u(y,p,m,_,I,f,k){var R=+new Date;do{if(y.bitLength()>p&&(y=d(p,m)),y.isProbablePrime(I))return k(null,y);y.dAddOffset(n[_++%8],0)}while(f<0||+new Date-R<f);E.util.setImmediate(function(){u(y,p,m,_,I,f,k)})}function c(y,p,m,_){if(typeof Worker=="undefined")return o(y,p,m,_);var I=d(y,p),f=m.workers,k=m.workLoad||100,R=k*30/8,g=m.workerScript||"forge/prime.worker.js";if(f===-1)return E.util.estimateCores(function(N,w){N&&(w=2),f=w-1,x()});x();function x(){f=Math.max(1,f);for(var N=[],w=0;w<f;++w)N[w]=new Worker(g);for(var w=0;w<f;++w)N[w].addEventListener("message",D);var T=!1;function D(v){if(T)return;var l=v.data;if(l.found){for(var b=0;b<N.length;++b)N[b].terminate();return T=!0,_(null,new r(l.prime,16))}I.bitLength()>y&&(I=d(y,p));var A=I.toString(16);v.target.postMessage({hex:A,workLoad:k}),I.dAddOffset(R,0)}}}function d(y,p){var m=new r(y,p),_=y-1;return m.testBit(_)||m.bitwiseTo(r.ONE.shiftLeft(_),a,m),m.dAddOffset(31-m.mod(i).byteValue(),0),m}function h(y){return y<=100?27:y<=150?18:y<=200?15:y<=250?12:y<=300?9:y<=350?8:y<=400?7:y<=500?6:y<=600?5:y<=800?4:y<=1250?3:2}})()});if(typeof Ie=="undefined")var Ie=E.jsbn.BigInteger;var vu=E.util.isNodejs?Yt:null,U=E.asn1,nr=E.util;E.pki=E.pki||{};var z9=E.pki.rsa=E.rsa=E.rsa||{},ue=E.pki,e5=[6,4,2,4,2,4,6,2],t5={name:"PrivateKeyInfo",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},r5={name:"RSAPrivateKey",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},n5={name:"RSAPublicKey",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},i5=E.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:U.Class.UNIVERSAL,type:U.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},a5=function(t){var e;if(t.algorithm in ue.oids)e=ue.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=U.oidToDer(e).getBytes(),i=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[]),a=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[]);a.value.push(U.create(U.Class.UNIVERSAL,U.Type.OID,!1,n)),a.value.push(U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,""));var s=U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),U.toDer(i).getBytes()},tp=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Ie.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Ie.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Ie(E.util.bytesToHex(E.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Ie.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};ue.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=rp(t,e,r)):(i=E.util.createBuffer(),i.putBytes(t));for(var s=new Ie(i.toHex(),16),o=tp(s,e,n),u=o.toString(16),c=E.util.createBuffer(),d=a-Math.ceil(u.length/2);d>0;)c.putByte(0),--d;return c.putBytes(E.util.hexToBytes(u)),c.getBytes()},ue.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new Ie(E.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=tp(s,e,r),u=o.toString(16),c=E.util.createBuffer(),d=i-Math.ceil(u.length/2);d>0;)c.putByte(0),--d;return c.putBytes(E.util.hexToBytes(u)),n!==!1?$s(c.getBytes(),e,r):c.getBytes()},ue.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||E.random,i={nextBytes:function(o){for(var u=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=u.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new Ie(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s},ue.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Ie(null);r.fromInt(30);for(var n=0,i=function(h,y){return h|y},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var u=t.p===null?t.pBits:t.qBits,c=u-1;t.pqState===0?(t.num=new Ie(u,t.rng),t.num.testBit(c)||t.num.bitwiseTo(Ie.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>u?t.pqState=0:t.num.isProbablePrime(o5(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(e5[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Ie.ONE).gcd(t.e).compareTo(Ie.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Ie.ONE),t.q1=t.q.subtract(Ie.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Ie.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var d=t.e.modInverse(t.phi);t.keys={privateKey:ue.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:ue.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null},ue.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(np("generateKeyPair"))return vu.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,u,c){if(o)return n(o);n(null,{privateKey:ue.privateKeyFromPem(c),publicKey:ue.publicKeyFromPem(u)})});if(ip("generateKey")&&ip("exportKey"))return nr.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:sp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return nr.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var u=ue.privateKeyFromAsn1(U.fromDer(E.util.createBuffer(o)));n(null,{privateKey:u,publicKey:ue.setRsaPublicKey(u.n,u.e)})}});if(ap("generateKey")&&ap("exportKey")){var i=nr.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:sp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var u=o.target.result,c=nr.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);c.oncomplete=function(d){var h=d.target.result,y=ue.privateKeyFromAsn1(U.fromDer(E.util.createBuffer(h)));n(null,{privateKey:y,publicKey:ue.setRsaPublicKey(y.n,y.e)})},c.onerror=function(d){n(d)}},i.onerror=function(o){n(o)};return}}else if(np("generateKeyPairSync")){var a=vu.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ue.privateKeyFromPem(a.privateKey),publicKey:ue.publicKeyFromPem(a.publicKey)}}}var s=ue.rsa.createKeyPairGenerationState(t,e,r);if(!n)return ue.rsa.stepKeyPairGenerationState(s,0),s.keys;s5(s,r,n)},ue.setRsaPublicKey=ue.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,u,c){return rp(o,u,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,u){return E.pkcs1.encode_rsa_oaep(u,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return ue.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),a==="RSASSA-PKCS1-V1_5"?a={verify:function(o,u){u=$s(u,r,!0);var c=U.fromDer(u);return o===c.value[1].value}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(o,u){return u=$s(u,r,!0),o===u}});var s=ue.rsa.decrypt(i,r,!0,!1);return a.verify(n,s,r.n.bitLength())},r},ue.setRsaPrivateKey=ue.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var u={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return u.decrypt=function(c,d,h){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var y=ue.rsa.decrypt(c,u,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:$s};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(p,m){return E.pkcs1.decode_rsa_oaep(m,p,h)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(y,u,!1)},u.sign=function(c,d){var h=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:a5},h=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return c}},h=1);var y=d.encode(c,u.n.bitLength());return ue.rsa.encrypt(y,u,h)},u},ue.wrapRsaPrivateKey=function(t){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(0).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(ue.oids.rsaEncryption).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,U.toDer(t).getBytes())])},ue.privateKeyFromAsn1=function(t){var e={},r=[];if(U.validate(t,t5,e,r)&&(t=U.fromDer(E.util.createBuffer(e.privateKey))),e={},r=[],!U.validate(t,r5,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,u,c,d,h;return i=E.util.createBuffer(e.privateKeyModulus).toHex(),a=E.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=E.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=E.util.createBuffer(e.privateKeyPrime1).toHex(),u=E.util.createBuffer(e.privateKeyPrime2).toHex(),c=E.util.createBuffer(e.privateKeyExponent1).toHex(),d=E.util.createBuffer(e.privateKeyExponent2).toHex(),h=E.util.createBuffer(e.privateKeyCoefficient).toHex(),ue.setRsaPrivateKey(new Ie(i,16),new Ie(a,16),new Ie(s,16),new Ie(o,16),new Ie(u,16),new Ie(c,16),new Ie(d,16),new Ie(h,16))},ue.privateKeyToAsn1=ue.privateKeyToRSAPrivateKey=function(t){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(0).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.n)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.e)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.d)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.p)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.q)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.dP)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.dQ)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.qInv))])},ue.publicKeyFromAsn1=function(t){var e={},r=[];if(U.validate(t,i5,e,r)){var n=U.derToOid(e.publicKeyOid);if(n!==ue.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!U.validate(t,n5,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=E.util.createBuffer(e.publicKeyModulus).toHex(),s=E.util.createBuffer(e.publicKeyExponent).toHex();return ue.setRsaPublicKey(new Ie(a,16),new Ie(s,16))},ue.publicKeyToAsn1=ue.publicKeyToSubjectPublicKeyInfo=function(t){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(ue.oids.rsaEncryption).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]),U.create(U.Class.UNIVERSAL,U.Type.BITSTRING,!1,[ue.publicKeyToRSAPublicKey(t)])])},ue.publicKeyToRSAPublicKey=function(t){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.n)),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Fr(t.e))])};function rp(t,e,r){var n=E.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var u=0;u<s;++u)n.putByte(o)}else for(;s>0;){for(var c=0,d=E.random.getBytes(s),u=0;u<s;++u)o=d.charCodeAt(u),o===0?++c:n.putByte(o);s=c}return n.putByte(0),n.putBytes(t),n}function $s(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=E.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var u=0;if(o===0){u=i-3-n;for(var c=0;c<u;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(u=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++u}else if(o===2)for(u=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++u}var d=a.getByte();if(d!==0||u!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function s5(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,u){if(o)return r(o);if(t.p=u,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,u){E.prime.generateProbablePrime(o,n,u)}function s(o,u){if(o)return r(o);if(t.q=u,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(Ie.ONE).gcd(t.e).compareTo(Ie.ONE)!==0){t.p=null,i();return}if(t.q.subtract(Ie.ONE).gcd(t.e).compareTo(Ie.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(Ie.ONE),t.q1=t.q.subtract(Ie.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Ie.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var d=t.e.modInverse(t.phi);t.keys={privateKey:ue.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:ue.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Fr(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=E.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function o5(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function np(t){return E.util.isNodejs&&typeof vu[t]=="function"}function ip(t){return typeof nr.globalScope!="undefined"&&typeof nr.globalScope.crypto=="object"&&typeof nr.globalScope.crypto.subtle=="object"&&typeof nr.globalScope.crypto.subtle[t]=="function"}function ap(t){return typeof nr.globalScope!="undefined"&&typeof nr.globalScope.msCrypto=="object"&&typeof nr.globalScope.msCrypto.subtle=="object"&&typeof nr.globalScope.msCrypto.subtle[t]=="function"}function sp(t){for(var e=E.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}if(typeof c5=="undefined")var c5=E.jsbn.BigInteger;var F=E.asn1,de=E.pki=E.pki||{},$9=de.pbe=E.pbe=E.pbe||{},ui=de.oids,u5={name:"EncryptedPrivateKeyInfo",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},d5={name:"PBES2Algorithms",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:F.Class.UNIVERSAL,type:F.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l5={name:"pkcs-12PbeParams",tagClass:F.Class.UNIVERSAL,type:F.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:F.Class.UNIVERSAL,type:F.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:F.Class.UNIVERSAL,type:F.Type.INTEGER,constructed:!1,capture:"iterations"}]};de.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=E.random.getBytesSync(r.saltSize),i=r.count,a=F.integerToDer(i),s,o,u;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,d,h;switch(r.algorithm){case"aes128":s=16,c=16,d=ui["aes128-CBC"],h=E.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,d=ui["aes192-CBC"],h=E.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,d=ui["aes256-CBC"],h=E.aes.createEncryptionCipher;break;case"des":s=8,c=8,d=ui.desCBC,h=E.des.createEncryptionCipher;break;default:var y=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw y.algorithm=r.algorithm,y}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),m=up(p),_=E.pkcs5.pbkdf2(e,n,i,s,m),I=E.random.getBytesSync(c),f=h(_);f.start(I),f.update(F.toDer(t)),f.finish(),u=f.output.getBytes();var k=f5(n,a,s,p);o=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ui.pkcs5PBES2).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ui.pkcs5PBKDF2).getBytes()),k]),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(d).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,I)])])])}else if(r.algorithm==="3des"){s=24;var R=new E.util.ByteBuffer(n),_=de.pbe.generatePkcs12Key(e,R,1,i,s),I=de.pbe.generatePkcs12Key(e,R,2,i,s),f=E.des.createEncryptionCipher(_);f.start(I),f.update(F.toDer(t)),f.finish(),u=f.output.getBytes(),o=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(ui["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,n),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,a.getBytes())])])}else{var y=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw y.algorithm=r.algorithm,y}var g=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[o,F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,u)]);return g},de.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!F.validate(t,u5,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=F.derToOid(n.encryptionOid),o=de.pbe.getCipher(s,n.encryptionParams,e),u=E.util.createBuffer(n.encryptedData);return o.update(u),o.finish()&&(r=F.fromDer(o.output)),r},de.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:F.toDer(t).getBytes()};return E.pem.encode(r,{maxline:e})},de.encryptedPrivateKeyFromPem=function(t){var e=E.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return F.fromDer(e.body)},de.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=de.wrapRsaPrivateKey(de.privateKeyToAsn1(t));return n=de.encryptPrivateKeyInfo(n,e,r),de.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=E.random.getBytesSync(16),o=E.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=E.random.getBytesSync(16),o=E.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=E.random.getBytesSync(16),o=E.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=E.random.getBytesSync(8),o=E.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=E.random.getBytesSync(8),o=E.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var c=E.pbe.opensslDeriveBytes(e,a.substr(0,8),s),d=o(c);d.start(a),d.update(F.toDer(de.privateKeyToAsn1(t))),d.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:E.util.bytesToHex(a).toUpperCase()},body:d.output.getBytes()};return E.pem.encode(h)},de.decryptRsaPrivateKey=function(t,e){var r=null,n=E.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=E.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=E.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=E.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=E.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=E.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return E.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return E.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return E.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=E.util.hexToBytes(n.dekInfo.parameters),u=E.pbe.opensslDeriveBytes(e,o.substr(0,8),a),c=s(u);if(c.start(o),c.update(E.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=de.decryptPrivateKeyInfo(F.fromDer(r),e):r=F.fromDer(r),r!==null&&(r=de.privateKeyFromAsn1(r)),r},de.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a=="undefined"||a===null){if(!("sha1"in E.md))throw new Error('"sha1" hash algorithm unavailable.');a=E.md.sha1.create()}var u=a.digestLength,c=a.blockLength,d=new E.util.ByteBuffer,h=new E.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var y=h.length(),p=e.length(),m=new E.util.ByteBuffer;m.fillWithByte(r,c);var _=c*Math.ceil(p/c),I=new E.util.ByteBuffer;for(o=0;o<_;o++)I.putByte(e.at(o%p));var f=c*Math.ceil(y/c),k=new E.util.ByteBuffer;for(o=0;o<f;o++)k.putByte(h.at(o%y));var R=I;R.putBuffer(k);for(var g=Math.ceil(i/u),x=1;x<=g;x++){var N=new E.util.ByteBuffer;N.putBytes(m.bytes()),N.putBytes(R.bytes());for(var w=0;w<n;w++)a.start(),a.update(N.getBytes()),N=a.digest();var T=new E.util.ByteBuffer;for(o=0;o<c;o++)T.putByte(N.at(o%u));var D=Math.ceil(p/c)+Math.ceil(y/c),v=new E.util.ByteBuffer;for(s=0;s<D;s++){var l=new E.util.ByteBuffer(R.getBytes(c)),b=511;for(o=T.length()-1;o>=0;o--)b=b>>8,b+=T.at(o)+l.at(o),l.setAt(o,b&255);v.putBuffer(l)}R=v,d.putBuffer(N)}return d.truncate(d.length()-i),d},de.pbe.getCipher=function(t,e,r){switch(t){case de.oids.pkcs5PBES2:return de.pbe.getCipherForPBES2(t,e,r);case de.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case de.oids["pbewithSHAAnd40BitRC2-CBC"]:return de.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},de.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!F.validate(e,d5,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=F.derToOid(n.kdfOid),t!==de.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=F.derToOid(n.encOid),t!==de.oids["aes128-CBC"]&&t!==de.oids["aes192-CBC"]&&t!==de.oids["aes256-CBC"]&&t!==de.oids["des-EDE3-CBC"]&&t!==de.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=E.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var u,c;switch(de.oids[t]){case"aes128-CBC":u=16,c=E.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,c=E.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,c=E.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,c=E.des.createDecryptionCipher;break;case"desCBC":u=8,c=E.des.createDecryptionCipher;break}var d=cp(n.prfOid),h=E.pkcs5.pbkdf2(r,s,o,u,d),y=n.encIv,p=c(h);return p.start(y),p},de.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!F.validate(e,l5,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=E.util.createBuffer(n.salt),o=E.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var u,c,d;switch(t){case de.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,c=8,d=E.des.startDecrypting;break;case de.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,c=8,d=function(_,I){var f=E.rc2.createDecryptionCipher(_,40);return f.start(I,null),f};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=cp(n.prfOid),y=de.pbe.generatePkcs12Key(r,s,1,o,u,h);h.start();var p=de.pbe.generatePkcs12Key(r,s,2,o,c,h);return d(y,p)},de.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in E.md))throw new Error('"md5" hash algorithm unavailable.');n=E.md.md5.create()}e===null&&(e="");for(var i=[op(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(op(n,i[s-1]+t+e));return i.join("").substr(0,r)};function op(t,e){return t.start().update(e).digest().getBytes()}function cp(t){var e;if(!t)e="hmacWithSHA1";else if(e=de.oids[F.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return up(e)}function up(t){var e=E.md;switch(t){case"hmacWithSHA224":e=E.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function f5(t,e,r,n){var i=F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OCTETSTRING,!1,t),F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(F.create(F.Class.UNIVERSAL,F.Type.INTEGER,!1,E.util.hexToBytes(r.toString(16))),F.create(F.Class.UNIVERSAL,F.Type.SEQUENCE,!0,[F.create(F.Class.UNIVERSAL,F.Type.OID,!1,F.oidToDer(de.oids[n]).getBytes()),F.create(F.Class.UNIVERSAL,F.Type.NULL,!1,"")])),i}var h5=(t=self)=>{const e=t.crypto||t.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e},Pt={get:h5};function p5({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:a=32767}={}){const s=Pt.get();r*=8;async function o(c,d){const h=s.getRandomValues(new Uint8Array(i)),y=s.getRandomValues(new Uint8Array(e)),p={name:t,iv:y},m={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},_=await s.subtle.importKey("raw",le(d),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),I=await s.subtle.deriveKey(m,_,{name:t,length:r},!0,["encrypt"]),f=await s.subtle.encrypt(p,I,c);return Bt([h,p.iv,new Uint8Array(f)])}async function u(c,d){const h=c.slice(0,i),y=c.slice(i,i+e),p=c.slice(i+e),m={name:t,iv:y},_={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},I=await s.subtle.importKey("raw",le(d),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),f=await s.subtle.deriveKey(_,I,{name:t,length:r},!0,["decrypt"]),k=await s.subtle.decrypt(m,f,p);return new Uint8Array(k)}return{encrypt:o,decrypt:u}}var dp={create:p5},m5={import:async function(t,e){const r=Mr.names.base64,n=r.decode(t),i=dp.create();return await i.decrypt(n,e)}};const Ya=self.crypto||self.msCrypto,wu=async(t,e)=>{if(typeof self=="undefined"||!self.crypto&&!self.msCrypto)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");switch(e){case"sha1":return new Uint8Array(await Ya.subtle.digest({name:"SHA-1"},t));case"sha2-256":return new Uint8Array(await Ya.subtle.digest({name:"SHA-256"},t));case"sha2-512":return new Uint8Array(await Ya.subtle.digest({name:"SHA-512"},t));case"dbl-sha2-256":{const r=await Ya.subtle.digest({name:"SHA-256"},t);return new Uint8Array(await Ya.subtle.digest({name:"SHA-256"},r))}default:throw new Error(`${e} is not a supported algorithm`)}};var On={factory:t=>async e=>wu(e,t),digest:wu,multihashing:async(t,e,r)=>{const n=await wu(t,e);return Xt.encode(n,e,r)}},G9=Z(function(t){var e=t.exports=E.sha512=E.sha512||{};E.md.sha512=E.md.algorithms.sha512=e;var r=E.sha384=E.sha512.sha384=E.sha512.sha384||{};r.create=function(){return e.create("SHA-384")},E.md.sha384=E.md.algorithms.sha384=r,E.sha512.sha256=E.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},E.md["sha512/256"]=E.md.algorithms["sha512/256"]=E.sha512.sha256,E.sha512.sha224=E.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},E.md["sha512/224"]=E.md.algorithms["sha512/224"]=E.sha512.sha224,e.create=function(c){if(i||o(),typeof c=="undefined"&&(c="SHA-512"),!(c in s))throw new Error("Invalid SHA-512 algorithm: "+c);for(var d=s[c],h=null,y=E.util.createBuffer(),p=new Array(80),m=0;m<80;++m)p[m]=new Array(2);var _=64;switch(c){case"SHA-384":_=48;break;case"SHA-512/256":_=32;break;case"SHA-512/224":_=28;break}var I={algorithm:c.replace("-","").toLowerCase(),blockLength:128,digestLength:_,messageLength:0,fullMessageLength:null,messageLengthSize:16};return I.start=function(){I.messageLength=0,I.fullMessageLength=I.messageLength128=[];for(var f=I.messageLengthSize/4,k=0;k<f;++k)I.fullMessageLength.push(0);y=E.util.createBuffer(),h=new Array(d.length);for(var k=0;k<d.length;++k)h[k]=d[k].slice(0);return I},I.start(),I.update=function(f,k){k==="utf8"&&(f=E.util.encodeUtf8(f));var R=f.length;I.messageLength+=R,R=[R/4294967296>>>0,R>>>0];for(var g=I.fullMessageLength.length-1;g>=0;--g)I.fullMessageLength[g]+=R[1],R[1]=R[0]+(I.fullMessageLength[g]/4294967296>>>0),I.fullMessageLength[g]=I.fullMessageLength[g]>>>0,R[0]=R[1]/4294967296>>>0;return y.putBytes(f),u(h,p,y),(y.read>2048||y.length()===0)&&y.compact(),I},I.digest=function(){var f=E.util.createBuffer();f.putBytes(y.bytes());var k=I.fullMessageLength[I.fullMessageLength.length-1]+I.messageLengthSize,R=k&I.blockLength-1;f.putBytes(n.substr(0,I.blockLength-R));for(var g,x,N=I.fullMessageLength[0]*8,w=0;w<I.fullMessageLength.length-1;++w)g=I.fullMessageLength[w+1]*8,x=g/4294967296>>>0,N+=x,f.putInt32(N>>>0),N=g>>>0;f.putInt32(N);for(var T=new Array(h.length),w=0;w<h.length;++w)T[w]=h[w].slice(0);u(T,p,f);var D=E.util.createBuffer(),v;c==="SHA-512"?v=T.length:c==="SHA-384"?v=T.length-2:v=T.length-4;for(var w=0;w<v;++w)D.putInt32(T[w][0]),(w!==v-1||c!=="SHA-512/224")&&D.putInt32(T[w][1]);return D},I};var n=null,i=!1,a=null,s=null;function o(){n=String.fromCharCode(128),n+=E.util.fillString(String.fromCharCode(0),128),a=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],s={},s["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],s["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],s["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],s["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],i=!0}function u(c,d,h){for(var y,p,m,_,I,f,k,R,g,x,N,w,T,D,v,l,b,A,C,P,O,L,B,S,M,q,z,G,j,H,V,we,ee,ne,Ee,ie=h.length();ie>=128;){for(j=0;j<16;++j)d[j][0]=h.getInt32()>>>0,d[j][1]=h.getInt32()>>>0;for(;j<80;++j)we=d[j-2],H=we[0],V=we[1],y=((H>>>19|V<<13)^(V>>>29|H<<3)^H>>>6)>>>0,p=((H<<13|V>>>19)^(V<<3|H>>>29)^(H<<26|V>>>6))>>>0,ne=d[j-15],H=ne[0],V=ne[1],m=((H>>>1|V<<31)^(H>>>8|V<<24)^H>>>7)>>>0,_=((H<<31|V>>>1)^(H<<24|V>>>8)^(H<<25|V>>>7))>>>0,ee=d[j-7],Ee=d[j-16],V=p+ee[1]+_+Ee[1],d[j][0]=y+ee[0]+m+Ee[0]+(V/4294967296>>>0)>>>0,d[j][1]=V>>>0;for(T=c[0][0],D=c[0][1],v=c[1][0],l=c[1][1],b=c[2][0],A=c[2][1],C=c[3][0],P=c[3][1],O=c[4][0],L=c[4][1],B=c[5][0],S=c[5][1],M=c[6][0],q=c[6][1],z=c[7][0],G=c[7][1],j=0;j<80;++j)k=((O>>>14|L<<18)^(O>>>18|L<<14)^(L>>>9|O<<23))>>>0,R=((O<<18|L>>>14)^(O<<14|L>>>18)^(L<<23|O>>>9))>>>0,g=(M^O&(B^M))>>>0,x=(q^L&(S^q))>>>0,I=((T>>>28|D<<4)^(D>>>2|T<<30)^(D>>>7|T<<25))>>>0,f=((T<<4|D>>>28)^(D<<30|T>>>2)^(D<<25|T>>>7))>>>0,N=(T&v|b&(T^v))>>>0,w=(D&l|A&(D^l))>>>0,V=G+R+x+a[j][1]+d[j][1],y=z+k+g+a[j][0]+d[j][0]+(V/4294967296>>>0)>>>0,p=V>>>0,V=f+w,m=I+N+(V/4294967296>>>0)>>>0,_=V>>>0,z=M,G=q,M=B,q=S,B=O,S=L,V=P+p,O=C+y+(V/4294967296>>>0)>>>0,L=V>>>0,C=b,P=A,b=v,A=l,v=T,l=D,V=p+_,T=y+m+(V/4294967296>>>0)>>>0,D=V>>>0;V=c[0][1]+D,c[0][0]=c[0][0]+T+(V/4294967296>>>0)>>>0,c[0][1]=V>>>0,V=c[1][1]+l,c[1][0]=c[1][0]+v+(V/4294967296>>>0)>>>0,c[1][1]=V>>>0,V=c[2][1]+A,c[2][0]=c[2][0]+b+(V/4294967296>>>0)>>>0,c[2][1]=V>>>0,V=c[3][1]+P,c[3][0]=c[3][0]+C+(V/4294967296>>>0)>>>0,c[3][1]=V>>>0,V=c[4][1]+L,c[4][0]=c[4][0]+O+(V/4294967296>>>0)>>>0,c[4][1]=V>>>0,V=c[5][1]+S,c[5][0]=c[5][0]+B+(V/4294967296>>>0)>>>0,c[5][1]=V>>>0,V=c[6][1]+q,c[6][0]=c[6][0]+M+(V/4294967296>>>0)>>>0,c[6][1]=V>>>0,V=c[7][1]+G,c[7][0]=c[7][0]+z+(V/4294967296>>>0)>>>0,c[7][1]=V>>>0,ie-=128}}}),kt=E.asn1,b5={name:"PrivateKeyInfo",tagClass:kt.Class.UNIVERSAL,type:kt.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:kt.Class.UNIVERSAL,type:kt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:kt.Class.UNIVERSAL,type:kt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:kt.Class.UNIVERSAL,type:kt.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:kt.Class.UNIVERSAL,type:kt.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},y5={name:"SubjectPublicKeyInfo",tagClass:kt.Class.UNIVERSAL,type:kt.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:kt.Class.UNIVERSAL,type:kt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:kt.Class.UNIVERSAL,type:kt.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:kt.Class.UNIVERSAL,type:kt.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},lp={privateKeyValidator:b5,publicKeyValidator:y5},g5=lp.publicKeyValidator,v5=lp.privateKeyValidator;if(typeof w5=="undefined")var w5=E.jsbn.BigInteger;var Eu=E.util.ByteBuffer,$t=typeof Buffer=="undefined"?Uint8Array:Buffer;E.pki=E.pki||{};var H9=E.pki.ed25519=E.ed25519=E.ed25519||{},me=E.ed25519;me.constants={},me.constants.PUBLIC_KEY_BYTE_LENGTH=32,me.constants.PRIVATE_KEY_BYTE_LENGTH=64,me.constants.SEED_BYTE_LENGTH=32,me.constants.SIGN_BYTE_LENGTH=64,me.constants.HASH_BYTE_LENGTH=64,me.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=E.random.getBytesSync(me.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==me.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+me.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=cn({message:e,encoding:"binary"});for(var r=new $t(me.constants.PUBLIC_KEY_BYTE_LENGTH),n=new $t(me.constants.PRIVATE_KEY_BYTE_LENGTH),i=0;i<32;++i)n[i]=e[i];return A5(r,n),{publicKey:r,privateKey:n}},me.privateKeyFromAsn1=function(t){var e={},r=[],n=E.asn1.validate(t,v5,e,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var a=E.asn1.derToOid(e.privateKeyOid),s=E.oids.EdDSA25519;if(a!==s)throw new Error('Invalid OID "'+a+'"; OID must be "'+s+'".');var o=e.privateKey,u=cn({message:E.asn1.fromDer(o).value,encoding:"binary"});return{privateKeyBytes:u}},me.publicKeyFromAsn1=function(t){var e={},r=[],n=E.asn1.validate(t,g5,e,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var a=E.asn1.derToOid(e.publicKeyOid),s=E.oids.EdDSA25519;if(a!==s)throw new Error('Invalid OID "'+a+'"; OID must be "'+s+'".');var o=e.ed25519PublicKey;if(o.length!==me.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return cn({message:o,encoding:"binary"})},me.publicKeyFromPrivateKey=function(t){t=t||{};var e=cn({message:t.privateKey,encoding:"binary"});if(e.length!==me.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+me.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new $t(me.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=e[32+n];return r},me.sign=function(t){t=t||{};var e=cn(t),r=cn({message:t.privateKey,encoding:"binary"});if(r.length===me.constants.SEED_BYTE_LENGTH){var n=me.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==me.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+me.constants.SEED_BYTE_LENGTH+" or "+me.constants.PRIVATE_KEY_BYTE_LENGTH);var i=new $t(me.constants.SIGN_BYTE_LENGTH+e.length);I5(i,e,e.length,r);for(var a=new $t(me.constants.SIGN_BYTE_LENGTH),s=0;s<a.length;++s)a[s]=i[s];return a},me.verify=function(t){t=t||{};var e=cn(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=cn({message:t.signature,encoding:"binary"});if(r.length!==me.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+me.constants.SIGN_BYTE_LENGTH);var n=cn({message:t.publicKey,encoding:"binary"});if(n.length!==me.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+me.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new $t(me.constants.SIGN_BYTE_LENGTH+e.length),a=new $t(me.constants.SIGN_BYTE_LENGTH+e.length),s;for(s=0;s<me.constants.SIGN_BYTE_LENGTH;++s)i[s]=r[s];for(s=0;s<e.length;++s)i[s+me.constants.SIGN_BYTE_LENGTH]=e[s];return k5(a,i,i.length,n)>=0};function cn(t){var e=t.message;if(e instanceof Uint8Array||e instanceof $t)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,r);e=new Eu(e,r)}else if(!(e instanceof Eu))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new $t(e.length()),i=0;i<n.length;++i)n[i]=e.at(i);return n}var xu=re(),Gs=re([1]),E5=re([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),x5=re([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),fp=re([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),hp=re([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Su=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),S5=re([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Xa(t,e){var r=E.md.sha512.create(),n=new Eu(t);r.update(n.getBytes(e),"binary");var i=r.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(i,"binary");for(var a=new $t(me.constants.HASH_BYTE_LENGTH),s=0;s<64;++s)a[s]=i.charCodeAt(s);return a}function A5(t,e){var r=[re(),re(),re(),re()],n,i=Xa(e,32);for(i[0]&=248,i[31]&=127,i[31]|=64,Tu(r,i),ku(t,r),n=0;n<32;++n)e[n+32]=t[n];return 0}function I5(t,e,r,n){var i,a,s=new Float64Array(64),o=[re(),re(),re(),re()],u=Xa(n,32);u[0]&=248,u[31]&=127,u[31]|=64;var c=r+64;for(i=0;i<r;++i)t[64+i]=e[i];for(i=0;i<32;++i)t[32+i]=u[32+i];var d=Xa(t.subarray(32),r+32);for(Au(d),Tu(o,d),ku(t,o),i=32;i<64;++i)t[i]=n[i];var h=Xa(t,r+64);for(Au(h),i=32;i<64;++i)s[i]=0;for(i=0;i<32;++i)s[i]=d[i];for(i=0;i<32;++i)for(a=0;a<32;a++)s[i+a]+=h[i]*u[a];return pp(t.subarray(32),s),c}function k5(t,e,r,n){var i,a,s=new $t(32),o=[re(),re(),re(),re()],u=[re(),re(),re(),re()];if(a=-1,r<64)return-1;if(T5(u,n))return-1;for(i=0;i<r;++i)t[i]=e[i];for(i=0;i<32;++i)t[i+32]=n[i];var c=Xa(t,r);if(Au(c),vp(o,u,c),Tu(u,e.subarray(32)),Iu(o,u),ku(s,o),r-=64,yp(e,0,s,0)){for(i=0;i<r;++i)t[i]=0;return-1}for(i=0;i<r;++i)t[i]=e[i+64];return a=r,a}function pp(t,e){var r,n,i,a;for(n=63;n>=32;--n){for(r=0,i=n-32,a=n-12;i<a;++i)e[i]+=r-16*e[n]*Su[i-(n-32)],r=e[i]+128>>8,e[i]-=r*256;e[i]+=r,e[n]=0}for(r=0,i=0;i<32;++i)e[i]+=r-(e[31]>>4)*Su[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;++i)e[i]-=r*Su[i];for(n=0;n<32;++n)e[n+1]+=e[n]>>8,t[n]=e[n]&255}function Au(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;pp(t,e)}function Iu(t,e){var r=re(),n=re(),i=re(),a=re(),s=re(),o=re(),u=re(),c=re(),d=re();Wi(r,t[1],t[0]),Wi(d,e[1],e[0]),_e(r,r,d),Hi(n,t[0],t[1]),Hi(d,e[0],e[1]),_e(n,n,d),_e(i,t[3],e[3]),_e(i,i,x5),_e(a,t[2],e[2]),Hi(a,a,a),Wi(s,n,r),Wi(o,a,i),Hi(u,a,i),Hi(c,n,r),_e(t[0],s,o),_e(t[1],c,u),_e(t[2],u,o),_e(t[3],s,c)}function mp(t,e,r){for(var n=0;n<4;++n)wp(t[n],e[n],r)}function ku(t,e){var r=re(),n=re(),i=re();N5(i,e[2]),_e(r,e[0],i),_e(n,e[1],i),Hs(t,n),t[31]^=gp(r)<<7}function Hs(t,e){var r,n,i,a=re(),s=re();for(r=0;r<16;++r)s[r]=e[r];for(Cu(s),Cu(s),Cu(s),n=0;n<2;++n){for(a[0]=s[0]-65517,r=1;r<15;++r)a[r]=s[r]-65535-(a[r-1]>>16&1),a[r-1]&=65535;a[15]=s[15]-32767-(a[14]>>16&1),i=a[15]>>16&1,a[14]&=65535,wp(s,a,1-i)}for(r=0;r<16;r++)t[2*r]=s[r]&255,t[2*r+1]=s[r]>>8}function T5(t,e){var r=re(),n=re(),i=re(),a=re(),s=re(),o=re(),u=re();return Bn(t[2],Gs),C5(t[1],e),di(i,t[1]),_e(a,i,E5),Wi(i,i,t[2]),Hi(a,t[2],a),di(s,a),di(o,s),_e(u,o,s),_e(r,u,i),_e(r,r,a),_5(r,r),_e(r,r,i),_e(r,r,a),_e(r,r,a),_e(t[0],r,a),di(n,t[0]),_e(n,n,a),bp(n,i)&&_e(t[0],t[0],S5),di(n,t[0]),_e(n,n,a),bp(n,i)?-1:(gp(t[0])===e[31]>>7&&Wi(t[0],xu,t[0]),_e(t[3],t[0],t[1]),0)}function C5(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function _5(t,e){var r=re(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=250;n>=0;--n)di(r,r),n!==1&&_e(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function bp(t,e){var r=new $t(32),n=new $t(32);return Hs(r,t),Hs(n,e),yp(r,0,n,0)}function yp(t,e,r,n){return R5(t,e,r,n,32)}function R5(t,e,r,n,i){var a,s=0;for(a=0;a<i;++a)s|=t[e+a]^r[n+a];return(1&s-1>>>8)-1}function gp(t){var e=new $t(32);return Hs(e,t),e[0]&1}function vp(t,e,r){var n,i;for(Bn(t[0],xu),Bn(t[1],Gs),Bn(t[2],Gs),Bn(t[3],xu),i=255;i>=0;--i)n=r[i/8|0]>>(i&7)&1,mp(t,e,n),Iu(e,t),Iu(t,t),mp(t,e,n)}function Tu(t,e){var r=[re(),re(),re(),re()];Bn(r[0],fp),Bn(r[1],hp),Bn(r[2],Gs),_e(r[3],fp,hp),vp(t,r,e)}function Bn(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}function N5(t,e){var r=re(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=253;n>=0;--n)di(r,r),n!==2&&n!==4&&_e(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function Cu(t){var e,r,n=1;for(e=0;e<16;++e)r=t[e]+n+65535,n=Math.floor(r/65536),t[e]=r-n*65536;t[0]+=n-1+37*(n-1)}function wp(t,e,r){for(var n,i=~(r-1),a=0;a<16;++a)n=i&(t[a]^e[a]),t[a]^=n,e[a]^=n}function re(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}function Hi(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]+r[n]}function Wi(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]-r[n]}function di(t,e){_e(t,e,e)}function _e(t,e,r){var n,i,a=0,s=0,o=0,u=0,c=0,d=0,h=0,y=0,p=0,m=0,_=0,I=0,f=0,k=0,R=0,g=0,x=0,N=0,w=0,T=0,D=0,v=0,l=0,b=0,A=0,C=0,P=0,O=0,L=0,B=0,S=0,M=r[0],q=r[1],z=r[2],G=r[3],j=r[4],H=r[5],V=r[6],we=r[7],ee=r[8],ne=r[9],Ee=r[10],ie=r[11],te=r[12],ge=r[13],X=r[14],he=r[15];n=e[0],a+=n*M,s+=n*q,o+=n*z,u+=n*G,c+=n*j,d+=n*H,h+=n*V,y+=n*we,p+=n*ee,m+=n*ne,_+=n*Ee,I+=n*ie,f+=n*te,k+=n*ge,R+=n*X,g+=n*he,n=e[1],s+=n*M,o+=n*q,u+=n*z,c+=n*G,d+=n*j,h+=n*H,y+=n*V,p+=n*we,m+=n*ee,_+=n*ne,I+=n*Ee,f+=n*ie,k+=n*te,R+=n*ge,g+=n*X,x+=n*he,n=e[2],o+=n*M,u+=n*q,c+=n*z,d+=n*G,h+=n*j,y+=n*H,p+=n*V,m+=n*we,_+=n*ee,I+=n*ne,f+=n*Ee,k+=n*ie,R+=n*te,g+=n*ge,x+=n*X,N+=n*he,n=e[3],u+=n*M,c+=n*q,d+=n*z,h+=n*G,y+=n*j,p+=n*H,m+=n*V,_+=n*we,I+=n*ee,f+=n*ne,k+=n*Ee,R+=n*ie,g+=n*te,x+=n*ge,N+=n*X,w+=n*he,n=e[4],c+=n*M,d+=n*q,h+=n*z,y+=n*G,p+=n*j,m+=n*H,_+=n*V,I+=n*we,f+=n*ee,k+=n*ne,R+=n*Ee,g+=n*ie,x+=n*te,N+=n*ge,w+=n*X,T+=n*he,n=e[5],d+=n*M,h+=n*q,y+=n*z,p+=n*G,m+=n*j,_+=n*H,I+=n*V,f+=n*we,k+=n*ee,R+=n*ne,g+=n*Ee,x+=n*ie,N+=n*te,w+=n*ge,T+=n*X,D+=n*he,n=e[6],h+=n*M,y+=n*q,p+=n*z,m+=n*G,_+=n*j,I+=n*H,f+=n*V,k+=n*we,R+=n*ee,g+=n*ne,x+=n*Ee,N+=n*ie,w+=n*te,T+=n*ge,D+=n*X,v+=n*he,n=e[7],y+=n*M,p+=n*q,m+=n*z,_+=n*G,I+=n*j,f+=n*H,k+=n*V,R+=n*we,g+=n*ee,x+=n*ne,N+=n*Ee,w+=n*ie,T+=n*te,D+=n*ge,v+=n*X,l+=n*he,n=e[8],p+=n*M,m+=n*q,_+=n*z,I+=n*G,f+=n*j,k+=n*H,R+=n*V,g+=n*we,x+=n*ee,N+=n*ne,w+=n*Ee,T+=n*ie,D+=n*te,v+=n*ge,l+=n*X,b+=n*he,n=e[9],m+=n*M,_+=n*q,I+=n*z,f+=n*G,k+=n*j,R+=n*H,g+=n*V,x+=n*we,N+=n*ee,w+=n*ne,T+=n*Ee,D+=n*ie,v+=n*te,l+=n*ge,b+=n*X,A+=n*he,n=e[10],_+=n*M,I+=n*q,f+=n*z,k+=n*G,R+=n*j,g+=n*H,x+=n*V,N+=n*we,w+=n*ee,T+=n*ne,D+=n*Ee,v+=n*ie,l+=n*te,b+=n*ge,A+=n*X,C+=n*he,n=e[11],I+=n*M,f+=n*q,k+=n*z,R+=n*G,g+=n*j,x+=n*H,N+=n*V,w+=n*we,T+=n*ee,D+=n*ne,v+=n*Ee,l+=n*ie,b+=n*te,A+=n*ge,C+=n*X,P+=n*he,n=e[12],f+=n*M,k+=n*q,R+=n*z,g+=n*G,x+=n*j,N+=n*H,w+=n*V,T+=n*we,D+=n*ee,v+=n*ne,l+=n*Ee,b+=n*ie,A+=n*te,C+=n*ge,P+=n*X,O+=n*he,n=e[13],k+=n*M,R+=n*q,g+=n*z,x+=n*G,N+=n*j,w+=n*H,T+=n*V,D+=n*we,v+=n*ee,l+=n*ne,b+=n*Ee,A+=n*ie,C+=n*te,P+=n*ge,O+=n*X,L+=n*he,n=e[14],R+=n*M,g+=n*q,x+=n*z,N+=n*G,w+=n*j,T+=n*H,D+=n*V,v+=n*we,l+=n*ee,b+=n*ne,A+=n*Ee,C+=n*ie,P+=n*te,O+=n*ge,L+=n*X,B+=n*he,n=e[15],g+=n*M,x+=n*q,N+=n*z,w+=n*G,T+=n*j,D+=n*H,v+=n*V,l+=n*we,b+=n*ee,A+=n*ne,C+=n*Ee,P+=n*ie,O+=n*te,L+=n*ge,B+=n*X,S+=n*he,a+=38*x,s+=38*N,o+=38*w,u+=38*T,c+=38*D,d+=38*v,h+=38*l,y+=38*b,p+=38*A,m+=38*C,_+=38*P,I+=38*O,f+=38*L,k+=38*B,R+=38*S,i=1,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=_+i+65535,i=Math.floor(n/65536),_=n-i*65536,n=I+i+65535,i=Math.floor(n/65536),I=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=k+i+65535,i=Math.floor(n/65536),k=n-i*65536,n=R+i+65535,i=Math.floor(n/65536),R=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,a+=i-1+37*(i-1),i=1,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=_+i+65535,i=Math.floor(n/65536),_=n-i*65536,n=I+i+65535,i=Math.floor(n/65536),I=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=k+i+65535,i=Math.floor(n/65536),k=n-i*65536,n=R+i+65535,i=Math.floor(n/65536),R=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,a+=i-1+37*(i-1),t[0]=a,t[1]=s,t[2]=o,t[3]=u,t[4]=c,t[5]=d,t[6]=h,t[7]=y,t[8]=p,t[9]=m,t[10]=_,t[11]=I,t[12]=f,t[13]=k,t[14]=R,t[15]=g}var P5=Z(function(t){const e=self.crypto||self.msCrypto,{Buffer:r}=At,n=65536;function i(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}e&&e.getRandomValues?t.exports=a:t.exports=i;function a(s){const o=new Uint8Array(s);let u=0;if(s>0)if(s>n)for(;u<s;)u+n>s?(e.getRandomValues(o.subarray(u,u+(s-u))),u+=s-u):(e.getRandomValues(o.subarray(u,u+n)),u+=n);else e.getRandomValues(o);return r.from(o)}}),_u=function(t){if(isNaN(t)||t<=0)throw K(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return P5(t)},Ru=Z(function(t,e){e.bigIntegerToUintBase64url=(r,n)=>{let i=Uint8Array.from(r.abs().toByteArray());if(i=i[0]===0?i.slice(1):i,n!=null){if(i.length>n)throw new Error("byte array longer than desired length");i=Bt([new Uint8Array(n-i.length),i])}return se(i,"base64url")},e.base64urlToBigInteger=r=>{const n=e.base64urlToBuffer(r);return new E.jsbn.BigInteger(se(n,"base16"),16)},e.base64urlToBuffer=(r,n)=>{let i=le(r,"base64urlpad");if(n!=null){if(i.length>n)throw new Error("byte array longer than desired length");i=Bt([new Uint8Array(n-i.length),i])}return i}});const{bigIntegerToUintBase64url:jr,base64urlToBigInteger:qr}=Ru;var D5=function(t){const e=E.asn1.fromDer(se(t,"ascii")),r=E.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:jr(r.n),e:jr(r.e),d:jr(r.d),p:jr(r.p),q:jr(r.q),dp:jr(r.dP),dq:jr(r.dQ),qi:jr(r.qInv),alg:"RS256",kid:"2011-04-29"}},O5=function(t){const e=E.pki.privateKeyToAsn1({n:qr(t.n),e:qr(t.e),d:qr(t.d),p:qr(t.p),q:qr(t.q),dP:qr(t.dp),dQ:qr(t.dq),qInv:qr(t.qi)});return le(E.asn1.toDer(e).getBytes(),"ascii")},B5=function(t){const e=E.asn1.fromDer(se(t,"ascii")),r=E.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:jr(r.n),e:jr(r.e),alg:"RS256",kid:"2011-04-29"}},M5=function(t){const e=E.pki.publicKeyToAsn1({n:qr(t.n),e:qr(t.e)});return le(E.asn1.toDer(e).getBytes(),"ascii")},L5={pkcs1ToJwk:D5,jwkToPkcs1:O5,pkixToJwk:B5,jwkToPkix:M5};const{base64urlToBigInteger:U5}=Ru;function Ep(t,e){return e.map(r=>U5(t[r]))}function K5(t){return E.pki.setRsaPrivateKey(...Ep(t,["n","e","d","p","q","dp","dq","qi"]))}function F5(t){return E.pki.setRsaPublicKey(...Ep(t,["n","e"]))}var j5={jwk2pub:F5,jwk2priv:K5},q5=L5,V5=async function(t){const e=await Pt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await xp(e);return{privateKey:r[0],publicKey:r[1]}},z5=async function(t){const e=await Pt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),r=[e,await W5(t)],n=await xp({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}},$5=_u,G5=async function(t,e){const r=await Pt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Pt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)},H5=async function(t,e,r){const n=await Pt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Pt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function xp(t){return Promise.all([Pt.get().subtle.exportKey("jwk",t.privateKey),Pt.get().subtle.exportKey("jwk",t.publicKey)])}function W5(t){return Pt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}const{jwk2pub:Y5,jwk2priv:X5}=j5;function Sp(t,e,r,n){const i=e?Y5(t):X5(t),a=se(Uint8Array.from(r),"ascii"),s=n(a,i);return le(s,"ascii")}var Q5=function(t,e){return Sp(t,!0,e,(r,n)=>n.encrypt(r))},J5=function(t,e){return Sp(t,!1,e,(r,n)=>n.decrypt(r))},ir={utils:q5,generateKey:V5,unmarshalPrivateKey:z5,getRandomValues:$5,hashAndSign:G5,hashAndVerify:H5,encrypt:Q5,decrypt:J5},Nu={export:async function(t,e){const r=dp.create(),n=await r.encrypt(t,e),i=Mr.names.base64;return i.encode(n)}};const Ws=Ur(du);class Pu{constructor(t){this._key=t}async verify(t,e){return ir.hashAndVerify(this._key,e,t)}marshal(){return ir.utils.jwkToPkix(this._key)}get bytes(){return Ws.PublicKey.encode({Type:Ws.KeyType.RSA,Data:this.marshal()})}encrypt(t){return ir.encrypt(this._key,t)}equals(t){return Ve(this.bytes,t.bytes)}async hash(){return On.multihashing(this.bytes,"sha2-256")}}class Ys{constructor(t,e){this._key=t,this._publicKey=e}genSecret(){return ir.getRandomValues(16)}async sign(t){return ir.hashAndSign(this._key,t)}get public(){if(!this._publicKey)throw K(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Pu(this._publicKey)}decrypt(t){return ir.decrypt(this._key,t)}marshal(){return ir.utils.jwkToPkcs1(this._key)}get bytes(){return Ws.PrivateKey.encode({Type:Ws.KeyType.RSA,Data:this.marshal()})}equals(t){return Ve(this.bytes,t.bytes)}async hash(){return On.multihashing(this.bytes,"sha2-256")}async id(){const t=await this.public.hash();return se(t,"base58btc")}async export(t,e="pkcs-8"){if(e==="pkcs-8"){const r=new E.util.ByteBuffer(this.marshal()),n=E.asn1.fromDer(r),i=E.pki.privateKeyFromAsn1(n),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return E.pki.encryptRsaPrivateKey(i,t,a)}else{if(e==="libp2p-key")return Nu.export(this.bytes,t);throw K(new Error(`export format '${e}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}}async function Z5(t){const e=ir.utils.pkcs1ToJwk(t),r=await ir.unmarshalPrivateKey(e);return new Ys(r.privateKey,r.publicKey)}function eA(t){const e=ir.utils.pkixToJwk(t);return new Pu(e)}async function tA(t){const e=await ir.unmarshalPrivateKey(t);return new Ys(e.privateKey,e.publicKey)}async function rA(t){const e=await ir.generateKey(t);return new Ys(e.privateKey,e.publicKey)}var nA={RsaPublicKey:Pu,RsaPrivateKey:Ys,unmarshalRsaPublicKey:eA,unmarshalRsaPrivateKey:Z5,generateKeyPair:rA,fromJwk:tA},iA=E.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH,aA=E.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH,sA=async function(){return E.pki.ed25519.generateKeyPair()},oA=async function(t){return E.pki.ed25519.generateKeyPair({seed:t})},cA=async function(t,e){return E.pki.ed25519.sign({message:e,privateKey:t})},uA=async function(t,e,r){return E.pki.ed25519.verify({signature:e,message:r,publicKey:t})},Mt={publicKeyLength:iA,privateKeyLength:aA,generateKey:sA,generateKeyFromSeed:oA,hashAndSign:cA,hashAndVerify:uA};const Xs=Ur(du);class Du{constructor(t){this._key=Yi(t,Mt.publicKeyLength)}async verify(t,e){return Mt.hashAndVerify(this._key,e,t)}marshal(){return this._key}get bytes(){return Xs.PublicKey.encode({Type:Xs.KeyType.Ed25519,Data:this.marshal()})}equals(t){return Ve(this.bytes,t.bytes)}async hash(){return On.multihashing(this.bytes,"sha2-256")}}class Qa{constructor(t,e){this._key=Yi(t,Mt.privateKeyLength),this._publicKey=Yi(e,Mt.publicKeyLength)}async sign(t){return Mt.hashAndSign(this._key,t)}get public(){return new Du(this._publicKey)}marshal(){return this._key}get bytes(){return Xs.PrivateKey.encode({Type:Xs.KeyType.Ed25519,Data:this.marshal()})}equals(t){return Ve(this.bytes,t.bytes)}async hash(){return On.multihashing(this.bytes,"sha2-256")}async id(){const t=await this.public.hash();return Mr.encode("base58btc",t).toString().slice(1)}async export(t,e="libp2p-key"){if(e==="libp2p-key")return Nu.export(this.bytes,t);throw K(new Error(`export format '${e}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function dA(t){if(t.length>Mt.privateKeyLength){t=Yi(t,Mt.privateKeyLength+Mt.publicKeyLength);const n=t.slice(0,Mt.privateKeyLength),i=t.slice(Mt.privateKeyLength,t.length);return new Qa(n,i)}t=Yi(t,Mt.privateKeyLength);const e=t.slice(0,Mt.privateKeyLength),r=t.slice(Mt.publicKeyLength);return new Qa(e,r)}function lA(t){return t=Yi(t,Mt.publicKeyLength),new Du(t)}async function fA(){const{privateKey:t,publicKey:e}=await Mt.generateKey();return new Qa(t,e)}async function hA(t){const{privateKey:e,publicKey:r}=await Mt.generateKeyFromSeed(t);return new Qa(e,r)}function Yi(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw K(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}var pA={Ed25519PublicKey:Du,Ed25519PrivateKey:Qa,unmarshalEd25519PrivateKey:dA,unmarshalEd25519PublicKey:lA,generateKeyPair:fA,generateKeyPairFromSeed:hA};const ke={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function ar(t,e){if(!t)throw new Error(e)}function xe(t,e,r){if(ar(e instanceof Uint8Array,`Expected ${t} to be an Uint8Array`),r!==void 0)if(Array.isArray(r)){const n=r.join(", "),i=`Expected ${t} to be an Uint8Array with length [${n}]`;ar(r.includes(e.length),i)}else{const n=`Expected ${t} to be an Uint8Array with length ${r}`;ar(e.length===r,n)}}function li(t){ar(Xi(t)==="Boolean","Expected compressed to be a Boolean")}function wr(t=r=>new Uint8Array(r),e){return typeof t=="function"&&(t=t(e)),xe("output",t,e),t}function Xi(t){return Object.prototype.toString.call(t).slice(8,-1)}var mA=t=>({contextRandomize(e){ar(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&xe("seed",e,32);switch(t.contextRandomize(e)){case 1:throw new Error(ke.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return xe("private key",e,32),t.privateKeyVerify(e)===0},privateKeyNegate(e){xe("private key",e,32);switch(t.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(ke.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,r){xe("private key",e,32),xe("tweak",r,32);switch(t.privateKeyTweakAdd(e,r)){case 0:return e;case 1:throw new Error(ke.TWEAK_ADD)}},privateKeyTweakMul(e,r){xe("private key",e,32),xe("tweak",r,32);switch(t.privateKeyTweakMul(e,r)){case 0:return e;case 1:throw new Error(ke.TWEAK_MUL)}},publicKeyVerify(e){return xe("public key",e,[33,65]),t.publicKeyVerify(e)===0},publicKeyCreate(e,r=!0,n){xe("private key",e,32),li(r),n=wr(n,r?33:65);switch(t.publicKeyCreate(n,e)){case 0:return n;case 1:throw new Error(ke.SECKEY_INVALID);case 2:throw new Error(ke.PUBKEY_SERIALIZE)}},publicKeyConvert(e,r=!0,n){xe("public key",e,[33,65]),li(r),n=wr(n,r?33:65);switch(t.publicKeyConvert(n,e)){case 0:return n;case 1:throw new Error(ke.PUBKEY_PARSE);case 2:throw new Error(ke.PUBKEY_SERIALIZE)}},publicKeyNegate(e,r=!0,n){xe("public key",e,[33,65]),li(r),n=wr(n,r?33:65);switch(t.publicKeyNegate(n,e)){case 0:return n;case 1:throw new Error(ke.PUBKEY_PARSE);case 2:throw new Error(ke.IMPOSSIBLE_CASE);case 3:throw new Error(ke.PUBKEY_SERIALIZE)}},publicKeyCombine(e,r=!0,n){ar(Array.isArray(e),"Expected public keys to be an Array"),ar(e.length>0,"Expected public keys array will have more than zero items");for(const i of e)xe("public key",i,[33,65]);li(r),n=wr(n,r?33:65);switch(t.publicKeyCombine(n,e)){case 0:return n;case 1:throw new Error(ke.PUBKEY_PARSE);case 2:throw new Error(ke.PUBKEY_COMBINE);case 3:throw new Error(ke.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,r,n=!0,i){xe("public key",e,[33,65]),xe("tweak",r,32),li(n),i=wr(i,n?33:65);switch(t.publicKeyTweakAdd(i,e,r)){case 0:return i;case 1:throw new Error(ke.PUBKEY_PARSE);case 2:throw new Error(ke.TWEAK_ADD)}},publicKeyTweakMul(e,r,n=!0,i){xe("public key",e,[33,65]),xe("tweak",r,32),li(n),i=wr(i,n?33:65);switch(t.publicKeyTweakMul(i,e,r)){case 0:return i;case 1:throw new Error(ke.PUBKEY_PARSE);case 2:throw new Error(ke.TWEAK_MUL)}},signatureNormalize(e){xe("signature",e,64);switch(t.signatureNormalize(e)){case 0:return e;case 1:throw new Error(ke.SIG_PARSE)}},signatureExport(e,r){xe("signature",e,64),r=wr(r,72);const n={output:r,outputlen:72};switch(t.signatureExport(n,e)){case 0:return r.slice(0,n.outputlen);case 1:throw new Error(ke.SIG_PARSE);case 2:throw new Error(ke.IMPOSSIBLE_CASE)}},signatureImport(e,r){xe("signature",e),r=wr(r,64);switch(t.signatureImport(r,e)){case 0:return r;case 1:throw new Error(ke.SIG_PARSE);case 2:throw new Error(ke.IMPOSSIBLE_CASE)}},ecdsaSign(e,r,n={},i){xe("message",e,32),xe("private key",r,32),ar(Xi(n)==="Object","Expected options to be an Object"),n.data!==void 0&&xe("options.data",n.data),n.noncefn!==void 0&&ar(Xi(n.noncefn)==="Function","Expected options.noncefn to be a Function"),i=wr(i,64);const a={signature:i,recid:null};switch(t.ecdsaSign(a,e,r,n.data,n.noncefn)){case 0:return a;case 1:throw new Error(ke.SIGN);case 2:throw new Error(ke.IMPOSSIBLE_CASE)}},ecdsaVerify(e,r,n){xe("signature",e,64),xe("message",r,32),xe("public key",n,[33,65]);switch(t.ecdsaVerify(e,r,n)){case 0:return!0;case 3:return!1;case 1:throw new Error(ke.SIG_PARSE);case 2:throw new Error(ke.PUBKEY_PARSE)}},ecdsaRecover(e,r,n,i=!0,a){xe("signature",e,64),ar(Xi(r)==="Number"&&r>=0&&r<=3,"Expected recovery id to be a Number within interval [0, 3]"),xe("message",n,32),li(i),a=wr(a,i?33:65);switch(t.ecdsaRecover(a,e,r,n)){case 0:return a;case 1:throw new Error(ke.SIG_PARSE);case 2:throw new Error(ke.RECOVER);case 3:throw new Error(ke.IMPOSSIBLE_CASE)}},ecdh(e,r,n={},i){xe("public key",e,[33,65]),xe("private key",r,32),ar(Xi(n)==="Object","Expected options to be an Object"),n.data!==void 0&&xe("options.data",n.data),n.hashfn!==void 0?(ar(Xi(n.hashfn)==="Function","Expected options.hashfn to be a Function"),n.xbuf!==void 0&&xe("options.xbuf",n.xbuf,32),n.ybuf!==void 0&&xe("options.ybuf",n.ybuf,32),xe("output",i)):i=wr(i,32);switch(t.ecdh(i,e,r,n.data,n.hashfn,n.xbuf,n.ybuf)){case 0:return i;case 1:throw new Error(ke.PUBKEY_PARSE);case 2:throw new Error(ke.ECDH)}}});const bA="elliptic",yA="6.5.3",gA="EC cryptography",vA="lib/elliptic.js",wA=["lib"],EA={jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},xA={type:"git",url:"git@github.com:indutny/elliptic"},SA=["EC","Elliptic","curve","Cryptography"],AA="Fedor Indutny <fedor@indutny.com>",IA="MIT",kA={url:"https://github.com/indutny/elliptic/issues"},TA="https://github.com/indutny/elliptic",CA={brfs:"^1.4.3",coveralls:"^3.0.8",grunt:"^1.0.4","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.2",jscs:"^3.0.7",jshint:"^2.10.3",mocha:"^6.2.2"},_A={"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"};var RA={name:bA,version:yA,description:gA,main:vA,files:wA,scripts:EA,repository:xA,keywords:SA,author:AA,license:IA,bugs:kA,homepage:TA,devDependencies:CA,dependencies:_A},Q=Z(function(t){(function(e,r){function n(v,l){if(!v)throw new Error(l||"Assertion failed")}function i(v,l){v.super_=l;var b=function(){};b.prototype=l.prototype,v.prototype=new b,v.prototype.constructor=v}function a(v,l,b){if(a.isBN(v))return v;this.negative=0,this.words=null,this.length=0,this.red=null,v!==null&&((l==="le"||l==="be")&&(b=l,l=10),this._init(v||0,l||10,b||"be"))}typeof e=="object"?e.exports=a:r.BN=a,a.BN=a,a.wordSize=26;var s;try{s=Yt.Buffer}catch(v){}a.isBN=function(l){return l instanceof a?!0:l!==null&&typeof l=="object"&&l.constructor.wordSize===a.wordSize&&Array.isArray(l.words)},a.max=function(l,b){return l.cmp(b)>0?l:b},a.min=function(l,b){return l.cmp(b)<0?l:b},a.prototype._init=function(l,b,A){if(typeof l=="number")return this._initNumber(l,b,A);if(typeof l=="object")return this._initArray(l,b,A);b==="hex"&&(b=16),n(b===(b|0)&&b>=2&&b<=36),l=l.toString().replace(/\s+/g,"");var C=0;if(l[0]==="-"&&C++,b===16?this._parseHex(l,C):this._parseBase(l,b,C),l[0]==="-"&&(this.negative=1),this.strip(),A!=="le")return;this._initArray(this.toArray(),b,A)},a.prototype._initNumber=function(l,b,A){if(l<0&&(this.negative=1,l=-l),l<67108864?(this.words=[l&67108863],this.length=1):l<4503599627370496?(this.words=[l&67108863,l/67108864&67108863],this.length=2):(n(l<9007199254740992),this.words=[l&67108863,l/67108864&67108863,1],this.length=3),A!=="le")return;this._initArray(this.toArray(),b,A)},a.prototype._initArray=function(l,b,A){if(n(typeof l.length=="number"),l.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(l.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var P,O,L=0;if(A==="be")for(C=l.length-1,P=0;C>=0;C-=3)O=l[C]|l[C-1]<<8|l[C-2]<<16,this.words[P]|=O<<L&67108863,this.words[P+1]=O>>>26-L&67108863,L+=24,L>=26&&(L-=26,P++);else if(A==="le")for(C=0,P=0;C<l.length;C+=3)O=l[C]|l[C+1]<<8|l[C+2]<<16,this.words[P]|=O<<L&67108863,this.words[P+1]=O>>>26-L&67108863,L+=24,L>=26&&(L-=26,P++);return this.strip()};function o(v,l,b){for(var A=0,C=Math.min(v.length,b),P=l;P<C;P++){var O=v.charCodeAt(P)-48;A<<=4,O>=49&&O<=54?A|=O-49+10:O>=17&&O<=22?A|=O-17+10:A|=O&15}return A}a.prototype._parseHex=function(l,b){this.length=Math.ceil((l.length-b)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var C,P,O=0;for(A=l.length-6,C=0;A>=b;A-=6)P=o(l,A,A+6),this.words[C]|=P<<O&67108863,this.words[C+1]|=P>>>26-O&4194303,O+=24,O>=26&&(O-=26,C++);A+6!==b&&(P=o(l,b,A+6),this.words[C]|=P<<O&67108863,this.words[C+1]|=P>>>26-O&4194303),this.strip()};function u(v,l,b,A){for(var C=0,P=Math.min(v.length,b),O=l;O<P;O++){var L=v.charCodeAt(O)-48;C*=A,L>=49?C+=L-49+10:L>=17?C+=L-17+10:C+=L}return C}a.prototype._parseBase=function(l,b,A){this.words=[0],this.length=1;for(var C=0,P=1;P<=67108863;P*=b)C++;C--,P=P/b|0;for(var O=l.length-A,L=O%C,B=Math.min(O,O-L)+A,S=0,M=A;M<B;M+=C)S=u(l,M,M+C,b),this.imuln(P),this.words[0]+S<67108864?this.words[0]+=S:this._iaddn(S);if(L!==0){var q=1;for(S=u(l,M,l.length,b),M=0;M<L;M++)q*=b;this.imuln(q),this.words[0]+S<67108864?this.words[0]+=S:this._iaddn(S)}},a.prototype.copy=function(l){l.words=new Array(this.length);for(var b=0;b<this.length;b++)l.words[b]=this.words[b];l.length=this.length,l.negative=this.negative,l.red=this.red},a.prototype.clone=function(){var l=new a(null);return this.copy(l),l},a.prototype._expand=function(l){for(;this.length<l;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(l,b){l=l||10,b=b|0||1;var A;if(l===16||l==="hex"){A="";for(var C=0,P=0,O=0;O<this.length;O++){var L=this.words[O],B=((L<<C|P)&16777215).toString(16);P=L>>>24-C&16777215,P!==0||O!==this.length-1?A=c[6-B.length]+B+A:A=B+A,C+=2,C>=26&&(C-=26,O--)}for(P!==0&&(A=P.toString(16)+A);A.length%b!==0;)A="0"+A;return this.negative!==0&&(A="-"+A),A}if(l===(l|0)&&l>=2&&l<=36){var S=d[l],M=h[l];A="";var q=this.clone();for(q.negative=0;!q.isZero();){var z=q.modn(M).toString(l);q=q.idivn(M),q.isZero()?A=z+A:A=c[S-z.length]+z+A}for(this.isZero()&&(A="0"+A);A.length%b!==0;)A="0"+A;return this.negative!==0&&(A="-"+A),A}n(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var l=this.words[0];return this.length===2?l+=this.words[1]*67108864:this.length===3&&this.words[2]===1?l+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-l:l},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(l,b){return n(typeof s!="undefined"),this.toArrayLike(s,l,b)},a.prototype.toArray=function(l,b){return this.toArrayLike(Array,l,b)},a.prototype.toArrayLike=function(l,b,A){var C=this.byteLength(),P=A||Math.max(1,C);n(C<=P,"byte array longer than desired length"),n(P>0,"Requested array length <= 0"),this.strip();var O=b==="le",L=new l(P),B,S,M=this.clone();if(O){for(S=0;!M.isZero();S++)B=M.andln(255),M.iushrn(8),L[S]=B;for(;S<P;S++)L[S]=0}else{for(S=0;S<P-C;S++)L[S]=0;for(S=0;!M.isZero();S++)B=M.andln(255),M.iushrn(8),L[P-S-1]=B}return L},Math.clz32?a.prototype._countBits=function(l){return 32-Math.clz32(l)}:a.prototype._countBits=function(l){var b=l,A=0;return b>=4096&&(A+=13,b>>>=13),b>=64&&(A+=7,b>>>=7),b>=8&&(A+=4,b>>>=4),b>=2&&(A+=2,b>>>=2),A+b},a.prototype._zeroBits=function(l){if(l===0)return 26;var b=l,A=0;return(b&8191)===0&&(A+=13,b>>>=13),(b&127)===0&&(A+=7,b>>>=7),(b&15)===0&&(A+=4,b>>>=4),(b&3)===0&&(A+=2,b>>>=2),(b&1)===0&&A++,A},a.prototype.bitLength=function(){var l=this.words[this.length-1],b=this._countBits(l);return(this.length-1)*26+b};function y(v){for(var l=new Array(v.bitLength()),b=0;b<l.length;b++){var A=b/26|0,C=b%26;l[b]=(v.words[A]&1<<C)>>>C}return l}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var l=0,b=0;b<this.length;b++){var A=this._zeroBits(this.words[b]);if(l+=A,A!==26)break}return l},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(l){return this.negative!==0?this.abs().inotn(l).iaddn(1):this.clone()},a.prototype.fromTwos=function(l){return this.testn(l-1)?this.notn(l).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(l){for(;this.length<l.length;)this.words[this.length++]=0;for(var b=0;b<l.length;b++)this.words[b]=this.words[b]|l.words[b];return this.strip()},a.prototype.ior=function(l){return n((this.negative|l.negative)===0),this.iuor(l)},a.prototype.or=function(l){return this.length>l.length?this.clone().ior(l):l.clone().ior(this)},a.prototype.uor=function(l){return this.length>l.length?this.clone().iuor(l):l.clone().iuor(this)},a.prototype.iuand=function(l){var b;this.length>l.length?b=l:b=this;for(var A=0;A<b.length;A++)this.words[A]=this.words[A]&l.words[A];return this.length=b.length,this.strip()},a.prototype.iand=function(l){return n((this.negative|l.negative)===0),this.iuand(l)},a.prototype.and=function(l){return this.length>l.length?this.clone().iand(l):l.clone().iand(this)},a.prototype.uand=function(l){return this.length>l.length?this.clone().iuand(l):l.clone().iuand(this)},a.prototype.iuxor=function(l){var b,A;this.length>l.length?(b=this,A=l):(b=l,A=this);for(var C=0;C<A.length;C++)this.words[C]=b.words[C]^A.words[C];if(this!==b)for(;C<b.length;C++)this.words[C]=b.words[C];return this.length=b.length,this.strip()},a.prototype.ixor=function(l){return n((this.negative|l.negative)===0),this.iuxor(l)},a.prototype.xor=function(l){return this.length>l.length?this.clone().ixor(l):l.clone().ixor(this)},a.prototype.uxor=function(l){return this.length>l.length?this.clone().iuxor(l):l.clone().iuxor(this)},a.prototype.inotn=function(l){n(typeof l=="number"&&l>=0);var b=Math.ceil(l/26)|0,A=l%26;this._expand(b),A>0&&b--;for(var C=0;C<b;C++)this.words[C]=~this.words[C]&67108863;return A>0&&(this.words[C]=~this.words[C]&67108863>>26-A),this.strip()},a.prototype.notn=function(l){return this.clone().inotn(l)},a.prototype.setn=function(l,b){n(typeof l=="number"&&l>=0);var A=l/26|0,C=l%26;return this._expand(A+1),b?this.words[A]=this.words[A]|1<<C:this.words[A]=this.words[A]&~(1<<C),this.strip()},a.prototype.iadd=function(l){var b;if(this.negative!==0&&l.negative===0)return this.negative=0,b=this.isub(l),this.negative^=1,this._normSign();if(this.negative===0&&l.negative!==0)return l.negative=0,b=this.isub(l),l.negative=1,b._normSign();var A,C;this.length>l.length?(A=this,C=l):(A=l,C=this);for(var P=0,O=0;O<C.length;O++)b=(A.words[O]|0)+(C.words[O]|0)+P,this.words[O]=b&67108863,P=b>>>26;for(;P!==0&&O<A.length;O++)b=(A.words[O]|0)+P,this.words[O]=b&67108863,P=b>>>26;if(this.length=A.length,P!==0)this.words[this.length]=P,this.length++;else if(A!==this)for(;O<A.length;O++)this.words[O]=A.words[O];return this},a.prototype.add=function(l){var b;return l.negative!==0&&this.negative===0?(l.negative=0,b=this.sub(l),l.negative^=1,b):l.negative===0&&this.negative!==0?(this.negative=0,b=l.sub(this),this.negative=1,b):this.length>l.length?this.clone().iadd(l):l.clone().iadd(this)},a.prototype.isub=function(l){if(l.negative!==0){l.negative=0;var b=this.iadd(l);return l.negative=1,b._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(l),this.negative=1,this._normSign();var A=this.cmp(l);if(A===0)return this.negative=0,this.length=1,this.words[0]=0,this;var C,P;A>0?(C=this,P=l):(C=l,P=this);for(var O=0,L=0;L<P.length;L++)b=(C.words[L]|0)-(P.words[L]|0)+O,O=b>>26,this.words[L]=b&67108863;for(;O!==0&&L<C.length;L++)b=(C.words[L]|0)+O,O=b>>26,this.words[L]=b&67108863;if(O===0&&L<C.length&&C!==this)for(;L<C.length;L++)this.words[L]=C.words[L];return this.length=Math.max(this.length,L),C!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(l){return this.clone().isub(l)};function p(v,l,b){b.negative=l.negative^v.negative;var A=v.length+l.length|0;b.length=A,A=A-1|0;var C=v.words[0]|0,P=l.words[0]|0,O=C*P,L=O&67108863,B=O/67108864|0;b.words[0]=L;for(var S=1;S<A;S++){for(var M=B>>>26,q=B&67108863,z=Math.min(S,l.length-1),G=Math.max(0,S-v.length+1);G<=z;G++){var j=S-G|0;C=v.words[j]|0,P=l.words[G]|0,O=C*P+q,M+=O/67108864|0,q=O&67108863}b.words[S]=q|0,B=M|0}return B!==0?b.words[S]=B|0:b.length--,b.strip()}var m=function(l,b,A){var C=l.words,P=b.words,O=A.words,L=0,B,S,M,q=C[0]|0,z=q&8191,G=q>>>13,j=C[1]|0,H=j&8191,V=j>>>13,we=C[2]|0,ee=we&8191,ne=we>>>13,Ee=C[3]|0,ie=Ee&8191,te=Ee>>>13,ge=C[4]|0,X=ge&8191,he=ge>>>13,zd=C[5]|0,$e=zd&8191,Ge=zd>>>13,$d=C[6]|0,He=$d&8191,We=$d>>>13,Gd=C[7]|0,Ye=Gd&8191,Xe=Gd>>>13,Hd=C[8]|0,Qe=Hd&8191,Je=Hd>>>13,Wd=C[9]|0,Ze=Wd&8191,et=Wd>>>13,Yd=P[0]|0,tt=Yd&8191,rt=Yd>>>13,Xd=P[1]|0,nt=Xd&8191,it=Xd>>>13,Qd=P[2]|0,at=Qd&8191,st=Qd>>>13,Jd=P[3]|0,ot=Jd&8191,ct=Jd>>>13,Zd=P[4]|0,ut=Zd&8191,dt=Zd>>>13,el=P[5]|0,lt=el&8191,ft=el>>>13,tl=P[6]|0,ht=tl&8191,pt=tl>>>13,rl=P[7]|0,mt=rl&8191,bt=rl>>>13,nl=P[8]|0,yt=nl&8191,gt=nl>>>13,il=P[9]|0,vt=il&8191,wt=il>>>13;A.negative=l.negative^b.negative,A.length=19,B=Math.imul(z,tt),S=Math.imul(z,rt),S=S+Math.imul(G,tt)|0,M=Math.imul(G,rt);var Ko=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Ko>>>26)|0,Ko&=67108863,B=Math.imul(H,tt),S=Math.imul(H,rt),S=S+Math.imul(V,tt)|0,M=Math.imul(V,rt),B=B+Math.imul(z,nt)|0,S=S+Math.imul(z,it)|0,S=S+Math.imul(G,nt)|0,M=M+Math.imul(G,it)|0;var Fo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Fo>>>26)|0,Fo&=67108863,B=Math.imul(ee,tt),S=Math.imul(ee,rt),S=S+Math.imul(ne,tt)|0,M=Math.imul(ne,rt),B=B+Math.imul(H,nt)|0,S=S+Math.imul(H,it)|0,S=S+Math.imul(V,nt)|0,M=M+Math.imul(V,it)|0,B=B+Math.imul(z,at)|0,S=S+Math.imul(z,st)|0,S=S+Math.imul(G,at)|0,M=M+Math.imul(G,st)|0;var jo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(jo>>>26)|0,jo&=67108863,B=Math.imul(ie,tt),S=Math.imul(ie,rt),S=S+Math.imul(te,tt)|0,M=Math.imul(te,rt),B=B+Math.imul(ee,nt)|0,S=S+Math.imul(ee,it)|0,S=S+Math.imul(ne,nt)|0,M=M+Math.imul(ne,it)|0,B=B+Math.imul(H,at)|0,S=S+Math.imul(H,st)|0,S=S+Math.imul(V,at)|0,M=M+Math.imul(V,st)|0,B=B+Math.imul(z,ot)|0,S=S+Math.imul(z,ct)|0,S=S+Math.imul(G,ot)|0,M=M+Math.imul(G,ct)|0;var qo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(qo>>>26)|0,qo&=67108863,B=Math.imul(X,tt),S=Math.imul(X,rt),S=S+Math.imul(he,tt)|0,M=Math.imul(he,rt),B=B+Math.imul(ie,nt)|0,S=S+Math.imul(ie,it)|0,S=S+Math.imul(te,nt)|0,M=M+Math.imul(te,it)|0,B=B+Math.imul(ee,at)|0,S=S+Math.imul(ee,st)|0,S=S+Math.imul(ne,at)|0,M=M+Math.imul(ne,st)|0,B=B+Math.imul(H,ot)|0,S=S+Math.imul(H,ct)|0,S=S+Math.imul(V,ot)|0,M=M+Math.imul(V,ct)|0,B=B+Math.imul(z,ut)|0,S=S+Math.imul(z,dt)|0,S=S+Math.imul(G,ut)|0,M=M+Math.imul(G,dt)|0;var Vo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Vo>>>26)|0,Vo&=67108863,B=Math.imul($e,tt),S=Math.imul($e,rt),S=S+Math.imul(Ge,tt)|0,M=Math.imul(Ge,rt),B=B+Math.imul(X,nt)|0,S=S+Math.imul(X,it)|0,S=S+Math.imul(he,nt)|0,M=M+Math.imul(he,it)|0,B=B+Math.imul(ie,at)|0,S=S+Math.imul(ie,st)|0,S=S+Math.imul(te,at)|0,M=M+Math.imul(te,st)|0,B=B+Math.imul(ee,ot)|0,S=S+Math.imul(ee,ct)|0,S=S+Math.imul(ne,ot)|0,M=M+Math.imul(ne,ct)|0,B=B+Math.imul(H,ut)|0,S=S+Math.imul(H,dt)|0,S=S+Math.imul(V,ut)|0,M=M+Math.imul(V,dt)|0,B=B+Math.imul(z,lt)|0,S=S+Math.imul(z,ft)|0,S=S+Math.imul(G,lt)|0,M=M+Math.imul(G,ft)|0;var zo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(zo>>>26)|0,zo&=67108863,B=Math.imul(He,tt),S=Math.imul(He,rt),S=S+Math.imul(We,tt)|0,M=Math.imul(We,rt),B=B+Math.imul($e,nt)|0,S=S+Math.imul($e,it)|0,S=S+Math.imul(Ge,nt)|0,M=M+Math.imul(Ge,it)|0,B=B+Math.imul(X,at)|0,S=S+Math.imul(X,st)|0,S=S+Math.imul(he,at)|0,M=M+Math.imul(he,st)|0,B=B+Math.imul(ie,ot)|0,S=S+Math.imul(ie,ct)|0,S=S+Math.imul(te,ot)|0,M=M+Math.imul(te,ct)|0,B=B+Math.imul(ee,ut)|0,S=S+Math.imul(ee,dt)|0,S=S+Math.imul(ne,ut)|0,M=M+Math.imul(ne,dt)|0,B=B+Math.imul(H,lt)|0,S=S+Math.imul(H,ft)|0,S=S+Math.imul(V,lt)|0,M=M+Math.imul(V,ft)|0,B=B+Math.imul(z,ht)|0,S=S+Math.imul(z,pt)|0,S=S+Math.imul(G,ht)|0,M=M+Math.imul(G,pt)|0;var $o=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+($o>>>26)|0,$o&=67108863,B=Math.imul(Ye,tt),S=Math.imul(Ye,rt),S=S+Math.imul(Xe,tt)|0,M=Math.imul(Xe,rt),B=B+Math.imul(He,nt)|0,S=S+Math.imul(He,it)|0,S=S+Math.imul(We,nt)|0,M=M+Math.imul(We,it)|0,B=B+Math.imul($e,at)|0,S=S+Math.imul($e,st)|0,S=S+Math.imul(Ge,at)|0,M=M+Math.imul(Ge,st)|0,B=B+Math.imul(X,ot)|0,S=S+Math.imul(X,ct)|0,S=S+Math.imul(he,ot)|0,M=M+Math.imul(he,ct)|0,B=B+Math.imul(ie,ut)|0,S=S+Math.imul(ie,dt)|0,S=S+Math.imul(te,ut)|0,M=M+Math.imul(te,dt)|0,B=B+Math.imul(ee,lt)|0,S=S+Math.imul(ee,ft)|0,S=S+Math.imul(ne,lt)|0,M=M+Math.imul(ne,ft)|0,B=B+Math.imul(H,ht)|0,S=S+Math.imul(H,pt)|0,S=S+Math.imul(V,ht)|0,M=M+Math.imul(V,pt)|0,B=B+Math.imul(z,mt)|0,S=S+Math.imul(z,bt)|0,S=S+Math.imul(G,mt)|0,M=M+Math.imul(G,bt)|0;var Go=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Go>>>26)|0,Go&=67108863,B=Math.imul(Qe,tt),S=Math.imul(Qe,rt),S=S+Math.imul(Je,tt)|0,M=Math.imul(Je,rt),B=B+Math.imul(Ye,nt)|0,S=S+Math.imul(Ye,it)|0,S=S+Math.imul(Xe,nt)|0,M=M+Math.imul(Xe,it)|0,B=B+Math.imul(He,at)|0,S=S+Math.imul(He,st)|0,S=S+Math.imul(We,at)|0,M=M+Math.imul(We,st)|0,B=B+Math.imul($e,ot)|0,S=S+Math.imul($e,ct)|0,S=S+Math.imul(Ge,ot)|0,M=M+Math.imul(Ge,ct)|0,B=B+Math.imul(X,ut)|0,S=S+Math.imul(X,dt)|0,S=S+Math.imul(he,ut)|0,M=M+Math.imul(he,dt)|0,B=B+Math.imul(ie,lt)|0,S=S+Math.imul(ie,ft)|0,S=S+Math.imul(te,lt)|0,M=M+Math.imul(te,ft)|0,B=B+Math.imul(ee,ht)|0,S=S+Math.imul(ee,pt)|0,S=S+Math.imul(ne,ht)|0,M=M+Math.imul(ne,pt)|0,B=B+Math.imul(H,mt)|0,S=S+Math.imul(H,bt)|0,S=S+Math.imul(V,mt)|0,M=M+Math.imul(V,bt)|0,B=B+Math.imul(z,yt)|0,S=S+Math.imul(z,gt)|0,S=S+Math.imul(G,yt)|0,M=M+Math.imul(G,gt)|0;var Ho=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Ho>>>26)|0,Ho&=67108863,B=Math.imul(Ze,tt),S=Math.imul(Ze,rt),S=S+Math.imul(et,tt)|0,M=Math.imul(et,rt),B=B+Math.imul(Qe,nt)|0,S=S+Math.imul(Qe,it)|0,S=S+Math.imul(Je,nt)|0,M=M+Math.imul(Je,it)|0,B=B+Math.imul(Ye,at)|0,S=S+Math.imul(Ye,st)|0,S=S+Math.imul(Xe,at)|0,M=M+Math.imul(Xe,st)|0,B=B+Math.imul(He,ot)|0,S=S+Math.imul(He,ct)|0,S=S+Math.imul(We,ot)|0,M=M+Math.imul(We,ct)|0,B=B+Math.imul($e,ut)|0,S=S+Math.imul($e,dt)|0,S=S+Math.imul(Ge,ut)|0,M=M+Math.imul(Ge,dt)|0,B=B+Math.imul(X,lt)|0,S=S+Math.imul(X,ft)|0,S=S+Math.imul(he,lt)|0,M=M+Math.imul(he,ft)|0,B=B+Math.imul(ie,ht)|0,S=S+Math.imul(ie,pt)|0,S=S+Math.imul(te,ht)|0,M=M+Math.imul(te,pt)|0,B=B+Math.imul(ee,mt)|0,S=S+Math.imul(ee,bt)|0,S=S+Math.imul(ne,mt)|0,M=M+Math.imul(ne,bt)|0,B=B+Math.imul(H,yt)|0,S=S+Math.imul(H,gt)|0,S=S+Math.imul(V,yt)|0,M=M+Math.imul(V,gt)|0,B=B+Math.imul(z,vt)|0,S=S+Math.imul(z,wt)|0,S=S+Math.imul(G,vt)|0,M=M+Math.imul(G,wt)|0;var Wo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Wo>>>26)|0,Wo&=67108863,B=Math.imul(Ze,nt),S=Math.imul(Ze,it),S=S+Math.imul(et,nt)|0,M=Math.imul(et,it),B=B+Math.imul(Qe,at)|0,S=S+Math.imul(Qe,st)|0,S=S+Math.imul(Je,at)|0,M=M+Math.imul(Je,st)|0,B=B+Math.imul(Ye,ot)|0,S=S+Math.imul(Ye,ct)|0,S=S+Math.imul(Xe,ot)|0,M=M+Math.imul(Xe,ct)|0,B=B+Math.imul(He,ut)|0,S=S+Math.imul(He,dt)|0,S=S+Math.imul(We,ut)|0,M=M+Math.imul(We,dt)|0,B=B+Math.imul($e,lt)|0,S=S+Math.imul($e,ft)|0,S=S+Math.imul(Ge,lt)|0,M=M+Math.imul(Ge,ft)|0,B=B+Math.imul(X,ht)|0,S=S+Math.imul(X,pt)|0,S=S+Math.imul(he,ht)|0,M=M+Math.imul(he,pt)|0,B=B+Math.imul(ie,mt)|0,S=S+Math.imul(ie,bt)|0,S=S+Math.imul(te,mt)|0,M=M+Math.imul(te,bt)|0,B=B+Math.imul(ee,yt)|0,S=S+Math.imul(ee,gt)|0,S=S+Math.imul(ne,yt)|0,M=M+Math.imul(ne,gt)|0,B=B+Math.imul(H,vt)|0,S=S+Math.imul(H,wt)|0,S=S+Math.imul(V,vt)|0,M=M+Math.imul(V,wt)|0;var Yo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Yo>>>26)|0,Yo&=67108863,B=Math.imul(Ze,at),S=Math.imul(Ze,st),S=S+Math.imul(et,at)|0,M=Math.imul(et,st),B=B+Math.imul(Qe,ot)|0,S=S+Math.imul(Qe,ct)|0,S=S+Math.imul(Je,ot)|0,M=M+Math.imul(Je,ct)|0,B=B+Math.imul(Ye,ut)|0,S=S+Math.imul(Ye,dt)|0,S=S+Math.imul(Xe,ut)|0,M=M+Math.imul(Xe,dt)|0,B=B+Math.imul(He,lt)|0,S=S+Math.imul(He,ft)|0,S=S+Math.imul(We,lt)|0,M=M+Math.imul(We,ft)|0,B=B+Math.imul($e,ht)|0,S=S+Math.imul($e,pt)|0,S=S+Math.imul(Ge,ht)|0,M=M+Math.imul(Ge,pt)|0,B=B+Math.imul(X,mt)|0,S=S+Math.imul(X,bt)|0,S=S+Math.imul(he,mt)|0,M=M+Math.imul(he,bt)|0,B=B+Math.imul(ie,yt)|0,S=S+Math.imul(ie,gt)|0,S=S+Math.imul(te,yt)|0,M=M+Math.imul(te,gt)|0,B=B+Math.imul(ee,vt)|0,S=S+Math.imul(ee,wt)|0,S=S+Math.imul(ne,vt)|0,M=M+Math.imul(ne,wt)|0;var Xo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Xo>>>26)|0,Xo&=67108863,B=Math.imul(Ze,ot),S=Math.imul(Ze,ct),S=S+Math.imul(et,ot)|0,M=Math.imul(et,ct),B=B+Math.imul(Qe,ut)|0,S=S+Math.imul(Qe,dt)|0,S=S+Math.imul(Je,ut)|0,M=M+Math.imul(Je,dt)|0,B=B+Math.imul(Ye,lt)|0,S=S+Math.imul(Ye,ft)|0,S=S+Math.imul(Xe,lt)|0,M=M+Math.imul(Xe,ft)|0,B=B+Math.imul(He,ht)|0,S=S+Math.imul(He,pt)|0,S=S+Math.imul(We,ht)|0,M=M+Math.imul(We,pt)|0,B=B+Math.imul($e,mt)|0,S=S+Math.imul($e,bt)|0,S=S+Math.imul(Ge,mt)|0,M=M+Math.imul(Ge,bt)|0,B=B+Math.imul(X,yt)|0,S=S+Math.imul(X,gt)|0,S=S+Math.imul(he,yt)|0,M=M+Math.imul(he,gt)|0,B=B+Math.imul(ie,vt)|0,S=S+Math.imul(ie,wt)|0,S=S+Math.imul(te,vt)|0,M=M+Math.imul(te,wt)|0;var Qo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Qo>>>26)|0,Qo&=67108863,B=Math.imul(Ze,ut),S=Math.imul(Ze,dt),S=S+Math.imul(et,ut)|0,M=Math.imul(et,dt),B=B+Math.imul(Qe,lt)|0,S=S+Math.imul(Qe,ft)|0,S=S+Math.imul(Je,lt)|0,M=M+Math.imul(Je,ft)|0,B=B+Math.imul(Ye,ht)|0,S=S+Math.imul(Ye,pt)|0,S=S+Math.imul(Xe,ht)|0,M=M+Math.imul(Xe,pt)|0,B=B+Math.imul(He,mt)|0,S=S+Math.imul(He,bt)|0,S=S+Math.imul(We,mt)|0,M=M+Math.imul(We,bt)|0,B=B+Math.imul($e,yt)|0,S=S+Math.imul($e,gt)|0,S=S+Math.imul(Ge,yt)|0,M=M+Math.imul(Ge,gt)|0,B=B+Math.imul(X,vt)|0,S=S+Math.imul(X,wt)|0,S=S+Math.imul(he,vt)|0,M=M+Math.imul(he,wt)|0;var Jo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Jo>>>26)|0,Jo&=67108863,B=Math.imul(Ze,lt),S=Math.imul(Ze,ft),S=S+Math.imul(et,lt)|0,M=Math.imul(et,ft),B=B+Math.imul(Qe,ht)|0,S=S+Math.imul(Qe,pt)|0,S=S+Math.imul(Je,ht)|0,M=M+Math.imul(Je,pt)|0,B=B+Math.imul(Ye,mt)|0,S=S+Math.imul(Ye,bt)|0,S=S+Math.imul(Xe,mt)|0,M=M+Math.imul(Xe,bt)|0,B=B+Math.imul(He,yt)|0,S=S+Math.imul(He,gt)|0,S=S+Math.imul(We,yt)|0,M=M+Math.imul(We,gt)|0,B=B+Math.imul($e,vt)|0,S=S+Math.imul($e,wt)|0,S=S+Math.imul(Ge,vt)|0,M=M+Math.imul(Ge,wt)|0;var Zo=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(Zo>>>26)|0,Zo&=67108863,B=Math.imul(Ze,ht),S=Math.imul(Ze,pt),S=S+Math.imul(et,ht)|0,M=Math.imul(et,pt),B=B+Math.imul(Qe,mt)|0,S=S+Math.imul(Qe,bt)|0,S=S+Math.imul(Je,mt)|0,M=M+Math.imul(Je,bt)|0,B=B+Math.imul(Ye,yt)|0,S=S+Math.imul(Ye,gt)|0,S=S+Math.imul(Xe,yt)|0,M=M+Math.imul(Xe,gt)|0,B=B+Math.imul(He,vt)|0,S=S+Math.imul(He,wt)|0,S=S+Math.imul(We,vt)|0,M=M+Math.imul(We,wt)|0;var ec=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(ec>>>26)|0,ec&=67108863,B=Math.imul(Ze,mt),S=Math.imul(Ze,bt),S=S+Math.imul(et,mt)|0,M=Math.imul(et,bt),B=B+Math.imul(Qe,yt)|0,S=S+Math.imul(Qe,gt)|0,S=S+Math.imul(Je,yt)|0,M=M+Math.imul(Je,gt)|0,B=B+Math.imul(Ye,vt)|0,S=S+Math.imul(Ye,wt)|0,S=S+Math.imul(Xe,vt)|0,M=M+Math.imul(Xe,wt)|0;var tc=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(tc>>>26)|0,tc&=67108863,B=Math.imul(Ze,yt),S=Math.imul(Ze,gt),S=S+Math.imul(et,yt)|0,M=Math.imul(et,gt),B=B+Math.imul(Qe,vt)|0,S=S+Math.imul(Qe,wt)|0,S=S+Math.imul(Je,vt)|0,M=M+Math.imul(Je,wt)|0;var rc=(L+B|0)+((S&8191)<<13)|0;L=(M+(S>>>13)|0)+(rc>>>26)|0,rc&=67108863,B=Math.imul(Ze,vt),S=Math.imul(Ze,wt),S=S+Math.imul(et,vt)|0,M=Math.imul(et,wt);var nc=(L+B|0)+((S&8191)<<13)|0;return L=(M+(S>>>13)|0)+(nc>>>26)|0,nc&=67108863,O[0]=Ko,O[1]=Fo,O[2]=jo,O[3]=qo,O[4]=Vo,O[5]=zo,O[6]=$o,O[7]=Go,O[8]=Ho,O[9]=Wo,O[10]=Yo,O[11]=Xo,O[12]=Qo,O[13]=Jo,O[14]=Zo,O[15]=ec,O[16]=tc,O[17]=rc,O[18]=nc,L!==0&&(O[19]=L,A.length++),A};Math.imul||(m=p);function _(v,l,b){b.negative=l.negative^v.negative,b.length=v.length+l.length;for(var A=0,C=0,P=0;P<b.length-1;P++){var O=C;C=0;for(var L=A&67108863,B=Math.min(P,l.length-1),S=Math.max(0,P-v.length+1);S<=B;S++){var M=P-S,q=v.words[M]|0,z=l.words[S]|0,G=q*z,j=G&67108863;O=O+(G/67108864|0)|0,j=j+L|0,L=j&67108863,O=O+(j>>>26)|0,C+=O>>>26,O&=67108863}b.words[P]=L,A=O,O=C}return A!==0?b.words[P]=A:b.length--,b.strip()}function I(v,l,b){var A=new f;return A.mulp(v,l,b)}a.prototype.mulTo=function(l,b){var A,C=this.length+l.length;return this.length===10&&l.length===10?A=m(this,l,b):C<63?A=p(this,l,b):C<1024?A=_(this,l,b):A=I(this,l,b),A};function f(v,l){this.x=v,this.y=l}f.prototype.makeRBT=function(l){for(var b=new Array(l),A=a.prototype._countBits(l)-1,C=0;C<l;C++)b[C]=this.revBin(C,A,l);return b},f.prototype.revBin=function(l,b,A){if(l===0||l===A-1)return l;for(var C=0,P=0;P<b;P++)C|=(l&1)<<b-P-1,l>>=1;return C},f.prototype.permute=function(l,b,A,C,P,O){for(var L=0;L<O;L++)C[L]=b[l[L]],P[L]=A[l[L]]},f.prototype.transform=function(l,b,A,C,P,O){this.permute(O,l,b,A,C,P);for(var L=1;L<P;L<<=1)for(var B=L<<1,S=Math.cos(2*Math.PI/B),M=Math.sin(2*Math.PI/B),q=0;q<P;q+=B)for(var z=S,G=M,j=0;j<L;j++){var H=A[q+j],V=C[q+j],we=A[q+j+L],ee=C[q+j+L],ne=z*we-G*ee;ee=z*ee+G*we,we=ne,A[q+j]=H+we,C[q+j]=V+ee,A[q+j+L]=H-we,C[q+j+L]=V-ee,j!==B&&(ne=S*z-M*G,G=S*G+M*z,z=ne)}},f.prototype.guessLen13b=function(l,b){var A=Math.max(b,l)|1,C=A&1,P=0;for(A=A/2|0;A;A=A>>>1)P++;return 1<<P+1+C},f.prototype.conjugate=function(l,b,A){if(A<=1)return;for(var C=0;C<A/2;C++){var P=l[C];l[C]=l[A-C-1],l[A-C-1]=P,P=b[C],b[C]=-b[A-C-1],b[A-C-1]=-P}},f.prototype.normalize13b=function(l,b){for(var A=0,C=0;C<b/2;C++){var P=Math.round(l[2*C+1]/b)*8192+Math.round(l[2*C]/b)+A;l[C]=P&67108863,P<67108864?A=0:A=P/67108864|0}return l},f.prototype.convert13b=function(l,b,A,C){for(var P=0,O=0;O<b;O++)P=P+(l[O]|0),A[2*O]=P&8191,P=P>>>13,A[2*O+1]=P&8191,P=P>>>13;for(O=2*b;O<C;++O)A[O]=0;n(P===0),n((P&~8191)===0)},f.prototype.stub=function(l){for(var b=new Array(l),A=0;A<l;A++)b[A]=0;return b},f.prototype.mulp=function(l,b,A){var C=2*this.guessLen13b(l.length,b.length),P=this.makeRBT(C),O=this.stub(C),L=new Array(C),B=new Array(C),S=new Array(C),M=new Array(C),q=new Array(C),z=new Array(C),G=A.words;G.length=C,this.convert13b(l.words,l.length,L,C),this.convert13b(b.words,b.length,M,C),this.transform(L,O,B,S,C,P),this.transform(M,O,q,z,C,P);for(var j=0;j<C;j++){var H=B[j]*q[j]-S[j]*z[j];S[j]=B[j]*z[j]+S[j]*q[j],B[j]=H}return this.conjugate(B,S,C),this.transform(B,S,G,O,C,P),this.conjugate(G,O,C),this.normalize13b(G,C),A.negative=l.negative^b.negative,A.length=l.length+b.length,A.strip()},a.prototype.mul=function(l){var b=new a(null);return b.words=new Array(this.length+l.length),this.mulTo(l,b)},a.prototype.mulf=function(l){var b=new a(null);return b.words=new Array(this.length+l.length),I(this,l,b)},a.prototype.imul=function(l){return this.clone().mulTo(l,this)},a.prototype.imuln=function(l){n(typeof l=="number"),n(l<67108864);for(var b=0,A=0;A<this.length;A++){var C=(this.words[A]|0)*l,P=(C&67108863)+(b&67108863);b>>=26,b+=C/67108864|0,b+=P>>>26,this.words[A]=P&67108863}return b!==0&&(this.words[A]=b,this.length++),this},a.prototype.muln=function(l){return this.clone().imuln(l)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(l){var b=y(l);if(b.length===0)return new a(1);for(var A=this,C=0;C<b.length&&!(b[C]!==0);C++,A=A.sqr());if(++C<b.length)for(var P=A.sqr();C<b.length;C++,P=P.sqr()){if(b[C]===0)continue;A=A.mul(P)}return A},a.prototype.iushln=function(l){n(typeof l=="number"&&l>=0);var b=l%26,A=(l-b)/26,C=67108863>>>26-b<<26-b,P;if(b!==0){var O=0;for(P=0;P<this.length;P++){var L=this.words[P]&C,B=(this.words[P]|0)-L<<b;this.words[P]=B|O,O=L>>>26-b}O&&(this.words[P]=O,this.length++)}if(A!==0){for(P=this.length-1;P>=0;P--)this.words[P+A]=this.words[P];for(P=0;P<A;P++)this.words[P]=0;this.length+=A}return this.strip()},a.prototype.ishln=function(l){return n(this.negative===0),this.iushln(l)},a.prototype.iushrn=function(l,b,A){n(typeof l=="number"&&l>=0);var C;b?C=(b-b%26)/26:C=0;var P=l%26,O=Math.min((l-P)/26,this.length),L=67108863^67108863>>>P<<P,B=A;if(C-=O,C=Math.max(0,C),B){for(var S=0;S<O;S++)B.words[S]=this.words[S];B.length=O}if(!(O===0))if(this.length>O)for(this.length-=O,S=0;S<this.length;S++)this.words[S]=this.words[S+O];else this.words[0]=0,this.length=1;var M=0;for(S=this.length-1;S>=0&&(M!==0||S>=C);S--){var q=this.words[S]|0;this.words[S]=M<<26-P|q>>>P,M=q&L}return B&&M!==0&&(B.words[B.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(l,b,A){return n(this.negative===0),this.iushrn(l,b,A)},a.prototype.shln=function(l){return this.clone().ishln(l)},a.prototype.ushln=function(l){return this.clone().iushln(l)},a.prototype.shrn=function(l){return this.clone().ishrn(l)},a.prototype.ushrn=function(l){return this.clone().iushrn(l)},a.prototype.testn=function(l){n(typeof l=="number"&&l>=0);var b=l%26,A=(l-b)/26,C=1<<b;if(this.length<=A)return!1;var P=this.words[A];return!!(P&C)},a.prototype.imaskn=function(l){n(typeof l=="number"&&l>=0);var b=l%26,A=(l-b)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=A)return this;if(b!==0&&A++,this.length=Math.min(A,this.length),b!==0){var C=67108863^67108863>>>b<<b;this.words[this.length-1]&=C}return this.strip()},a.prototype.maskn=function(l){return this.clone().imaskn(l)},a.prototype.iaddn=function(l){return n(typeof l=="number"),n(l<67108864),l<0?this.isubn(-l):this.negative!==0?this.length===1&&(this.words[0]|0)<l?(this.words[0]=l-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(l),this.negative=1,this):this._iaddn(l)},a.prototype._iaddn=function(l){this.words[0]+=l;for(var b=0;b<this.length&&this.words[b]>=67108864;b++)this.words[b]-=67108864,b===this.length-1?this.words[b+1]=1:this.words[b+1]++;return this.length=Math.max(this.length,b+1),this},a.prototype.isubn=function(l){if(n(typeof l=="number"),n(l<67108864),l<0)return this.iaddn(-l);if(this.negative!==0)return this.negative=0,this.iaddn(l),this.negative=1,this;if(this.words[0]-=l,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this.strip()},a.prototype.addn=function(l){return this.clone().iaddn(l)},a.prototype.subn=function(l){return this.clone().isubn(l)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(l,b,A){var C=l.length+A,P;this._expand(C);var O,L=0;for(P=0;P<l.length;P++){O=(this.words[P+A]|0)+L;var B=(l.words[P]|0)*b;O-=B&67108863,L=(O>>26)-(B/67108864|0),this.words[P+A]=O&67108863}for(;P<this.length-A;P++)O=(this.words[P+A]|0)+L,L=O>>26,this.words[P+A]=O&67108863;if(L===0)return this.strip();for(n(L===-1),L=0,P=0;P<this.length;P++)O=-(this.words[P]|0)+L,L=O>>26,this.words[P]=O&67108863;return this.negative=1,this.strip()},a.prototype._wordDiv=function(l,b){var A=this.length-l.length,C=this.clone(),P=l,O=P.words[P.length-1]|0,L=this._countBits(O);A=26-L,A!==0&&(P=P.ushln(A),C.iushln(A),O=P.words[P.length-1]|0);var B=C.length-P.length,S;if(b!=="mod"){S=new a(null),S.length=B+1,S.words=new Array(S.length);for(var M=0;M<S.length;M++)S.words[M]=0}var q=C.clone()._ishlnsubmul(P,1,B);q.negative===0&&(C=q,S&&(S.words[B]=1));for(var z=B-1;z>=0;z--){var G=(C.words[P.length+z]|0)*67108864+(C.words[P.length+z-1]|0);for(G=Math.min(G/O|0,67108863),C._ishlnsubmul(P,G,z);C.negative!==0;)G--,C.negative=0,C._ishlnsubmul(P,1,z),C.isZero()||(C.negative^=1);S&&(S.words[z]=G)}return S&&S.strip(),C.strip(),b!=="div"&&A!==0&&C.iushrn(A),{div:S||null,mod:C}},a.prototype.divmod=function(l,b,A){if(n(!l.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var C,P,O;return this.negative!==0&&l.negative===0?(O=this.neg().divmod(l,b),b!=="mod"&&(C=O.div.neg()),b!=="div"&&(P=O.mod.neg(),A&&P.negative!==0&&P.iadd(l)),{div:C,mod:P}):this.negative===0&&l.negative!==0?(O=this.divmod(l.neg(),b),b!=="mod"&&(C=O.div.neg()),{div:C,mod:O.mod}):(this.negative&l.negative)!==0?(O=this.neg().divmod(l.neg(),b),b!=="div"&&(P=O.mod.neg(),A&&P.negative!==0&&P.isub(l)),{div:O.div,mod:P}):l.length>this.length||this.cmp(l)<0?{div:new a(0),mod:this}:l.length===1?b==="div"?{div:this.divn(l.words[0]),mod:null}:b==="mod"?{div:null,mod:new a(this.modn(l.words[0]))}:{div:this.divn(l.words[0]),mod:new a(this.modn(l.words[0]))}:this._wordDiv(l,b)},a.prototype.div=function(l){return this.divmod(l,"div",!1).div},a.prototype.mod=function(l){return this.divmod(l,"mod",!1).mod},a.prototype.umod=function(l){return this.divmod(l,"mod",!0).mod},a.prototype.divRound=function(l){var b=this.divmod(l);if(b.mod.isZero())return b.div;var A=b.div.negative!==0?b.mod.isub(l):b.mod,C=l.ushrn(1),P=l.andln(1),O=A.cmp(C);return O<0||P===1&&O===0?b.div:b.div.negative!==0?b.div.isubn(1):b.div.iaddn(1)},a.prototype.modn=function(l){n(l<=67108863);for(var b=(1<<26)%l,A=0,C=this.length-1;C>=0;C--)A=(b*A+(this.words[C]|0))%l;return A},a.prototype.idivn=function(l){n(l<=67108863);for(var b=0,A=this.length-1;A>=0;A--){var C=(this.words[A]|0)+b*67108864;this.words[A]=C/l|0,b=C%l}return this.strip()},a.prototype.divn=function(l){return this.clone().idivn(l)},a.prototype.egcd=function(l){n(l.negative===0),n(!l.isZero());var b=this,A=l.clone();b.negative!==0?b=b.umod(l):b=b.clone();for(var C=new a(1),P=new a(0),O=new a(0),L=new a(1),B=0;b.isEven()&&A.isEven();)b.iushrn(1),A.iushrn(1),++B;for(var S=A.clone(),M=b.clone();!b.isZero();){for(var q=0,z=1;(b.words[0]&z)===0&&q<26;++q,z<<=1);if(q>0)for(b.iushrn(q);q-- >0;)(C.isOdd()||P.isOdd())&&(C.iadd(S),P.isub(M)),C.iushrn(1),P.iushrn(1);for(var G=0,j=1;(A.words[0]&j)===0&&G<26;++G,j<<=1);if(G>0)for(A.iushrn(G);G-- >0;)(O.isOdd()||L.isOdd())&&(O.iadd(S),L.isub(M)),O.iushrn(1),L.iushrn(1);b.cmp(A)>=0?(b.isub(A),C.isub(O),P.isub(L)):(A.isub(b),O.isub(C),L.isub(P))}return{a:O,b:L,gcd:A.iushln(B)}},a.prototype._invmp=function(l){n(l.negative===0),n(!l.isZero());var b=this,A=l.clone();b.negative!==0?b=b.umod(l):b=b.clone();for(var C=new a(1),P=new a(0),O=A.clone();b.cmpn(1)>0&&A.cmpn(1)>0;){for(var L=0,B=1;(b.words[0]&B)===0&&L<26;++L,B<<=1);if(L>0)for(b.iushrn(L);L-- >0;)C.isOdd()&&C.iadd(O),C.iushrn(1);for(var S=0,M=1;(A.words[0]&M)===0&&S<26;++S,M<<=1);if(S>0)for(A.iushrn(S);S-- >0;)P.isOdd()&&P.iadd(O),P.iushrn(1);b.cmp(A)>=0?(b.isub(A),C.isub(P)):(A.isub(b),P.isub(C))}var q;return b.cmpn(1)===0?q=C:q=P,q.cmpn(0)<0&&q.iadd(l),q},a.prototype.gcd=function(l){if(this.isZero())return l.abs();if(l.isZero())return this.abs();var b=this.clone(),A=l.clone();b.negative=0,A.negative=0;for(var C=0;b.isEven()&&A.isEven();C++)b.iushrn(1),A.iushrn(1);do{for(;b.isEven();)b.iushrn(1);for(;A.isEven();)A.iushrn(1);var P=b.cmp(A);if(P<0){var O=b;b=A,A=O}else if(P===0||A.cmpn(1)===0)break;b.isub(A)}while(!0);return A.iushln(C)},a.prototype.invm=function(l){return this.egcd(l).a.umod(l)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(l){return this.words[0]&l},a.prototype.bincn=function(l){n(typeof l=="number");var b=l%26,A=(l-b)/26,C=1<<b;if(this.length<=A)return this._expand(A+1),this.words[A]|=C,this;for(var P=C,O=A;P!==0&&O<this.length;O++){var L=this.words[O]|0;L+=P,P=L>>>26,L&=67108863,this.words[O]=L}return P!==0&&(this.words[O]=P,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(l){var b=l<0;if(this.negative!==0&&!b)return-1;if(this.negative===0&&b)return 1;this.strip();var A;if(this.length>1)A=1;else{b&&(l=-l),n(l<=67108863,"Number is too big");var C=this.words[0]|0;A=C===l?0:C<l?-1:1}return this.negative!==0?-A|0:A},a.prototype.cmp=function(l){if(this.negative!==0&&l.negative===0)return-1;if(this.negative===0&&l.negative!==0)return 1;var b=this.ucmp(l);return this.negative!==0?-b|0:b},a.prototype.ucmp=function(l){if(this.length>l.length)return 1;if(this.length<l.length)return-1;for(var b=0,A=this.length-1;A>=0;A--){var C=this.words[A]|0,P=l.words[A]|0;if(C===P)continue;C<P?b=-1:C>P&&(b=1);break}return b},a.prototype.gtn=function(l){return this.cmpn(l)===1},a.prototype.gt=function(l){return this.cmp(l)===1},a.prototype.gten=function(l){return this.cmpn(l)>=0},a.prototype.gte=function(l){return this.cmp(l)>=0},a.prototype.ltn=function(l){return this.cmpn(l)===-1},a.prototype.lt=function(l){return this.cmp(l)===-1},a.prototype.lten=function(l){return this.cmpn(l)<=0},a.prototype.lte=function(l){return this.cmp(l)<=0},a.prototype.eqn=function(l){return this.cmpn(l)===0},a.prototype.eq=function(l){return this.cmp(l)===0},a.red=function(l){return new T(l)},a.prototype.toRed=function(l){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),l.convertTo(this)._forceRed(l)},a.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(l){return this.red=l,this},a.prototype.forceRed=function(l){return n(!this.red,"Already a number in reduction context"),this._forceRed(l)},a.prototype.redAdd=function(l){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,l)},a.prototype.redIAdd=function(l){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,l)},a.prototype.redSub=function(l){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,l)},a.prototype.redISub=function(l){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,l)},a.prototype.redShl=function(l){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,l)},a.prototype.redMul=function(l){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.mul(this,l)},a.prototype.redIMul=function(l){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.imul(this,l)},a.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(l){return n(this.red&&!l.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,l)};var k={k256:null,p224:null,p192:null,p25519:null};function R(v,l){this.name=v,this.p=new a(l,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var l=new a(null);return l.words=new Array(Math.ceil(this.n/13)),l},R.prototype.ireduce=function(l){var b=l,A;do this.split(b,this.tmp),b=this.imulK(b),b=b.iadd(this.tmp),A=b.bitLength();while(A>this.n);var C=A<this.n?-1:b.ucmp(this.p);return C===0?(b.words[0]=0,b.length=1):C>0?b.isub(this.p):b.strip!==void 0?b.strip():b._strip(),b},R.prototype.split=function(l,b){l.iushrn(this.n,0,b)},R.prototype.imulK=function(l){return l.imul(this.k)};function g(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(g,R),g.prototype.split=function(l,b){for(var A=4194303,C=Math.min(l.length,9),P=0;P<C;P++)b.words[P]=l.words[P];if(b.length=C,l.length<=9){l.words[0]=0,l.length=1;return}var O=l.words[9];for(b.words[b.length++]=O&A,P=10;P<l.length;P++){var L=l.words[P]|0;l.words[P-10]=(L&A)<<4|O>>>22,O=L}O>>>=22,l.words[P-10]=O,O===0&&l.length>10?l.length-=10:l.length-=9},g.prototype.imulK=function(l){l.words[l.length]=0,l.words[l.length+1]=0,l.length+=2;for(var b=0,A=0;A<l.length;A++){var C=l.words[A]|0;b+=C*977,l.words[A]=b&67108863,b=C*64+(b/67108864|0)}return l.words[l.length-1]===0&&(l.length--,l.words[l.length-1]===0&&l.length--),l};function x(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(x,R);function N(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(N,R);function w(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(w,R),w.prototype.imulK=function(l){for(var b=0,A=0;A<l.length;A++){var C=(l.words[A]|0)*19+b,P=C&67108863;C>>>=26,l.words[A]=P,b=C}return b!==0&&(l.words[l.length++]=b),l},a._prime=function(l){if(k[l])return k[l];var b;if(l==="k256")b=new g;else if(l==="p224")b=new x;else if(l==="p192")b=new N;else if(l==="p25519")b=new w;else throw new Error("Unknown prime "+l);return k[l]=b,b};function T(v){if(typeof v=="string"){var l=a._prime(v);this.m=l.p,this.prime=l}else n(v.gtn(1),"modulus must be greater than 1"),this.m=v,this.prime=null}T.prototype._verify1=function(l){n(l.negative===0,"red works only with positives"),n(l.red,"red works only with red numbers")},T.prototype._verify2=function(l,b){n((l.negative|b.negative)===0,"red works only with positives"),n(l.red&&l.red===b.red,"red works only with red numbers")},T.prototype.imod=function(l){return this.prime?this.prime.ireduce(l)._forceRed(this):l.umod(this.m)._forceRed(this)},T.prototype.neg=function(l){return l.isZero()?l.clone():this.m.sub(l)._forceRed(this)},T.prototype.add=function(l,b){this._verify2(l,b);var A=l.add(b);return A.cmp(this.m)>=0&&A.isub(this.m),A._forceRed(this)},T.prototype.iadd=function(l,b){this._verify2(l,b);var A=l.iadd(b);return A.cmp(this.m)>=0&&A.isub(this.m),A},T.prototype.sub=function(l,b){this._verify2(l,b);var A=l.sub(b);return A.cmpn(0)<0&&A.iadd(this.m),A._forceRed(this)},T.prototype.isub=function(l,b){this._verify2(l,b);var A=l.isub(b);return A.cmpn(0)<0&&A.iadd(this.m),A},T.prototype.shl=function(l,b){return this._verify1(l),this.imod(l.ushln(b))},T.prototype.imul=function(l,b){return this._verify2(l,b),this.imod(l.imul(b))},T.prototype.mul=function(l,b){return this._verify2(l,b),this.imod(l.mul(b))},T.prototype.isqr=function(l){return this.imul(l,l.clone())},T.prototype.sqr=function(l){return this.mul(l,l)},T.prototype.sqrt=function(l){if(l.isZero())return l.clone();var b=this.m.andln(3);if(n(b%2===1),b===3){var A=this.m.add(new a(1)).iushrn(2);return this.pow(l,A)}for(var C=this.m.subn(1),P=0;!C.isZero()&&C.andln(1)===0;)P++,C.iushrn(1);n(!C.isZero());var O=new a(1).toRed(this),L=O.redNeg(),B=this.m.subn(1).iushrn(1),S=this.m.bitLength();for(S=new a(2*S*S).toRed(this);this.pow(S,B).cmp(L)!==0;)S.redIAdd(L);for(var M=this.pow(S,C),q=this.pow(l,C.addn(1).iushrn(1)),z=this.pow(l,C),G=P;z.cmp(O)!==0;){for(var j=z,H=0;j.cmp(O)!==0;H++)j=j.redSqr();n(H<G);var V=this.pow(M,new a(1).iushln(G-H-1));q=q.redMul(V),M=V.redSqr(),z=z.redMul(M),G=H}return q},T.prototype.invm=function(l){var b=l._invmp(this.m);return b.negative!==0?(b.negative=0,this.imod(b).redNeg()):this.imod(b)},T.prototype.pow=function(l,b){if(b.isZero())return new a(1).toRed(this);if(b.cmpn(1)===0)return l.clone();var A=4,C=new Array(1<<A);C[0]=new a(1).toRed(this),C[1]=l;for(var P=2;P<C.length;P++)C[P]=this.mul(C[P-1],l);var O=C[0],L=0,B=0,S=b.bitLength()%26;for(S===0&&(S=26),P=b.length-1;P>=0;P--){for(var M=b.words[P],q=S-1;q>=0;q--){var z=M>>q&1;if(O!==C[0]&&(O=this.sqr(O)),z===0&&L===0){B=0;continue}if(L<<=1,L|=z,B++,B!==A&&(P!==0||q!==0))continue;O=this.mul(O,C[L]),B=0,L=0}S=26}return O},T.prototype.convertTo=function(l){var b=l.umod(this.m);return b===l?b.clone():b},T.prototype.convertFrom=function(l){var b=l.clone();return b.red=null,b},a.mont=function(l){return new D(l)};function D(v){T.call(this,v),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(D,T),D.prototype.convertTo=function(l){return this.imod(l.ushln(this.shift))},D.prototype.convertFrom=function(l){var b=this.imod(l.mul(this.rinv));return b.red=null,b},D.prototype.imul=function(l,b){if(l.isZero()||b.isZero())return l.words[0]=0,l.length=1,l;var A=l.imul(b),C=A.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),P=A.isub(C).iushrn(this.shift),O=P;return P.cmp(this.m)>=0?O=P.isub(this.m):P.cmpn(0)<0&&(O=P.iadd(this.m)),O._forceRed(this)},D.prototype.mul=function(l,b){if(l.isZero()||b.isZero())return new a(0)._forceRed(this);var A=l.mul(b),C=A.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),P=A.isub(C).iushrn(this.shift),O=P;return P.cmp(this.m)>=0?O=P.isub(this.m):P.cmpn(0)<0&&(O=P.iadd(this.m)),O._forceRed(this)},D.prototype.invm=function(l){var b=this.imod(l._invmp(this.m).mul(this.r2));return b._forceRed(this)}})(t,pe)}),Mn=Ap;function Ap(t,e){if(!t)throw new Error(e||"Assertion failed")}Ap.equal=function(e,r,n){if(e!=r)throw new Error(n||"Assertion failed: "+e+" != "+r)};var Er=Z(function(t,e){var r=e;function n(s,o){if(Array.isArray(s))return s.slice();if(!s)return[];var u=[];if(typeof s!="string"){for(var c=0;c<s.length;c++)u[c]=s[c]|0;return u}if(o==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var c=0;c<s.length;c+=2)u.push(parseInt(s[c]+s[c+1],16))}else for(var c=0;c<s.length;c++){var d=s.charCodeAt(c),h=d>>8,y=d&255;h?u.push(h,y):u.push(y)}return u}r.toArray=n;function i(s){return s.length===1?"0"+s:s}r.zero2=i;function a(s){for(var o="",u=0;u<s.length;u++)o+=i(s[u].toString(16));return o}r.toHex=a,r.encode=function(o,u){return u==="hex"?a(o):o}}),Te=Z(function(t,e){var r=e;r.assert=Mn,r.toArray=Er.toArray,r.zero2=Er.zero2,r.toHex=Er.toHex,r.encode=Er.encode;function n(u,c,d){var h=new Array(Math.max(u.bitLength(),d)+1);h.fill(0);for(var y=1<<c+1,p=u.clone(),m=0;m<h.length;m++){var _,I=p.andln(y-1);p.isOdd()?(I>(y>>1)-1?_=(y>>1)-I:_=I,p.isubn(_)):_=0,h[m]=_,p.iushrn(1)}return h}r.getNAF=n;function i(u,c){var d=[[],[]];u=u.clone(),c=c.clone();for(var h=0,y=0;u.cmpn(-h)>0||c.cmpn(-y)>0;){var p=u.andln(3)+h&3,m=c.andln(3)+y&3;p===3&&(p=-1),m===3&&(m=-1);var _;if((p&1)===0)_=0;else{var I=u.andln(7)+h&7;(I===3||I===5)&&m===2?_=-p:_=p}d[0].push(_);var f;if((m&1)===0)f=0;else{var I=c.andln(7)+y&7;(I===3||I===5)&&p===2?f=-m:f=m}d[1].push(f),2*h===_+1&&(h=1-h),2*y===f+1&&(y=1-y),u.iushrn(1),c.iushrn(1)}return d}r.getJSF=i;function a(u,c,d){var h="_"+c;u.prototype[c]=function(){return this[h]!==void 0?this[h]:this[h]=d.call(this)}}r.cachedProperty=a;function s(u){return typeof u=="string"?r.toArray(u,"hex"):u}r.parseBytes=s;function o(u){return new Q(u,"hex","le")}r.intFromLE=o}),Ou,Bu=function(e){return Ou||(Ou=new Ln(null)),Ou.generate(e)};function Ln(t){this.rand=t}var NA=Ln;if(Ln.prototype.generate=function(e){return this._rand(e)},Ln.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),n=0;n<r.length;n++)r[n]=this.rand.getByte();return r},typeof self=="object")self.crypto&&self.crypto.getRandomValues?Ln.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Ln.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(Ln.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Ip=Yt;if(typeof Ip.randomBytes!="function")throw new Error("Not supported");Ln.prototype._rand=function(e){return Ip.randomBytes(e)}}catch(t){}Bu.Rand=NA;var Qs=Te.getNAF,PA=Te.getJSF,Js=Te.assert;function Un(t,e){this.type=t,this.p=new Q(e.p,16),this.red=e.prime?Q.red(e.prime):Q.mont(this.p),this.zero=new Q(0).toRed(this.red),this.one=new Q(1).toRed(this.red),this.two=new Q(2).toRed(this.red),this.n=e.n&&new Q(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var jt=Un;Un.prototype.point=function(){throw new Error("Not implemented")},Un.prototype.validate=function(){throw new Error("Not implemented")},Un.prototype._fixedNafMul=function(e,r){Js(e.precomputed);var n=e._getDoubles(),i=Qs(r,1,this._bitLength),a=(1<<n.step+1)-(n.step%2===0?2:1);a/=3;for(var s=[],o=0;o<i.length;o+=n.step){for(var u=0,r=o+n.step-1;r>=o;r--)u=(u<<1)+i[r];s.push(u)}for(var c=this.jpoint(null,null,null),d=this.jpoint(null,null,null),h=a;h>0;h--){for(var o=0;o<s.length;o++){var u=s[o];u===h?d=d.mixedAdd(n.points[o]):u===-h&&(d=d.mixedAdd(n.points[o].neg()))}c=c.add(d)}return c.toP()},Un.prototype._wnafMul=function(e,r){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var a=i.points,s=Qs(r,n,this._bitLength),o=this.jpoint(null,null,null),u=s.length-1;u>=0;u--){for(var r=0;u>=0&&s[u]===0;u--)r++;if(u>=0&&r++,o=o.dblp(r),u<0)break;var c=s[u];Js(c!==0),e.type==="affine"?c>0?o=o.mixedAdd(a[c-1>>1]):o=o.mixedAdd(a[-c-1>>1].neg()):c>0?o=o.add(a[c-1>>1]):o=o.add(a[-c-1>>1].neg())}return e.type==="affine"?o.toP():o},Un.prototype._wnafMulAdd=function(e,r,n,i,a){for(var s=this._wnafT1,o=this._wnafT2,u=this._wnafT3,c=0,d=0;d<i;d++){var h=r[d],y=h._getNAFPoints(e);s[d]=y.wnd,o[d]=y.points}for(var d=i-1;d>=1;d-=2){var p=d-1,m=d;if(s[p]!==1||s[m]!==1){u[p]=Qs(n[p],s[p],this._bitLength),u[m]=Qs(n[m],s[m],this._bitLength),c=Math.max(u[p].length,c),c=Math.max(u[m].length,c);continue}var _=[r[p],null,null,r[m]];r[p].y.cmp(r[m].y)===0?(_[1]=r[p].add(r[m]),_[2]=r[p].toJ().mixedAdd(r[m].neg())):r[p].y.cmp(r[m].y.redNeg())===0?(_[1]=r[p].toJ().mixedAdd(r[m]),_[2]=r[p].add(r[m].neg())):(_[1]=r[p].toJ().mixedAdd(r[m]),_[2]=r[p].toJ().mixedAdd(r[m].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],f=PA(n[p],n[m]);c=Math.max(f[0].length,c),u[p]=new Array(c),u[m]=new Array(c);for(var k=0;k<c;k++){var R=f[0][k]|0,g=f[1][k]|0;u[p][k]=I[(R+1)*3+(g+1)],u[m][k]=0,o[p]=_}}for(var x=this.jpoint(null,null,null),N=this._wnafT4,d=c;d>=0;d--){for(var w=0;d>=0;){for(var T=!0,k=0;k<i;k++)N[k]=u[k][d]|0,N[k]!==0&&(T=!1);if(!T)break;w++,d--}if(d>=0&&w++,x=x.dblp(w),d<0)break;for(var k=0;k<i;k++){var D=N[k],h;if(D===0)continue;D>0?h=o[k][D-1>>1]:D<0&&(h=o[k][-D-1>>1].neg()),h.type==="affine"?x=x.mixedAdd(h):x=x.add(h)}}for(var d=0;d<i;d++)o[d]=null;return a?x:x.toP()};function sr(t,e){this.curve=t,this.type=e,this.precomputed=null}Un.BasePoint=sr,sr.prototype.eq=function(){throw new Error("Not implemented")},sr.prototype.validate=function(){return this.curve.validate(this)},Un.prototype.decodePoint=function(e,r){e=Te.toArray(e,r);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?Js(e[e.length-1]%2===0):e[0]===7&&Js(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")},sr.prototype.encodeCompressed=function(e){return this.encode(e,!0)},sr.prototype._encode=function(e){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))},sr.prototype.encode=function(e,r){return Te.encode(this._encode(r),e)},sr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this},sr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1},sr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,a=0;a<r;a+=e){for(var s=0;s<e;s++)i=i.dbl();n.push(i)}return{step:e,points:n}},sr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),a=1;a<n;a++)r[a]=r[a-1].add(i);return{wnd:e,points:r}},sr.prototype._getBeta=function(){return null},sr.prototype.dblp=function(e){for(var r=this,n=0;n<e;n++)r=r.dbl();return r};var DA=Te.assert;function or(t){jt.call(this,"short",t),this.a=new Q(t.a,16).toRed(this.red),this.b=new Q(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}je(or,jt);var OA=or;or.prototype._getEndomorphism=function(e){if(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)return;var r,n;if(e.beta)r=new Q(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(e.lambda)n=new Q(e.lambda,16);else{var a=this._getEndoRoots(this.n);this.g.mul(a[0]).x.cmp(this.g.x.redMul(r))===0?n=a[0]:(n=a[1],DA(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var s;return e.basis?s=e.basis.map(function(o){return{a:new Q(o.a,16),b:new Q(o.b,16)}}):s=this._getEndoBasis(n),{beta:r,lambda:n,basis:s}},or.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:Q.mont(e),n=new Q(2).toRed(r).redInvm(),i=n.redNeg(),a=new Q(3).toRed(r).redNeg().redSqrt().redMul(n),s=i.redAdd(a).fromRed(),o=i.redSub(a).fromRed();return[s,o]},or.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),a=new Q(1),s=new Q(0),o=new Q(0),u=new Q(1),c,d,h,y,p,m,_,I=0,f,k;n.cmpn(0)!==0;){var R=i.div(n);f=i.sub(R.mul(n)),k=o.sub(R.mul(a));var g=u.sub(R.mul(s));if(!h&&f.cmp(r)<0)c=_.neg(),d=a,h=f.neg(),y=k;else if(h&&++I===2)break;_=f,i=n,n=f,o=a,a=k,u=s,s=g}p=f.neg(),m=k;var x=h.sqr().add(y.sqr()),N=p.sqr().add(m.sqr());return N.cmp(x)>=0&&(p=c,m=d),h.negative&&(h=h.neg(),y=y.neg()),p.negative&&(p=p.neg(),m=m.neg()),[{a:h,b:y},{a:p,b:m}]},or.prototype._endoSplit=function(e){var r=this.endo.basis,n=r[0],i=r[1],a=i.b.mul(e).divRound(this.n),s=n.b.neg().mul(e).divRound(this.n),o=a.mul(n.a),u=s.mul(i.a),c=a.mul(n.b),d=s.mul(i.b),h=e.sub(o).sub(u),y=c.add(d).neg();return{k1:h,k2:y}},or.prototype.pointFromX=function(e,r){e=new Q(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var a=i.fromRed().isOdd();return(r&&!a||!r&&a)&&(i=i.redNeg()),this.point(e,i)},or.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,n=e.y,i=this.a.redMul(r),a=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(a).cmpn(0)===0},or.prototype._endoWnafMulAdd=function(e,r,n){for(var i=this._endoWnafT1,a=this._endoWnafT2,s=0;s<e.length;s++){var o=this._endoSplit(r[s]),u=e[s],c=u._getBeta();o.k1.negative&&(o.k1.ineg(),u=u.neg(!0)),o.k2.negative&&(o.k2.ineg(),c=c.neg(!0)),i[s*2]=u,i[s*2+1]=c,a[s*2]=o.k1,a[s*2+1]=o.k2}for(var d=this._wnafMulAdd(1,i,a,s*2,n),h=0;h<s*2;h++)i[h]=null,a[h]=null;return d};function Tt(t,e,r,n){jt.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Q(e,16),this.y=new Q(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}je(Tt,jt.BasePoint),or.prototype.point=function(e,r,n){return new Tt(this,e,r,n)},or.prototype.pointFromJSON=function(e,r){return Tt.fromJSON(this,e,r)},Tt.prototype._getBeta=function(){if(!this.curve.endo)return;var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(a){return n.point(a.x.redMul(n.endo.beta),a.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return r},Tt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Tt.fromJSON=function(e,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=e.point(r[0],r[1],n);if(!r[2])return i;function a(o){return e.point(o[0],o[1],n)}var s=r[2];return i.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[i].concat(s.doubles.points.map(a))},naf:s.naf&&{wnd:s.naf.wnd,points:[i].concat(s.naf.points.map(a))}},i},Tt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Tt.prototype.isInfinity=function(){return this.inf},Tt.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(e.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)},Tt.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),a=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),s=a.redSqr().redISub(this.x.redAdd(this.x)),o=a.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)},Tt.prototype.getX=function(){return this.x.fromRed()},Tt.prototype.getY=function(){return this.y.fromRed()},Tt.prototype.mul=function(e){return e=new Q(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},Tt.prototype.mulAdd=function(e,r,n){var i=[this,r],a=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,a):this.curve._wnafMulAdd(1,i,a,2)},Tt.prototype.jmulAdd=function(e,r,n){var i=[this,r],a=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,a,!0):this.curve._wnafMulAdd(1,i,a,2,!0)},Tt.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)},Tt.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(a){return a.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r},Tt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Dt(t,e,r,n){jt.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Q(0)):(this.x=new Q(e,16),this.y=new Q(r,16),this.z=new Q(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}je(Dt,jt.BasePoint),or.prototype.jpoint=function(e,r,n){return new Dt(this,e,r,n)},Dt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(e);return this.curve.point(n,i)},Dt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},Dt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),a=e.x.redMul(n),s=this.y.redMul(r.redMul(e.z)),o=e.y.redMul(n.redMul(this.z)),u=i.redSub(a),c=s.redSub(o);if(u.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var d=u.redSqr(),h=d.redMul(u),y=i.redMul(d),p=c.redSqr().redIAdd(h).redISub(y).redISub(y),m=c.redMul(y.redISub(p)).redISub(s.redMul(h)),_=this.z.redMul(e.z).redMul(u);return this.curve.jpoint(p,m,_)},Dt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=e.x.redMul(r),a=this.y,s=e.y.redMul(r).redMul(this.z),o=n.redSub(i),u=a.redSub(s);if(o.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),d=c.redMul(o),h=n.redMul(c),y=u.redSqr().redIAdd(d).redISub(h).redISub(h),p=u.redMul(h.redISub(y)).redISub(a.redMul(d)),m=this.z.redMul(o);return this.curve.jpoint(y,p,m)},Dt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var r=this,n=0;n<e;n++)r=r.dbl();return r}for(var i=this.curve.a,a=this.curve.tinv,s=this.x,o=this.y,u=this.z,c=u.redSqr().redSqr(),d=o.redAdd(o),n=0;n<e;n++){var h=s.redSqr(),y=d.redSqr(),p=y.redSqr(),m=h.redAdd(h).redIAdd(h).redIAdd(i.redMul(c)),_=s.redMul(y),I=m.redSqr().redISub(_.redAdd(_)),f=_.redISub(I),k=m.redMul(f);k=k.redIAdd(k).redISub(p);var R=d.redMul(u);n+1<e&&(c=c.redMul(p)),s=I,u=R,d=k}return this.curve.jpoint(s,d.redMul(a),u)},Dt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},Dt.prototype._zeroDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),a=this.y.redSqr(),s=a.redSqr(),o=this.x.redAdd(a).redSqr().redISub(i).redISub(s);o=o.redIAdd(o);var u=i.redAdd(i).redIAdd(i),c=u.redSqr().redISub(o).redISub(o),d=s.redIAdd(s);d=d.redIAdd(d),d=d.redIAdd(d),e=c,r=u.redMul(o.redISub(c)).redISub(d),n=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),y=this.y.redSqr(),p=y.redSqr(),m=this.x.redAdd(y).redSqr().redISub(h).redISub(p);m=m.redIAdd(m);var _=h.redAdd(h).redIAdd(h),I=_.redSqr(),f=p.redIAdd(p);f=f.redIAdd(f),f=f.redIAdd(f),e=I.redISub(m).redISub(m),r=_.redMul(m.redISub(e)).redISub(f),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,r,n)},Dt.prototype._threeDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),a=this.y.redSqr(),s=a.redSqr(),o=this.x.redAdd(a).redSqr().redISub(i).redISub(s);o=o.redIAdd(o);var u=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),c=u.redSqr().redISub(o).redISub(o);e=c;var d=s.redIAdd(s);d=d.redIAdd(d),d=d.redIAdd(d),r=u.redMul(o.redISub(c)).redISub(d),n=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),y=this.y.redSqr(),p=this.x.redMul(y),m=this.x.redSub(h).redMul(this.x.redAdd(h));m=m.redAdd(m).redIAdd(m);var _=p.redIAdd(p);_=_.redIAdd(_);var I=_.redAdd(_);e=m.redSqr().redISub(I),n=this.y.redAdd(this.z).redSqr().redISub(y).redISub(h);var f=y.redSqr();f=f.redIAdd(f),f=f.redIAdd(f),f=f.redIAdd(f),r=m.redMul(_.redISub(e)).redISub(f)}return this.curve.jpoint(e,r,n)},Dt.prototype._dbl=function(){var e=this.curve.a,r=this.x,n=this.y,i=this.z,a=i.redSqr().redSqr(),s=r.redSqr(),o=n.redSqr(),u=s.redAdd(s).redIAdd(s).redIAdd(e.redMul(a)),c=r.redAdd(r);c=c.redIAdd(c);var d=c.redMul(o),h=u.redSqr().redISub(d.redAdd(d)),y=d.redISub(h),p=o.redSqr();p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var m=u.redMul(y).redISub(p),_=n.redAdd(n).redMul(i);return this.curve.jpoint(h,m,_)},Dt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),a=e.redAdd(e).redIAdd(e),s=a.redSqr(),o=this.x.redAdd(r).redSqr().redISub(e).redISub(i);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(s);var u=o.redSqr(),c=i.redIAdd(i);c=c.redIAdd(c),c=c.redIAdd(c),c=c.redIAdd(c);var d=a.redIAdd(o).redSqr().redISub(s).redISub(u).redISub(c),h=r.redMul(d);h=h.redIAdd(h),h=h.redIAdd(h);var y=this.x.redMul(u).redISub(h);y=y.redIAdd(y),y=y.redIAdd(y);var p=this.y.redMul(d.redMul(c.redISub(d)).redISub(o.redMul(u)));p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var m=this.z.redAdd(o).redSqr().redISub(n).redISub(u);return this.curve.jpoint(y,p,m)},Dt.prototype.mul=function(e,r){return e=new Q(e,r),this.curve._wnafMul(this,e)},Dt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),a=n.redMul(e.z);return this.y.redMul(a).redISub(e.y.redMul(i)).cmpn(0)===0},Dt.prototype.eqXToP=function(e){var r=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),a=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(a),this.x.cmp(n)===0)return!0}},Dt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},Dt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};function Qi(t){jt.call(this,"mont",t),this.a=new Q(t.a,16).toRed(this.red),this.b=new Q(t.b,16).toRed(this.red),this.i4=new Q(4).toRed(this.red).redInvm(),this.two=new Q(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}je(Qi,jt);var BA=Qi;Qi.prototype.validate=function(e){var r=e.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),a=i.redSqrt();return a.redSqr().cmp(i)===0};function Ct(t,e,r){jt.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Q(e,16),this.z=new Q(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}je(Ct,jt.BasePoint),Qi.prototype.decodePoint=function(e,r){return this.point(Te.toArray(e,r),1)},Qi.prototype.point=function(e,r){return new Ct(this,e,r)},Qi.prototype.pointFromJSON=function(e){return Ct.fromJSON(this,e)},Ct.prototype.precompute=function(){},Ct.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},Ct.fromJSON=function(e,r){return new Ct(e,r[0],r[1]||e.one)},Ct.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Ct.prototype.isInfinity=function(){return this.z.cmpn(0)===0},Ct.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),a=r.redSub(i),s=r.redMul(i),o=a.redMul(i.redAdd(this.curve.a24.redMul(a)));return this.curve.point(s,o)},Ct.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},Ct.prototype.diffAdd=function(e,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),a=e.x.redAdd(e.z),s=e.x.redSub(e.z),o=s.redMul(n),u=a.redMul(i),c=r.z.redMul(o.redAdd(u).redSqr()),d=r.x.redMul(o.redISub(u).redSqr());return this.curve.point(c,d)},Ct.prototype.mul=function(e){for(var r=e.clone(),n=this,i=this.curve.point(null,null),a=this,s=[];r.cmpn(0)!==0;r.iushrn(1))s.push(r.andln(1));for(var o=s.length-1;o>=0;o--)s[o]===0?(n=n.diffAdd(i,a),i=i.dbl()):(i=n.diffAdd(i,a),n=n.dbl());return i},Ct.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},Ct.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},Ct.prototype.eq=function(e){return this.getX().cmp(e.getX())===0},Ct.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},Ct.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var MA=Te.assert;function Vr(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,jt.call(this,"edwards",t),this.a=new Q(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Q(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Q(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),MA(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}je(Vr,jt);var LA=Vr;Vr.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},Vr.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},Vr.prototype.jpoint=function(e,r,n,i){return this.point(e,r,n,i)},Vr.prototype.pointFromX=function(e,r){e=new Q(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),a=this.one.redSub(this.c2.redMul(this.d).redMul(n)),s=i.redMul(a.redInvm()),o=s.redSqrt();if(o.redSqr().redSub(s).cmp(this.zero)!==0)throw new Error("invalid point");var u=o.fromRed().isOdd();return(r&&!u||!r&&u)&&(o=o.redNeg()),this.point(e,o)},Vr.prototype.pointFromY=function(e,r){e=new Q(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),a=n.redMul(this.d).redMul(this.c2).redSub(this.a),s=i.redMul(a.redInvm());if(s.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var o=s.redSqrt();if(o.redSqr().redSub(s).cmp(this.zero)!==0)throw new Error("invalid point");return o.fromRed().isOdd()!==r&&(o=o.redNeg()),this.point(o,e)},Vr.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),n=e.y.redSqr(),i=r.redMul(this.a).redAdd(n),a=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(a)===0};function Pe(t,e,r,n,i){jt.BasePoint.call(this,t,"projective"),e===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Q(e,16),this.y=new Q(r,16),this.z=n?new Q(n,16):this.curve.one,this.t=i&&new Q(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}je(Pe,jt.BasePoint),Vr.prototype.pointFromJSON=function(e){return Pe.fromJSON(this,e)},Vr.prototype.point=function(e,r,n,i){return new Pe(this,e,r,n,i)},Pe.fromJSON=function(e,r){return new Pe(e,r[0],r[1],r[2])},Pe.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Pe.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},Pe.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(e),a=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),s=i.redAdd(r),o=s.redSub(n),u=i.redSub(r),c=a.redMul(o),d=s.redMul(u),h=a.redMul(u),y=o.redMul(s);return this.curve.point(c,d,y,h)},Pe.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,a,s;if(this.curve.twisted){var o=this.curve._mulA(r),u=o.redAdd(n);if(this.zOne)i=e.redSub(r).redSub(n).redMul(u.redSub(this.curve.two)),a=u.redMul(o.redSub(n)),s=u.redSqr().redSub(u).redSub(u);else{var c=this.z.redSqr(),d=u.redSub(c).redISub(c);i=e.redSub(r).redISub(n).redMul(d),a=u.redMul(o.redSub(n)),s=u.redMul(d)}}else{var o=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),d=o.redSub(c).redSub(c);i=this.curve._mulC(e.redISub(o)).redMul(d),a=this.curve._mulC(o).redMul(r.redISub(n)),s=o.redMul(d)}return this.curve.point(i,a,s)},Pe.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Pe.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),a=this.z.redMul(e.z.redAdd(e.z)),s=n.redSub(r),o=a.redSub(i),u=a.redAdd(i),c=n.redAdd(r),d=s.redMul(o),h=u.redMul(c),y=s.redMul(c),p=o.redMul(u);return this.curve.point(d,h,p,y)},Pe.prototype._projAdd=function(e){var r=this.z.redMul(e.z),n=r.redSqr(),i=this.x.redMul(e.x),a=this.y.redMul(e.y),s=this.curve.d.redMul(i).redMul(a),o=n.redSub(s),u=n.redAdd(s),c=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(a),d=r.redMul(o).redMul(c),h,y;return this.curve.twisted?(h=r.redMul(u).redMul(a.redSub(this.curve._mulA(i))),y=o.redMul(u)):(h=r.redMul(u).redMul(a.redSub(i)),y=this.curve._mulC(o).redMul(u)),this.curve.point(d,h,y)},Pe.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},Pe.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},Pe.prototype.mulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!1)},Pe.prototype.jmulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!0)},Pe.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},Pe.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Pe.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Pe.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Pe.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0},Pe.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=e.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}},Pe.prototype.toP=Pe.prototype.normalize,Pe.prototype.mixedAdd=Pe.prototype.add;var Zs=Z(function(t,e){var r=e;r.base=jt,r.short=OA,r.mont=BA,r.edwards=LA}),UA=je;function KA(t,e){return(t.charCodeAt(e)&64512)!==55296||(e<0||e+1>=t.length)?!1:(t.charCodeAt(e+1)&64512)===56320}function FA(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(var n=0,i=0;i<t.length;i++){var a=t.charCodeAt(i);a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):KA(t,i)?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128)}else for(i=0;i<t.length;i++)r[i]=t[i]|0;return r}var jA=FA;function qA(t){for(var e="",r=0;r<t.length;r++)e+=Tp(t[r].toString(16));return e}var VA=qA;function kp(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}var zA=kp;function $A(t,e){for(var r="",n=0;n<t.length;n++){var i=t[n];e==="little"&&(i=kp(i)),r+=Cp(i.toString(16))}return r}var GA=$A;function Tp(t){return t.length===1?"0"+t:t}var HA=Tp;function Cp(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}var WA=Cp;function YA(t,e,r,n){var i=r-e;Mn(i%4===0);for(var a=new Array(i/4),s=0,o=e;s<a.length;s++,o+=4){var u;n==="big"?u=t[o]<<24|t[o+1]<<16|t[o+2]<<8|t[o+3]:u=t[o+3]<<24|t[o+2]<<16|t[o+1]<<8|t[o],a[s]=u>>>0}return a}var XA=YA;function QA(t,e){for(var r=new Array(t.length*4),n=0,i=0;n<t.length;n++,i+=4){var a=t[n];e==="big"?(r[i]=a>>>24,r[i+1]=a>>>16&255,r[i+2]=a>>>8&255,r[i+3]=a&255):(r[i+3]=a>>>24,r[i+2]=a>>>16&255,r[i+1]=a>>>8&255,r[i]=a&255)}return r}var JA=QA;function ZA(t,e){return t>>>e|t<<32-e}var e8=ZA;function t8(t,e){return t<<e|t>>>32-e}var r8=t8;function n8(t,e){return t+e>>>0}var i8=n8;function a8(t,e,r){return t+e+r>>>0}var s8=a8;function o8(t,e,r,n){return t+e+r+n>>>0}var c8=o8;function u8(t,e,r,n,i){return t+e+r+n+i>>>0}var d8=u8;function l8(t,e,r,n){var i=t[e],a=t[e+1],s=n+a>>>0,o=(s<n?1:0)+r+i;t[e]=o>>>0,t[e+1]=s}var f8=l8;function h8(t,e,r,n){var i=e+n>>>0,a=(i<e?1:0)+t+r;return a>>>0}var p8=h8;function m8(t,e,r,n){var i=e+n;return i>>>0}var b8=m8;function y8(t,e,r,n,i,a,s,o){var u=0,c=e;c=c+n>>>0,u+=c<e?1:0,c=c+a>>>0,u+=c<a?1:0,c=c+o>>>0,u+=c<o?1:0;var d=t+r+i+s+u;return d>>>0}var g8=y8;function v8(t,e,r,n,i,a,s,o){var u=e+n+a+o;return u>>>0}var w8=v8;function E8(t,e,r,n,i,a,s,o,u,c){var d=0,h=e;h=h+n>>>0,d+=h<e?1:0,h=h+a>>>0,d+=h<a?1:0,h=h+o>>>0,d+=h<o?1:0,h=h+c>>>0,d+=h<c?1:0;var y=t+r+i+s+u+d;return y>>>0}var x8=E8;function S8(t,e,r,n,i,a,s,o,u,c){var d=e+n+a+o+c;return d>>>0}var A8=S8;function I8(t,e,r){var n=e<<32-r|t>>>r;return n>>>0}var k8=I8;function T8(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}var C8=T8;function _8(t,e,r){return t>>>r}var R8=_8;function N8(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}var P8=N8,oe={inherits:UA,toArray:jA,toHex:VA,htonl:zA,toHex32:GA,zero2:HA,zero8:WA,join32:XA,split32:JA,rotr32:e8,rotl32:r8,sum32:i8,sum32_3:s8,sum32_4:c8,sum32_5:d8,sum64:f8,sum64_hi:p8,sum64_lo:b8,sum64_4_hi:g8,sum64_4_lo:w8,sum64_5_hi:x8,sum64_5_lo:A8,rotr64_hi:k8,rotr64_lo:C8,shr64_hi:R8,shr64_lo:P8};function eo(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var D8=eo;eo.prototype.update=function(e,r){if(e=oe.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length),this.pending.length===0&&(this.pending=null),e=oe.join32(e,0,e.length-n,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},eo.prototype.digest=function(e){return this.update(this._pad()),Mn(this.pending===null),this._digest(e)},eo.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,n=r-(e+this.padLength)%r,i=new Array(n+this.padLength);i[0]=128;for(var a=1;a<n;a++)i[a]=0;if(e<<=3,this.endian==="big"){for(var s=8;s<this.padLength;s++)i[a++]=0;i[a++]=0,i[a++]=0,i[a++]=0,i[a++]=0,i[a++]=e>>>24&255,i[a++]=e>>>16&255,i[a++]=e>>>8&255,i[a++]=e&255}else for(i[a++]=e&255,i[a++]=e>>>8&255,i[a++]=e>>>16&255,i[a++]=e>>>24&255,i[a++]=0,i[a++]=0,i[a++]=0,i[a++]=0,s=8;s<this.padLength;s++)i[a++]=0;return i};var Ja={BlockHash:D8},zr=oe.rotr32;function O8(t,e,r,n){if(t===0)return _p(e,r,n);if(t===1||t===3)return Np(e,r,n);if(t===2)return Rp(e,r,n)}var B8=O8;function _p(t,e,r){return t&e^~t&r}var M8=_p;function Rp(t,e,r){return t&e^t&r^e&r}var L8=Rp;function Np(t,e,r){return t^e^r}var U8=Np;function K8(t){return zr(t,2)^zr(t,13)^zr(t,22)}var F8=K8;function j8(t){return zr(t,6)^zr(t,11)^zr(t,25)}var q8=j8;function V8(t){return zr(t,7)^zr(t,18)^t>>>3}var z8=V8;function $8(t){return zr(t,17)^zr(t,19)^t>>>10}var G8=$8,fi={ft_1:B8,ch32:M8,maj32:L8,p32:U8,s0_256:F8,s1_256:q8,g0_256:z8,g1_256:G8},Mu=oe.rotl32,Za=oe.sum32,H8=oe.sum32_5,W8=fi.ft_1,Pp=Ja.BlockHash,Y8=[1518500249,1859775393,2400959708,3395469782];function $r(){if(!(this instanceof $r))return new $r;Pp.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}oe.inherits($r,Pp);var X8=$r;$r.blockSize=512,$r.outSize=160,$r.hmacStrength=80,$r.padLength=64,$r.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=Mu(n[i-3]^n[i-8]^n[i-14]^n[i-16],1);var a=this.h[0],s=this.h[1],o=this.h[2],u=this.h[3],c=this.h[4];for(i=0;i<n.length;i++){var d=~~(i/20),h=H8(Mu(a,5),W8(d,s,o,u),c,n[i],Y8[d]);c=u,u=o,o=Mu(s,30),s=a,a=h}this.h[0]=Za(this.h[0],a),this.h[1]=Za(this.h[1],s),this.h[2]=Za(this.h[2],o),this.h[3]=Za(this.h[3],u),this.h[4]=Za(this.h[4],c)},$r.prototype._digest=function(e){return e==="hex"?oe.toHex32(this.h,"big"):oe.split32(this.h,"big")};var xr=oe.sum32,Q8=oe.sum32_4,J8=oe.sum32_5,Z8=fi.ch32,e6=fi.maj32,t6=fi.s0_256,r6=fi.s1_256,n6=fi.g0_256,i6=fi.g1_256,Dp=Ja.BlockHash,a6=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Gr(){if(!(this instanceof Gr))return new Gr;Dp.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=a6,this.W=new Array(64)}oe.inherits(Gr,Dp);var Lu=Gr;Gr.blockSize=512,Gr.outSize=256,Gr.hmacStrength=192,Gr.padLength=64,Gr.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=Q8(i6(n[i-2]),n[i-7],n6(n[i-15]),n[i-16]);var a=this.h[0],s=this.h[1],o=this.h[2],u=this.h[3],c=this.h[4],d=this.h[5],h=this.h[6],y=this.h[7];for(Mn(this.k.length===n.length),i=0;i<n.length;i++){var p=J8(y,r6(c),Z8(c,d,h),this.k[i],n[i]),m=xr(t6(a),e6(a,s,o));y=h,h=d,d=c,c=xr(u,p),u=o,o=s,s=a,a=xr(p,m)}this.h[0]=xr(this.h[0],a),this.h[1]=xr(this.h[1],s),this.h[2]=xr(this.h[2],o),this.h[3]=xr(this.h[3],u),this.h[4]=xr(this.h[4],c),this.h[5]=xr(this.h[5],d),this.h[6]=xr(this.h[6],h),this.h[7]=xr(this.h[7],y)},Gr.prototype._digest=function(e){return e==="hex"?oe.toHex32(this.h,"big"):oe.split32(this.h,"big")};function un(){if(!(this instanceof un))return new un;Lu.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}oe.inherits(un,Lu);var s6=un;un.blockSize=512,un.outSize=224,un.hmacStrength=192,un.padLength=64,un.prototype._digest=function(e){return e==="hex"?oe.toHex32(this.h.slice(0,7),"big"):oe.split32(this.h.slice(0,7),"big")};var Hr=oe.rotr64_hi,Wr=oe.rotr64_lo,Op=oe.shr64_hi,Bp=oe.shr64_lo,Kn=oe.sum64,Uu=oe.sum64_hi,Ku=oe.sum64_lo,o6=oe.sum64_4_hi,c6=oe.sum64_4_lo,u6=oe.sum64_5_hi,d6=oe.sum64_5_lo,Mp=Ja.BlockHash,l6=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Sr(){if(!(this instanceof Sr))return new Sr;Mp.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=l6,this.W=new Array(160)}oe.inherits(Sr,Mp);var Fu=Sr;Sr.blockSize=1024,Sr.outSize=512,Sr.hmacStrength=192,Sr.padLength=128,Sr.prototype._prepareBlock=function(e,r){for(var n=this.W,i=0;i<32;i++)n[i]=e[r+i];for(;i<n.length;i+=2){var a=x6(n[i-4],n[i-3]),s=S6(n[i-4],n[i-3]),o=n[i-14],u=n[i-13],c=w6(n[i-30],n[i-29]),d=E6(n[i-30],n[i-29]),h=n[i-32],y=n[i-31];n[i]=o6(a,s,o,u,c,d,h,y),n[i+1]=c6(a,s,o,u,c,d,h,y)}},Sr.prototype._update=function(e,r){this._prepareBlock(e,r);var n=this.W,i=this.h[0],a=this.h[1],s=this.h[2],o=this.h[3],u=this.h[4],c=this.h[5],d=this.h[6],h=this.h[7],y=this.h[8],p=this.h[9],m=this.h[10],_=this.h[11],I=this.h[12],f=this.h[13],k=this.h[14],R=this.h[15];Mn(this.k.length===n.length);for(var g=0;g<n.length;g+=2){var x=k,N=R,w=g6(y,p),T=v6(y,p),D=f6(y,p,m,_,I),v=h6(y,p,m,_,I,f),l=this.k[g],b=this.k[g+1],A=n[g],C=n[g+1],P=u6(x,N,w,T,D,v,l,b,A,C),O=d6(x,N,w,T,D,v,l,b,A,C);x=b6(i,a),N=y6(i,a),w=p6(i,a,s,o,u),T=m6(i,a,s,o,u,c);var L=Uu(x,N,w,T),B=Ku(x,N,w,T);k=I,R=f,I=m,f=_,m=y,_=p,y=Uu(d,h,P,O),p=Ku(h,h,P,O),d=u,h=c,u=s,c=o,s=i,o=a,i=Uu(P,O,L,B),a=Ku(P,O,L,B)}Kn(this.h,0,i,a),Kn(this.h,2,s,o),Kn(this.h,4,u,c),Kn(this.h,6,d,h),Kn(this.h,8,y,p),Kn(this.h,10,m,_),Kn(this.h,12,I,f),Kn(this.h,14,k,R)},Sr.prototype._digest=function(e){return e==="hex"?oe.toHex32(this.h,"big"):oe.split32(this.h,"big")};function f6(t,e,r,n,i){var a=t&r^~t&i;return a<0&&(a+=4294967296),a}function h6(t,e,r,n,i,a){var s=e&n^~e&a;return s<0&&(s+=4294967296),s}function p6(t,e,r,n,i){var a=t&r^t&i^r&i;return a<0&&(a+=4294967296),a}function m6(t,e,r,n,i,a){var s=e&n^e&a^n&a;return s<0&&(s+=4294967296),s}function b6(t,e){var r=Hr(t,e,28),n=Hr(e,t,2),i=Hr(e,t,7),a=r^n^i;return a<0&&(a+=4294967296),a}function y6(t,e){var r=Wr(t,e,28),n=Wr(e,t,2),i=Wr(e,t,7),a=r^n^i;return a<0&&(a+=4294967296),a}function g6(t,e){var r=Hr(t,e,14),n=Hr(t,e,18),i=Hr(e,t,9),a=r^n^i;return a<0&&(a+=4294967296),a}function v6(t,e){var r=Wr(t,e,14),n=Wr(t,e,18),i=Wr(e,t,9),a=r^n^i;return a<0&&(a+=4294967296),a}function w6(t,e){var r=Hr(t,e,1),n=Hr(t,e,8),i=Op(t,e,7),a=r^n^i;return a<0&&(a+=4294967296),a}function E6(t,e){var r=Wr(t,e,1),n=Wr(t,e,8),i=Bp(t,e,7),a=r^n^i;return a<0&&(a+=4294967296),a}function x6(t,e){var r=Hr(t,e,19),n=Hr(e,t,29),i=Op(t,e,6),a=r^n^i;return a<0&&(a+=4294967296),a}function S6(t,e){var r=Wr(t,e,19),n=Wr(e,t,29),i=Bp(t,e,6),a=r^n^i;return a<0&&(a+=4294967296),a}function dn(){if(!(this instanceof dn))return new dn;Fu.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}oe.inherits(dn,Fu);var A6=dn;dn.blockSize=1024,dn.outSize=384,dn.hmacStrength=192,dn.padLength=128,dn.prototype._digest=function(e){return e==="hex"?oe.toHex32(this.h.slice(0,12),"big"):oe.split32(this.h.slice(0,12),"big")};var I6=X8,k6=s6,T6=Lu,C6=A6,_6=Fu,R6={sha1:I6,sha224:k6,sha256:T6,sha384:C6,sha512:_6},to=oe.rotl32,Lp=oe.sum32,es=oe.sum32_3,Up=oe.sum32_4,Kp=Ja.BlockHash;function Yr(){if(!(this instanceof Yr))return new Yr;Kp.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}oe.inherits(Yr,Kp);var N6=Yr;Yr.blockSize=512,Yr.outSize=160,Yr.hmacStrength=192,Yr.padLength=64,Yr.prototype._update=function(e,r){for(var n=this.h[0],i=this.h[1],a=this.h[2],s=this.h[3],o=this.h[4],u=n,c=i,d=a,h=s,y=o,p=0;p<80;p++){var m=Lp(to(Up(n,Fp(p,i,a,s),e[O6[p]+r],P6(p)),M6[p]),o);n=o,o=s,s=to(a,10),a=i,i=m,m=Lp(to(Up(u,Fp(79-p,c,d,h),e[B6[p]+r],D6(p)),L6[p]),y),u=y,y=h,h=to(d,10),d=c,c=m}m=es(this.h[1],a,h),this.h[1]=es(this.h[2],s,y),this.h[2]=es(this.h[3],o,u),this.h[3]=es(this.h[4],n,c),this.h[4]=es(this.h[0],i,d),this.h[0]=m},Yr.prototype._digest=function(e){return e==="hex"?oe.toHex32(this.h,"little"):oe.split32(this.h,"little")};function Fp(t,e,r,n){return t<=15?e^r^n:t<=31?e&r|~e&n:t<=47?(e|~r)^n:t<=63?e&n|r&~n:e^(r|~n)}function P6(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function D6(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var O6=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],B6=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],M6=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],L6=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],U6={ripemd160:N6};function Ji(t,e,r){if(!(this instanceof Ji))return new Ji(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(oe.toArray(e,r))}var K6=Ji;Ji.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),Mn(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)},Ji.prototype.update=function(e,r){return this.inner.update(e,r),this},Ji.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};var Xr=Z(function(t,e){var r=e;r.utils=oe,r.common=Ja,r.sha=R6,r.ripemd=U6,r.hmac=K6,r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160}),F6={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}},ts=Z(function(t,e){var r=e,n=Te.assert;function i(o){o.type==="short"?this.curve=new Zs.short(o):o.type==="edwards"?this.curve=new Zs.edwards(o):this.curve=new Zs.mont(o),this.g=this.curve.g,this.n=this.curve.n,this.hash=o.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}r.PresetCurve=i;function a(o,u){Object.defineProperty(r,o,{configurable:!0,enumerable:!0,get:function(){var c=new i(u);return Object.defineProperty(r,o,{configurable:!0,enumerable:!0,value:c}),c}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Xr.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Xr.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Xr.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Xr.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Xr.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Xr.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Xr.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var s;try{s=F6}catch(o){s=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Xr.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",s]})});function Fn(t){if(!(this instanceof Fn))return new Fn(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Er.toArray(t.entropy,t.entropyEnc||"hex"),r=Er.toArray(t.nonce,t.nonceEnc||"hex"),n=Er.toArray(t.pers,t.persEnc||"hex");Mn(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,n)}var jp=Fn;Fn.prototype._init=function(e,r,n){var i=e.concat(r).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},Fn.prototype._hmac=function(){return new Xr.hmac(this.hash,this.K)},Fn.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);if(e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),!e)return;this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest()},Fn.prototype.reseed=function(e,r,n,i){typeof r!="string"&&(i=n,n=r,r=null),e=Er.toArray(e,r),n=Er.toArray(n,i),Mn(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1},Fn.prototype.generate=function(e,r,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(i=n,n=r,r=null),n&&(n=Er.toArray(n,i||"hex"),this._update(n));for(var a=[];a.length<e;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var s=a.slice(0,e);return this._update(n),this._reseed++,Er.encode(s,r)};var qp=Te.assert;function Lt(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var ju=Lt;Lt.fromPublic=function(e,r,n){return r instanceof Lt?r:new Lt(e,{pub:r,pubEnc:n})},Lt.fromPrivate=function(e,r,n){return r instanceof Lt?r:new Lt(e,{priv:r,privEnc:n})},Lt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},Lt.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub},Lt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv},Lt.prototype._importPrivate=function(e,r){this.priv=new Q(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)},Lt.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?qp(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&qp(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)},Lt.prototype.derive=function(e){return e.mul(this.priv).getX()},Lt.prototype.sign=function(e,r,n){return this.ec.sign(e,this,r,n)},Lt.prototype.verify=function(e,r){return this.ec.verify(e,r,this)},Lt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var j6=Te.assert;function ro(t,e){if(t instanceof ro)return t;if(this._importDER(t,e))return;j6(t.r&&t.s,"Signature without r or s"),this.r=new Q(t.r,16),this.s=new Q(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam}var no=ro;function q6(){this.place=0}function qu(t,e){var r=t[e.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,a=0,s=e.place;a<n;a++,s++)i<<=8,i|=t[s],i>>>=0;return i<=127?!1:(e.place=s,i)}function Vp(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}ro.prototype._importDER=function(e,r){e=Te.toArray(e,r);var n=new q6;if(e[n.place++]!==48)return!1;var i=qu(e,n);if(i===!1)return!1;if(i+n.place!==e.length)return!1;if(e[n.place++]!==2)return!1;var a=qu(e,n);if(a===!1)return!1;var s=e.slice(n.place,a+n.place);if(n.place+=a,e[n.place++]!==2)return!1;var o=qu(e,n);if(o===!1)return!1;if(e.length!==o+n.place)return!1;var u=e.slice(n.place,o+n.place);if(s[0]===0)if(s[1]&128)s=s.slice(1);else return!1;if(u[0]===0)if(u[1]&128)u=u.slice(1);else return!1;return this.r=new Q(s),this.s=new Q(u),this.recoveryParam=null,!0};function Vu(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}ro.prototype.toDER=function(e){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=Vp(r),n=Vp(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];Vu(i,r.length),i=i.concat(r),i.push(2),Vu(i,n.length);var a=i.concat(n),s=[48];return Vu(s,a.length),s=s.concat(a),Te.encode(s,e)};var zp=Te.assert;function cr(t){if(!(this instanceof cr))return new cr(t);typeof t=="string"&&(zp(ts.hasOwnProperty(t),"Unknown curve "+t),t=ts[t]),t instanceof ts.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var V6=cr;cr.prototype.keyPair=function(e){return new ju(this,e)},cr.prototype.keyFromPrivate=function(e,r){return ju.fromPrivate(this,e,r)},cr.prototype.keyFromPublic=function(e,r){return ju.fromPublic(this,e,r)},cr.prototype.genKeyPair=function(e){e||(e={});var r=new jp({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Bu(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Q(2));do{var a=new Q(r.generate(n));if(a.cmp(i)>0)continue;return a.iaddn(1),this.keyFromPrivate(a)}while(!0)},cr.prototype._truncateToN=function(e,r){var n=e.byteLength()*8-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e},cr.prototype.sign=function(e,r,n,i){typeof n=="object"&&(i=n,n=null),i||(i={}),r=this.keyFromPrivate(r,n),e=this._truncateToN(new Q(e,16));for(var a=this.n.byteLength(),s=r.getPrivate().toArray("be",a),o=e.toArray("be",a),u=new jp({hash:this.hash,entropy:s,nonce:o,pers:i.pers,persEnc:i.persEnc||"utf8"}),c=this.n.sub(new Q(1)),d=0;;d++){var h=i.k?i.k(d):new Q(u.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),h.cmpn(1)<=0||h.cmp(c)>=0)continue;var y=this.g.mul(h);if(y.isInfinity())continue;var p=y.getX(),m=p.umod(this.n);if(m.cmpn(0)===0)continue;var _=h.invm(this.n).mul(m.mul(r.getPrivate()).iadd(e));if(_=_.umod(this.n),_.cmpn(0)===0)continue;var I=(y.getY().isOdd()?1:0)|(p.cmp(m)!==0?2:0);return i.canonical&&_.cmp(this.nh)>0&&(_=this.n.sub(_),I^=1),new no({r:m,s:_,recoveryParam:I})}},cr.prototype.verify=function(e,r,n,i){e=this._truncateToN(new Q(e,16)),n=this.keyFromPublic(n,i),r=new no(r,"hex");var a=r.r,s=r.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var o=s.invm(this.n),u=o.mul(e).umod(this.n),c=o.mul(a).umod(this.n);if(!this.curve._maxwellTrick){var d=this.g.mulAdd(u,n.getPublic(),c);return d.isInfinity()?!1:d.getX().umod(this.n).cmp(a)===0}var d=this.g.jmulAdd(u,n.getPublic(),c);return d.isInfinity()?!1:d.eqXToP(a)},cr.prototype.recoverPubKey=function(t,e,r,n){zp((3&r)===r,"The recovery param is more than two bits"),e=new no(e,n);var i=this.n,a=new Q(t),s=e.r,o=e.s,u=r&1,c=r>>1;if(s.cmp(this.curve.p.umod(this.curve.n))>=0&&c)throw new Error("Unable to find sencond key candinate");c?s=this.curve.pointFromX(s.add(this.curve.n),u):s=this.curve.pointFromX(s,u);var d=e.r.invm(i),h=i.sub(a).mul(d).umod(i),y=o.mul(d).umod(i);return this.g.mulAdd(h,s,y)},cr.prototype.getKeyRecoveryParam=function(t,e,r,n){if(e=new no(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var a;try{a=this.recoverPubKey(t,e,i)}catch(s){continue}if(a.eq(r))return i}throw new Error("Unable to find valid recovery factor")};var $p=Te.assert,Gp=Te.parseBytes,Zi=Te.cachedProperty;function _t(t,e){this.eddsa=t,this._secret=Gp(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=Gp(e.pub)}_t.fromPublic=function(e,r){return r instanceof _t?r:new _t(e,{pub:r})},_t.fromSecret=function(e,r){return r instanceof _t?r:new _t(e,{secret:r})},_t.prototype.secret=function(){return this._secret},Zi(_t,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),Zi(_t,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),Zi(_t,"privBytes",function(){var e=this.eddsa,r=this.hash(),n=e.encodingLength-1,i=r.slice(0,e.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i}),Zi(_t,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),Zi(_t,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),Zi(_t,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),_t.prototype.sign=function(e){return $p(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},_t.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)},_t.prototype.getSecret=function(e){return $p(this._secret,"KeyPair is public only"),Te.encode(this.secret(),e)},_t.prototype.getPublic=function(e){return Te.encode(this.pubBytes(),e)};var Hp=_t,z6=Te.assert,io=Te.cachedProperty,$6=Te.parseBytes;function hi(t,e){this.eddsa=t,typeof e!="object"&&(e=$6(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),z6(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof Q&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}io(hi,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),io(hi,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),io(hi,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),io(hi,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),hi.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},hi.prototype.toHex=function(){return Te.encode(this.toBytes(),"hex").toUpperCase()};var Wp=hi,G6=Te.assert,Yp=Te.parseBytes;function Gt(t){if(G6(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Gt))return new Gt(t);var t=ts[t].curve;this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=Xr.sha512}var H6=Gt;Gt.prototype.sign=function(e,r){e=Yp(e);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),e),a=this.g.mul(i),s=this.encodePoint(a),o=this.hashInt(s,n.pubBytes(),e).mul(n.priv()),u=i.add(o).umod(this.curve.n);return this.makeSignature({R:a,S:u,Rencoded:s})},Gt.prototype.verify=function(e,r,n){e=Yp(e),r=this.makeSignature(r);var i=this.keyFromPublic(n),a=this.hashInt(r.Rencoded(),i.pubBytes(),e),s=this.g.mul(r.S()),o=r.R().add(i.pub().mul(a));return o.eq(s)},Gt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Te.intFromLE(e.digest()).umod(this.curve.n)},Gt.prototype.keyFromPublic=function(e){return Hp.fromPublic(this,e)},Gt.prototype.keyFromSecret=function(e){return Hp.fromSecret(this,e)},Gt.prototype.makeSignature=function(e){return e instanceof Wp?e:new Wp(this,e)},Gt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r},Gt.prototype.decodePoint=function(e){e=Te.parseBytes(e);var r=e.length-1,n=e.slice(0,r).concat(e[r]&~128),i=(e[r]&128)!==0,a=Te.intFromLE(n);return this.curve.pointFromY(a,i)},Gt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},Gt.prototype.decodeInt=function(e){return Te.intFromLE(e)},Gt.prototype.isPoint=function(e){return e instanceof this.pointClass};var W6=Z(function(t,e){var r=e;r.version=RA.version,r.utils=Te,r.rand=Bu,r.curve=Zs,r.curves=ts,r.ec=V6,r.eddsa=H6});const Y6=W6.ec,Qr=new Y6("secp256k1"),ve=Qr.curve,Re=ve.n.constructor;function X6(t,e){let r=new Re(e);if(r.cmp(ve.p)>=0)return null;r=r.toRed(ve.red);let n=r.redSqr().redIMul(r).redIAdd(ve.b).redSqrt();return t===3!==n.isOdd()&&(n=n.redNeg()),Qr.keyPair({pub:{x:r,y:n}})}function Q6(t,e,r){let n=new Re(e),i=new Re(r);if(n.cmp(ve.p)>=0||i.cmp(ve.p)>=0)return null;if(n=n.toRed(ve.red),i=i.toRed(ve.red),(t===6||t===7)&&i.isOdd()!==(t===7))return null;const a=n.redSqr().redIMul(n);return i.redSqr().redISub(a.redIAdd(ve.b)).isZero()?Qr.keyPair({pub:{x:n,y:i}}):null}function jn(t){const e=t[0];switch(e){case 2:case 3:return t.length!==33?null:X6(e,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:Q6(e,t.subarray(1,33),t.subarray(33,65));default:return null}}function pi(t,e){const r=e.encode(null,t.length===33);for(let n=0;n<t.length;++n)t[n]=r[n]}var J6={contextRandomize(){return 0},privateKeyVerify(t){const e=new Re(t);return e.cmp(ve.n)<0&&!e.isZero()?0:1},privateKeyNegate(t){const e=new Re(t),r=ve.n.sub(e).umod(ve.n).toArrayLike(Uint8Array,"be",32);return t.set(r),0},privateKeyTweakAdd(t,e){const r=new Re(e);if(r.cmp(ve.n)>=0)return 1;if(r.iadd(new Re(t)),r.cmp(ve.n)>=0&&r.isub(ve.n),r.isZero())return 1;const n=r.toArrayLike(Uint8Array,"be",32);return t.set(n),0},privateKeyTweakMul(t,e){let r=new Re(e);if(r.cmp(ve.n)>=0||r.isZero())return 1;r.imul(new Re(t)),r.cmp(ve.n)>=0&&(r=r.umod(ve.n));const n=r.toArrayLike(Uint8Array,"be",32);return t.set(n),0},publicKeyVerify(t){const e=jn(t);return e===null?1:0},publicKeyCreate(t,e){const r=new Re(e);if(r.cmp(ve.n)>=0||r.isZero())return 1;const n=Qr.keyFromPrivate(e).getPublic();return pi(t,n),0},publicKeyConvert(t,e){const r=jn(e);if(r===null)return 1;const n=r.getPublic();return pi(t,n),0},publicKeyNegate(t,e){const r=jn(e);if(r===null)return 1;const n=r.getPublic();return n.y=n.y.redNeg(),pi(t,n),0},publicKeyCombine(t,e){const r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=jn(e[i]),r[i]===null)return 1;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?2:(pi(t,n),0)},publicKeyTweakAdd(t,e,r){const n=jn(e);if(n===null)return 1;if(r=new Re(r),r.cmp(ve.n)>=0)return 2;const i=n.getPublic().add(ve.g.mul(r));return i.isInfinity()?2:(pi(t,i),0)},publicKeyTweakMul(t,e,r){const n=jn(e);if(n===null)return 1;if(r=new Re(r),r.cmp(ve.n)>=0||r.isZero())return 2;const i=n.getPublic().mul(r);return pi(t,i),0},signatureNormalize(t){const e=new Re(t.subarray(0,32)),r=new Re(t.subarray(32,64));return e.cmp(ve.n)>=0||r.cmp(ve.n)>=0?1:(r.cmp(Qr.nh)===1&&t.set(ve.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){const r=e.subarray(0,32),n=e.subarray(32,64);if(new Re(r).cmp(ve.n)>=0)return 1;if(new Re(n).cmp(ve.n)>=0)return 1;const{output:i}=t;let a=i.subarray(4,4+33);a[0]=0,a.set(r,1);let s=33,o=0;for(;s>1&&a[o]===0&&!(a[o+1]&128);--s,++o);if(a=a.subarray(o),a[0]&128)return 1;if(s>1&&a[0]===0&&!(a[1]&128))return 1;let u=i.subarray(6+33,6+33+33);u[0]=0,u.set(n,1);let c=33,d=0;for(;c>1&&u[d]===0&&!(u[d+1]&128);--c,++d);return u=u.subarray(d),u[0]&128||c>1&&u[0]===0&&!(u[1]&128)?1:(t.outputlen=6+s+c,i[0]=48,i[1]=t.outputlen-2,i[2]=2,i[3]=a.length,i.set(a,4),i[4+s]=2,i[5+s]=u.length,i.set(u,6+s),0)},signatureImport(t,e){if(e.length<8)return 1;if(e.length>72)return 1;if(e[0]!==48)return 1;if(e[1]!==e.length-2)return 1;if(e[2]!==2)return 1;const r=e[3];if(r===0)return 1;if(5+r>=e.length)return 1;if(e[4+r]!==2)return 1;const n=e[5+r];if(n===0)return 1;if(6+r+n!==e.length)return 1;if(e[4]&128)return 1;if(r>1&&e[4]===0&&!(e[5]&128))return 1;if(e[r+6]&128)return 1;if(n>1&&e[r+6]===0&&!(e[r+7]&128))return 1;let i=e.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let a=e.subarray(6+r);if(a.length===33&&a[0]===0&&(a=a.slice(1)),a.length>32)throw new Error("S length is too long");let s=new Re(i);s.cmp(ve.n)>=0&&(s=new Re(0));let o=new Re(e.subarray(6+r));return o.cmp(ve.n)>=0&&(o=new Re(0)),t.set(s.toArrayLike(Uint8Array,"be",32),0),t.set(o.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e,r,n,i){if(i){const o=i;i=u=>{const c=o(e,r,null,n,u),d=c instanceof Uint8Array&&c.length===32;if(!d)throw new Error("This is the way");return new Re(c)}}const a=new Re(r);if(a.cmp(ve.n)>=0||a.isZero())return 1;let s;try{s=Qr.sign(e,r,{canonical:!0,k:i,pers:n})}catch(o){return 1}return t.signature.set(s.r.toArrayLike(Uint8Array,"be",32),0),t.signature.set(s.s.toArrayLike(Uint8Array,"be",32),32),t.recid=s.recoveryParam,0},ecdsaVerify(t,e,r){const n={r:t.subarray(0,32),s:t.subarray(32,64)},i=new Re(n.r),a=new Re(n.s);if(i.cmp(ve.n)>=0||a.cmp(ve.n)>=0)return 1;if(a.cmp(Qr.nh)===1||i.isZero()||a.isZero())return 3;const s=jn(r);if(s===null)return 2;const o=s.getPublic(),u=Qr.verify(e,n,o);return u?0:3},ecdsaRecover(t,e,r,n){const i={r:e.slice(0,32),s:e.slice(32,64)},a=new Re(i.r),s=new Re(i.s);if(a.cmp(ve.n)>=0||s.cmp(ve.n)>=0)return 1;if(a.isZero()||s.isZero())return 2;let o;try{o=Qr.recoverPubKey(n,i,r)}catch(u){return 2}return pi(t,o),0},ecdh(t,e,r,n,i,a,s){const o=jn(e);if(o===null)return 1;const u=new Re(r);if(u.cmp(ve.n)>=0||u.isZero())return 2;const c=o.getPublic().mul(u);if(i===void 0){const d=c.encode(null,!0),h=Qr.hash().update(d).digest();for(let y=0;y<32;++y)t[y]=h[y]}else{a||(a=new Uint8Array(32));const d=c.getX().toArray("be",32);for(let m=0;m<32;++m)a[m]=d[m];s||(s=new Uint8Array(32));const h=c.getY().toArray("be",32);for(let m=0;m<32;++m)s[m]=h[m];const y=i(a,s,n),p=y instanceof Uint8Array&&y.length===t.length;if(!p)return 2;t.set(y)}return 0}},Ar=mA(J6);const Xp="sha2-256";var Z6=t=>{const e=32;function r(){let d;do d=t(32);while(!Ar.privateKeyVerify(d));return d}async function n(d,h){const y=await On.digest(h,Xp),p=Ar.ecdsaSign(y,d);return Ar.signatureExport(p.signature)}async function i(d,h,y){const p=await On.digest(y,Xp);return h=Ar.signatureImport(h),Ar.ecdsaVerify(h,p,d)}function a(d){if(!Ar.publicKeyVerify(d))throw new Error("Invalid public key");return Ar.publicKeyConvert(d,!0)}function s(d){return Ar.publicKeyConvert(d,!1)}function o(d){if(!Ar.privateKeyVerify(d))throw new Error("Invalid private key")}function u(d){if(!Ar.publicKeyVerify(d))throw new Error("Invalid public key")}function c(d){return o(d),Ar.publicKeyCreate(d)}return{generateKey:r,privateKeyLength:e,hashAndSign:n,hashAndVerify:i,compressPublicKey:a,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:u,computePublicKey:c}},eI=(t,e,r)=>{r=r||Z6(e);class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,c){return r.hashAndVerify(this._key,c,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()})}equals(u){return Ve(this.bytes,u.bytes)}hash(){return On.multihashing(this.bytes,"sha2-256")}}class i{constructor(u,c){this._key=u,this._publicKey=c||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()})}equals(u){return Ve(this.bytes,u.bytes)}hash(){return On.multihashing(this.bytes,"sha2-256")}async id(){const u=await this.public.hash();return se(u,"base58btc")}async export(u,c="libp2p-key"){if(c==="libp2p-key")return Nu.export(this.bytes,u);throw K(new Error(`export format '${c}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function a(u){return new i(u)}function s(u){return new n(u)}async function o(){const u=await r.generateKey();return new i(u)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:a,unmarshalSecp256k1PublicKey:s,generateKeyPair:o}},tI={SHA1:20,SHA256:32,SHA512:64};const rI={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},nI=async(t,e)=>{const r=await Pt.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};var iI=async function(t,e){const r=rI[t],n=await Pt.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return nI(n,i)},length:tI[t]}},Qp={create:iI};const Jp={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};var aI=async(t,e,r)=>{const n=Jp[t];if(!n){const k=Object.keys(Jp).join(" / ");throw K(new Error(`unknown cipher type '${t}'. Must be ${k}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw K(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");const i=n.keySize,a=n.ivSize,s=20,o=le("key expansion"),u=2*(a+i+s),c=await Qp.create(e,r);let d=await c.digest(o);const h=[];let y=0;for(;y<u;){const k=await c.digest(Bt([d,o]));let R=k.length;y+R>u&&(R=u-y),h.push(k),y+=R,d=await c.digest(d)}const p=u/2,m=Bt(h),_=m.slice(0,p),I=m.slice(p,u),f=k=>({iv:k.slice(0,a),cipherKey:k.slice(a,a+i),macKey:k.slice(a+i)});return{k1:f(_),k2:f(I)}},sI=function(t,e){if(!t.includes(e)){const r=t.join(" / ");throw K(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}};const{base64urlToBuffer:Zp}=Ru,e0={"P-256":256,"P-384":384,"P-521":521};var oI=async function(t){sI(Object.keys(e0),t);const e=await Pt.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,a)=>{let s;a?s=await Pt.get().subtle.importKey("jwk",uI(t,a),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):s=e.privateKey;const o=[await Pt.get().subtle.importKey("jwk",r0(t,i),{name:"ECDH",namedCurve:t},!1,[]),s],u=await Pt.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:o[0]},o[1],e0[t]);return new Uint8Array(u,u.byteOffset,u.byteLength)},n=await Pt.get().subtle.exportKey("jwk",e.publicKey);return{key:cI(n),genSharedKey:r}};const t0={"P-256":32,"P-384":48,"P-521":66};function cI(t){const e=t0[t.crv];return Bt([Uint8Array.from([4]),Zp(t.x,e),Zp(t.y,e)],1+e*2)}function r0(t,e){const r=t0[t];if(Ve(!e.slice(0,1),Uint8Array.from([4])))throw K(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:se(e.slice(1,r+1),"base64url"),y:se(e.slice(1+r),"base64url"),ext:!0}}const uI=(t,e)=>({...r0(t,e.public),d:se(e.private,"base64url")});var dI={generateEphmeralKeyPair:oI},lI=async t=>dI.generateEphmeralKeyPair(t),ur=Z(function(t,e){const r=Ur(du);e=t.exports;const n={rsa:nA,ed25519:pA,secp256k1:eI(r,_u)};e.supportedKeys=n,e.keysPBM=r;const i={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function a(s){const o=n[s.toLowerCase()];if(!o){const u=Object.keys(n).join(" / ");throw K(new Error(`invalid or unsupported key type ${s}. Must be ${u}`),"ERR_UNSUPPORTED_KEY_TYPE")}return o}e.keyStretcher=aI,e.generateEphemeralKeyPair=lI,e.generateKeyPair=async(s,o)=>a(s).generateKeyPair(o),e.generateKeyPairFromSeed=async(s,o,u)=>{const c=a(s);if(s.toLowerCase()!=="ed25519")throw K(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return c.generateKeyPairFromSeed(o,u)},e.unmarshalPublicKey=s=>{const o=r.PublicKey.decode(s),u=o.Data;switch(o.Type){case r.KeyType.RSA:return n.rsa.unmarshalRsaPublicKey(u);case r.KeyType.Ed25519:return n.ed25519.unmarshalEd25519PublicKey(u);case r.KeyType.Secp256k1:if(n.secp256k1)return n.secp256k1.unmarshalSecp256k1PublicKey(u);throw K(new Error(i.message),i.code);default:a(o.Type)}},e.marshalPublicKey=(s,o)=>(o=(o||"rsa").toLowerCase(),a(o),s.bytes),e.unmarshalPrivateKey=async s=>{const o=r.PrivateKey.decode(s),u=o.Data;switch(o.Type){case r.KeyType.RSA:return n.rsa.unmarshalRsaPrivateKey(u);case r.KeyType.Ed25519:return n.ed25519.unmarshalEd25519PrivateKey(u);case r.KeyType.Secp256k1:if(n.secp256k1)return n.secp256k1.unmarshalSecp256k1PrivateKey(u);throw K(new Error(i.message),i.code);default:a(o.Type)}},e.marshalPrivateKey=(s,o)=>(o=(o||"rsa").toLowerCase(),a(o),s.bytes),e.import=async(s,o)=>{try{const d=await m5.import(s,o);return e.unmarshalPrivateKey(d)}catch(d){}const u=E.pki.decryptRsaPrivateKey(s,o);if(u===null)throw K(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let c=E.asn1.toDer(E.pki.privateKeyToAsn1(u));return c=le(c.getBytes(),"ascii"),n.rsa.unmarshalRsaPrivateKey(c)}}),fI=Ur(`

message PeerIdProto {
  required bytes id = 1;
  bytes pubKey = 2;
  bytes privKey = 3;
}

`),be=Z(function(t,e){const{PeerIdProto:r}=fI;class n{constructor(c,d,h){if(!(c instanceof Uint8Array))throw new Error("invalid id provided");if(d&&h&&!Ve(d.public.bytes,h.bytes))throw new Error("inconsistent arguments");this._id=c,this._idB58String=Xt.toB58String(this.id),this._privKey=d,this._pubKey=h}get id(){return this._id}set id(c){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(c){this._privKey=c}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{const c=Xt.decode(this.id);c.name==="identity"&&(this._pubKey=ur.unmarshalPublicKey(c.digest))}catch(c){}return this._pubKey}set pubKey(c){this._pubKey=c}marshalPubKey(){if(this.pubKey)return ur.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return ur.marshalPrivateKey(this.privKey)}marshal(c){return r.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:c?null:this.marshalPrivKey()})}toPrint(){let c=this.toB58String();c.startsWith("Qm")&&(c=c.slice(2));let d=6;return c.length<d&&(d=c.length),"<peer.ID "+c.substr(0,d)+">"}toJSON(){return{id:this.toB58String(),privKey:u(this.marshalPrivKey()),pubKey:u(this.marshalPubKey())}}toHexString(){return Xt.toHexString(this.id)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){const c=new za(1,"libp2p-key",this.id,"base32");this._idCIDString=c.toBaseEncodedString("base32")}return this._idCIDString}equals(c){if(c instanceof Uint8Array)return Ve(this.id,c);if(c.id)return Ve(this.id,c.id);throw new Error("not valid Id")}isEqual(c){return this.equals(c)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&Ve(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{const c=Xt.decode(this.id);if(c.name==="identity")return!0}catch(c){}return!1}}const i=vn(n,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});e=t.exports=i;const a=c=>c.bytes.length<=42?Xt.encode(c.bytes,"identity"):c.hash(),s=async(c,d)=>{const h=await a(d);return new i(h,c,d)};e.create=async c=>{c=c||{},c.bits=c.bits||2048,c.keyType=c.keyType||"RSA";const d=await ur.generateKeyPair(c.keyType,c.bits);return s(d,d.public)},e.createFromHexString=c=>new i(Xt.fromHexString(c)),e.createFromBytes=c=>new i(c),e.createFromB58String=c=>e.createFromCID(c);const o=c=>c.codec==="libp2p-key"||c.codec==="dag-pb";e.createFromCID=c=>{if(c=za.isCID(c)?c:new za(c),!o(c))throw new Error("Supplied PeerID CID has invalid multicodec: "+c.codec);return new i(c.multihash)},e.createFromPubKey=async c=>{let d=c;if(typeof d=="string"&&(d=le(c,"base64pad")),!(d instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");const h=await ur.unmarshalPublicKey(d);return s(null,h)},e.createFromPrivKey=async c=>{if(typeof c=="string"&&(c=le(c,"base64pad")),!(c instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");const d=await ur.unmarshalPrivateKey(c);return s(d,d.public)},e.createFromJSON=async c=>{const d=Xt.fromB58String(c.id),h=c.privKey&&le(c.privKey,"base64pad"),y=c.pubKey&&le(c.pubKey,"base64pad"),p=y&&await ur.unmarshalPublicKey(y);if(!h)return new i(d,null,p);const m=await ur.unmarshalPrivateKey(h),_=await a(m.public);let I;if(p&&(I=await a(p)),p&&!Ve(_,I))throw new Error("Public and private key do not match");if(d&&!Ve(_,d))throw new Error("Id and private key do not match");return new i(d,m,p)},e.createFromProtobuf=async c=>{typeof c=="string"&&(c=le(c,"base16"));let{id:d,privKey:h,pubKey:y}=r.decode(c);h=h?await ur.unmarshalPrivateKey(h):!1,y=y?await ur.unmarshalPublicKey(y):!1;let p,m;if(h&&(m=await a(h.public)),y&&(p=await a(y)),h){if(y&&!Ve(m,p))throw new Error("Public and private key do not match");return new i(m,h,h.public)}if(y)return new i(p,null,y);if(d)return new i(d);throw new Error("Protobuf did not contain any usable key material")},e.isPeerId=c=>Boolean(typeof c=="object"&&c._id&&c._idB58String);function u(c){if(c)return se(c,"base64pad")}});const{hasOwnProperty:n0}=Object.prototype,{propertyIsEnumerable:hI}=Object,ea=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),pI=pe,i0={concatArrays:!1,ignoreUndefined:!1},ao=t=>{const e=[];for(const r in t)n0.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(t);for(const n of r)hI.call(t,n)&&e.push(n)}return e};function ta(t){return Array.isArray(t)?mI(t):Yn(t)?bI(t):t}function mI(t){const e=t.slice(0,0);return ao(t).forEach(r=>{ea(e,r,ta(t[r]))}),e}function bI(t){const e=Object.getPrototypeOf(t)===null?Object.create(null):{};return ao(t).forEach(r=>{ea(e,r,ta(t[r]))}),e}const a0=(t,e,r,n)=>(r.forEach(i=>{if(typeof e[i]=="undefined"&&n.ignoreUndefined)return;i in t&&t[i]!==Object.getPrototypeOf(t)?ea(t,i,zu(t[i],e[i],n)):ea(t,i,ta(e[i]))}),t),yI=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(a=>{const s=[];for(let o=0;o<a.length;o++){if(!n0.call(a,o))continue;s.push(String(o)),a===t?ea(n,i++,a[o]):ea(n,i++,ta(a[o]))}n=a0(n,a,ao(a).filter(o=>!s.includes(o)),r)}),n};function zu(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?yI(t,e,r):!Yn(e)||!Yn(t)?ta(e):a0(t,e,ao(e),r)}var rs=function(...t){const e=zu(ta(i0),this!==pI&&this||{},i0);let r={_:{}};for(const n of t){if(n===void 0)continue;if(!Yn(n))throw new TypeError("`"+n+"` is not an Option Object");r=zu(r,{_:n},e)}return r._};(function(){if(typeof globalThis=="object")return;Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__})();var mi=globalThis,gI=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;const n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(n,r.indent.repeat(e))};const s0=/\s+at.*(?:\(|\s)(.*)\)?/,vI=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,wI=typeof Yt.homedir=="undefined"?"":Yt.homedir();var EI=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{const n=r.match(s0);if(n===null||!n[1])return!0;const i=n[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")?!1:!vI.test(i)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(s0,(n,i)=>n.replace(i,i.replace(wI,"~"))):r).join(`
`));const xI=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,"");class SI extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);t=[...t].map(r=>r instanceof Error?r:r!==null&&typeof r=="object"?Object.assign(new Error(r.message),r):new Error(r));let e=t.map(r=>typeof r.stack=="string"?xI(EI(r.stack)):String(r)).join(`
`);e=`
`+gI(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(const t of this._errors)yield t}}var o0=SI;class c0 extends Error{constructor(t){super(t||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}}class $u{static fn(t){return(...e)=>new $u((r,n,i)=>{e.push(i),t(...e).then(r,n)})}constructor(t){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((e,r)=>{this._reject=r;const n=s=>{this._isPending=!1,e(s)},i=s=>{this._isPending=!1,r(s)},a=s=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(s)};return Object.defineProperties(a,{shouldReject:{get:()=>this._rejectOnCancel,set:s=>{this._rejectOnCancel=s}}}),t(n,i,a)})}then(t,e){return this._promise.then(t,e)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(t){if(!this._isPending||this._isCanceled)return;if(this._cancelHandlers.length>0)try{for(const e of this._cancelHandlers)e()}catch(e){this._reject(e)}this._isCanceled=!0,this._rejectOnCancel&&this._reject(new c0(t))}get isCanceled(){return this._isCanceled}}Object.setPrototypeOf($u.prototype,Promise.prototype);var Gu=$u,AI=c0;Gu.CancelError=AI;class u0 extends Error{}const II=(t,e)=>new Gu((r,n,i)=>{const{count:a,filter:s=()=>!0}=e;if(!Number.isFinite(a)){n(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}const o=[],u=[];let c=0,d=!1;const h=new Set,y=()=>(o.length===a&&(r(o),d=!0),c-u.length<a&&(n(new o0(u)),d=!0),d),p=()=>{for(const m of t)!h.has(m)&&typeof m.cancel=="function"&&m.cancel()};i(p);for(const m of t)c++,(async()=>{try{const _=await m;if(d)return;if(!s(_))throw new u0("Value does not satisfy filter");o.push(_)}catch(_){u.push(_)}finally{h.add(m),!d&&y()&&p()}})();a>c&&(n(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${c} items`)),p())});var so=II,kI=o0,TI=u0;so.AggregateError=kI,so.FilterError=TI;var oo=(t,e)=>{const r=so(t,{...e,count:1});return Gu.fn(async n=>{n(()=>{r.cancel()});const[i]=await r;return i})()},CI=so.AggregateError;oo.AggregateError=CI;var _I=t=>{const e=t._modules.peerRouting||[];return t._dht&&e.unshift(t._dht),{findPeer:async(r,n)=>{if(!e.length)throw K(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");return oo(e.map(async i=>{const a=await i.findPeer(r,n);if(!a||Object.keys(a).length===0)throw K(new Error("not found"),"NOT_FOUND");return a}))}}},RI={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"},NI={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"},Ot={messages:RI,codes:NI};const PI=async t=>{const e=[];for await(const r of t)e.push(r);return e};var DI=PI;const{messages:Hu,codes:Wu}=Ot;var OI=t=>{const e=t._modules.contentRouting||[],r=t._dht;return r&&e.unshift(r),{async*findProviders(n,i){if(!e.length)throw K(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");const a=await oo(e.map(async s=>{const o=await DI(s.findProviders(n,i));if(!o||!o.length)throw K(new Error("not found"),"NOT_FOUND");return o}));for(const s of a)yield s},async provide(n){if(!e.length)throw K(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");return Promise.all(e.map(i=>i.provide(n)))},async put(n,i,a){if(!t.isStarted()||!r.isStarted)throw K(new Error(Hu.NOT_STARTED_YET),Wu.DHT_NOT_STARTED);return r.put(n,i,a)},async get(n,i){if(!t.isStarted()||!r.isStarted)throw K(new Error(Hu.NOT_STARTED_YET),Wu.DHT_NOT_STARTED);return r.get(n,i)},async getMany(n,i,a){if(!t.isStarted()||!r.isStarted)throw K(new Error(Hu.NOT_STARTED_YET),Wu.DHT_NOT_STARTED);return r.getMany(n,i,a)}}};const d0="[a-fA-F\\d:]",qn=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${d0})|(?<=${d0})(?=\\s|$))`:"",Ir="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",xt="[a-fA-F\\d]{1,4}",co=`
(
(?:${xt}:){7}(?:${xt}|:)|                                // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${xt}:){6}(?:${Ir}|:${xt}|:)|                         // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${xt}:){5}(?::${Ir}|(:${xt}){1,2}|:)|                 // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${xt}:){4}(?:(:${xt}){0,1}:${Ir}|(:${xt}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${xt}:){3}(?:(:${xt}){0,2}:${Ir}|(:${xt}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${xt}:){2}(?:(:${xt}){0,3}:${Ir}|(:${xt}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${xt}:){1}(?:(:${xt}){0,4}:${Ir}|(:${xt}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::((?::${xt}){0,5}:${Ir}|(?::${xt}){1,7}|:))           // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(%[0-9a-zA-Z]{1,})?                                           // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),BI=new RegExp(`(?:^${Ir}$)|(?:^${co}$)`),MI=new RegExp(`^${Ir}$`),LI=new RegExp(`^${co}$`),Yu=t=>t&&t.exact?BI:new RegExp(`(?:${qn(t)}${Ir}${qn(t)})|(?:${qn(t)}${co}${qn(t)})`,"g");Yu.v4=t=>t&&t.exact?MI:new RegExp(`${qn(t)}${Ir}${qn(t)}`,"g"),Yu.v6=t=>t&&t.exact?LI:new RegExp(`${qn(t)}${co}${qn(t)}`,"g");var Xu=Yu;const ra=t=>Xu({exact:!0}).test(t);ra.v4=t=>Xu.v4({exact:!0}).test(t),ra.v6=t=>Xu.v6({exact:!0}).test(t),ra.version=t=>ra(t)?ra.v4(t)?4:6:void 0;var Qu=ra;const UI=Qu,Ju=Qu.v4,l0=Qu.v6,f0=function(t,e,r){r=~~r;var n;if(Ju(t))n=e||new Uint8Array(r+4),t.split(/\./g).map(function(d){n[r++]=parseInt(d,10)&255});else if(l0(t)){var i=t.split(":",8),a;for(a=0;a<i.length;a++){var s=Ju(i[a]),o;s&&(o=f0(i[a]),i[a]=se(o.slice(0,2),"base16")),o&&++a<8&&i.splice(a,0,se(o.slice(2,4),"base16"))}if(i[0]==="")for(;i.length<8;)i.unshift("0");else if(i[i.length-1]==="")for(;i.length<8;)i.push("0");else if(i.length<8){for(a=0;a<i.length&&i[a]!=="";a++);var u=[a,"1"];for(a=9-i.length;a>0;a--)u.push("0");i.splice.apply(i,u)}for(n=e||new Uint8Array(r+16),a=0;a<i.length;a++){var c=parseInt(i[a],16);n[r++]=c>>8&255,n[r++]=c&255}}if(!n)throw Error("Invalid ip address: "+t);return n},KI=function(t,e,r){e=~~e,r=r||t.length-e;var n=[],i;const a=new DataView(t.buffer);if(r===4){for(let s=0;s<r;s++)n.push(t[e+s]);i=n.join(".")}else if(r===16){for(let s=0;s<r;s+=2)n.push(a.getUint16(e+s).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};var uo={isIP:UI,isV4:Ju,isV6:l0,toBytes:f0,toString:KI};function Ht(t){if(typeof t=="number"){if(Ht.codes[t])return Ht.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"||t instanceof String){if(Ht.names[t])return Ht.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}const dr=-1;Ht.lengthPrefixedVarSize=dr,Ht.V=dr,Ht.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,dr,"ip6zone"],[53,dr,"dns","resolvable"],[54,dr,"dns4","resolvable"],[55,dr,"dns6","resolvable"],[56,dr,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,dr,"unix",!1,"path"],[421,dr,"ipfs"],[421,dr,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,dr,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,dr,"memory"]],Ht.names={},Ht.codes={},Ht.table.map(t=>{const e=h0.apply(null,t);Ht.codes[e.code]=e,Ht.names[e.name]=e}),Ht.object=h0;function h0(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}var kr=Ht,p0=ns;function ns(t,e){return e instanceof Uint8Array?ns.toString(t,e):ns.toBytes(t,e)}ns.toString=function(e,r){e=kr(e);switch(e.code){case 4:case 41:return FI(r);case 6:case 273:case 33:case 132:return b0(r);case 53:case 54:case 55:case 56:case 400:case 777:return qI(r);case 421:return zI(r);case 444:return y0(r);case 445:return y0(r);default:return se(r,"base16")}},ns.toBytes=function(e,r){e=kr(e);switch(e.code){case 4:return m0(r);case 41:return m0(r);case 6:case 273:case 33:case 132:return Zu(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return jI(r);case 421:return VI(r);case 444:return $I(r);case 445:return GI(r);default:return le(r,"base16")}};function m0(t){if(!uo.isIP(t))throw new Error("invalid ip address");return uo.toBytes(t)}function FI(t){const e=uo.toString(t);if(!e||!uo.isIP(e))throw new Error("invalid ip address");return e}function Zu(t){const e=new ArrayBuffer(2),r=new DataView(e);return r.setUint16(0,t),new Uint8Array(e)}function b0(t){const e=new DataView(t.buffer);return e.getUint16(0)}function jI(t){const e=le(t),r=Uint8Array.from(W.encode(e.length));return Bt([r,e],r.length+e.length)}function qI(t){const e=W.decode(t);if(t=t.slice(W.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return se(t)}function VI(t){const e=new za(t).multihash,r=Uint8Array.from(W.encode(e.length));return Bt([r,e],r.length+e.length)}function zI(t){const e=W.decode(t),r=t.slice(W.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return se(r,"base58btc")}function $I(t){const e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");const r=Mr.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const i=Zu(n);return Bt([r,i],r.length+i.length)}function GI(t){const e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");const r=Mr.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const i=Zu(n);return Bt([r,i],r.length+i.length)}function y0(t){const e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=se(e,"base32"),i=b0(r);return n+":"+i}var Tr={stringToStringTuples:g0,stringTuplesToString:v0,tuplesToStringTuples:E0,stringTuplesToTuples:w0,bytesToTuples:ed,tuplesToBytes:x0,bytesToString:HI,stringToBytes:A0,fromString:WI,fromBytes:I0,validateBytes:td,isValidBytes:YI,cleanPath:lo,ParseError:rd,protoFromTuple:is,sizeForAddr:S0};function g0(t){const e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){const i=r[n],a=kr(i);if(a.size===0){e.push([i]);continue}if(n++,n>=r.length)throw rd("invalid address: "+t);if(a.path){e.push([i,lo(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function v0(t){const e=[];return t.map(r=>{const n=is(r);e.push(n.name),r.length>1&&e.push(r[1])}),lo(e.join("/"))}function w0(t){return t.map(e=>{Array.isArray(e)||(e=[e]);const r=is(e);return e.length>1?[r.code,p0.toBytes(r.code,e[1])]:[r.code]})}function E0(t){return t.map(e=>{const r=is(e);return e.length>1?[r.code,p0.toString(r.code,e[1])]:[r.code]})}function x0(t){return I0(Bt(t.map(e=>{const r=is(e);let n=Uint8Array.from(W.encode(r.code));return e.length>1&&(n=Bt([n,e[1]])),n})))}function S0(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{const r=W.decode(e);return r+W.decode.bytes}}function ed(t){const e=[];let r=0;for(;r<t.length;){const n=W.decode(t,r),i=W.decode.bytes,a=kr(n),s=S0(a,t.slice(r+i));if(s===0){e.push([n]),r+=i;continue}const o=t.slice(r+i,r+i+s);if(r+=s+i,r>t.length)throw rd("Invalid address Uint8Array: "+se(t,"base16"));e.push([n,o])}return e}function HI(t){const e=ed(t),r=E0(e);return v0(r)}function A0(t){t=lo(t);const e=g0(t),r=w0(e);return x0(r)}function WI(t){return A0(t)}function I0(t){const e=td(t);if(e)throw e;return Uint8Array.from(t)}function td(t){try{ed(t)}catch(e){return e}}function YI(t){return td(t)===void 0}function lo(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function rd(t){return new Error("Error parsing address: "+t)}function is(t){const e=kr(t[0]);return e}var De=Z(function(t,e){const r=Symbol.for("nodejs.util.inspect.custom"),n=new Map,i=vn.proto(function(a){if(!(this instanceof i))return new i(a);if(a==null&&(a=""),a instanceof Uint8Array)this.bytes=Tr.fromBytes(a);else if(typeof a=="string"||a instanceof String){if(a.length>0&&a.charAt(0)!=="/")throw new Error(`multiaddr "${a}" must start with a "/"`);this.bytes=Tr.fromString(a)}else if(a.bytes&&a.protos&&a.protoCodes)this.bytes=Tr.fromBytes(a.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")},{className:"Multiaddr",symbolName:"@multiformats/js-multiaddr/multiaddr"});i.prototype.toString=function(){return Tr.bytesToString(this.bytes)},i.prototype.toJSON=i.prototype.toString,i.prototype.toOptions=function(){const s={},o=this.toString().split("/");return s.family=o[1]==="ip4"?"ipv4":"ipv6",s.host=o[2],s.transport=o[3],s.port=parseInt(o[4]),s},i.prototype[r]=function(){return"<Multiaddr "+se(this.bytes,"base16")+" - "+Tr.bytesToString(this.bytes)+">"},i.prototype.inspect=function(){return"<Multiaddr "+se(this.bytes,"base16")+" - "+Tr.bytesToString(this.bytes)+">"},i.prototype.protos=function(){return this.protoCodes().map(s=>Object.assign({},kr(s)))},i.prototype.protoCodes=function(){const s=[],o=this.bytes;let u=0;for(;u<o.length;){const c=W.decode(o,u),d=W.decode.bytes,h=kr(c),y=Tr.sizeForAddr(h,o.slice(u+d));u+=y+d,s.push(c)}return s},i.prototype.protoNames=function(){return this.protos().map(s=>s.name)},i.prototype.tuples=function(){return Tr.bytesToTuples(this.bytes)},i.prototype.stringTuples=function(){const s=Tr.bytesToTuples(this.bytes);return Tr.tuplesToStringTuples(s)},i.prototype.encapsulate=function(s){return s=i(s),i(this.toString()+s.toString())},i.prototype.decapsulate=function(s){s=s.toString();const o=this.toString(),u=o.lastIndexOf(s);if(u<0)throw new Error("Address "+this+" does not contain subaddress: "+s);return i(o.slice(0,u))},i.prototype.decapsulateCode=function(s){const o=this.tuples();for(let u=o.length-1;u>=0;u--)if(o[u][0]===s)return i(Tr.tuplesToBytes(o.slice(0,u)));return this},i.prototype.getPeerId=function(){let s=null;try{const o=this.stringTuples().filter(u=>{if(u[0]===kr.names.ipfs.code)return!0});s=o.pop()[1],s=se(new za(s).multihash,"base58btc")}catch(o){s=null}return s},i.prototype.getPath=function(){let s=null;try{s=this.stringTuples().filter(o=>{const u=kr(o[0]);if(u.path)return!0})[0][1]}catch(o){s=null}return s},i.prototype.equals=function(s){return Ve(this.bytes,s.bytes)},i.prototype.resolve=async function(){const s=this.protos().find(c=>c.resolvable);if(!s)return[this];const o=n.get(s.name);if(!o)throw K(new Error(`no available resolver for ${s.name}`),"ERR_NO_AVAILABLE_RESOLVER");const u=await o(this);return u.map(c=>i(c))},i.prototype.nodeAddress=function(){const s=this.protoCodes(),o=this.protoNames(),u=this.toString().split("/").slice(1);if(u.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(s[0]!==4&&s[0]!==41&&s[0]!==54&&s[0]!==55)throw new Error(`no protocol with name: "'${o[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(u[2]!=="tcp"&&u[2]!=="udp")throw new Error(`no protocol with name: "'${o[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:s[0]===41||s[0]===55?6:4,address:u[1],port:parseInt(u[3])}},i.fromNodeAddress=function(s,o){if(!s)throw new Error("requires node address object");if(!o)throw new Error("requires transport protocol");let u;switch(s.family){case"IPv4":u="ip4";break;case"IPv6":u="ip6";break;default:throw Error(`Invalid addr family. Got '${s.family}' instead of 'IPv4' or 'IPv6'`)}return i("/"+[u,s.address,o,s.port].join("/"))},i.prototype.isThinWaistAddress=function(s){const o=(s||this).protos();return o.length!==2||o[0].code!==4&&o[0].code!==41?!1:!(o[1].code!==6&&o[1].code!==273)},i.protocols=kr,i.isName=function(s){return i.isMultiaddr(s)?s.protos().some(o=>o.resolvable):!1},i.resolve=function(s){return!i.isMultiaddr(s)||!i.isName(s)?Promise.reject(Error("not a valid name")):Promise.reject(new Error("not implemented yet"))},i.resolvers=n,e=t.exports=i});const{codes:XI}=Ot;function QI(t){typeof t=="string"&&(t=De(t));let e;if(De.isMultiaddr(t)){e=t;try{t=be.createFromB58String(t.getPeerId())}catch(r){throw K(new Error(`${t} is not a valid peer type`),XI.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}var fo=QI,JI=k0,Vn=k0.prototype,ZI=new Date%1e9;function ek(){return(Math.random()*1e9>>>0)+ZI++}function k0(t){t=t||{},this.id=t.id||ek(),this.max=t.max||Infinity,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,n=this.items.length;n--;)e=this.items[n],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}Vn.has=function(t){return t in this._lookup},Vn.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value},Vn.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null},Vn.set=function(t,e,r){var n=this._lookup[t],i=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this},Vn.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1},Vn.expire=function(t,e){var r=e||0,n=this._lookup[t];if(!n)return this;if(typeof r=="string"&&(r=sl(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this},Vn.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this},Vn.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}};var T0=Object.prototype.toString,C0=function(e){var r=T0.call(e),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&T0.call(e.callee)==="[object Function]"),n},_0;if(!Object.keys){var ho=Object.prototype.hasOwnProperty,R0=Object.prototype.toString,tk=C0,N0=Object.prototype.propertyIsEnumerable,rk=!N0.call({toString:null},"toString"),nk=N0.call(function(){},"prototype"),po=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],nd=function(t){var e=t.constructor;return e&&e.prototype===t},ik={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},ak=function(){if(typeof window=="undefined")return!1;for(var t in window)try{if(!ik["$"+t]&&ho.call(window,t)&&window[t]!==null&&typeof window[t]=="object")try{nd(window[t])}catch(e){return!0}}catch(e){return!0}return!1}(),sk=function(t){if(typeof window=="undefined"||!ak)return nd(t);try{return nd(t)}catch(e){return!1}};_0=function(e){var r=e!==null&&typeof e=="object",n=R0.call(e)==="[object Function]",i=tk(e),a=r&&R0.call(e)==="[object String]",s=[];if(!r&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var o=nk&&n;if(a&&e.length>0&&!ho.call(e,0))for(var u=0;u<e.length;++u)s.push(String(u));if(i&&e.length>0)for(var c=0;c<e.length;++c)s.push(String(c));else for(var d in e)!(o&&d==="prototype")&&ho.call(e,d)&&s.push(String(d));if(rk)for(var h=sk(e),y=0;y<po.length;++y)!(h&&po[y]==="constructor")&&ho.call(e,po[y])&&s.push(po[y]);return s}}var ok=_0,ck=Array.prototype.slice,P0=Object.keys,mo=P0?function(e){return P0(e)}:ok,D0=Object.keys;mo.shim=function(){if(Object.keys){var e=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);e||(Object.keys=function(n){return C0(n)?D0(ck.call(n)):D0(n)})}else Object.keys=mo;return Object.keys||mo};var uk=mo,dk=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",lk=Object.prototype.toString,fk=Array.prototype.concat,id=Object.defineProperty,hk=function(t){return typeof t=="function"&&lk.call(t)==="[object Function]"},pk=function(){var t={};try{id(t,"x",{enumerable:!1,value:t});for(var e in t)return!1;return t.x===t}catch(r){return!1}},O0=id&&pk(),mk=function(t,e,r,n){if(e in t&&(!hk(n)||!n()))return;O0?id(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r},B0=function(t,e){var r=arguments.length>2?arguments[2]:{},n=uk(e);dk&&(n=fk.call(n,Object.getOwnPropertySymbols(e)));for(var i=0;i<n.length;i+=1)mk(t,n[i],e[n[i]],r[n[i]])};B0.supportsDescriptors=!!O0;var M0=B0,L0=Z(function(t){typeof self!="undefined"?t.exports=self:typeof window!="undefined"?t.exports=window:t.exports=Function("return this")()}),ad=function(){return typeof pe!="object"||!pe||pe.Math!==Math||pe.Array!==Array?L0:pe},bk=function(){var e=ad();if(M0.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(e,"globalThis");(!r||r.configurable&&(r.enumerable||r.writable||globalThis!==e))&&Object.defineProperty(e,"globalThis",{configurable:!0,enumerable:!1,value:e,writable:!1})}else(typeof globalThis!="object"||globalThis!==e)&&(e.globalThis=e);return e},yk=ad(),U0=function(){return yk};M0(U0,{getPolyfill:ad,implementation:L0,shim:bk});var gk=U0,vk=Z(function(t){const e=gk();e.fetch&&e.Headers&&e.Request&&e.Response?(t.exports=function(...n){return e.fetch(...n)},t.exports.Headers=e.Headers,t.exports.Request=e.Request,t.exports.Response=e.Response,t.exports.default=t.exports):t.exports=kb});const{default:wk,Headers:Ek}=vk;function xk({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}var Sk=xk;function Ak(t){return wk(t,{headers:new Ek({accept:"application/dns-json"})})}var Ik=Ak;function kk(t,e){return`${e}_${t}`}var Tk=kk,Ck={buildResource:Sk,fetch:Ik,getCacheKey:Tk};const bo=J("dns-over-http-resolver");bo.error=J("dns-over-http-resolver:error");const{buildResource:sd,fetch:od,getCacheKey:na}=Ck;class cd{constructor({maxCache:t=100}={}){this._cache=new JI({max:t}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){const t=[].concat(this._servers);for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*e),n=t[e];t[e]=t[r],t[r]=n}return t}setServers(t){this._servers=t}resolve(t,e="A"){switch(e){case"A":return this.resolve4(t);case"AAAA":return this.resolve6(t);case"TXT":return this.resolveTxt(t);default:throw new Error(`${e} is not supported`)}}async resolve4(t){const e="A",r=this._cache.get(na(t,e));if(r)return r;for(const n of this._getShuffledServers())try{const i=await od(sd({serverResolver:n,hostname:t,recordType:e})),a=await i.json(),s=a.Answer.map(u=>u.data),o=Math.min(a.Answer.map(u=>u.TTL));return this._cache.set(na(t,e),s,{ttl:o}),s}catch(i){bo.error(`${n} could not resolve ${t} record ${e}`)}throw new Error(`Could not resolve ${t} record ${e}`)}async resolve6(t){const e="AAAA",r=this._cache.get(na(t,e));if(r)return r;for(const n of this._getShuffledServers())try{const i=await od(sd({serverResolver:n,hostname:t,recordType:e})),a=await i.json(),s=a.Answer.map(u=>u.data),o=Math.min(a.Answer.map(u=>u.TTL));return this._cache.set(na(t,e),s,{ttl:o}),s}catch(i){bo.error(`${n} could not resolve ${t} record ${e}`)}throw new Error(`Could not resolve ${t} record ${e}`)}async resolveTxt(t){const e="TXT",r=this._cache.get(na(t,e));if(r)return r;for(const n of this._getShuffledServers())try{const i=await od(sd({serverResolver:n,hostname:t,recordType:e})),a=await i.json(),s=a.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),o=Math.min(a.Answer.map(u=>u.TTL));return this._cache.set(na(t,e),s,{ttl:o}),s}catch(i){bo.error(`${n} could not resolve ${t} record ${e}`)}throw new Error(`Could not resolve ${t} record ${e}`)}}cd.Resolver=cd;var _k=cd;let yo;try{if(yo=Ab.promises,!yo)throw new Error("no dns available")}catch(t){yo=_k}var Rk=yo;const{code:Nk}=kr("dnsaddr");async function Pk(t){const{Resolver:e}=Rk,r=new e,n=t.getPeerId(),[,i]=t.stringTuples().find(([o])=>o===Nk)||[],a=await r.resolveTxt(`_dnsaddr.${i}`);let s=a.flat().map(o=>o.split("=")[1]);return n&&(s=s.filter(o=>o.includes(n))),s}var Dk={dnsaddrResolver:Pk},as={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}};const K0=async t=>{try{const e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};var go=K0,Ok=K0;go.default=Ok;const F0=(t,...e)=>new Promise(r=>{r(t(...e))});var j0=F0,Bk=F0;j0.default=Bk;const q0=t=>{if(!((Number.isInteger(t)||t===Infinity)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));const e=[];let r=0;const n=()=>{r--,e.length>0&&e.shift()()},i=(o,u,...c)=>{r++;const d=j0(o,...c);u(d),d.then(n,n)},a=(o,u,...c)=>{r<t?i(o,u,...c):e.push(i.bind(null,o,u,...c))},s=(o,...u)=>new Promise(c=>a(o,c,...u));return Object.defineProperties(s,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),s};var V0=q0,Mk=q0;V0.default=Mk;var Lk=async(t,e={})=>{const{concurrency:r=Infinity}=e,n=V0(r);return Promise.all(t.map(i=>i&&typeof i.then=="function"?go(i):typeof i=="function"?go(n(()=>i())):go(Promise.resolve(i))))};const{codes:ia}=Ot,zn=J("libp2p:transports");zn.error=J("libp2p:transports:error");class z0{constructor({libp2p:t,upgrader:e,faultTolerance:r=ud.FATAL_ALL}){this.libp2p=t,this.upgrader=e,this._transports=new Map,this._listeners=new Map,this.faultTolerance=r}add(t,e,r={}){if(zn("adding %s",t),!t)throw K(new Error(`Transport must have a valid key, was given '${t}'`),ia.ERR_INVALID_KEY);if(this._transports.has(t))throw K(new Error("There is already a transport with this key"),ia.ERR_DUPLICATE_TRANSPORT);const n=new e({...r,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(t,n),this._listeners.has(t)||this._listeners.set(t,[])}async close(){const t=[];for(const[e,r]of this._listeners)for(zn("closing listeners for %s",e);r.length;){const n=r.pop();t.push(n.close())}await Promise.all(t),zn("all listeners closed");for(const e of this._listeners.keys())this._listeners.set(e,[])}async dial(t,e){const r=this.transportForMultiaddr(t);if(!r)throw K(new Error(`No transport available for address ${String(t)}`),ia.ERR_TRANSPORT_UNAVAILABLE);try{return await r.dial(t,e)}catch(n){throw n.code||(n.code=ia.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let t=[];for(const e of this._listeners.values())for(const r of e)t=[...t,...r.getAddrs()];return t}getTransports(){return this._transports.values()}transportForMultiaddr(t){for(const e of this._transports.values()){const r=e.filter([t]);if(r.length)return e}return null}async listen(){const t=this.libp2p.addressManager.getListenAddrs();if(t.length===0){zn("no addresses were provided for listening, this node is dial only");return}const e=[];for(const[r,n]of this._transports.entries()){const i=n.filter(t),a=[];for(const u of i){zn("creating listener for %s on %s",r,u);const c=n.createListener({},this.onConnection);this._listeners.get(r).push(c),a.push(c.listen(u))}if(a.length===0){e.push(r);continue}const s=await Lk(a),o=s.find(u=>u.isFulfilled===!0);if(!o)throw K(new Error(`Transport (${r}) could not listen on any available address`),ia.ERR_NO_VALID_ADDRESSES)}if(e.length===this._transports.size){const r=`no valid addresses were provided for transports [${e}]`;if(this.faultTolerance===ud.FATAL_ALL)throw K(new Error(r),ia.ERR_NO_VALID_ADDRESSES);zn(`libp2p in dial mode only: ${r}`)}}async remove(t){if(zn("removing %s",t),this._listeners.has(t))for(const e of this._listeners.get(t))await e.close();this._transports.delete(t),this._listeners.delete(t)}async removeAll(){const t=[];for(const e of this._transports.keys())t.push(this.remove(e));await Promise.all(t)}}const ud={FATAL_ALL:0,NO_FATAL:1};z0.FaultTolerance=ud;var $0=z0;const{dnsaddrResolver:Uk}=Dk,{FaultTolerance:Kk}=$0,Fk={addresses:{listen:[],announce:[],noAnnounce:[]},connectionManager:{minConnections:25},transportManager:{faultTolerance:Kk.FATAL_ALL},dialer:{maxParallelDials:as.MAX_PARALLEL_DIALS,maxDialsPerPeer:as.MAX_PER_PEER_DIALS,dialTimeout:as.DIAL_TIMEOUT,resolvers:{dnsaddr:Uk}},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},config:{dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0,emitSelf:!0,signMessages:!0,strictSigning:!0},relay:{enabled:!0,hop:{enabled:!1,active:!1}},transport:{}}};var jk=t=>{if(t=rs(Fk,t),t.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return t},qk={validate:jk};const Vk=J("libp2p:addresses");Vk.error=J("libp2p:addresses:error");class zk{constructor({listen:t=[],announce:e=[],noAnnounce:r=[]}={}){this.listen=new Set(t),this.announce=new Set(e),this.noAnnounce=new Set(r)}getListenAddrs(){return Array.from(this.listen).map(t=>De(t))}getAnnounceAddrs(){return Array.from(this.announce).map(t=>De(t))}getNoAnnounceAddrs(){return Array.from(this.noAnnounce).map(t=>De(t))}}var $k=zk;const dd=J("latency-monitor:VisibilityChangeEmitter");var Gk=class extends Rr{constructor(){super();if(typeof document=="undefined"){dd('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?dd("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){return this._hidden===void 0||document[this._hidden]===void 0?void 0:!document[this._hidden]}_handleVisibilityChange(){const e=!document[this._hidden];dd(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};const ln=J("latency-monitor:LatencyMonitor");class Hk extends Rr{constructor({latencyCheckIntervalMs:t,dataEmitIntervalMs:e,asyncTestFn:r,latencyRandomPercentage:n}={}){super();const i=this;i.latencyCheckIntervalMs=t||500,i.latencyRandomPercentage=n||10,i._latecyCheckMultiply=2*(i.latencyRandomPercentage/100)*i.latencyCheckIntervalMs,i._latecyCheckSubtract=i._latecyCheckMultiply/2,i.dataEmitIntervalMs=e===null||e===0?void 0:e||5*1e3,ln("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",i.latencyCheckIntervalMs,i.dataEmitIntervalMs),i.dataEmitIntervalMs?ln("Expecting ~%s events per summary",i.latencyCheckIntervalMs/i.dataEmitIntervalMs):ln("Not emitting summaries"),i.asyncTestFn=r,mi.process&&mi.process.hrtime?(ln("Using process.hrtime for timing"),i.now=mi.process.hrtime,i.getDeltaMS=a=>{const s=i.now(a);return s[0]*1e3+s[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(ln("Using performance.now for timing"),i.now=window.performance.now.bind(window.performance),i.getDeltaMS=a=>Math.round(i.now()-a)):(ln("Using Date.now for timing"),i.now=Date.now,i.getDeltaMS=a=>i.now()-a),i._latencyData=i._initLatencyData(),Wk()&&(i._visibilityChangeEmitter=new Gk,i._visibilityChangeEmitter.on("visibilityChange",a=>{a?i._startTimers():(i._emitSummary(),i._stopTimers())})),(!i._visibilityChangeEmitter||i._visibilityChangeEmitter.isVisible())&&i._startTimers()}_startTimers(){if(this._checkLatencyID)return;this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref())}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){const t=this.getSummary();t.events>0&&this.emit("data",t)}getSummary(){const t={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),ln("Summary: %O",t),t}_checkLatency(){const t=this,e=Math.random()*t._latecyCheckMultiply-t._latecyCheckSubtract,r={deltaOffset:Math.ceil(t.latencyCheckIntervalMs+e),startTime:t.now()},n=()=>{if(!this._checkLatencyID)return;const i=t.getDeltaMS(r.startTime)-r.deltaOffset;t._checkLatency(),t._latencyData.events++,t._latencyData.minMs=Math.min(t._latencyData.minMs,i),t._latencyData.maxMs=Math.max(t._latencyData.maxMs,i),t._latencyData.totalMs+=i,ln("MS: %s Data: %O",i,t._latencyData)};ln("localData: %O",r),this._checkLatencyID=setTimeout(()=>{t.asyncTestFn?(r.deltaOffset=0,r.startTime=t.now(),t.asyncTestFn(n)):(r.deltaOffset-=1,n())},r.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}function Wk(){return typeof window!="undefined"}var Yk=Hk,ld=function(){return Date.now()};function fd(t,e,r){var n=this;this._started=ld(),this._rescheduled=0,this._scheduled=e,this._args=r,this._timer=setTimeout(i,e);function i(){n._rescheduled>0?(n._scheduled=n._rescheduled-(ld()-n._started),n._timer=setTimeout(i,n._scheduled),n._rescheduled=0):t.apply(null,n._args)}}fd.prototype.reschedule=function(t){var e=ld();return e+t-(this._started+this._scheduled)<0?!1:(this._started=e,this._rescheduled=t,!0)},fd.prototype.clear=function(){clearTimeout(this._timer)};function Xk(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new fd(arguments[0],arguments[1],t)}var bi=Xk;const lr=J("libp2p:connection-manager");lr.error=J("libp2p:connection-manager:error");const{EventEmitter:Qk}=Rr,{ERR_INVALID_PARAMETERS:G0}=Ot,Jk={maxConnections:Infinity,minConnections:0,maxData:Infinity,maxSentData:Infinity,maxReceivedData:Infinity,maxEventLoopDelay:Infinity,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1};class Zk extends Qk{constructor(t,e){super();if(this._libp2p=t,this._peerId=t.peerId.toB58String(),this._options=rs.call({ignoreUndefined:!0},Jk,e),this._options.maxConnections<this._options.minConnections)throw K(new Error("Connection Manager maxConnections must be greater than minConnections"),G0);lr("options: %j",this._options),this._libp2p=t,this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this)}get size(){return Array.from(this.connections.values()).reduce((t,e)=>t+e.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||bi(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor=new Yk({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval}),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,lr("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor&&this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._started=!1,await this._close(),lr("stopped")}async _close(){const t=[];for(const e of this.connections.values())for(const r of e)t.push(r.close());await t,this.connections.clear()}setPeerValue(t,e){if(e<0||e>1)throw new Error("value should be a number between 0 and 1");t.toB58String&&(t=t.toB58String()),this._peerValues.set(t,e)}_checkMetrics(){const t=this._libp2p.metrics.global.movingAverages,e=t.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",e);const r=t.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",r);const n=e+r;this._checkMaxLimit("maxData",n),lr("metrics update",n),this._timer=bi(this._checkMetrics,this._options.pollInterval)}onConnect(t){const e=t.remotePeer,r=e.toB58String(),n=this.connections.get(r);this.emit("peer:connect",t),n?n.push(t):this.connections.set(r,[t]),this._libp2p.peerStore.keyBook.set(e,e.pubKey),this._peerValues.has(r)||this._peerValues.set(r,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(t){const e=t.remotePeer.toB58String();let r=this.connections.get(e);r&&r.length>1?(r=r.filter(n=>n.id!==t.id),this.connections.set(e,r)):r&&(this.connections.delete(e),this._peerValues.delete(t.remotePeer.toB58String()),this.emit("peer:disconnect",t))}get(t){const e=this.getAll(t);return e.length?e[0]:null}getAll(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),G0);const e=t.toB58String(),r=this.connections.get(e);return r?r.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(t){this._checkMaxLimit("maxEventLoopDelay",t.avgMs)}_checkMaxLimit(t,e){const r=this._options[t];lr("checking limit of %s. current value: %d of %d",t,e,r),e>r&&(lr("%s: limit exceeded: %s, %d",this._peerId,t,e),this._maybeDisconnectOne())}async _autoDial(){const t=this._options.minConnections;if(this.size>=t){this._autoDialTimeout=bi(this._autoDial,this._options.autoDialInterval);return}const e=Array.from(this._libp2p.peerStore.peers.values()).sort((r,n)=>n.protocols&&n.protocols.length&&(!r.protocols||!r.protocols.length)||n.id.pubKey&&!r.id.pubKey?1:-1);for(let r=0;r<e.length&&this.size<t;r++)if(!this.get(e[r].id)){lr("connecting to a peerStore stored peer %s",e[r].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(e[r].id),!this._started)return}catch(n){lr.error("could not connect to peerStore stored peer",n)}}this._autoDialTimeout=bi(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){const t=Array.from(this._peerValues).sort(tT);lr("%s: sorted peer values: %j",this._peerId,t);const e=t[0];if(e){const r=e[0];lr("%s: lowest value peer is %s",this._peerId,r),lr("%s: closing a connection to %j",this._peerId,r);for(const n of this.connections.values())if(n[0].remotePeer.toB58String()===r){n[0].close();break}}}}}var eT=Zk;function tT(t,e){return t[1]-e[1]}const H0=ae("dns4"),W0=ae("dns6"),Y0=ae("dnsaddr"),yi=Ut(ae("dns"),Y0,H0,W0),ss=Ut(ae("ip4"),ae("ip6")),aa=Ut(ye(ss,ae("tcp")),ye(yi,ae("tcp"))),X0=ye(ss,ae("udp")),Q0=ye(X0,ae("utp")),sa=Ut(ye(aa,ae("ws")),ye(yi,ae("ws"))),oa=Ut(ye(aa,ae("wss")),ye(yi,ae("wss"))),hd=Ut(ye(aa,ae("http")),ye(ss,ae("http")),ye(yi,ae("http"))),pd=Ut(ye(aa,ae("https")),ye(ss,ae("https")),ye(yi,ae("https"))),md=Ut(ye(sa,ae("p2p-webrtc-star"),ae("p2p")),ye(oa,ae("p2p-webrtc-star"),ae("p2p")),ye(sa,ae("p2p-webrtc-star")),ye(oa,ae("p2p-webrtc-star"))),rT=Ut(ye(sa,ae("p2p-websocket-star"),ae("p2p")),ye(oa,ae("p2p-websocket-star"),ae("p2p")),ye(sa,ae("p2p-websocket-star")),ye(oa,ae("p2p-websocket-star"))),J0=Ut(ye(hd,ae("p2p-webrtc-direct")),ye(pd,ae("p2p-webrtc-direct"))),ca=Ut(sa,oa,hd,pd,md,J0,aa,Q0,yi),nT=Ut(ye(ca,ae("p2p-stardust"),ae("p2p")),ye(ca,ae("p2p-stardust"))),$n=Ut(ye(ca,ae("p2p")),md,ae("p2p")),Z0=Ut(ye($n,ae("p2p-circuit"),$n),ye($n,ae("p2p-circuit")),ye(ae("p2p-circuit"),$n),ye(ca,ae("p2p-circuit")),ye(ae("p2p-circuit"),ca),ae("p2p-circuit")),em=()=>Ut(ye(Z0,em),Z0),ua=em(),tm=Ut(ye(ua,$n,ua),ye($n,ua),ye(ua,$n),ua,$n);var iT=yi,aT=H0,sT=W0,oT=Y0,cT=ss,uT=aa,dT=X0,lT=Q0,fT=hd,hT=pd,pT=sa,mT=oa,bT=rT,yT=md,gT=J0,vT=ca,wT=nT,ET=ua,xT=tm,ST=tm;function rm(t){return function(r){if(!De.isMultiaddr(r))try{r=De(r)}catch(i){return!1}const n=t(r.protoNames());return n===null?!1:n.length===0}}function ye(){const t=Array.from(arguments);function e(r){return r.length<t.length?null:(t.some(n=>{if(r=typeof n=="function"?n().partialMatch(r):n.partialMatch(r),r===null)return!0}),r)}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:rm(e),partialMatch:e}}function Ut(){const t=Array.from(arguments);function e(n){let i=null;return t.some(a=>{const s=typeof a=="function"?a().partialMatch(n):a.partialMatch(n);if(s)return i=s,!0}),i}const r={toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:rm(e),partialMatch:e};return r}function ae(t){const e=t;function r(i){if(typeof i=="string")try{i=De(i)}catch(s){return!1}const a=i.protoNames();return a.length===1&&a[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}var AT={DNS:iT,DNS4:aT,DNS6:sT,DNSADDR:oT,IP:cT,TCP:uT,UDP:dT,UTP:lT,HTTP:fT,HTTPS:hT,WebSockets:pT,WebSocketsSecure:mT,WebSocketStar:bT,WebRTCStar:yT,WebRTCDirect:gT,Reliable:vT,Stardust:wT,Circuit:ET,P2P:xT,IPFS:ST},os=Ur(`
message CircuitRelay {

  enum Status {
    SUCCESS                    = 100;
    HOP_SRC_ADDR_TOO_LONG      = 220;
    HOP_DST_ADDR_TOO_LONG      = 221;
    HOP_SRC_MULTIADDR_INVALID  = 250;
    HOP_DST_MULTIADDR_INVALID  = 251;
    HOP_NO_CONN_TO_DST         = 260;
    HOP_CANT_DIAL_DST          = 261;
    HOP_CANT_OPEN_DST_STREAM   = 262;
    HOP_CANT_SPEAK_RELAY       = 270;
    HOP_CANT_RELAY_TO_SELF     = 280;
    STOP_SRC_ADDR_TOO_LONG     = 320;
    STOP_DST_ADDR_TOO_LONG     = 321;
    STOP_SRC_MULTIADDR_INVALID = 350;
    STOP_DST_MULTIADDR_INVALID = 351;
    STOP_RELAY_REFUSED         = 390;
    MALFORMED_MESSAGE          = 400;
  }

  enum Type { // RPC identifier, either HOP, STOP or STATUS
    HOP = 1;
    STOP = 2;
    STATUS = 3;
    CAN_HOP = 4;
  }

  message Peer {
    required bytes id = 1;    // peer id
    repeated bytes addrs = 2; // peer's known addresses
  }

  optional Type type = 1;     // Type of the message

  optional Peer srcPeer = 2;  // srcPeer and dstPeer are used when Type is HOP or STATUS
  optional Peer dstPeer = 3;

  optional Status code = 4;   // Status code, used when Type is STATUS
}
`),IT=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")},bd=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}};const nm=(t,e,r)=>yd(t,Array.isArray(e)?e:[{signal:e,options:r}]),yd=(t,e)=>{t=IT(t),e=e.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*r(){let n;const i=()=>{n&&n()};for(const{signal:a}of e)a.addEventListener("abort",i);for(;;){let a;try{for(const{signal:o,options:u}of e)if(o.aborted){const{abortMessage:c,abortCode:d}=u;throw new bd(c,d)}const s=new Promise((o,u)=>{n=()=>{const{options:c}=e.find(({signal:y})=>y.aborted),{abortMessage:d,abortCode:h}=c;u(new bd(d,h))}});a=await Promise.race([s,t.next()]),n=null}catch(s){for(const{signal:c}of e)c.removeEventListener("abort",i);const o=e.find(({signal:c})=>c.aborted),u=s.type==="aborted"&&o;if(u&&o.options.onAbort&&await o.options.onAbort(t),typeof t.return=="function"&&await t.return(),u&&o.options.returnOnAbort)return;throw s}if(a.done)break;yield a.value}for(const{signal:a}of e)a.removeEventListener("abort",i)}return r()},im=(t,e,r)=>am(t,Array.isArray(e)?e:[{signal:e,options:r}]),am=(t,e)=>r=>t(yd(r,e)),kT=(t,e,r)=>TT(t,Array.isArray(e)?e:[{signal:e,options:r}]),TT=(t,e)=>({sink:am(t.sink,e),source:yd(t.source,e)});var gi=nm,CT=bd,_T=nm,RT=im,NT=im,PT=kT;gi.AbortError=CT,gi.source=_T,gi.sink=RT,gi.transform=NT,gi.duplex=PT;const DT=J("libp2p:stream:converter");function OT({stream:t,remoteAddr:e,localAddr:r},n={}){const{sink:i,source:a}=t,s={async sink(u){n.signal&&(u=gi(u,n.signal));try{await i(u)}catch(c){c.type!=="aborted"&&DT(c)}o()},source:n.signal?gi(a,n.signal):a,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now()},close(){i([]),o()}};function o(){s.timeline.close||(s.timeline.close=Date.now())}return s}var sm=OT,gd={relay:"/libp2p/circuit/relay/0.1.0"};const BT=J("libp2p:circuit:listener");BT.err=J("libp2p:circuit:error:listener");var MT=t=>{const e=new Rr,r=new Map;return e.listen=async n=>{const i=String(n).split("/p2p-circuit").find(o=>o!==""),a=await t._dialer.connectToPeer(De(i)),s=a.remoteAddr.encapsulate("/p2p-circuit");r.set(a.remotePeer.toB58String(),s),e.emit("listening")},e.close=()=>{},e.getAddrs=()=>{const n=[];for(const i of r.values())n.push(i);return n},e};const{CircuitRelay:vi}=os;function om(t,e){t.write({type:vi.Type.STATUS,code:e})}function LT(t,e){try{t.dstPeer.addrs.forEach(r=>De(r))}catch(r){throw om(e,t.type===vi.Type.HOP?vi.Status.HOP_DST_MULTIADDR_INVALID:vi.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer.addrs.forEach(r=>De(r))}catch(r){throw om(e,t.type===vi.Type.HOP?vi.Status.HOP_SRC_MULTIADDR_INVALID:vi.Status.STOP_SRC_MULTIADDR_INVALID),r}}var cm={validateAddrs:LT};const{Buffer:Cr}=At,um=Symbol.for("BufferList");function Oe(t){if(!(this instanceof Oe))return new Oe(t);Oe._init.call(this,t)}Oe._init=function(e){Object.defineProperty(this,um,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},Oe.prototype._new=function(e){return new Oe(e)},Oe.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let n=0;n<this._bufs.length;n++){const i=r+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-r];r=i}},Oe.prototype._reverseOffset=function(t){const e=t[0];let r=t[1];for(let n=0;n<e;n++)r+=this._bufs[n].length;return r},Oe.prototype.get=function(e){if(e>this.length||e<0)return;const r=this._offset(e);return this._bufs[r[0]][r[1]]},Oe.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)},Oe.prototype.copy=function(e,r,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length)return e||Cr.alloc(0);if(i<=0)return e||Cr.alloc(0);const a=!!e,s=this._offset(n),o=i-n;let u=o,c=a&&r||0,d=s[1];if(n===0&&i===this.length){if(!a)return this._bufs.length===1?this._bufs[0]:Cr.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,c),c+=this._bufs[h].length;return e}if(u<=this._bufs[s[0]].length-d)return a?this._bufs[s[0]].copy(e,r,d,d+u):this._bufs[s[0]].slice(d,d+u);a||(e=Cr.allocUnsafe(o));for(let h=s[0];h<this._bufs.length;h++){const y=this._bufs[h].length-d;if(u>y)this._bufs[h].copy(e,c,d),c+=y;else{this._bufs[h].copy(e,c,d,d+u),c+=y;break}u-=y,d&&(d=0)}return e.length>c?e.slice(0,c):e},Oe.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();const n=this._offset(e),i=this._offset(r),a=this._bufs.slice(n[0],i[0]+1);return i[1]===0?a.pop():a[a.length-1]=a[a.length-1].slice(0,i[1]),n[1]!==0&&(a[0]=a[0].slice(n[1])),this._new(a)},Oe.prototype.toString=function(e,r,n){return this.slice(r,n).toString(e)},Oe.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this},Oe.prototype.duplicate=function(){const e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e},Oe.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Cr.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Cr.from(e));return this},Oe.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},Oe.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Cr.from([t]):typeof t=="string"?t=Cr.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Cr.from(t.buffer,t.byteOffset,t.byteLength):Cr.isBuffer(t)||(t=Cr.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;const n=this._offset(e);let i=n[0],a=n[1];for(;i<this._bufs.length;i++){const s=this._bufs[i];for(;a<s.length;){const o=s.length-a;if(o>=t.length){const u=s.indexOf(t,a);if(u!==-1)return this._reverseOffset([i,u]);a=s.length-t.length+1}else{const u=this._reverseOffset([i,a]);if(this._match(u,t))return u;a++}}a=0}return-1},Oe.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0},function(){const t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const e in t)(function(r){t[r]===null?Oe.prototype[r]=function(n,i){return this.slice(n,n+i)[r](0,i)}:Oe.prototype[r]=function(n){return this.slice(n,n+t[r])[r](0)}})(e)}(),Oe.prototype._isBufferList=function(e){return e instanceof Oe||Oe.isBufferList(e)},Oe.isBufferList=function(e){return e!=null&&e[um]};var qt=Oe;const{Buffer:UT}=At,dm=(t,e,r)=>{const n=W.encode(t,e,r);return dm.bytes=W.encode.bytes,e||UT.from(n)};var vd=dm;const{Buffer:lm}=At,wd=8,fm=10*1024;function hm(t){t=t||{};const e=Math.max(t.poolSize||fm,t.minPoolSize||wd),r=t.lengthEncoder||vd;return n=>async function*(){let i=lm.alloc(e),a=0;for await(const s of n){r(s.length,i,a);const o=i.slice(a,a+r.bytes);a+=r.bytes,i.length-a<wd&&(i=lm.alloc(e),a=0),yield new qt().append(o).append(s)}}()}hm.single=(t,e)=>{e=e||{};const r=e.lengthEncoder||vd;return new qt([r(t.length),t])};var Ed=hm,KT=wd,FT=fm;Ed.MIN_POOL_SIZE=KT,Ed.DEFAULT_POOL_SIZE=FT;const{Buffer:jT}=At,qT=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),pm=t=>{const e=W.decode(jT.isBuffer(t)?t:qT(t));return pm.bytes=W.decode.bytes,e};var mm=pm;const{Buffer:VT}=At,bm=8,ym=1024*1024*4,gm=VT.alloc(0),Gn={LENGTH:"readLength",DATA:"readData"},zT={[Gn.LENGTH]:(t,e,r,n)=>{e=e.append(t);let i;try{i=n.lengthDecoder(e)}catch(a){if(e.length>n.maxLengthLength)throw Object.assign(a,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(a instanceof RangeError)return{mode:Gn.LENGTH,buffer:e};throw a}if(i>n.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(n.lengthDecoder.bytes),e=new qt,n.onLength&&n.onLength(i),i<=0?(n.onData&&n.onData(gm),{mode:Gn.LENGTH,chunk:t,buffer:e,data:gm}):{mode:Gn.DATA,chunk:t,buffer:e,state:{dataLength:i}}},[Gn.DATA]:(t,e,r,n)=>{if(e=e.append(t),e.length<r.dataLength)return{mode:Gn.DATA,buffer:e,state:r};const{dataLength:i}=r,a=e.shallowSlice(0,i);return t=e.length>i?e.shallowSlice(i):null,e=new qt,n.onData&&n.onData(a),{mode:Gn.LENGTH,chunk:t,buffer:e,data:a}}};function xd(t){return t=t||{},t.lengthDecoder=t.lengthDecoder||mm,t.maxLengthLength=t.maxLengthLength||bm,t.maxDataLength=t.maxDataLength||ym,e=>async function*(){let r=new qt,n=Gn.LENGTH,i;for await(let a of e)for(;a;){const s=zT[n](a,r,i,t);({mode:n,chunk:a,buffer:r,state:i}=s),s.data&&(yield s.data)}if(r.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}()}xd.fromReader=(t,e)=>{e=e||{};let r=1;const n={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(i){if(i.code==="ERR_UNDER_READ")return{done:!0,value:null};throw i}finally{r=1}}};return e.onLength=i=>{r=i},xd(e)(n)};var Sd=xd,$T=bm,GT=ym;Sd.MAX_LENGTH_LENGTH=$T,Sd.MAX_DATA_LENGTH=GT;const{Buffer:HT}=At,vm=(t,e,r)=>(e=e||HT.allocUnsafe(4),e.writeInt32BE(t,r),e);vm.bytes=4;var WT=vm;const wm=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};wm.bytes=4;var YT=wm,XT=Ed,QT=Sd,JT=vd,ZT=mm,eC=WT,tC=YT,Jr={encode:XT,decode:QT,varintEncode:JT,varintDecode:ZT,int32BEEncode:eC,int32BEDecode:tC},Em=t=>{const e=async function*(){let r=yield,n=new qt;for await(const i of t){if(!r){r=yield n.append(i),n=new qt;continue}for(n.append(i);n.length>=r;){const a=n.shallowSlice(0,r);if(n.consume(r),r=yield a,!r){n.length&&(r=yield n,n=new qt);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return e.next(),e},xm=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];return e===void 0?void 0:(this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e)}isEmpty(){return this.buffer[this.btm]===void 0}},cs=class{constructor(e){this.hwm=e||16,this.head=new xm(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){const r=this.head;this.head=r.next=new xm(2*this.head.buffer.length),this.head.push(e)}}shift(){const e=this.tail.shift();if(e===void 0&&this.tail.next){const r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}},rC=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new cs,n,i,a;const s=()=>{if(!r.isEmpty()){if(t.writev){let _;const I=[];for(;!r.isEmpty();){if(_=r.shift(),_.error)throw _.error;I.push(_.value)}return{done:_.done,value:I}}const m=r.shift();if(m.error)throw m.error;return m}return a?{done:!0}:new Promise((m,_)=>{i=I=>(i=null,I.error?_(I.error):t.writev&&!I.done?m({done:I.done,value:[I.value]}):m(I),n)})},o=m=>i?i(m):(r.push(m),n),u=m=>(r=new cs,i?i({error:m}):(r.push({error:m}),n)),c=m=>a?n:o({done:!1,value:m}),d=m=>a?n:(a=!0,m?u(m):o({done:!0})),h=()=>(r=new cs,d(),{done:!0}),y=m=>(d(m),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:h,throw:y,push:c,end:d},!e)return n;const p=n;return n={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(m){return p.throw(m),e&&(e(m),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:c,end(m){return p.end(m),e&&(e(m),e=null),n}},n};const nC=()=>{const t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};var Ad=nC,vo=t=>{const e=rC(),r=Em(t.source),n=Ad();let i;const a=t.sink(async function*(){yield*e;const o=await n.promise;yield*o}());a.catch(o=>{i=o});const s={sink:o=>i?Promise.reject(i):(n.resolve(o),a),source:r};return{reader:r,writer:e,stream:s,rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}};const{CircuitRelay:Sm}=os,us=J("libp2p:circuit:stream-handler");us.error=J("libp2p:circuit:stream-handler:error");class iC{constructor({stream:t,maxLength:e=4096}){this.stream=t,this.shake=vo(this.stream),this.decoder=Jr.decode.fromReader(this.shake.reader,{maxDataLength:e})}async read(){const t=await this.decoder.next();if(t.value){const e=Sm.decode(t.value.slice());return us("read message type",e.type),e}us("read received no value, closing stream"),this.close()}write(t){us("write message type %s",t.type),this.shake.write(Jr.encode.single(Sm.encode(t)))}rest(){return this.shake.rest(),this.shake.stream}end(t){this.write(t),this.close()}close(){us("closing the stream"),this.rest().sink([])}}var Id=iC;const Am=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},kd=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),wo=t=>t&&typeof t.sink=="function"&&kd(t.source),aC=t=>e=>(t.sink(e),t.source),Im=(...t)=>{if(wo(t[0])){const e=t[0];t[0]=()=>e.source}else if(kd(t[0])){const e=t[0];t[0]=()=>e}if(t.length>1&&(wo(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink)),t.length>2)for(let e=1;e<t.length-1;e++)wo(t[e])&&(t[e]=aC(t[e]));return Am(...t)};var Vt=Im,sC=Im,oC=Am,cC=kd,uC=wo;Vt.pipe=sC,Vt.rawPipe=oC,Vt.isIterable=cC,Vt.isDuplex=uC;const{CircuitRelay:Td}=os,{validateAddrs:dC}=cm,da=J("libp2p:circuit:stop");da.error=J("libp2p:circuit:stop:error");var lC=function({connection:e,request:r,streamHandler:n}){try{dC(r,n)}catch(i){return da.error("invalid stop request via peer %s",e.remotePeer.toB58String(),i)}return da("stop request is valid"),n.write({type:Td.Type.STATUS,code:Td.Status.SUCCESS}),n.rest()},fC=async function({connection:e,request:r}){const{stream:n}=await e.newStream([gd.relay]);da("starting stop request to %s",e.remotePeer.toB58String());const i=new Id({stream:n});i.write(r);const a=await i.read();if(a.code===Td.Status.SUCCESS)return da("stop request to %s was successful",e.remotePeer.toB58String()),i.rest();da("stop request failed with code %d",a.code),i.close()},km={handleStop:lC,stop:fC};const fn=J("libp2p:circuit:hop");fn.error=J("libp2p:circuit:hop:error");const{validateAddrs:hC}=cm,{CircuitRelay:_r}=os,{codes:pC}=Ot,{stop:mC}=km;var bC=async function({connection:e,request:r,streamHandler:n,circuit:i}){if(!i._options.hop.enabled)return fn("HOP request received but we are not acting as a relay"),n.end({type:_r.Type.STATUS,code:_r.Status.HOP_CANT_SPEAK_RELAY});try{hC(r,n)}catch(d){return fn.error("invalid hop request via peer %s",e.remotePeer.toB58String(),d)}const a=new be(r.dstPeer.id),s=i._connectionManager.get(a);if(!s&&!i._options.hop.active)return fn("HOP request received but we are not connected to the destination peer"),n.end({type:_r.Type.STATUS,code:_r.Status.HOP_NO_CONN_TO_DST});const o={type:_r.Type.STOP,dstPeer:r.dstPeer,srcPeer:r.srcPeer};let u;try{u=await mC({connection:s,request:o,circuit:i})}catch(d){return fn.error(d)}fn("hop request from %s is valid",e.remotePeer.toB58String()),n.write({type:_r.Type.STATUS,code:_r.Status.SUCCESS});const c=n.rest();return Vt(c,u,c)},yC=async function({connection:e,request:r}){const{stream:n}=await e.newStream([gd.relay]),i=new Id({stream:n});i.write(r);const a=await i.read();if(a.code===_r.Status.SUCCESS)return fn("hop request was successful"),i.rest();throw fn("hop request failed with code %d, closing stream",a.code),i.close(),K(new Error(`HOP request failed with code ${a.code}`),pC.ERR_HOP_REQUEST_FAILED)},gC=function({connection:e,streamHandler:r,circuit:n}){const i=n._options.hop.enabled;fn("can hop (%s) request from %s",i,e.remotePeer.toB58String()),r.end({type:_r.Type.STATUS,code:i?_r.Status.SUCCESS:_r.Status.HOP_CANT_SPEAK_RELAY})},vC={handleHop:bC,hop:yC,handleCanHop:gC};const{CircuitRelay:la}=os,hn=J("libp2p:circuit");hn.error=J("libp2p:circuit:error");const{relay:wC}=gd,{handleCanHop:EC,handleHop:xC,hop:SC}=vC,{handleStop:AC}=km;class IC{constructor({libp2p:t,upgrader:e}){this._dialer=t.dialer,this._registrar=t.registrar,this._connectionManager=t.connectionManager,this._upgrader=e,this._options=t._config.relay,this._libp2p=t,this.peerId=t.peerId,this._registrar.handle(wC,this._onProtocol.bind(this))}async _onProtocol({connection:t,stream:e,protocol:r}){const n=new Id({stream:e}),i=await n.read(),a=this;let s;switch(i.type){case la.Type.CAN_HOP:{hn("received CAN_HOP request from %s",t.remotePeer.toB58String()),await EC({circuit:a,connection:t,streamHandler:n});break}case la.Type.HOP:{hn("received HOP request from %s",t.remotePeer.toB58String()),s=await xC({connection:t,request:i,streamHandler:n,circuit:a});break}case la.Type.STOP:{hn("received STOP request from %s",t.remotePeer.toB58String()),s=await AC({connection:t,request:i,streamHandler:n,circuit:a});break}default:hn("Request of type %s not supported",i.type)}if(s){const o=De(i.dstPeer.addrs[0]),u=De(i.srcPeer.addrs[0]),c=sm({stream:s,remoteAddr:o,localAddr:u}),d=la.Type===la.Type.HOP?"relay":"inbound";hn("new %s connection %s",d,c.remoteAddr);const h=await this._upgrader.upgradeInbound(c);hn("%s connection %s upgraded",d,c.remoteAddr),this.handler&&this.handler(h)}}async dial(t,e){const r=t.toString().split("/p2p-circuit"),n=De(r[0]),i=De(r[r.length-1]),a=be.createFromCID(n.getPeerId()),s=be.createFromCID(i.getPeerId());let o=!1,u=this._connectionManager.get(a);u||(u=await this._dialer.connectToPeer(n,e),o=!0);try{const c=await SC({connection:u,circuit:this,request:{type:la.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(y=>y.bytes)},dstPeer:{id:s.toBytes(),addrs:[De(i).bytes]}}}),d=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),h=sm({stream:c,remoteAddr:t,localAddr:d});return hn("new outbound connection %s",h.remoteAddr),this._upgrader.upgradeOutbound(h)}catch(c){throw hn.error("Circuit relay dial failed",c),o&&await u.close(),c}}createListener(t,e){return typeof t=="function"&&(e=t,t={}),this.handler=e,MT(this)}filter(t){return t=Array.isArray(t)?t:[t],t.filter(e=>AT.Circuit.matches(e))}}var Tm=vn(IC,{className:"Circuit",symbolName:"@libp2p/js-libp2p-circuit/circuit"});const{AbortController:Cm,AbortSignal:kC}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;var Eo=Cm,TC=kC,CC=Cm;Eo.AbortSignal=TC,Eo.default=CC;const{AbortController:_C}=typeof self!="undefined"?self:typeof window!="undefined"?window:Eo;class Cd extends _C{constructor(t){super();this._ms=t,this._timer=bi(()=>this.abort(),t),Object.setPrototypeOf(this,Cd.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=bi(()=>this.abort(),this._ms)}}var _m=Cd,RC=Cd;_m.TimeoutController=RC;var NC=AbortController;function Rm(t){const e=new NC;function r(){e.abort();for(const n of t){if(!n||!n.removeEventListener)continue;n.removeEventListener("abort",r)}}for(const n of t){if(!n||!n.addEventListener)continue;if(n.aborted){r();break}n.addEventListener("abort",r)}return e.signal}var _d=Rm,PC=Rm;_d.anySignal=PC;var DC=class{constructor(){this._buffer=new cs,this._waitingConsumers=new cs}push(e){const{promise:r,resolve:n}=Ad();return this._buffer.push({chunk:e,resolve:n}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){const e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){const{promise:e,resolve:r}=Ad();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}};const OC=J("libp2p:dialer:request");OC.error=J("libp2p:dialer:request:error");class BC{constructor({addrs:t,dialAction:e,dialer:r}){this.addrs=t,this.dialer=r,this.dialAction=e}async run(t){const e=this.dialer.getTokens(this.addrs.length);if(e.length<1)throw K(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");const r=new DC;e.forEach(a=>r.push(a));const n=this.addrs.map(()=>new Eo);let i=0;try{return await oo(this.addrs.map(async(a,s)=>{const o=await r.shift();let u;try{const c=n[s].signal;u=await this.dialAction(a,{...t,signal:_d([c,t.signal])}),n.splice(s,1)}finally{i++,this.addrs.length-i>=e.length?r.push(o):this.dialer.releaseToken(e.splice(e.indexOf(o),1)[0])}return u}))}finally{n.map(a=>a.abort()),e.forEach(a=>this.dialer.releaseToken(a))}}}var MC=BC,LC={DialRequest:MC};const wi=J("libp2p:dialer");wi.error=J("libp2p:dialer:error");const{DialRequest:UC}=LC,{codes:Rd}=Ot,{DIAL_TIMEOUT:KC,MAX_PARALLEL_DIALS:FC,MAX_PER_PEER_DIALS:jC}=as;class qC{constructor({transportManager:t,peerStore:e,concurrency:r=FC,timeout:n=KC,perPeerLimit:i=jC,resolvers:a={}}){this.transportManager=t,this.peerStore=e,this.concurrency=r,this.timeout=n,this.perPeerLimit=i,this.tokens=[...new Array(r)].map((s,o)=>o),this._pendingDials=new Map;for(const[s,o]of Object.entries(a))De.resolvers.set(s,o)}destroy(){for(const t of this._pendingDials.values())try{t.controller.abort()}catch(e){wi.error(e)}this._pendingDials.clear()}async connectToPeer(t,e={}){const r=await this._createDialTarget(t);if(!r.addrs.length)throw K(new Error("The dial request has no addresses"),Rd.ERR_NO_VALID_ADDRESSES);const n=this._pendingDials.get(r.id)||this._createPendingDial(r,e);try{const i=await n.promise;return wi("dial succeeded to %s",r.id),i}catch(i){throw n.controller.signal.aborted&&(i.code=Rd.ERR_TIMEOUT),wi.error(i),i}finally{n.destroy()}}async _createDialTarget(t){const{id:e,multiaddrs:r}=fo(t);r&&this.peerStore.addressBook.add(e,r);let n=this.peerStore.addressBook.getMultiaddrsForPeer(e)||[];De.isMultiaddr(t)&&(n=n.filter(a=>!t.equals(a)),n.unshift(t));const i=[];for(const a of n){const s=await this._resolve(a);s.forEach(o=>i.push(o))}return{id:e.toB58String(),addrs:i}}_createPendingDial(t,e){const r=(u,c)=>{if(c.signal.aborted)throw K(new Error("already aborted"),Rd.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,c)},n=new UC({addrs:t.addrs,dialAction:r,dialer:this}),i=new _m(this.timeout),a=[i.signal];e.signal&&a.push(e.signal);const s=_d(a),o={dialRequest:n,controller:i,promise:n.run({...e,signal:s}),destroy:()=>{i.clear(),this._pendingDials.delete(t.id)}};return this._pendingDials.set(t.id,o),o}getTokens(t){const e=Math.min(t,this.perPeerLimit,this.tokens.length),r=this.tokens.splice(0,e);return wi("%d tokens request, returning %d, %d remaining",t,e,this.tokens.length),r}releaseToken(t){if(this.tokens.indexOf(t)>-1)return;wi("token %d released",t),this.tokens.push(t)}async _resolve(t){const e=t.protoNames().includes("dnsaddr");if(!e)return[t];const r=await this._resolveRecord(t),n=await Promise.all(r.map(i=>this._resolve(i)));return n.flat().reduce((i,a)=>(i.find(s=>s.equals(a))||i.push(a),i),[])}async _resolveRecord(t){try{t=De(t.toString());const e=await t.resolve();return e}catch(e){return wi.error(`multiaddr ${t} could not be resolved`),[]}}}var VC=qC;function zC(t){return t>=55296&&t<=56319}function $C(t){return t>=56320&&t<=57343}var GC=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,a=0,s,o,u=0;u<i;u+=1){if(s=r.charCodeAt(u),o=r[u],zC(s)&&$C(r.charCodeAt(u+1))&&(u+=1,o+=r[u]),a+=e(o),a===n)return r.slice(0,u+1);if(a>n)return r.slice(0,u-o.length+1)}return r};function HC(t){return t>=55296&&t<=56319}function WC(t){return t>=56320&&t<=57343}var YC=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,a=null,s=0;s<r;s++)i=e.charCodeAt(s),WC(i)?a!=null&&HC(a)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),a=i;return n},XC=GC.bind(null,YC),QC=/[\/\?<>\\:\*\|"]/g,JC=/[\x00-\x1f\x80-\x9f]/g,ZC=/^\.+$/,e_=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,t_=/[\. ]+$/;function Nm(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(QC,e).replace(JC,e).replace(ZC,e).replace(e_,e).replace(t_,e);return XC(r,255)}var r_=function(t,e){var r=e&&e.replacement||"",n=Nm(t,r);return r===""?n:Nm(n,"")},Pm={createCipheriv:(t,e,r)=>{const n=E.cipher.createCipher("AES-CTR",se(e,"ascii"));return n.start({iv:se(r,"ascii")}),{update:i=>(n.update(E.util.createBuffer(se(i,"ascii"))),le(n.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{const n=E.cipher.createDecipher("AES-CTR",se(e,"ascii"));return n.start({iv:se(r,"ascii")}),{update:i=>(n.update(E.util.createBuffer(se(i,"ascii"))),le(n.output.getBytes(),"ascii"))}}};const Dm={16:"aes-128-ctr",32:"aes-256-ctr"};var n_=function(t){const e=Dm[t.length];if(!e){const r=Object.entries(Dm).map(([n,i])=>`${n} (${i})`).join(" / ");throw K(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e},i_=async function(t,e){const r=n_(t),n=Pm.createCipheriv(r,t,e),i=Pm.createDecipheriv(r,t,e),a={async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}};return a},a_={create:i_};const Om={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function s_(t,e,r,n,i){const a=Om[i];if(!a){const o=Object.keys(Om).join(" / ");throw K(new Error(`Hash '${i}' is unknown or not supported. Must be ${o}`),"ERR_UNSUPPORTED_HASH_TYPE")}const s=f3(t,e,r,n,a);return t3.encode64(s)}var o_=s_,c_=a_,u_=Qp,d_=ur,l_=_u,f_=o_,fa={aes:c_,hmac:u_,keys:d_,randomBytes:l_,pbkdf2:f_},W9=Z(function(t){var e=E.asn1,r=t.exports=E.pkcs7asn1=E.pkcs7asn1||{};E.pkcs7=E.pkcs7||{},E.pkcs7.asn1=r;var n={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=n;var i={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(i)},r.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(i)};var a={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};r.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[a]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}),Y9=Z(function(t){E.mgf=E.mgf||{};var e=t.exports=E.mgf.mgf1=E.mgf1=E.mgf1||{};e.create=function(r){var n={generate:function(i,a){for(var s=new E.util.ByteBuffer,o=Math.ceil(a/r.digestLength),u=0;u<o;u++){var c=new E.util.ByteBuffer;c.putInt32(u),r.start(),r.update(i+c.getBytes()),s.putBuffer(r.digest())}return s.truncate(s.length()-a),s.getBytes()}};return n}}),X9=E.mgf=E.mgf||{};E.mgf.mgf1=E.mgf1;var Q9=Z(function(t){var e=t.exports=E.pss=E.pss||{};e.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var n=r.md,i=r.mgf,a=n.digestLength,s=r.salt||null;typeof s=="string"&&(s=E.util.createBuffer(s));var o;if("saltLength"in r)o=r.saltLength;else if(s!==null)o=s.length();else throw new Error("Salt length not specified or specific salt not given.");if(s!==null&&s.length()!==o)throw new Error("Given salt length does not match length of given salt.");var u=r.prng||E.random,c={};return c.encode=function(d,h){var y,p=h-1,m=Math.ceil(p/8),_=d.digest().getBytes();if(m<a+o+2)throw new Error("Message is too long to encrypt.");var I;s===null?I=u.getBytesSync(o):I=s.bytes();var f=new E.util.ByteBuffer;f.fillWithByte(0,8),f.putBytes(_),f.putBytes(I),n.start(),n.update(f.getBytes());var k=n.digest().getBytes(),R=new E.util.ByteBuffer;R.fillWithByte(0,m-o-a-2),R.putByte(1),R.putBytes(I);var g=R.getBytes(),x=m-a-1,N=i.generate(k,x),w="";for(y=0;y<x;y++)w+=String.fromCharCode(g.charCodeAt(y)^N.charCodeAt(y));var T=65280>>8*m-p&255;return w=String.fromCharCode(w.charCodeAt(0)&~T)+w.substr(1),w+k+String.fromCharCode(188)},c.verify=function(d,h,y){var p,m=y-1,_=Math.ceil(m/8);if(h=h.substr(-_),_<a+o+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(h.charCodeAt(_-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var I=_-a-1,f=h.substr(0,I),k=h.substr(I,a),R=65280>>8*_-m&255;if((f.charCodeAt(0)&R)!==0)throw new Error("Bits beyond keysize not zero as expected.");var g=i.generate(k,I),x="";for(p=0;p<I;p++)x+=String.fromCharCode(f.charCodeAt(p)^g.charCodeAt(p));x=String.fromCharCode(x.charCodeAt(0)&~R)+x.substr(1);var N=_-a-o-2;for(p=0;p<N;p++)if(x.charCodeAt(p)!==0)throw new Error("Leftmost octets not zero as expected");if(x.charCodeAt(N)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var w=x.substr(-o),T=new E.util.ByteBuffer;T.fillWithByte(0,8),T.putBytes(d),T.putBytes(w),n.start(),n.update(T.getBytes());var D=n.digest().getBytes();return k===D},c}}),J9=Z(function(t){var e=E.asn1,r=t.exports=E.pki=E.pki||{},n=r.oids,i={};i.CN=n.commonName,i.commonName="CN",i.C=n.countryName,i.countryName="C",i.L=n.localityName,i.localityName="L",i.ST=n.stateOrProvinceName,i.stateOrProvinceName="ST",i.O=n.organizationName,i.organizationName="O",i.OU=n.organizationalUnitName,i.organizationalUnitName="OU",i.E=n.emailAddress,i.emailAddress="E";var a=E.pki.rsa.publicKeyValidator,s={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},a,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},o={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},u={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},a,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},c={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[u,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};r.RDNAttributesAsArray=function(g,x){for(var N=[],w,T,D,v=0;v<g.value.length;++v){w=g.value[v];for(var l=0;l<w.value.length;++l)D={},T=w.value[l],D.type=e.derToOid(T.value[0].value),D.value=T.value[1].value,D.valueTagClass=T.value[1].type,D.type in n&&(D.name=n[D.type],D.name in i&&(D.shortName=i[D.name])),x&&(x.update(D.type),x.update(D.value)),N.push(D)}return N},r.CRIAttributesAsArray=function(g){for(var x=[],N=0;N<g.length;++N)for(var w=g[N],T=e.derToOid(w.value[0].value),D=w.value[1].value,v=0;v<D.length;++v){var l={};if(l.type=T,l.value=D[v].value,l.valueTagClass=D[v].type,l.type in n&&(l.name=n[l.type],l.name in i&&(l.shortName=i[l.name])),l.type===n.extensionRequest){l.extensions=[];for(var b=0;b<l.value.length;++b)l.extensions.push(r.certificateExtensionFromAsn1(l.value[b]))}x.push(l)}return x};function d(g,x){typeof x=="string"&&(x={shortName:x});for(var N=null,w,T=0;N===null&&T<g.attributes.length;++T)w=g.attributes[T],(x.type&&x.type===w.type||(x.name&&x.name===w.name||x.shortName&&x.shortName===w.shortName))&&(N=w);return N}var h=function(g,x,N){var w={};if(g!==n["RSASSA-PSS"])return w;N&&(w={hash:{algorithmOid:n.sha1},mgf:{algorithmOid:n.mgf1,hash:{algorithmOid:n.sha1}},saltLength:20});var T={},D=[];if(!e.validate(x,o,T,D)){var v=new Error("Cannot read RSASSA-PSS parameter block.");throw v.errors=D,v}return T.hashOid!==void 0&&(w.hash=w.hash||{},w.hash.algorithmOid=e.derToOid(T.hashOid)),T.maskGenOid!==void 0&&(w.mgf=w.mgf||{},w.mgf.algorithmOid=e.derToOid(T.maskGenOid),w.mgf.hash=w.mgf.hash||{},w.mgf.hash.algorithmOid=e.derToOid(T.maskGenHashOid)),T.saltLength!==void 0&&(w.saltLength=T.saltLength.charCodeAt(0)),w};r.certificateFromPem=function(g,x,N){var w=E.pem.decode(g)[0];if(w.type!=="CERTIFICATE"&&w.type!=="X509 CERTIFICATE"&&w.type!=="TRUSTED CERTIFICATE"){var T=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw T.headerType=w.type,T}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var D=e.fromDer(w.body,N);return r.certificateFromAsn1(D,x)},r.certificateToPem=function(g,x){var N={type:"CERTIFICATE",body:e.toDer(r.certificateToAsn1(g)).getBytes()};return E.pem.encode(N,{maxline:x})},r.publicKeyFromPem=function(g){var x=E.pem.decode(g)[0];if(x.type!=="PUBLIC KEY"&&x.type!=="RSA PUBLIC KEY"){var N=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw N.headerType=x.type,N}if(x.procType&&x.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var w=e.fromDer(x.body);return r.publicKeyFromAsn1(w)},r.publicKeyToPem=function(g,x){var N={type:"PUBLIC KEY",body:e.toDer(r.publicKeyToAsn1(g)).getBytes()};return E.pem.encode(N,{maxline:x})},r.publicKeyToRSAPublicKeyPem=function(g,x){var N={type:"RSA PUBLIC KEY",body:e.toDer(r.publicKeyToRSAPublicKey(g)).getBytes()};return E.pem.encode(N,{maxline:x})},r.getPublicKeyFingerprint=function(g,x){x=x||{};var N=x.md||E.md.sha1.create(),w=x.type||"RSAPublicKey",T;switch(w){case"RSAPublicKey":T=e.toDer(r.publicKeyToRSAPublicKey(g)).getBytes();break;case"SubjectPublicKeyInfo":T=e.toDer(r.publicKeyToAsn1(g)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+x.type+'".')}N.start(),N.update(T);var D=N.digest();if(x.encoding==="hex"){var v=D.toHex();return x.delimiter?v.match(/.{2}/g).join(x.delimiter):v}else{if(x.encoding==="binary")return D.getBytes();if(x.encoding)throw new Error('Unknown encoding "'+x.encoding+'".')}return D},r.certificationRequestFromPem=function(g,x,N){var w=E.pem.decode(g)[0];if(w.type!=="CERTIFICATE REQUEST"){var T=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw T.headerType=w.type,T}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var D=e.fromDer(w.body,N);return r.certificationRequestFromAsn1(D,x)},r.certificationRequestToPem=function(g,x){var N={type:"CERTIFICATE REQUEST",body:e.toDer(r.certificationRequestToAsn1(g)).getBytes()};return E.pem.encode(N,{maxline:x})},r.createCertificate=function(){var g={};return g.version=2,g.serialNumber="00",g.signatureOid=null,g.signature=null,g.siginfo={},g.siginfo.algorithmOid=null,g.validity={},g.validity.notBefore=new Date,g.validity.notAfter=new Date,g.issuer={},g.issuer.getField=function(x){return d(g.issuer,x)},g.issuer.addField=function(x){p([x]),g.issuer.attributes.push(x)},g.issuer.attributes=[],g.issuer.hash=null,g.subject={},g.subject.getField=function(x){return d(g.subject,x)},g.subject.addField=function(x){p([x]),g.subject.attributes.push(x)},g.subject.attributes=[],g.subject.hash=null,g.extensions=[],g.publicKey=null,g.md=null,g.setSubject=function(x,N){p(x),g.subject.attributes=x,delete g.subject.uniqueId,N&&(g.subject.uniqueId=N),g.subject.hash=null},g.setIssuer=function(x,N){p(x),g.issuer.attributes=x,delete g.issuer.uniqueId,N&&(g.issuer.uniqueId=N),g.issuer.hash=null},g.setExtensions=function(x){for(var N=0;N<x.length;++N)m(x[N],{cert:g});g.extensions=x},g.getExtension=function(x){typeof x=="string"&&(x={name:x});for(var N=null,w,T=0;N===null&&T<g.extensions.length;++T)w=g.extensions[T],(x.id&&w.id===x.id||x.name&&w.name===x.name)&&(N=w);return N},g.sign=function(x,N){g.md=N||E.md.sha1.create();var w=n[g.md.algorithm+"WithRSAEncryption"];if(!w){var T=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw T.algorithm=g.md.algorithm,T}g.signatureOid=g.siginfo.algorithmOid=w,g.tbsCertificate=r.getTBSCertificate(g);var D=e.toDer(g.tbsCertificate);g.md.update(D.getBytes()),g.signature=x.sign(g.md)},g.verify=function(x){var N=!1;if(!g.issued(x)){var w=x.issuer,T=g.subject,D=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw D.expectedIssuer=w.attributes,D.actualIssuer=T.attributes,D}var v=x.md;if(v===null){if(x.signatureOid in n){var l=n[x.signatureOid];switch(l){case"sha1WithRSAEncryption":v=E.md.sha1.create();break;case"md5WithRSAEncryption":v=E.md.md5.create();break;case"sha256WithRSAEncryption":v=E.md.sha256.create();break;case"sha384WithRSAEncryption":v=E.md.sha384.create();break;case"sha512WithRSAEncryption":v=E.md.sha512.create();break;case"RSASSA-PSS":v=E.md.sha256.create();break}}if(v===null){var D=new Error("Could not compute certificate digest. Unknown signature OID.");throw D.signatureOid=x.signatureOid,D}var b=x.tbsCertificate||r.getTBSCertificate(x),A=e.toDer(b);v.update(A.getBytes())}if(v!==null){var C;switch(x.signatureOid){case n.sha1WithRSAEncryption:C=void 0;break;case n["RSASSA-PSS"]:var P,O;if(P=n[x.signatureParameters.mgf.hash.algorithmOid],P===void 0||E.md[P]===void 0){var D=new Error("Unsupported MGF hash function.");throw D.oid=x.signatureParameters.mgf.hash.algorithmOid,D.name=P,D}if(O=n[x.signatureParameters.mgf.algorithmOid],O===void 0||E.mgf[O]===void 0){var D=new Error("Unsupported MGF function.");throw D.oid=x.signatureParameters.mgf.algorithmOid,D.name=O,D}if(O=E.mgf[O].create(E.md[P].create()),P=n[x.signatureParameters.hash.algorithmOid],P===void 0||E.md[P]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:x.signatureParameters.hash.algorithmOid,name:P};C=E.pss.create(E.md[P].create(),O,x.signatureParameters.saltLength);break}N=g.publicKey.verify(v.digest().getBytes(),x.signature,C)}return N},g.isIssuer=function(x){var N=!1,w=g.issuer,T=x.subject;if(w.hash&&T.hash)N=w.hash===T.hash;else if(w.attributes.length===T.attributes.length){N=!0;for(var D,v,l=0;N&&l<w.attributes.length;++l)D=w.attributes[l],v=T.attributes[l],(D.type!==v.type||D.value!==v.value)&&(N=!1)}return N},g.issued=function(x){return x.isIssuer(g)},g.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(g.publicKey,{type:"RSAPublicKey"})},g.verifySubjectKeyIdentifier=function(){for(var x=n.subjectKeyIdentifier,N=0;N<g.extensions.length;++N){var w=g.extensions[N];if(w.id===x){var T=g.generateSubjectKeyIdentifier().getBytes();return E.util.hexToBytes(w.subjectKeyIdentifier)===T}}return!1},g},r.certificateFromAsn1=function(g,x){var N={},w=[];if(!e.validate(g,s,N,w)){var T=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw T.errors=w,T}var D=e.derToOid(N.publicKeyOid);if(D!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var v=r.createCertificate();v.version=N.certVersion?N.certVersion.charCodeAt(0):0;var l=E.util.createBuffer(N.certSerialNumber);v.serialNumber=l.toHex(),v.signatureOid=E.asn1.derToOid(N.certSignatureOid),v.signatureParameters=h(v.signatureOid,N.certSignatureParams,!0),v.siginfo.algorithmOid=E.asn1.derToOid(N.certinfoSignatureOid),v.siginfo.parameters=h(v.siginfo.algorithmOid,N.certinfoSignatureParams,!1),v.signature=N.certSignature;var b=[];if(N.certValidity1UTCTime!==void 0&&b.push(e.utcTimeToDate(N.certValidity1UTCTime)),N.certValidity2GeneralizedTime!==void 0&&b.push(e.generalizedTimeToDate(N.certValidity2GeneralizedTime)),N.certValidity3UTCTime!==void 0&&b.push(e.utcTimeToDate(N.certValidity3UTCTime)),N.certValidity4GeneralizedTime!==void 0&&b.push(e.generalizedTimeToDate(N.certValidity4GeneralizedTime)),b.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(b.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(v.validity.notBefore=b[0],v.validity.notAfter=b[1],v.tbsCertificate=N.tbsCertificate,x){if(v.md=null,v.signatureOid in n){var D=n[v.signatureOid];switch(D){case"sha1WithRSAEncryption":v.md=E.md.sha1.create();break;case"md5WithRSAEncryption":v.md=E.md.md5.create();break;case"sha256WithRSAEncryption":v.md=E.md.sha256.create();break;case"sha384WithRSAEncryption":v.md=E.md.sha384.create();break;case"sha512WithRSAEncryption":v.md=E.md.sha512.create();break;case"RSASSA-PSS":v.md=E.md.sha256.create();break}}if(v.md===null){var T=new Error("Could not compute certificate digest. Unknown signature OID.");throw T.signatureOid=v.signatureOid,T}var A=e.toDer(v.tbsCertificate);v.md.update(A.getBytes())}var C=E.md.sha1.create();v.issuer.getField=function(O){return d(v.issuer,O)},v.issuer.addField=function(O){p([O]),v.issuer.attributes.push(O)},v.issuer.attributes=r.RDNAttributesAsArray(N.certIssuer,C),N.certIssuerUniqueId&&(v.issuer.uniqueId=N.certIssuerUniqueId),v.issuer.hash=C.digest().toHex();var P=E.md.sha1.create();return v.subject.getField=function(O){return d(v.subject,O)},v.subject.addField=function(O){p([O]),v.subject.attributes.push(O)},v.subject.attributes=r.RDNAttributesAsArray(N.certSubject,P),N.certSubjectUniqueId&&(v.subject.uniqueId=N.certSubjectUniqueId),v.subject.hash=P.digest().toHex(),N.certExtensions?v.extensions=r.certificateExtensionsFromAsn1(N.certExtensions):v.extensions=[],v.publicKey=r.publicKeyFromAsn1(N.subjectPublicKeyInfo),v},r.certificateExtensionsFromAsn1=function(g){for(var x=[],N=0;N<g.value.length;++N)for(var w=g.value[N],T=0;T<w.value.length;++T)x.push(r.certificateExtensionFromAsn1(w.value[T]));return x},r.certificateExtensionFromAsn1=function(g){var x={};if(x.id=e.derToOid(g.value[0].value),x.critical=!1,g.value[1].type===e.Type.BOOLEAN?(x.critical=g.value[1].value.charCodeAt(0)!==0,x.value=g.value[2].value):x.value=g.value[1].value,x.id in n){if(x.name=n[x.id],x.name==="keyUsage"){var N=e.fromDer(x.value),w=0,T=0;N.value.length>1&&(w=N.value.charCodeAt(1),T=N.value.length>2?N.value.charCodeAt(2):0),x.digitalSignature=(w&128)===128,x.nonRepudiation=(w&64)===64,x.keyEncipherment=(w&32)===32,x.dataEncipherment=(w&16)===16,x.keyAgreement=(w&8)===8,x.keyCertSign=(w&4)===4,x.cRLSign=(w&2)===2,x.encipherOnly=(w&1)===1,x.decipherOnly=(T&128)===128}else if(x.name==="basicConstraints"){var N=e.fromDer(x.value);N.value.length>0&&N.value[0].type===e.Type.BOOLEAN?x.cA=N.value[0].value.charCodeAt(0)!==0:x.cA=!1;var D=null;N.value.length>0&&N.value[0].type===e.Type.INTEGER?D=N.value[0].value:N.value.length>1&&(D=N.value[1].value),D!==null&&(x.pathLenConstraint=e.derToInteger(D))}else if(x.name==="extKeyUsage")for(var N=e.fromDer(x.value),v=0;v<N.value.length;++v){var l=e.derToOid(N.value[v].value);l in n?x[n[l]]=!0:x[l]=!0}else if(x.name==="nsCertType"){var N=e.fromDer(x.value),w=0;N.value.length>1&&(w=N.value.charCodeAt(1)),x.client=(w&128)===128,x.server=(w&64)===64,x.email=(w&32)===32,x.objsign=(w&16)===16,x.reserved=(w&8)===8,x.sslCA=(w&4)===4,x.emailCA=(w&2)===2,x.objCA=(w&1)===1}else if(x.name==="subjectAltName"||x.name==="issuerAltName"){x.altNames=[];for(var b,N=e.fromDer(x.value),A=0;A<N.value.length;++A){b=N.value[A];var C={type:b.type,value:b.value};x.altNames.push(C);switch(b.type){case 1:case 2:case 6:break;case 7:C.ip=E.util.bytesToIP(b.value);break;case 8:C.oid=e.derToOid(b.value);break}}}else if(x.name==="subjectKeyIdentifier"){var N=e.fromDer(x.value);x.subjectKeyIdentifier=E.util.bytesToHex(N.value)}}return x},r.certificationRequestFromAsn1=function(g,x){var N={},w=[];if(!e.validate(g,c,N,w)){var T=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw T.errors=w,T}var D=e.derToOid(N.publicKeyOid);if(D!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var v=r.createCertificationRequest();if(v.version=N.csrVersion?N.csrVersion.charCodeAt(0):0,v.signatureOid=E.asn1.derToOid(N.csrSignatureOid),v.signatureParameters=h(v.signatureOid,N.csrSignatureParams,!0),v.siginfo.algorithmOid=E.asn1.derToOid(N.csrSignatureOid),v.siginfo.parameters=h(v.siginfo.algorithmOid,N.csrSignatureParams,!1),v.signature=N.csrSignature,v.certificationRequestInfo=N.certificationRequestInfo,x){if(v.md=null,v.signatureOid in n){var D=n[v.signatureOid];switch(D){case"sha1WithRSAEncryption":v.md=E.md.sha1.create();break;case"md5WithRSAEncryption":v.md=E.md.md5.create();break;case"sha256WithRSAEncryption":v.md=E.md.sha256.create();break;case"sha384WithRSAEncryption":v.md=E.md.sha384.create();break;case"sha512WithRSAEncryption":v.md=E.md.sha512.create();break;case"RSASSA-PSS":v.md=E.md.sha256.create();break}}if(v.md===null){var T=new Error("Could not compute certification request digest. Unknown signature OID.");throw T.signatureOid=v.signatureOid,T}var l=e.toDer(v.certificationRequestInfo);v.md.update(l.getBytes())}var b=E.md.sha1.create();return v.subject.getField=function(A){return d(v.subject,A)},v.subject.addField=function(A){p([A]),v.subject.attributes.push(A)},v.subject.attributes=r.RDNAttributesAsArray(N.certificationRequestInfoSubject,b),v.subject.hash=b.digest().toHex(),v.publicKey=r.publicKeyFromAsn1(N.subjectPublicKeyInfo),v.getAttribute=function(A){return d(v,A)},v.addAttribute=function(A){p([A]),v.attributes.push(A)},v.attributes=r.CRIAttributesAsArray(N.certificationRequestInfoAttributes||[]),v},r.createCertificationRequest=function(){var g={};return g.version=0,g.signatureOid=null,g.signature=null,g.siginfo={},g.siginfo.algorithmOid=null,g.subject={},g.subject.getField=function(x){return d(g.subject,x)},g.subject.addField=function(x){p([x]),g.subject.attributes.push(x)},g.subject.attributes=[],g.subject.hash=null,g.publicKey=null,g.attributes=[],g.getAttribute=function(x){return d(g,x)},g.addAttribute=function(x){p([x]),g.attributes.push(x)},g.md=null,g.setSubject=function(x){p(x),g.subject.attributes=x,g.subject.hash=null},g.setAttributes=function(x){p(x),g.attributes=x},g.sign=function(x,N){g.md=N||E.md.sha1.create();var w=n[g.md.algorithm+"WithRSAEncryption"];if(!w){var T=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw T.algorithm=g.md.algorithm,T}g.signatureOid=g.siginfo.algorithmOid=w,g.certificationRequestInfo=r.getCertificationRequestInfo(g);var D=e.toDer(g.certificationRequestInfo);g.md.update(D.getBytes()),g.signature=x.sign(g.md)},g.verify=function(){var x=!1,N=g.md;if(N===null){if(g.signatureOid in n){var w=n[g.signatureOid];switch(w){case"sha1WithRSAEncryption":N=E.md.sha1.create();break;case"md5WithRSAEncryption":N=E.md.md5.create();break;case"sha256WithRSAEncryption":N=E.md.sha256.create();break;case"sha384WithRSAEncryption":N=E.md.sha384.create();break;case"sha512WithRSAEncryption":N=E.md.sha512.create();break;case"RSASSA-PSS":N=E.md.sha256.create();break}}if(N===null){var T=new Error("Could not compute certification request digest. Unknown signature OID.");throw T.signatureOid=g.signatureOid,T}var D=g.certificationRequestInfo||r.getCertificationRequestInfo(g),v=e.toDer(D);N.update(v.getBytes())}if(N!==null){var l;switch(g.signatureOid){case n.sha1WithRSAEncryption:break;case n["RSASSA-PSS"]:var b,A;if(b=n[g.signatureParameters.mgf.hash.algorithmOid],b===void 0||E.md[b]===void 0){var T=new Error("Unsupported MGF hash function.");throw T.oid=g.signatureParameters.mgf.hash.algorithmOid,T.name=b,T}if(A=n[g.signatureParameters.mgf.algorithmOid],A===void 0||E.mgf[A]===void 0){var T=new Error("Unsupported MGF function.");throw T.oid=g.signatureParameters.mgf.algorithmOid,T.name=A,T}if(A=E.mgf[A].create(E.md[b].create()),b=n[g.signatureParameters.hash.algorithmOid],b===void 0||E.md[b]===void 0){var T=new Error("Unsupported RSASSA-PSS hash function.");throw T.oid=g.signatureParameters.hash.algorithmOid,T.name=b,T}l=E.pss.create(E.md[b].create(),A,g.signatureParameters.saltLength);break}x=g.publicKey.verify(N.digest().getBytes(),g.signature,l)}return x},g};function y(g){for(var x=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),N,w,T=g.attributes,D=0;D<T.length;++D){N=T[D];var v=N.value,l=e.Type.PRINTABLESTRING;"valueTagClass"in N&&(l=N.valueTagClass,l===e.Type.UTF8&&(v=E.util.encodeUtf8(v))),w=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,l,!1,v)])]),x.value.push(w)}return x}function p(g){for(var x,N=0;N<g.length;++N){if(x=g[N],typeof x.name=="undefined"&&(x.type&&x.type in r.oids?x.name=r.oids[x.type]:x.shortName&&x.shortName in i&&(x.name=r.oids[i[x.shortName]])),typeof x.type=="undefined")if(x.name&&x.name in r.oids)x.type=r.oids[x.name];else{var w=new Error("Attribute type not specified.");throw w.attribute=x,w}if(typeof x.shortName=="undefined"&&(x.name&&x.name in i&&(x.shortName=i[x.name])),x.type===n.extensionRequest&&(x.valueConstructed=!0,x.valueTagClass=e.Type.SEQUENCE,!x.value&&x.extensions)){x.value=[];for(var T=0;T<x.extensions.length;++T)x.value.push(r.certificateExtensionToAsn1(m(x.extensions[T])))}if(typeof x.value=="undefined"){var w=new Error("Attribute value not specified.");throw w.attribute=x,w}}}function m(g,x){if(x=x||{},typeof g.name=="undefined"&&(g.id&&g.id in r.oids&&(g.name=r.oids[g.id])),typeof g.id=="undefined")if(g.name&&g.name in r.oids)g.id=r.oids[g.name];else{var N=new Error("Extension ID not specified.");throw N.extension=g,N}if(typeof g.value!="undefined")return g;if(g.name==="keyUsage"){var w=0,T=0,D=0;g.digitalSignature&&(T|=128,w=7),g.nonRepudiation&&(T|=64,w=6),g.keyEncipherment&&(T|=32,w=5),g.dataEncipherment&&(T|=16,w=4),g.keyAgreement&&(T|=8,w=3),g.keyCertSign&&(T|=4,w=2),g.cRLSign&&(T|=2,w=1),g.encipherOnly&&(T|=1,w=0),g.decipherOnly&&(D|=128,w=7);var v=String.fromCharCode(w);D!==0?v+=String.fromCharCode(T)+String.fromCharCode(D):T!==0&&(v+=String.fromCharCode(T)),g.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,v)}else if(g.name==="basicConstraints")g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),g.cA&&g.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in g&&g.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.pathLenConstraint).getBytes()));else if(g.name==="extKeyUsage"){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var l=g.value.value;for(var b in g){if(g[b]!==!0)continue;b in n?l.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n[b]).getBytes())):b.indexOf(".")!==-1&&l.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(b).getBytes()))}}else if(g.name==="nsCertType"){var w=0,T=0;g.client&&(T|=128,w=7),g.server&&(T|=64,w=6),g.email&&(T|=32,w=5),g.objsign&&(T|=16,w=4),g.reserved&&(T|=8,w=3),g.sslCA&&(T|=4,w=2),g.emailCA&&(T|=2,w=1),g.objCA&&(T|=1,w=0);var v=String.fromCharCode(w);T!==0&&(v+=String.fromCharCode(T)),g.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,v)}else if(g.name==="subjectAltName"||g.name==="issuerAltName"){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var A,C=0;C<g.altNames.length;++C){A=g.altNames[C];var v=A.value;if(A.type===7&&A.ip){if(v=E.util.bytesFromIP(A.ip),v===null){var N=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw N.extension=g,N}}else A.type===8&&(A.oid?v=e.oidToDer(e.oidToDer(A.oid)):v=e.oidToDer(v));g.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,A.type,!1,v))}}else if(g.name==="nsComment"&&x.cert){if(!/^[\x00-\x7F]*$/.test(g.comment)||g.comment.length<1||g.comment.length>128)throw new Error('Invalid "nsComment" content.');g.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,g.comment)}else if(g.name==="subjectKeyIdentifier"&&x.cert){var P=x.cert.generateSubjectKeyIdentifier();g.subjectKeyIdentifier=P.toHex(),g.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,P.getBytes())}else if(g.name==="authorityKeyIdentifier"&&x.cert){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var l=g.value.value;if(g.keyIdentifier){var O=g.keyIdentifier===!0?x.cert.generateSubjectKeyIdentifier().getBytes():g.keyIdentifier;l.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,O))}if(g.authorityCertIssuer){var L=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[y(g.authorityCertIssuer===!0?x.cert.issuer:g.authorityCertIssuer)])];l.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,L))}if(g.serialNumber){var B=E.util.hexToBytes(g.serialNumber===!0?x.cert.serialNumber:g.serialNumber);l.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,B))}}else if(g.name==="cRLDistributionPoints"){g.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var l=g.value.value,S=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),M=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),A,C=0;C<g.altNames.length;++C){A=g.altNames[C];var v=A.value;if(A.type===7&&A.ip){if(v=E.util.bytesFromIP(A.ip),v===null){var N=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw N.extension=g,N}}else A.type===8&&(A.oid?v=e.oidToDer(e.oidToDer(A.oid)):v=e.oidToDer(v));M.value.push(e.create(e.Class.CONTEXT_SPECIFIC,A.type,!1,v))}S.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[M])),l.push(S)}if(typeof g.value=="undefined"){var N=new Error("Extension value not specified.");throw N.extension=g,N}return g}function _(g,x){switch(g){case n["RSASSA-PSS"]:var N=[];return x.hash.algorithmOid!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),x.mgf.algorithmOid!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),x.saltLength!==void 0&&N.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function I(g){var x=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(g.attributes.length===0)return x;for(var N=g.attributes,w=0;w<N.length;++w){var T=N[w],D=T.value,v=e.Type.UTF8;"valueTagClass"in T&&(v=T.valueTagClass),v===e.Type.UTF8&&(D=E.util.encodeUtf8(D));var l=!1;"valueConstructed"in T&&(l=T.valueConstructed);var b=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,v,l,D)])]);x.value.push(b)}return x}var f=new Date("1950-01-01T00:00:00Z"),k=new Date("2050-01-01T00:00:00Z");function R(g){return g>=f&&g<k?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(g)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(g))}r.getTBSCertificate=function(g){var x=R(g.validity.notBefore),N=R(g.validity.notAfter),w=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,E.util.hexToBytes(g.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.siginfo.algorithmOid).getBytes()),_(g.siginfo.algorithmOid,g.siginfo.parameters)]),y(g.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[x,N]),y(g.subject),r.publicKeyToAsn1(g.publicKey)]);return g.issuer.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+g.issuer.uniqueId)])),g.subject.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+g.subject.uniqueId)])),g.extensions.length>0&&w.value.push(r.certificateExtensionsToAsn1(g.extensions)),w},r.getCertificationRequestInfo=function(g){var x=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(g.version).getBytes()),y(g.subject),r.publicKeyToAsn1(g.publicKey),I(g)]);return x},r.distinguishedNameToAsn1=function(g){return y(g)},r.certificateToAsn1=function(g){var x=g.tbsCertificate||r.getTBSCertificate(g);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[x,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.signatureOid).getBytes()),_(g.signatureOid,g.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+g.signature)])},r.certificateExtensionsToAsn1=function(g){var x=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),N=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);x.value.push(N);for(var w=0;w<g.length;++w)N.value.push(r.certificateExtensionToAsn1(g[w]));return x},r.certificateExtensionToAsn1=function(g){var x=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);x.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.id).getBytes())),g.critical&&x.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,String.fromCharCode(255)));var N=g.value;return typeof g.value!="string"&&(N=e.toDer(N).getBytes()),x.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,N)),x},r.certificationRequestToAsn1=function(g){var x=g.certificationRequestInfo||r.getCertificationRequestInfo(g);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[x,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.signatureOid).getBytes()),_(g.signatureOid,g.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+g.signature)])},r.createCaStore=function(g){var x={certs:{}};x.getIssuer=function(v){var l=N(v.issuer);return l},x.addCertificate=function(v){if(typeof v=="string"&&(v=E.pki.certificateFromPem(v)),w(v.subject),!x.hasCertificate(v))if(v.subject.hash in x.certs){var l=x.certs[v.subject.hash];E.util.isArray(l)||(l=[l]),l.push(v),x.certs[v.subject.hash]=l}else x.certs[v.subject.hash]=v},x.hasCertificate=function(v){typeof v=="string"&&(v=E.pki.certificateFromPem(v));var l=N(v.subject);if(!l)return!1;E.util.isArray(l)||(l=[l]);for(var b=e.toDer(r.certificateToAsn1(v)).getBytes(),A=0;A<l.length;++A){var C=e.toDer(r.certificateToAsn1(l[A])).getBytes();if(b===C)return!0}return!1},x.listAllCertificates=function(){var v=[];for(var l in x.certs)if(x.certs.hasOwnProperty(l)){var b=x.certs[l];if(!E.util.isArray(b))v.push(b);else for(var A=0;A<b.length;++A)v.push(b[A])}return v},x.removeCertificate=function(v){var l;if(typeof v=="string"&&(v=E.pki.certificateFromPem(v)),w(v.subject),!x.hasCertificate(v))return null;var b=N(v.subject);if(!E.util.isArray(b))return l=x.certs[v.subject.hash],delete x.certs[v.subject.hash],l;for(var A=e.toDer(r.certificateToAsn1(v)).getBytes(),C=0;C<b.length;++C){var P=e.toDer(r.certificateToAsn1(b[C])).getBytes();A===P&&(l=b[C],b.splice(C,1))}return b.length===0&&delete x.certs[v.subject.hash],l};function N(v){return w(v),x.certs[v.hash]||null}function w(v){if(!v.hash){var l=E.md.sha1.create();v.attributes=r.RDNAttributesAsArray(y(v),l),v.hash=l.digest().toHex()}}if(g)for(var T=0;T<g.length;++T){var D=g[T];x.addCertificate(D)}return x},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(g,x,N){typeof N=="function"&&(N={verify:N}),N=N||{},x=x.slice(0);var w=x.slice(0),T=N.validityCheckDate;typeof T=="undefined"&&(T=new Date);var D=!0,v=null,l=0;do{var b=x.shift(),A=null,C=!1;if(T&&((T<b.validity.notBefore||T>b.validity.notAfter)&&(v={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:b.validity.notBefore,notAfter:b.validity.notAfter,now:T})),v===null){if(A=x[0]||g.getIssuer(b),A===null&&(b.isIssuer(b)&&(C=!0,A=b)),A){var P=A;E.util.isArray(P)||(P=[P]);for(var O=!1;!O&&P.length>0;){A=P.shift();try{O=A.verify(b)}catch(H){}}O||(v={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}v===null&&(!A||C)&&!g.hasCertificate(b)&&(v={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(v===null&&A&&!b.isIssuer(A)&&(v={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),v===null)for(var L={keyUsage:!0,basicConstraints:!0},B=0;v===null&&B<b.extensions.length;++B){var S=b.extensions[B];S.critical&&!(S.name in L)&&(v={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(v===null&&(!D||x.length===0&&(!A||C))){var M=b.getExtension("basicConstraints"),q=b.getExtension("keyUsage");if(q!==null&&((!q.keyCertSign||M===null)&&(v={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate})),v===null&&M!==null&&!M.cA&&(v={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),v===null&&q!==null&&"pathLenConstraint"in M){var z=l-1;z>M.pathLenConstraint&&(v={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}}var G=v===null?!0:v.error,j=N.verify?N.verify(G,l,w):G;if(j===!0)v=null;else throw G===!0&&(v={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(j||j===0)&&(typeof j=="object"&&!E.util.isArray(j)?(j.message&&(v.message=j.message),j.error&&(v.error=j.error)):typeof j=="string"&&(v.error=j)),v;D=!1,++l}while(x.length>0);return!0}}),Z9=Z(function(t){var e=E.asn1,r=t.exports=E.pkcs7=E.pkcs7||{};r.messageFromPem=function(p){var m=E.pem.decode(p)[0];if(m.type!=="PKCS7"){var _=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw _.headerType=m.type,_}if(m.procType&&m.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var I=e.fromDer(m.body);return r.messageFromAsn1(I)},r.messageToPem=function(p,m){var _={type:"PKCS7",body:e.toDer(p.toAsn1()).getBytes()};return E.pem.encode(_,{maxline:m})},r.messageFromAsn1=function(p){var m={},_=[];if(!e.validate(p,r.asn1.contentInfoValidator,m,_)){var I=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw I.errors=_,I}var f=e.derToOid(m.contentType),k;switch(f){case E.pki.oids.envelopedData:k=r.createEnvelopedData();break;case E.pki.oids.encryptedData:k=r.createEncryptedData();break;case E.pki.oids.signedData:k=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+f+" is not (yet) supported.")}return k.fromAsn1(m.content.value[0]),k},r.createSignedData=function(){var p=null;return p={type:E.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(I){if(h(p,I,r.asn1.signedDataValidator),p.certificates=[],p.crls=[],p.digestAlgorithmIdentifiers=[],p.contentInfo=null,p.signerInfos=[],p.rawCapture.certificates)for(var f=p.rawCapture.certificates.value,k=0;k<f.length;++k)p.certificates.push(E.pki.certificateFromAsn1(f[k]))},toAsn1:function(){p.contentInfo||p.sign();for(var I=[],f=0;f<p.certificates.length;++f)I.push(E.pki.certificateToAsn1(p.certificates[f]));var k=[],R=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(p.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,p.digestAlgorithmIdentifiers),p.contentInfo])]);return I.length>0&&R.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,I)),k.length>0&&R.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,k)),R.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,p.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.type).getBytes()),R])},addSigner:function(I){var f=I.issuer,k=I.serialNumber;if(I.certificate){var R=I.certificate;typeof R=="string"&&(R=E.pki.certificateFromPem(R)),f=R.issuer.attributes,k=R.serialNumber}var g=I.key;if(!g)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof g=="string"&&(g=E.pki.privateKeyFromPem(g));var x=I.digestAlgorithm||E.pki.oids.sha1;switch(x){case E.pki.oids.sha1:case E.pki.oids.sha256:case E.pki.oids.sha384:case E.pki.oids.sha512:case E.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+x)}var N=I.authenticatedAttributes||[];if(N.length>0){for(var w=!1,T=!1,D=0;D<N.length;++D){var v=N[D];if(!w&&v.type===E.pki.oids.contentType){if(w=!0,T)break;continue}if(!T&&v.type===E.pki.oids.messageDigest){if(T=!0,w)break;continue}}if(!w||!T)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}p.signers.push({key:g,version:1,issuer:f,serialNumber:k,digestAlgorithm:x,signatureAlgorithm:E.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:N,unauthenticatedAttributes:[]})},sign:function(I){if(I=I||{},(typeof p.content!="object"||p.contentInfo===null)&&(p.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(E.pki.oids.data).getBytes())]),"content"in p)){var f;p.content instanceof E.util.ByteBuffer?f=p.content.bytes():typeof p.content=="string"&&(f=E.util.encodeUtf8(p.content)),I.detached?p.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f):p.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f)]))}if(p.signers.length===0)return;var k=m();_(k)},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(I){typeof I=="string"&&(I=E.pki.certificateFromPem(I)),p.certificates.push(I)},addCertificateRevokationList:function(I){throw new Error("PKCS#7 CRL support not yet implemented.")}},p;function m(){for(var I={},f=0;f<p.signers.length;++f){var k=p.signers[f],R=k.digestAlgorithm;R in I||(I[R]=E.md[E.pki.oids[R]].create()),k.authenticatedAttributes.length===0?k.md=I[R]:k.md=E.md[E.pki.oids[R]].create()}p.digestAlgorithmIdentifiers=[];for(var R in I)p.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(R).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return I}function _(I){var f;if(p.detachedContent?f=p.detachedContent:(f=p.contentInfo.value[1],f=f.value[0]),!f)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var k=e.derToOid(p.contentInfo.value[0].value),R=e.toDer(f);R.getByte(),e.getBerValueLength(R),R=R.getBytes();for(var g in I)I[g].start().update(R);for(var x=new Date,N=0;N<p.signers.length;++N){var w=p.signers[N];if(w.authenticatedAttributes.length===0){if(k!==E.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{w.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var T=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),D=0;D<w.authenticatedAttributes.length;++D){var v=w.authenticatedAttributes[D];v.type===E.pki.oids.messageDigest?v.value=I[w.digestAlgorithm].digest():v.type===E.pki.oids.signingTime&&(v.value||(v.value=x)),T.value.push(c(v)),w.authenticatedAttributesAsn1.value.push(c(v))}R=e.toDer(T).getBytes(),w.md.start().update(R)}w.signature=w.key.sign(w.md,"RSASSA-PKCS1-V1_5")}p.signerInfos=u(p.signers)}},r.createEncryptedData=function(){var p=null;return p={type:E.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:E.pki.oids["aes256-CBC"]},fromAsn1:function(m){h(p,m,r.asn1.encryptedDataValidator)},decrypt:function(m){m!==void 0&&(p.encryptedContent.key=m),y(p)}},p},r.createEnvelopedData=function(){var p=null;return p={type:E.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:E.pki.oids["aes256-CBC"]},fromAsn1:function(m){var _=h(p,m,r.asn1.envelopedDataValidator);p.recipients=a(_.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(p.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,s(p.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,d(p.encryptedContent))])])])},findRecipient:function(m){for(var _=m.issuer.attributes,I=0;I<p.recipients.length;++I){var f=p.recipients[I],k=f.issuer;if(f.serialNumber!==m.serialNumber)continue;if(k.length!==_.length)continue;for(var R=!0,g=0;g<_.length;++g)if(k[g].type!==_[g].type||k[g].value!==_[g].value){R=!1;break}if(R)return f}return null},decrypt:function(m,_){if(p.encryptedContent.key===void 0&&m!==void 0&&_!==void 0)switch(m.encryptedContent.algorithm){case E.pki.oids.rsaEncryption:case E.pki.oids.desCBC:var I=_.decrypt(m.encryptedContent.content);p.encryptedContent.key=E.util.createBuffer(I);break;default:throw new Error("Unsupported asymmetric cipher, OID "+m.encryptedContent.algorithm)}y(p)},addRecipient:function(m){p.recipients.push({version:0,issuer:m.issuer.attributes,serialNumber:m.serialNumber,encryptedContent:{algorithm:E.pki.oids.rsaEncryption,key:m.publicKey}})},encrypt:function(m,_){if(p.encryptedContent.content===void 0){_=_||p.encryptedContent.algorithm,m=m||p.encryptedContent.key;var I,f,k;switch(_){case E.pki.oids["aes128-CBC"]:I=16,f=16,k=E.aes.createEncryptionCipher;break;case E.pki.oids["aes192-CBC"]:I=24,f=16,k=E.aes.createEncryptionCipher;break;case E.pki.oids["aes256-CBC"]:I=32,f=16,k=E.aes.createEncryptionCipher;break;case E.pki.oids["des-EDE3-CBC"]:I=24,f=8,k=E.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+_)}if(m===void 0)m=E.util.createBuffer(E.random.getBytes(I));else if(m.length()!=I)throw new Error("Symmetric key has wrong length; got "+m.length()+" bytes, expected "+I+".");p.encryptedContent.algorithm=_,p.encryptedContent.key=m,p.encryptedContent.parameter=E.util.createBuffer(E.random.getBytes(f));var R=k(m);if(R.start(p.encryptedContent.parameter.copy()),R.update(p.content),!R.finish())throw new Error("Symmetric encryption failed.");p.encryptedContent.content=R.output}for(var g=0;g<p.recipients.length;++g){var x=p.recipients[g];if(x.encryptedContent.content!==void 0)continue;switch(x.encryptedContent.algorithm){case E.pki.oids.rsaEncryption:x.encryptedContent.content=x.encryptedContent.key.encrypt(p.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+x.encryptedContent.algorithm)}}}},p};function n(p){var m={},_=[];if(!e.validate(p,r.asn1.recipientInfoValidator,m,_)){var I=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw I.errors=_,I}return{version:m.version.charCodeAt(0),issuer:E.pki.RDNAttributesAsArray(m.issuer),serialNumber:E.util.createBuffer(m.serial).toHex(),encryptedContent:{algorithm:e.derToOid(m.encAlgorithm),parameter:m.encParameter.value,content:m.encKey}}}function i(p){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(p.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[E.pki.distinguishedNameToAsn1({attributes:p.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,E.util.hexToBytes(p.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p.encryptedContent.content)])}function a(p){for(var m=[],_=0;_<p.length;++_)m.push(n(p[_]));return m}function s(p){for(var m=[],_=0;_<p.length;++_)m.push(i(p[_]));return m}function o(p){var m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(p.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[E.pki.distinguishedNameToAsn1({attributes:p.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,E.util.hexToBytes(p.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(p.authenticatedAttributesAsn1&&m.value.push(p.authenticatedAttributesAsn1),m.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),m.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p.signature)),p.unauthenticatedAttributes.length>0){for(var _=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),I=0;I<p.unauthenticatedAttributes.length;++I){var f=p.unauthenticatedAttributes[I];_.values.push(c(f))}m.value.push(_)}return m}function u(p){for(var m=[],_=0;_<p.length;++_)m.push(o(p[_]));return m}function c(p){var m;if(p.type===E.pki.oids.contentType)m=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.value).getBytes());else if(p.type===E.pki.oids.messageDigest)m=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p.value.bytes());else if(p.type===E.pki.oids.signingTime){var _=new Date("1950-01-01T00:00:00Z"),I=new Date("2050-01-01T00:00:00Z"),f=p.value;if(typeof f=="string"){var k=Date.parse(f);isNaN(k)?f.length===13?f=e.utcTimeToDate(f):f=e.generalizedTimeToDate(f):f=new Date(k)}f>=_&&f<I?m=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(f)):m=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(f))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[m])])}function d(p){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(E.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p.parameter.getBytes())]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p.content.getBytes())])]}function h(p,m,_){var I={},f=[];if(!e.validate(m,_,I,f)){var k=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw k.errors=k,k}var R=e.derToOid(I.contentType);if(R!==E.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(I.encryptedContent){var g="";if(E.util.isArray(I.encryptedContent))for(var x=0;x<I.encryptedContent.length;++x){if(I.encryptedContent[x].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");g+=I.encryptedContent[x].value}else g=I.encryptedContent;p.encryptedContent={algorithm:e.derToOid(I.encAlgorithm),parameter:E.util.createBuffer(I.encParameter.value),content:E.util.createBuffer(g)}}if(I.content){var g="";if(E.util.isArray(I.content))for(var x=0;x<I.content.length;++x){if(I.content[x].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");g+=I.content[x].value}else g=I.content;p.content=E.util.createBuffer(g)}return p.version=I.version.charCodeAt(0),p.rawCapture=I,I}function y(p){if(p.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(p.content===void 0){var m;switch(p.encryptedContent.algorithm){case E.pki.oids["aes128-CBC"]:case E.pki.oids["aes192-CBC"]:case E.pki.oids["aes256-CBC"]:m=E.aes.createDecryptionCipher(p.encryptedContent.key);break;case E.pki.oids.desCBC:case E.pki.oids["des-EDE3-CBC"]:m=E.des.createDecryptionCipher(p.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+p.encryptedContent.algorithm)}if(m.start(p.encryptedContent.parameter),m.update(p.encryptedContent.content),!m.finish())throw new Error("Symmetric decryption failed.");p.content=m.output}}}),h_=Z(function(t,e){const r=E.pki;e=t.exports,e.certificateForKey=(i,a)=>{const s=r.setRsaPublicKey(a.n,a.e),o=r.createCertificate();o.publicKey=s,o.serialNumber="01",o.validity.notBefore=new Date,o.validity.notAfter=new Date,o.validity.notAfter.setFullYear(o.validity.notBefore.getFullYear()+10);const u=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:i.id}];return o.setSubject(u),o.setIssuer(u),o.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),o.sign(a),o};async function n(i,a){const s=i.map(a),o=await Promise.all(s),u=o.findIndex(c=>c);return i[u]}t.exports.findAsync=n});const{certificateForKey:p_,findAsync:m_}=h_;class b_{constructor(t){if(!t)throw K(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=t}async encrypt(t,e){if(!(e instanceof Uint8Array))throw K(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");const r=await this.keychain.findKeyByName(t),n=await this.keychain._getPrivateKey(t),i=E.pki.decryptRsaPrivateKey(n,this.keychain._()),a=await p_(r,i),s=E.pkcs7.createEnvelopedData();s.addRecipient(a),s.content=E.util.createBuffer(e),s.encrypt();const o=E.asn1.toDer(s.toAsn1()).getBytes();return le(o,"ascii")}async decrypt(t){if(!(t instanceof Uint8Array))throw K(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let e;try{const o=E.util.createBuffer(se(t,"ascii")),u=E.asn1.fromDer(o);e=E.pkcs7.messageFromAsn1(u)}catch(o){throw K(new Error("Invalid CMS: "+o.message),"ERR_INVALID_CMS")}const r=e.recipients.filter(o=>o.issuer.find(u=>u.shortName==="O"&&u.value==="ipfs")).filter(o=>o.issuer.find(u=>u.shortName==="CN")).map(o=>({recipient:o,keyId:o.issuer.find(u=>u.shortName==="CN").value})),n=await m_(r,async o=>{try{const u=await this.keychain.findKeyById(o.keyId);if(u)return!0}catch(u){return!1}return!1});if(!n){const o=r.map(u=>u.keyId);throw K(new Error("Decryption needs one of the key(s): "+o.join(", ")),"ERR_MISSING_KEYS",{missingKeys:o})}const i=await this.keychain.findKeyById(n.keyId),a=await this.keychain._getPrivateKey(i.name),s=E.pki.decryptRsaPrivateKey(a,this.keychain._());return e.decrypt(n.recipient,s),le(e.content.getBytes(),"ascii")}}var y_=b_;const{Number:g_}=mi,v_="/pkcs8/",Bm="/info/",Ei={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},Nd={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function pn(t){return t?typeof t!="string"?!1:t===r_(t.trim()):!1}async function Ne(t){const e=200,r=1e3,n=Math.random()*(r-e)+e;throw await new Promise(i=>setTimeout(i,n)),t}function Hn(t){return new En.Key(v_+t)}function xi(t){return new En.Key(Bm+t)}class w_{constructor(t,e){if(!t)throw new Error("store is required");if(this.store=t,this.opts=rs(Nd,e),this.opts.passPhrase&&this.opts.passPhrase.length<20)throw new Error("passPhrase must be least 20 characters");if(this.opts.dek.keyLength<Ei.minKeyLength)throw new Error(`dek.keyLength must be least ${Ei.minKeyLength} bytes`);if(this.opts.dek.salt.length<Ei.minSaltLength)throw new Error(`dek.saltLength must be least ${Ei.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Ei.minIterationCount)throw new Error(`dek.iterationCount must be least ${Ei.minIterationCount}`);const r=this.opts.passPhrase?fa.pbkdf2(this.opts.passPhrase,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Object.defineProperty(this,"_",{value:()=>r})}get cms(){return new y_(this)}static generateOptions(){const t=Object.assign({},Nd),e=Math.ceil(Ei.minSaltLength/3)*3;return t.dek.salt=se(fa.randomBytes(e),"base64"),t}static get options(){return Nd}async createKey(t,e,r){const n=this;if(!pn(t)||t==="self")return Ne(K(new Error(`Invalid key name '${t}'`),"ERR_INVALID_KEY_NAME"));if(typeof e!="string")return Ne(K(new Error(`Invalid key type '${e}'`),"ERR_INVALID_KEY_TYPE"));const i=Hn(t),a=await n.store.has(i);if(a)return Ne(K(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(e.toLowerCase()){case"rsa":if(!g_.isSafeInteger(r)||r<2048)return Ne(K(new Error(`Invalid RSA key size ${r}`),"ERR_INVALID_KEY_SIZE"));break}let s;try{const o=await fa.keys.generateKeyPair(e,r),u=await o.id(),c=await o.export(this._());s={name:t,id:u};const d=n.store.batch();d.put(i,le(c)),d.put(xi(t),le(JSON.stringify(s))),await d.commit()}catch(o){return Ne(o)}return s}async listKeys(){const t=this,e={prefix:Bm},r=[];for await(const n of t.store.query(e))r.push(JSON.parse(se(n.value)));return r}async findKeyById(t){try{const e=await this.listKeys();return e.find(r=>r.id===t)}catch(e){return Ne(e)}}async findKeyByName(t){if(!pn(t))return Ne(K(new Error(`Invalid key name '${t}'`),"ERR_INVALID_KEY_NAME"));const e=xi(t);try{const r=await this.store.get(e);return JSON.parse(se(r))}catch(r){return Ne(K(new Error(`Key '${t}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(t){const e=this;if(!pn(t)||t==="self")return Ne(K(new Error(`Invalid key name '${t}'`),"ERR_INVALID_KEY_NAME"));const r=Hn(t),n=await e.findKeyByName(t),i=e.store.batch();return i.delete(r),i.delete(xi(t)),await i.commit(),n}async renameKey(t,e){const r=this;if(!pn(t)||t==="self")return Ne(K(new Error(`Invalid old key name '${t}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!pn(e)||e==="self")return Ne(K(new Error(`Invalid new key name '${e}'`),"ERR_NEW_KEY_NAME_INVALID"));const n=Hn(t),i=Hn(e),a=xi(t),s=xi(e),o=await r.store.has(i);if(o)return Ne(K(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{const u=await r.store.get(n),c=await r.store.get(a),d=JSON.parse(se(c));d.name=e;const h=r.store.batch();return h.put(i,u),h.put(s,le(JSON.stringify(d))),h.delete(n),h.delete(a),await h.commit(),d}catch(u){return Ne(u)}}async exportKey(t,e){if(!pn(t))return Ne(K(new Error(`Invalid key name '${t}'`),"ERR_INVALID_KEY_NAME"));if(!e)return Ne(K(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));const r=Hn(t);try{const n=await this.store.get(r),i=se(n),a=await fa.keys.import(i,this._());return a.export(e)}catch(n){return Ne(n)}}async importKey(t,e,r){const n=this;if(!pn(t)||t==="self")return Ne(K(new Error(`Invalid key name '${t}'`),"ERR_INVALID_KEY_NAME"));if(!e)return Ne(K(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));const i=Hn(t),a=await n.store.has(i);if(a)return Ne(K(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let s;try{s=await fa.keys.import(e,r)}catch(d){return Ne(K(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let o;try{o=await s.id(),e=await s.export(this._())}catch(d){return Ne(d)}const u={name:t,id:o},c=n.store.batch();return c.put(i,le(e)),c.put(xi(t),le(JSON.stringify(u))),await c.commit(),u}async importPeer(t,e){const r=this;if(!pn(t))return Ne(K(new Error(`Invalid key name '${t}'`),"ERR_INVALID_KEY_NAME"));if(!e||!e.privKey)return Ne(K(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));const n=e.privKey,i=Hn(t),a=await r.store.has(i);if(a)return Ne(K(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{const s=await n.id(),o=await n.export(this._()),u={name:t,id:s},c=r.store.batch();return c.put(i,le(o)),c.put(xi(t),le(JSON.stringify(u))),await c.commit(),u}catch(s){return Ne(s)}}async _getPrivateKey(t){if(!pn(t))return Ne(K(new Error(`Invalid key name '${t}'`),"ERR_INVALID_KEY_NAME"));try{const e=Hn(t),r=await this.store.get(e);return se(r)}catch(e){return Ne(K(new Error(`Key '${t}' does not exist. ${e.message}`),"ERR_KEY_NOT_FOUND"))}}}var Mm=w_;async function*E_(t,e){let r=[];for await(const n of e)r.push(n),r.length===t&&(yield r,r=[]);r.length>0&&(yield r)}function*x_(t,e){let r=[];for(const n of e)r.push(n),r.length===t&&(yield r,r=[]);r.length>0&&(yield r)}function Lm(t,e){return e===void 0?r=>Lm(t,r):e[Symbol.asyncIterator]?E_(t,e):x_(t,e)}function Si(t){if(typeof t.next=="function")return t;if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function Pd(){let t,e;const r=new Promise((n,i)=>{e=n,t=i});return{promise:r,reject:t,resolve:e}}function S_(t,e){const r=Si(e),n=[],i=[];let a=!1,s=!1;function o(){for(;i.length>0&&n.length>0;){const h=i.shift(),{error:y,value:p}=n.shift();y?h.reject(y):h.resolve({done:!1,value:p})}for(;i.length>0&&s;){const{resolve:h}=i.shift();h({done:!0,value:void 0})}}async function u(){if(s)return;if(a)return;if(n.length>=t)return;a=!0;try{const{done:h,value:y}=await r.next();h?s=!0:n.push({value:y})}catch(h){s=!0,n.push({error:h})}o(),a=!1,u()}async function c(){if(n.length>0){const{error:y,value:p}=n.shift();if(y)throw y;return u(),{done:!1,value:p}}if(s)return{done:!0,value:void 0};const h=Pd();return i.push(h),u(),h.promise}const d={next:c,[Symbol.asyncIterator]:()=>d};return d}function*A_(t,e){const r=[];let n;try{for(const i of e){if(r.push(i),r.length<=t)continue;yield r.shift()}}catch(i){n=i}for(const i of r)yield i;if(n)throw n}function xo(t,e){return e===void 0?r=>xo(t,r):t===0?e:e[Symbol.asyncIterator]?S_(t,e):A_(t,e)}async function I_(t){const e=[];for await(const r of t)e.push(r);return e}function k_(t){return t[Symbol.asyncIterator]?I_(t):Array.from(t)}async function*T_(t){for await(const e of t)yield*e}function*C_(t){for(const e of t)yield*e}function __(...t){const e=t.find(r=>r[Symbol.asyncIterator]!==void 0);return e?T_(t):C_(t)}async function R_(t){for await(const e of t);}function N_(t){if(t[Symbol.asyncIterator])return R_(t);for(const e of t);}async function*Um(t,e){for await(const r of e)await t(r)&&(yield r)}function So(t,e){return e===void 0?r=>Um(t,r):Um(t,e)}async function*ds(t){for await(const e of t)e&&typeof e!="string"&&(e[Symbol.iterator]||e[Symbol.asyncIterator])?yield*ds(e):yield e}async function*Km(t,e){for await(const r of e)yield await t(r)}function Ao(t,e){return e===void 0?r=>Km(t,r):Km(t,e)}function Fm(t,e){return e===void 0?r=>Fm(t,r):So(r=>r!=null,ds(Ao(t,e)))}function P_(t,e,r){const n=Si(r),i=[],a=[];let s=!1,o=!1,u=0,c=null;function d(){for(;a.length>0&&i.length>0;){const{resolve:_}=a.shift(),I=i.shift();_({done:!1,value:I})}for(;a.length>0&&u===0&&s;){const{resolve:_,reject:I}=a.shift();c?(I(c),c=null):_({done:!0,value:void 0})}}async function h(){if(s){d();return}if(o)return;if(u+i.length>=t)return;o=!0,u++;try{const{done:_,value:I}=await n.next();_?(s=!0,u--,d()):y(I)}catch(_){s=!0,u--,c=_,d()}o=!1,h()}async function y(_){try{const I=await e(_);if(I&&I[Symbol.asyncIterator])for await(const f of I)i.push(f);else i.push(I)}catch(I){s=!0,c=I}u--,d(),h()}async function p(){if(i.length===0){const I=Pd();return a.push(I),h(),I.promise}const _=i.shift();return h(),{done:!1,value:_}}const m={next:p,[Symbol.asyncIterator]:()=>m};return m}function Io(t,e,r){return e===void 0?(n,i)=>i?Io(t,n,i):Io(t,n):r===void 0?n=>Io(t,e,n):So(n=>n!=null,ds(P_(t,e,r)))}async function D_(t){return new Promise(e=>{t.once("readable",()=>{e()})})}async function*O_(t){for(;;){const e=t.read();if(e!==null){yield e;continue}if(t._readableState.ended)break;await D_(t)}}function B_(t){return typeof t[Symbol.asyncIterator]=="function"?t:O_(t)}async function*M_(...t){const e=new Set(t.map(Si));for(;e.size>0;)for(const r of e){const n=await r.next();n.done?e.delete(r):yield n.value}}function jm(t,...e){let r=t();for(const n of e)r=n(r);return r}async function*L_(t,e,r){let n=null;const i=u=>({value:e(u)}),a=async function*(u){for await(const c of u){if(n)return;yield c}},s=jm(()=>r,xo(1),a,Ao(i),xo(t-1)),o=Si(s);for(;;){const{value:u,done:c}=await o.next();if(c)break;try{const d=await u.value;n||(yield d)}catch(d){n=d}}if(n)throw n}function ko(t,e,r){return e===void 0?(n,i)=>ko(t,n,i):r===void 0?n=>ko(t,e,n):t===1?Ao(e,r):L_(t,e,r)}function To(t,e,r){return e===void 0?(n,i)=>i?To(t,n,i):To(t,n):r===void 0?n=>To(t,e,n):So(n=>n!=null,ds(ko(t,e,r)))}async function*U_(...t){const e=t.map(Si),r=new Set,n=new Map;let i=null,a=null,s=null;const o=h=>{i=h,a&&a(h)},u=h=>{s&&s(h)},c=()=>new Promise((h,y)=>{if(i&&y(i),n.size>0)return h();s=h,a=y}),d=h=>{const y=Promise.resolve(h.next()).then(async({done:p,value:m})=>{p||n.set(h,m),r.delete(y)});r.add(y),y.then(u,o)};for(const h of e)d(h);for(;;){if(r.size===0&&n.size===0)return;await c();for(const[h,y]of n)n.delete(h),yield y,d(h)}}async function qm(t,e,r){let n=e;for await(const i of r)n=await t(n,i);return n}function Dd(t,e,r){return e===void 0?(n,i)=>i?qm(t,n,i):Dd(t,n):r===void 0?n=>Dd(t,e,n):qm(t,e,r)}async function*K_(t,e){let r=0;for await(const n of e)if(yield await n,r++,r>=t)break}function*F_(t,e){let r=0;for(const n of e)if(yield n,r++,r>=t)break}function Vm(t,e){return e===void 0?r=>Vm(t,r):e[Symbol.asyncIterator]?K_(t,e):F_(t,e)}async function*zm(t,e){for await(const r of e)await t(r),yield r}function j_(t,e){return e===void 0?r=>zm(t,r):zm(t,e)}function $m(t,e){let r=t[0]+e[0],n=t[1]+e[1];if(n>=1e9){const i=n%1e9;r+=(n-i)/1e9,n=i}return[r,n]}async function*q_(t,e){const r=e[Symbol.asyncIterator]();let n=[0,0];for(;;){const i=Y.hrtime(),{value:a,done:s}=await r.next(),o=Y.hrtime(i);if(n=$m(n,o),t.progress&&t.progress(o,n),s)return t.total&&t.total(n),a;yield a}}function*V_(t,e){const r=e[Symbol.iterator]();let n=[0,0];for(;;){const i=Y.hrtime(),{value:a,done:s}=r.next(),o=Y.hrtime(i);if(n=$m(n,o),t.progress&&t.progress(o,n),s)return t.total&&t.total(n),a;yield a}}function Gm(t={},e){return e===void 0?r=>Gm(t,r):e[Symbol.asyncIterator]!==void 0?q_(t,e):V_(t,e)}function z_(t,e,r){const n=Si(r),i=[],a=[];let s=!1,o=!1,u=0,c=null;function d(){for(;a.length>0&&i.length>0;){const{resolve:_}=a.shift(),I=i.shift();_({done:!1,value:I})}for(;a.length>0&&u===0&&s;){const{resolve:_,reject:I}=a.shift();c?(I(c),c=null):_({done:!0,value:void 0})}}async function h(){if(s){d();return}if(o)return;if(u+i.length>=t)return;o=!0,u++;try{const{done:_,value:I}=await n.next();_?(s=!0,u--,d()):y(I)}catch(_){s=!0,u--,c=_,d()}o=!1,h()}async function y(_){try{const I=await e(_);i.push(I)}catch(I){s=!0,c=I}u--,d(),h()}async function p(){if(i.length===0){const I=Pd();return a.push(I),h(),I.promise}const _=i.shift();return h(),{done:!1,value:_}}const m={next:p,[Symbol.asyncIterator]:()=>m};return m}function Co(t,e,r){return e===void 0?(n,i)=>i?Co(t,n,i):Co(t,n):r===void 0?n=>Co(t,e,n):z_(t,e,r)}async function Hm(t,e){let r=null,n=null,i=null;const a=c=>{r=c,n&&n(c)},s=()=>{i&&i()},o=()=>{t.removeListener("error",a),t.removeListener("drain",s)};t.once("error",a);const u=()=>new Promise((c,d)=>{if(r)return d(r);t.once("drain",s),i=c,n=d});for await(const c of e)if(t.write(c)===!1&&await u(),r)break;if(o(),r)throw r}function $_(t,e){return e===void 0?r=>Hm(t,r):Hm(t,e)}var G_=Object.freeze({__proto__:null,batch:Lm,buffer:xo,collect:k_,concat:__,consume:N_,filter:So,flatMap:Fm,flatTransform:Io,flatten:ds,fromStream:B_,getIterator:Si,map:Ao,merge:M_,parallelFlatMap:To,parallelMap:ko,parallelMerge:U_,pipeline:jm,reduce:Dd,take:Vm,tap:j_,time:Gm,transform:Co,writeToStream:$_}),H_=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),n=Object.create(null);function i(a,s){r[a]=s,e++,e>=t&&(e=0,n=r,r=Object.create(null))}return{has:function(a){return r[a]!==void 0||n[a]!==void 0},remove:function(a){r[a]!==void 0&&(r[a]=void 0),n[a]!==void 0&&(n[a]=void 0)},get:function(a){var s=r[a];if(s!==void 0)return s;if((s=n[a])!==void 0)return i(a,s),s},set:function(a,s){r[a]!==void 0?r[a]=s:i(a,s)},clear:function(){r=Object.create(null),n=Object.create(null)}}},W_=t=>{const e=H_(t);return e.delete=e.remove,e},Wm=Z(function(t,e){const r=Math.exp;e=t.exports=function(i){if(typeof i!="number")throw new Error("must provide a timespan to the moving average constructor");if(i<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let a,s=0,o=0,u=0,c,d={};function h(y,p){return 1-r(-(y-p)/i)}return d.push=function(p,m){if(c){const _=h(p,c),I=m-a,f=_*I;a=_*m+(1-_)*a,s=(1-_)*(s+I*f),o=Math.sqrt(s),u=a+_*I}else a=m;c=p},d.movingAverage=function(){return a},d.variance=function(){return s},d.deviation=function(){return o},d.forecast=function(){return u},d}}),ha=al(Bb);class Y_ extends Rr{constructor(t,e){super();this._options=e,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);const r=this._options.movingAverageIntervals;for(var n=0;n<t.length;n++){var i=t[n];this._stats[i]=ha(0),this._movingAverages[i]={};for(var a=0;a<r.length;a++){var s=r[a],o=this._movingAverages[i][s]=Wm(s);o.push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){const t=this.snapshot,e=this.movingAverages,r={dataReceived:t.dataReceived.toString(),dataSent:t.dataSent.toString(),movingAverages:{}},n=Object.keys(e);for(const i of n){r.movingAverages[i]={};for(const a of Object.keys(e[i]))r.movingAverages[i][a]=e[i][a].movingAverage()}return r}push(t,e){this._queue.push([t,e,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=bi(this._update,this._nextTimeout())}_nextTimeout(){const t=this._queue.length/this._options.computeThrottleMaxQueueSize,e=Math.max(this._options.computeThrottleTimeout*(1-t),0);return e}_update(){if(this._timeout=null,this._queue.length){let t;for(t of this._queue)this._applyOp(t);this._queue=[],this._updateFrequency(t[2]),this.emit("update",this._stats)}}_updateFrequency(t){const e=t-this._frequencyLastTime;Object.keys(this._stats).forEach(r=>{this._updateFrequencyFor(r,e,t)}),this._frequencyLastTime=t}_updateFrequencyFor(t,e,r){const n=this._frequencyAccumulators[t]||0;this._frequencyAccumulators[t]=0;const i=e||1,a=n/i*1e3;let s=this._movingAverages[t];s||(s=this._movingAverages[t]={});const o=this._options.movingAverageIntervals;for(var u=0;u<o.length;u++){var c=o[u],d=s[c];d||(d=s[c]=Wm(c)),d.push(r,a)}}_applyOp(t){const e=t[0],r=t[1];if(typeof r!="number")throw new Error("invalid increment number:",r);let n;Object.prototype.hasOwnProperty.call(this._stats,e)?n=this._stats[e]:n=this._stats[e]=ha(0),this._stats[e]=n.plus(r),this._frequencyAccumulators[e]||(this._frequencyAccumulators[e]=0),this._frequencyAccumulators[e]+=r}}var Od=Y_,Bd=al(G_);const{tap:Ym}=Bd,{METRICS:X_}=as,Md=["dataReceived","dataSent"],Q_={in:"dataReceived",out:"dataSent"};class Xm{constructor(t){this._options=rs(X_,t),this._globalStats=new Od(Md,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=W_(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=t.connectionManager,this._connectionManager.on("peer:disconnect",e=>{this.onPeerDisconnected(e.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(const t of this._peerStats.values())t.stop();for(const t of this._protocolStats.values())t.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(t){const e=t.toB58String();return this._peerStats.get(e)||this._oldPeers.get(e)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(t){return this._protocolStats.get(t)}onPeerDisconnected(t){const e=t.toB58String(),r=this._peerStats.get(e);r&&(r.stop(),this._peerStats.delete(e),this._oldPeers.set(e,r))}_onMessage({remotePeer:t,protocol:e,direction:r,dataLength:n}){if(!this._running)return;const i=Q_[r];let a=this.forPeer(t);if(a||(a=new Od(Md,this._options),this._peerStats.set(t.toB58String(),a)),a.push(i,n),this._globalStats.push(i,n),e){let s=this.forProtocol(e);s||(s=new Od(Md,this._options),this._protocolStats.set(e,s)),s.push(i,n)}}updatePlaceholder(t,e){if(!this._running)return;const r=this.forPeer(t),n=e.toB58String(),i=this.forPeer(e);let a=r;i&&(a=Xm.mergeStats(i,a),this._oldPeers.delete(n)),this._peerStats.delete(t.toB58String()),this._peerStats.set(n,a),a.start()}trackStream({stream:t,remotePeer:e,protocol:r}){const n=this,i=t.source;t.source=Ym(s=>n._onMessage({remotePeer:e,protocol:r,direction:"in",dataLength:s.length}))(i);const a=t.sink;return t.sink=s=>Vt(s,Ym(o=>n._onMessage({remotePeer:e,protocol:r,direction:"out",dataLength:o.length})),a),t}static mergeStats(t,e){return t.stop(),e.stop(),t._queue=[...t._queue,...e._queue],t}}var J_=Xm,Wt=Z(function(t,e){const r=le(`
`);async function n(i){for await(const a of i)return a}e.encode=i=>Jr.encode.single(new qt([i,r])),e.write=(i,a)=>i.push(e.encode(a)),e.writeAll=(i,a)=>{i.push(a.reduce((s,o)=>s.append(e.encode(o)),new qt))},e.read=async i=>{let a=1;const s={[Symbol.asyncIterator](){return this},next:()=>i.next(a)},o=c=>{a=c},u=await Vt(s,Jr.decode({onLength:o}),n);if(u.get(u.length-1)!==r[0])throw K(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return u.shallowSlice(0,-1)}});const pa=J("mss:select");var Qm=async(t,e,r)=>{e=Array.isArray(e)?[...e]:[e];const{reader:n,writer:i,rest:a,stream:s}=vo(t),o=e.shift();r?(pa('select: write ["%s", "%s"]',r,o),Wt.writeAll(i,[r,o])):(pa('select: write "%s"',o),Wt.write(i,o));let u=(await Wt.read(n)).toString();if(pa('select: read "%s"',u),u===r&&(u=(await Wt.read(n)).toString(),pa('select: read "%s"',u)),u===o)return a(),{stream:s,protocol:o};for(const c of e){pa('select: write "%s"',c),Wt.write(i,c);const d=(await Wt.read(n)).toString();if(pa('select: read "%s" for "%s"',d,c),d===c)return a(),{stream:s,protocol:c}}throw a(),K(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")},Z_="/multistream/1.0.0",Jm={PROTOCOL_ID:Z_};const ls=J("mss:handle"),{PROTOCOL_ID:Ld}=Jm;var eR=async(t,e)=>{e=Array.isArray(e)?e:[e];const{writer:r,reader:n,rest:i,stream:a}=vo(t);for(;;){const s=(await Wt.read(n)).toString();if(ls('read "%s"',s),s===Ld){ls('respond with "%s" for "%s"',Ld,s),Wt.write(r,Ld);continue}if(e.includes(s))return Wt.write(r,s),ls('respond with "%s" for "%s"',s,s),i(),{stream:a,protocol:s};if(s==="ls"){Wt.write(r,new qt(e.map(o=>Wt.encode(o)))),ls('respond with "%s" for %s',e,s);continue}Wt.write(r,"na"),ls('respond with "na" for "%s"',s)}};const tR=J("it-multistream-select:ls");var rR=async t=>{const{reader:e,writer:r,rest:n,stream:i}=vo(t);tR('write "ls"'),Wt.write(r,"ls"),n();const a=await Wt.read(e),s=Em([a]),o=[];return await Vt(s,Jr.decode(),async u=>{for await(const c of u)o.push(c.shallowSlice(0,-1).toString())}),{stream:i,protocols:o}};const{PROTOCOL_ID:Ud}=Jm;var nR=Ud;class Zm{constructor(t){this._stream=t,this._shaken=!1}async _handshake(){if(this._shaken)return;const{stream:t}=await Qm(this._stream,Ud);this._stream=t,this._shaken=!0}}class iR extends Zm{select(t){return Qm(this._stream,t,this._shaken?null:Ud)}async ls(){await this._handshake();const{stream:t,protocols:e}=await rR(this._stream);return this._stream=t,e}}var aR=iR;class sR extends Zm{handle(t){return eR(this._stream,t)}}var oR=sR,ma={PROTOCOL_ID:nR,Dialer:aR,Listener:oR},Ai={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};function cR(t,e,r,n,i,a,s){if(t&&!De.isMultiaddr(t))throw K(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!be.isPeerId(e))throw K(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!be.isPeerId(r))throw K(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw K(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw K(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof a!="function")throw K(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!s)throw K(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(s.direction!=="inbound"&&s.direction!=="outbound")throw K(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!s.timeline)throw K(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!s.timeline.open)throw K(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!s.timeline.upgraded)throw K(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}class uR{constructor({localAddr:t,remoteAddr:e,localPeer:r,remotePeer:n,newStream:i,close:a,getStreams:s,stat:o}){cR(t,r,n,i,a,s,o),this.id=parseInt(Math.random()*1e9).toString(36)+Date.now(),this.localAddr=t,this.remoteAddr=e,this.localPeer=r,this.remotePeer=n,this._stat={...o,status:Ai.OPEN},this._newStream=i,this._close=a,this._getStreams=s,this.registry=new Map,this.tags=[]}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(t){if(this.stat.status===Ai.CLOSING)throw K(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===Ai.CLOSED)throw K(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(t)||(t=[t]);const{stream:e,protocol:r}=await this._newStream(t);return this.addStream(e,{protocol:r}),{stream:e,protocol:r}}addStream(t,{protocol:e,metadata:r={}}){this.registry.set(t.id,{protocol:e,...r})}removeStream(t){this.registry.delete(t)}async close(){if(this.stat.status===Ai.CLOSED)return;if(this._closing)return this._closing;this.stat.status=Ai.CLOSING,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=Ai.CLOSED}}var dR=vn(uR,{className:"Connection",symbolName:"@libp2p/interface-connection/connection"}),lR=dR,fR={Connection:lR};function hR(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}var eb=function(e){var r=void 0,n=void 0;function i(o){if(!(o instanceof Object))throw new Error('Target "'+o+'" is not an object');n=o}function a(o){Object.keys(o).forEach(function(u){var c=o[u];if(typeof c!="function")throw new Error('Trap "'+u+": "+c+'" is not a function');if(!Reflect[u])throw new Error('Trap "'+u+": "+c+'" is not a valid trap')}),r=o}i(function(){}),e&&i(e),a(Reflect);var s=new Proxy({},{get:function(u,c){return function(){for(var d=arguments.length,h=Array(d),y=0;y<d;y++)h[y]=arguments[y];return r[c].apply(null,[n].concat(hR(h.slice(1))))}}});return{setTarget:i,setHandler:a,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,s)}};const ze=J("libp2p:upgrader");ze.error=J("libp2p:upgrader:error");const{Connection:pR}=fR,{codes:fs}=Ot;class mR{constructor({localPeer:t,metrics:e,cryptos:r,muxers:n,onConnectionEnd:i=()=>{},onConnection:a=()=>{}}){this.localPeer=t,this.metrics=e,this.cryptos=r||new Map,this.muxers=n||new Map,this.protector=null,this.protocols=new Map,this.onConnection=a,this.onConnectionEnd=i}async upgradeInbound(t){let e,r,n,i,a,s,o;if(this.metrics){({setTarget:s,proxy:o}=eb());const c=parseInt(Math.random()*1e9).toString(36)+Date.now();s({toB58String:()=>c}),t=this.metrics.trackStream({stream:t,remotePeer:o})}ze("Starting the inbound connection upgrade");let u=t;this.protector&&(u=await this.protector.protect(t));try{({conn:e,remotePeer:r,protocol:a}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?{stream:n,Muxer:i}=await this._multiplexInbound(e,this.muxers):n=e}catch(c){throw ze.error("Failed to upgrade inbound connection",c),await t.close(c),c}return this.metrics&&(this.metrics.updatePlaceholder(o,r),s(r)),ze("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:a,direction:"inbound",maConn:t,upgradedConn:n,Muxer:i,remotePeer:r})}async upgradeOutbound(t){let e;try{e=be.createFromB58String(t.remoteAddr.getPeerId())}catch(d){ze.error("multiaddr did not contain a valid peer id",d)}let r,n,i,a,s,o,u;if(this.metrics){({setTarget:o,proxy:u}=eb());const d=parseInt(Math.random()*1e9).toString(36)+Date.now();o({toB58String:()=>d}),t=this.metrics.trackStream({stream:t,remotePeer:u})}ze("Starting the outbound connection upgrade");let c=t;this.protector&&(c=await this.protector.protect(t));try{({conn:r,remotePeer:n,protocol:a}=await this._encryptOutbound(this.localPeer,c,e,this.cryptos)),this.muxers.size?{stream:i,Muxer:s}=await this._multiplexOutbound(r,this.muxers):i=r}catch(d){throw ze.error("Failed to upgrade outbound connection",d),await t.close(d),d}return this.metrics&&(this.metrics.updatePlaceholder(u,n),o(n)),ze("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:t,upgradedConn:i,Muxer:s,remotePeer:n})}_createConnection({cryptoProtocol:t,direction:e,maConn:r,upgradedConn:n,Muxer:i,remotePeer:a}){let s,o,u;i&&(s=new i({onStream:async h=>{const y=new ma.Listener(h);try{const{stream:p,protocol:m}=await y.handle(Array.from(this.protocols.keys()));ze("%s: incoming stream opened on %s",e,m),this.metrics&&this.metrics.trackStream({stream:p,remotePeer:a,protocol:m}),u.addStream(h,{protocol:m}),this._onStream({connection:u,stream:{...h,...p},protocol:m})}catch(p){ze.error(p)}},onStreamEnd:h=>{u.removeStream(h.id)}}),o=async h=>{ze("%s: starting new stream on %s",e,h);const y=s.newStream(),p=new ma.Dialer(y);try{const{stream:m,protocol:_}=await p.select(h);return this.metrics&&this.metrics.trackStream({stream:m,remotePeer:a,protocol:_}),{stream:{...y,...m},protocol:_}}catch(m){throw ze.error("could not create new stream",m),K(m,fs.ERR_UNSUPPORTED_PROTOCOL)}},Vt(n,s,n).catch(ze.error));const c=r.timeline;r.timeline=new Proxy(c,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!c.close&&(async()=>{try{u.stat.status===Ai.OPEN&&await u.close()}catch(y){ze.error(y)}finally{this.onConnectionEnd(u)}})(),Reflect.set(...h))}),r.timeline.upgraded=Date.now();const d=()=>{throw K(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return u=new pR({localAddr:r.localAddr,remoteAddr:r.remoteAddr,localPeer:this.localPeer,remotePeer:a,stat:{direction:e,timeline:r.timeline,multiplexer:i&&i.multicodec,encryption:t},newStream:o||d,getStreams:()=>s?s.streams:d,close:async h=>{await r.close(h),s&&s.streams.map(y=>y.abort(h))}}),this.onConnection(u),u}_onStream({connection:t,stream:e,protocol:r}){const n=this.protocols.get(r);n({connection:t,stream:e,protocol:r})}async _encryptInbound(t,e,r){const n=new ma.Listener(e),i=Array.from(r.keys());ze("handling inbound crypto protocol selection",i);try{const{stream:a,protocol:s}=await n.handle(i),o=r.get(s);return ze("encrypting inbound connection..."),{...await o.secureInbound(t,a),protocol:s}}catch(a){throw K(a,fs.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(t,e,r,n){const i=new ma.Dialer(e),a=Array.from(n.keys());ze("selecting outbound crypto protocol",a);try{const{stream:s,protocol:o}=await i.select(a),u=n.get(o);return ze("encrypting outbound connection to %j",r),{...await u.secureOutbound(t,s,r),protocol:o}}catch(s){throw K(s,fs.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(t,e){const r=new ma.Dialer(t),n=Array.from(e.keys());ze("outbound selecting muxer %s",n);try{const{stream:i,protocol:a}=await r.select(n);ze("%s selected as muxer protocol",a);const s=e.get(a);return{stream:i,Muxer:s}}catch(i){throw K(i,fs.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(t,e){const r=new ma.Listener(t),n=Array.from(e.keys());ze("inbound handling muxers %s",n);try{const{stream:i,protocol:a}=await r.handle(n),s=e.get(a);return{stream:i,Muxer:s}}catch(i){throw K(i,fs.ERR_MUXER_UNAVAILABLE)}}}var bR=mR;const{codes:{ERR_INVALID_PARAMETERS:tb}}=Ot,yR=t=>t;class gR{constructor({peerStore:t,eventName:e,eventProperty:r,eventTransformer:n=yR}){this._ps=t,this.eventName=e,this.eventProperty=r,this.eventTransformer=n,this.data=new Map}set(t,e){throw K(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(t,e,{emit:r=!0}={}){const n=t.toB58String();this.data.set(n,e),r&&this._emit(t,e)}_emit(t,e){this._ps.emit(this.eventName,{peerId:t,[this.eventProperty]:this.eventTransformer(e)})}get(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),tb);const e=this.data.get(t.toB58String());return e?[...e]:void 0}delete(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),tb);return this.data.delete(t.toB58String())?(this._emit(t,[]),!0):!1}}var _o=gR;class vR{constructor(t,e){this.domain=t,this.codec=e}marshal(){throw K(new Error("marshal must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}equals(t){throw K(new Error("equals must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}}var wR=vR;function ER(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,n)=>e[n].equals(r))}var xR=ER;const SR=`
message PeerRecord {
    // AddressInfo is a wrapper around a binary multiaddr. It is defined as a
    // separate message to allow us to add per-address metadata in the future.
    message AddressInfo {
        bytes multiaddr = 1;
    }

    // peer_id contains a libp2p peer id in its binary representation.
    bytes peer_id = 1;

    // seq contains a monotonically-increasing sequence counter to order PeerRecords in time.
    uint64 seq = 2;

    // addresses is a list of public listen addresses for the peer.
    repeated AddressInfo addresses = 3;
}
`;var rb=Ur(SR).PeerRecord,AR=Pn.getName(Pn.LIBP2P_PEER_RECORD),IR=Uint8Array.from([3,1]),kR={ENVELOPE_DOMAIN_PEER_RECORD:AR,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:IR};const{ENVELOPE_DOMAIN_PEER_RECORD:nb,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:TR}=kR;class Ro extends wR{constructor({peerId:t,multiaddrs:e=[],seqNumber:r=Date.now()}){super(nb,TR);this.peerId=t,this.multiaddrs=e,this.seqNumber=r,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=rb.encode({peer_id:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))}),this._marshal)}equals(t){return this.peerId.equals(t.peerId)?this.seqNumber!==t.seqNumber?!1:!!xR(this.multiaddrs,t.multiaddrs):!1}}Ro.createFromProtobuf=t=>{const e=rb.decode(t),r=be.createFromBytes(e.peer_id),n=(e.addresses||[]).map(a=>De(a.multiaddr)),i=e.seq;return new Ro({peerId:r,multiaddrs:n,seqNumber:i})},Ro.DOMAIN=nb;var No=Ro;const CR=`
message Envelope {
  // public_key is the public key of the keypair the enclosed payload was
  // signed with.
  bytes public_key = 1;

  // payload_type encodes the type of payload, so that it can be deserialized
  // deterministically.
  bytes payload_type = 2;

  // payload is the actual payload carried inside this envelope.
  bytes payload = 3;

  // signature is the signature produced by the private key corresponding to
  // the enclosed public key, over the payload, prefixing a domain string for
  // additional security.
  bytes signature = 5;
}
`;var ib=Ur(CR).Envelope;const _R=J("libp2p:envelope");_R.error=J("libp2p:envelope:error");const{codes:RR}=Ot;class Ii{constructor({peerId:t,payloadType:e,payload:r,signature:n}){this.peerId=t,this.payloadType=e,this.payload=r,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;const t=ur.marshalPublicKey(this.peerId.pubKey);return this._marshal=ib.encode({public_key:t,payload_type:this.payloadType,payload:this.payload,signature:this.signature}),this._marshal}equals(t){return Ve(this.peerId.pubKey.bytes,t.peerId.pubKey.bytes)&&Ve(this.payloadType,t.payloadType)&&Ve(this.payload,t.payload)&&Ve(this.signature,t.signature)}validate(t){const e=ab(t,this.payloadType,this.payload);return this.peerId.pubKey.verify(e,this.signature)}}const ab=(t,e,r)=>{t=le(t);const n=W.encode(t.byteLength),i=W.encode(e.length),a=W.encode(r.length);return Bt([new Uint8Array(n),t,new Uint8Array(i),e,new Uint8Array(a),r])};Ii.createFromProtobuf=async t=>{const e=ib.decode(t),r=await be.createFromPubKey(e.public_key);return new Ii({peerId:r,payloadType:e.payload_type,payload:e.payload,signature:e.signature})},Ii.seal=async(t,e)=>{const r=t.domain,n=t.codec,i=t.marshal(),a=ab(r,n,i),s=await e.privKey.sign(a);return new Ii({peerId:e,payloadType:n,payload:i,signature:s})},Ii.openAndCertify=async(t,e)=>{const r=await Ii.createFromProtobuf(t),n=await r.validate(e);if(!n)throw K(new Error("envelope signature is not valid for the given domain"),RR.ERR_SIGNATURE_NOT_VALID);return r};var Po=Ii;const fr=J("libp2p:peer-store:address-book");fr.error=J("libp2p:peer-store:address-book:error");const{codes:{ERR_INVALID_PARAMETERS:ba}}=Ot;class NR extends _o{constructor(t){super({peerStore:t,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:e=>e.addresses?e.addresses.map(r=>r.multiaddr):[]});this.data=new Map}consumePeerRecord(t){let e;try{e=No.createFromProtobuf(t.payload)}catch(o){return fr.error("invalid peer record received"),!1}if(!e.peerId.equals(t.peerId))return fr("signing key does not match PeerId in the PeerRecord"),!1;if(!e.multiaddrs||!e.multiaddrs.length)return!1;const r=e.peerId,n=r.toB58String(),i=this.data.get(n)||{},a=i.record;if(a&&a.seqNumber>=e.seqNumber)return!1;const s=this._toAddresses(e.multiaddrs,!0);return this._setData(r,{addresses:s,record:{raw:t.marshal(),seqNumber:e.seqNumber}}),fr(`stored provided peer record for ${n}`),!0}getRawEnvelope(t){const e=this.data.get(t.toB58String());return!e||!e.record||!e.record.raw?void 0:e.record.raw}getPeerRecord(t){const e=this.getRawEnvelope(t);return e?Po.createFromProtobuf(e):void 0}set(t,e){if(!be.isPeerId(t))throw fr.error("peerId must be an instance of peer-id to store data"),K(new Error("peerId must be an instance of peer-id"),ba);const r=this._toAddresses(e),n=t.toB58String(),i=this.data.get(n)||{},a=i.addresses;if(!r.length)return this;if(a&&a.length===r.length){const s=a.filter(o=>r.some(u=>o.multiaddr.equals(u.multiaddr)));if(s.length===a.length)return fr(`the addresses provided to store are equal to the already stored for ${n}`),this}return this._setData(t,{addresses:r,record:i.record}),fr(`stored provided multiaddrs for ${n}`),a||this._ps.emit("peer",t),this}add(t,e){if(!be.isPeerId(t))throw fr.error("peerId must be an instance of peer-id to store data"),K(new Error("peerId must be an instance of peer-id"),ba);const r=this._toAddresses(e),n=t.toB58String(),i=this.data.get(n)||{},a=i.addresses||[];return a.forEach(s=>{r.find(o=>o.multiaddr.equals(s.multiaddr))||r.push(s)}),a&&a.length===r.length?(fr(`the addresses provided to store are already stored for ${n}`),this):(this._setData(t,{addresses:r,record:i.record}),fr(`added provided multiaddrs for ${n}`),i.addresses||this._ps.emit("peer",t),this)}get(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),ba);const e=this.data.get(t.toB58String());return e&&e.addresses?[...e.addresses]:void 0}_toAddresses(t,e=!1){if(!t)throw fr.error("multiaddrs must be provided to store data"),K(new Error("multiaddrs must be provided"),ba);const r=[];return t.forEach(n=>{if(!De.isMultiaddr(n))throw fr.error(`multiaddr ${n} must be an instance of multiaddr`),K(new Error(`multiaddr ${n} must be an instance of multiaddr`),ba);r.push({multiaddr:n,isCertified:e})}),r}getMultiaddrsForPeer(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),ba);const e=this.data.get(t.toB58String());return!e||!e.addresses?void 0:e.addresses.map(r=>{const n=r.multiaddr,i=n.getPeerId();return i&&i===t.toB58String()?n:n.encapsulate(`/p2p/${t.toB58String()}`)})}}var PR=NR;const Kd=J("libp2p:peer-store:key-book");Kd.error=J("libp2p:peer-store:key-book:error");const{codes:{ERR_INVALID_PARAMETERS:sb}}=Ot;class DR extends _o{constructor(t){super({peerStore:t,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:e=>e.pubKey});this.data=new Map}set(t,e){if(!be.isPeerId(t))throw Kd.error("peerId must be an instance of peer-id to store data"),K(new Error("peerId must be an instance of peer-id"),sb);const r=t.toB58String(),n=this.data.get(r);return!n&&e&&(t.pubKey=e,this._setData(t,t),Kd(`stored provided public key for ${r}`)),this}get(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),sb);const e=this.data.get(t.toB58String());return e?e.pubKey:void 0}}var OR=DR;const Do=J("libp2p:peer-store:proto-book");Do.error=J("libp2p:peer-store:proto-book:error");const{codes:{ERR_INVALID_PARAMETERS:ya}}=Ot;class BR extends _o{constructor(t){super({peerStore:t,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(t,e,r){if(!be.isPeerId(t))throw Do.error("peerId must be an instance of peer-id to store data"),K(new Error("peerId must be an instance of peer-id"),ya);if(typeof e!="string"||!(r instanceof Uint8Array))throw Do.error("valid key and value must be provided to store data"),K(new Error("valid key and value must be provided"),ya);return this._setValue(t,e,r),this}_setValue(t,e,r,{emit:n=!0}={}){const i=t.toB58String(),a=this.data.get(i)||new Map,s=a.get(e);if(s&&Ve(r,s)){Do(`the metadata provided to store is equal to the already stored for ${i} on ${e}`);return}a.set(e,r),this.data.set(i,a),n&&this._emit(t,e)}get(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),ya);return this.data.get(t.toB58String())}getValue(t,e){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),ya);const r=this.data.get(t.toB58String());return r&&r.get(e)}delete(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),ya);return this.data.delete(t.toB58String())?(this._emit(t),!0):!1}deleteValue(t,e){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),ya);const r=this.data.get(t.toB58String());return!r||!r.delete(e)?!1:(this._emit(t,e),!0)}}var MR=BR;const mn=J("libp2p:peer-store:proto-book");mn.error=J("libp2p:peer-store:proto-book:error");const{codes:{ERR_INVALID_PARAMETERS:Oo}}=Ot;class LR extends _o{constructor(t){super({peerStore:t,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:e=>Array.from(e)});this.data=new Map}set(t,e){if(!be.isPeerId(t))throw mn.error("peerId must be an instance of peer-id to store data"),K(new Error("peerId must be an instance of peer-id"),Oo);if(!e)throw mn.error("protocols must be provided to store data"),K(new Error("protocols must be provided"),Oo);const r=t.toB58String(),n=this.data.get(r),i=new Set(e),a=(s,o)=>s.size===o.size&&[...s].every(u=>o.has(u));return n&&a(n,i)?(mn(`the protocols provided to store are equal to the already stored for ${r}`),this):(this._setData(t,i),mn(`stored provided protocols for ${r}`),this)}add(t,e){if(!be.isPeerId(t))throw mn.error("peerId must be an instance of peer-id to store data"),K(new Error("peerId must be an instance of peer-id"),Oo);if(!e)throw mn.error("protocols must be provided to store data"),K(new Error("protocols must be provided"),Oo);const r=t.toB58String(),n=this.data.get(r)||new Set,i=new Set([...n,...e]);return n.size===i.size?(mn(`the protocols provided to store are already stored for ${r}`),this):(e=[...i],this._setData(t,i),mn(`added provided protocols for ${r}`),this)}}var UR=LR;const KR=J("libp2p:peer-store");KR.error=J("libp2p:peer-store:error");const{EventEmitter:FR}=Rr,{ERR_INVALID_PARAMETERS:jR}=Ot;class qR extends FR{constructor({peerId:t}){super();this._peerId=t,this.addressBook=new PR(this),this.keyBook=new OR(this),this.metadataBook=new MR(this),this.protoBook=new UR(this)}start(){}stop(){}get peers(){const t=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&t.delete(this._peerId.toB58String());const e=new Map;return t.forEach(r=>{e.set(r,this.get(be.createFromCID(r)))}),e}delete(t){const e=this.addressBook.delete(t),r=this.keyBook.delete(t),n=this.protoBook.delete(t),i=this.metadataBook.delete(t);return e||r||n||i}get(t){if(!be.isPeerId(t))throw K(new Error("peerId must be an instance of peer-id"),jR);const e=this.keyBook.data.get(t.toB58String()),r=this.addressBook.get(t),n=this.metadataBook.get(t),i=this.protoBook.get(t);return!e&&!r&&!n&&!i?void 0:{id:e||t,addresses:r||[],protocols:i||[],metadata:n}}}var ob=qR,VR=(t,e,r)=>{class n extends t{subscribe(i,a){a&&this.on(i,a),super.subscribe(i)}unsubscribe(i,a){a?this.removeListener(i,a):this.removeAllListeners(i),this.listenerCount(i)===0&&super.unsubscribe(i)}}return new n(e,r)},zR="/peers/",$R="/peers/addrs/",GR="/peers/keys/",HR="/peers/metadata/",WR="/peers/protos/",YR={NAMESPACE_COMMON:zR,NAMESPACE_ADDRESS:$R,NAMESPACE_KEYS:GR,NAMESPACE_METADATA:HR,NAMESPACE_PROTOCOL:WR};const XR=`
message Addresses {
  // Address represents a single multiaddr.
  message Address {
    required bytes multiaddr = 1;

    // Flag to indicate if the address comes from a certified source.
    optional bool isCertified = 2;
  }

  // CertifiedRecord contains a serialized signed PeerRecord used to
  // populate the signedAddrs list.
  message CertifiedRecord {
    // The Seq counter from the signed PeerRecord envelope
    uint64 seq = 1;

    // The serialized bytes of the SignedEnvelope containing the PeerRecord.
    bytes raw = 2;
  }

  // The known multiaddrs.
  repeated Address addrs = 1;

  // The most recently received signed PeerRecord.
  CertifiedRecord certified_record = 2;
}
`;var cb=Ur(XR).Addresses;const QR=`
message Protocols {
  repeated string protocols = 1;
}
`;var ub=Ur(QR).Protocols;const St=J("libp2p:persistent-peer-store");St.error=J("libp2p:persistent-peer-store:error");const{Key:Bo}=En,{NAMESPACE_ADDRESS:JR,NAMESPACE_COMMON:ZR,NAMESPACE_KEYS:eN,NAMESPACE_METADATA:tN,NAMESPACE_PROTOCOL:rN}=YR;class nN extends ob{constructor({peerId:t,datastore:e,threshold:r=5}){super({peerId:t});this._datastore=e,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=r,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){St("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(const t of this._datastore.query({prefix:ZR}))await this._processDatastoreEntry(t);St("PeerStore started")}async stop(){St("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),St("PeerStore stopped")}_addDirtyPeer({peerId:t}){const e=t.toB58String();St("add dirty peer",e),this._dirtyPeers.add(e),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(r=>{St.error("error committing data",r)})}_addDirtyPeerKey({peerId:t}){if(t.hasInlinePublicKey())return;const e=t.toB58String();St("add dirty peer key",e),this._dirtyPeers.add(e),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(r=>{St.error("error committing data",r)})}_addDirtyPeerMetadata({peerId:t,metadata:e}){const r=t.toB58String();St("add dirty metadata peer",r),this._dirtyPeers.add(r);const n=this._dirtyMetadata.get(r)||new Set;n.add(e),this._dirtyMetadata.set(r,n),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{St.error("error committing data",i)})}async _commitData(){const t=Array.from(this._dirtyPeers);if(!t.length)return;this._dirtyPeers.clear(),St("create batch commit");const e=this._datastore.batch();for(const r of t){const n=this.keyBook.data.get(r)||be.createFromCID(r);this._batchAddressBook(n,e),!n.hasInlinePublicKey()&&this._batchKeyBook(n,e),this._batchMetadataBook(n,e),this._batchProtoBook(n,e)}await e.commit(),St("batch committed")}_batchAddressBook(t,e){const r=t.toString(),n=new Bo(`${JR}${r}`),i=this.addressBook.data.get(t.toB58String());try{if(!i){e.delete(n);return}const a=cb.encode({addrs:i.addresses.map(s=>({multiaddr:s.multiaddr.bytes,isCertified:s.isCertified})),certified_record:i.record?{seq:i.record.seqNumber,raw:i.record.raw}:void 0});e.put(n,a)}catch(a){St.error(a)}}_batchKeyBook(t,e){const r=t.toString(),n=new Bo(`${eN}${r}`);try{if(!t.pubKey){e.delete(n);return}const i=t.marshalPubKey();e.put(n,i)}catch(i){St.error(i)}}_batchMetadataBook(t,e){const r=t.toString(),n=this._dirtyMetadata.get(t.toB58String())||[];try{n.forEach(i=>{const a=new Bo(`${tN}${r}/${i}`),s=this.metadataBook.getValue(t,i);s?e.put(a,s):e.delete(a)})}catch(i){St.error(i)}}_batchProtoBook(t,e){const r=t.toString(),n=new Bo(`${rN}${r}`),i=this.protoBook.get(t);try{if(!i){e.delete(n);return}const a=ub.encode({protocols:i});e.put(n,a)}catch(a){St.error(a)}}async _processDatastoreEntry({key:t,value:e}){try{const r=t.toString().split("/"),n=be.createFromCID(r[3]);let i;switch(r[2]){case"addrs":i=cb.decode(e),this.addressBook._setData(n,{addresses:i.addrs.map(a=>({multiaddr:De(a.multiaddr),isCertified:Boolean(a.isCertified)})),record:i.certified_record?{raw:i.certified_record.raw,seqNumber:i.certified_record.seq}:void 0},{emit:!1});break;case"keys":i=await be.createFromPubKey(e),this.keyBook._setData(i,i,{emit:!1});break;case"metadata":this.metadataBook._setValue(n,r[4],e,{emit:!1});break;case"protos":i=ub.decode(e),this.protoBook._setData(n,new Set(i.protocols),{emit:!1});break;default:St("invalid data persisted for: ",t.toString())}}catch(r){St.error(r)}}}var iN=nN;const db=()=>{};class aN{constructor({min:t=0,max:e=Infinity,handlers:r={}}){this.min=t,this.max=e,this._onConnect=r.onConnect||db,this._onDisconnect=r.onDisconnect||db,this.peers=new Set}set registrar(t){this._registrar=t}disconnect(t){this._onDisconnect(t)}}var sN=vn(aN,{className:"Topology",symbolName:"@libp2p/js-interfaces/topology"});const oN=J("libp2p:peer-store");oN.error=J("libp2p:peer-store:error");const{ERR_INVALID_PARAMETERS:cN}=Ot;class uN{constructor({peerStore:t,connectionManager:e}){this.peerStore=t,this.connectionManager=e,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(t){this._handle=t}getConnection(t){return this.connectionManager.get(t)}register(t){if(!sN.isTopology(t))throw K(new Error("topology must be an instance of interfaces/topology"),cN);const e=parseInt(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(e,t),t.registrar=this,e}unregister(t){return this.topologies.delete(t)}_onDisconnect(t,e){for(const[,r]of this.topologies)r.disconnect(t.remotePeer,e)}}var dN=uN,Fd=Z(function(t){const{Buffer:e}=At;t.exports=async function*(r){for await(const n of r)e.isBuffer(n)?yield n:qt.isBufferList(n)?yield n.slice():yield e.from(n)},t.exports.toBuffer=t.exports,t.exports.toList=async function*(r){for await(const n of r)e.isBuffer(n)?yield new qt().append(n):qt.isBufferList(n)?yield n:yield new qt().append(e.from(n))}}),lN={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32},Mo=Z(function(t,e){const r=J("libp2p-ping");r.error=J("libp2p-ping:error");const{toBuffer:n}=Fd,{collect:i,take:a}=Bd,{PROTOCOL:s,PING_LENGTH:o}=lN;async function u(h,y){r("dialing %s to %s",s,y.toB58String?y.toB58String():y);const{stream:p}=await h.dialProtocol(y,s),m=new Date,_=fa.randomBytes(o),[I]=await Vt([_],p,k=>a(1,k),n,i),f=Date.now();if(!_.equals(I))throw K(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return f-m}function c(h){h.handle(s,({stream:y})=>Vt(y,y))}function d(h){h.unhandle(s)}e=t.exports=u,e.mount=c,e.unmount=d}),fN=t=>e=>async function*(){for await(const r of e)yield t.encode(r)}(),hN=t=>e=>async function*(){for await(const r of e)yield t.decode(r)}(),jd={encode:fN,decode:hN},pN=t=>e=>Jr.encode()(jd.encode(t)(e)),mN=t=>e=>jd.decode(t)(Fd(Jr.decode()(e))),bN=jd,yN={encode:pN,decode:mN,it:bN};const gN=`
message Identify {
  // protocolVersion determines compatibility between peers
  optional string protocolVersion = 5; // e.g. ipfs/1.0.0

  // agentVersion is like a UserAgent string in browsers, or client version in bittorrent
  // includes the client name and client.
  optional string agentVersion = 6; // e.g. go-ipfs/0.1.0

  // publicKey is this node's public key (which also gives its node.ID)
  // - may not need to be sent, as secure channel implies it has been sent.
  // - then again, if we change / disable secure channel, may still want it.
  optional bytes publicKey = 1;

  // listenAddrs are the multiaddrs the sender node listens for open connections on
  repeated bytes listenAddrs = 2;

  // oservedAddr is the multiaddr of the remote endpoint that the sender node perceives
  // this is useful information to convey to the other side, as it helps the remote endpoint
  // determine whether its connection to the local peer goes through NAT.
  optional bytes observedAddr = 4;

  repeated string protocols = 3;

  // signedPeerRecord contains a serialized SignedEnvelope containing a PeerRecord,
  // signed by the sending node. It contains the same addresses as the listenAddrs field, but
  // in a form that lets us share authenticated addrs with other peers.
  optional bytes signedPeerRecord = 8;
}
`;var hs=Ur(gN).Identify;const vN="libp2p",wN="0.29.3",EN="JavaScript implementation of libp2p, a modular peer to peer network stack",xN="Jacob Heun <jacobheun@gmail.com>",SN="src/index.js",AN=["dist","src"],IN={lint:"aegir lint",build:"aegir build",test:"npm run test:node && npm run test:browser","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser",release:"aegir release -t node -t browser","release-minor":"aegir release --type minor -t node -t browser","release-major":"aegir release --type major -t node -t browser",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},kN={type:"git",url:"https://github.com/libp2p/js-libp2p.git"},TN=["libp2p","network","p2p","peer","peer-to-peer","IPFS"],CN={url:"https://github.com/libp2p/js-libp2p/issues"},_N="https://libp2p.io",RN="MIT",NN={node:">=12.0.0",npm:">=6.0.0"},PN={"abort-controller":"^3.0.0","aggregate-error":"^3.0.1","any-signal":"^1.1.0","bignumber.js":"^9.0.0","class-is":"^1.1.0",debug:"^4.1.1","err-code":"^2.0.0",events:"^3.1.0",hashlru:"^2.3.0","interface-datastore":"^2.0.0","ipfs-utils":"^2.2.0","it-all":"^1.0.1","it-buffer":"^0.1.2","it-handshake":"^1.0.1","it-length-prefixed":"^3.0.1","it-pipe":"^1.1.0","it-protocol-buffers":"^0.2.0","libp2p-crypto":"^0.18.0","libp2p-interfaces":"^0.5.1","libp2p-utils":"^0.2.0",mafmt:"^8.0.0","merge-options":"^2.0.0","moving-average":"^1.0.0",multiaddr:"^8.1.0",multicodec:"^2.0.0","multistream-select":"^1.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.9.1","p-any":"^3.0.0","p-fifo":"^1.0.0","p-settle":"^4.0.1","peer-id":"^0.14.2",protons:"^2.0.0",retimer:"^2.0.0","sanitize-filename":"^1.6.3","streaming-iterables":"^5.0.2","timeout-abort-controller":"^1.1.1",varint:"^5.0.0",xsalsa20:"^1.0.2"},DN={"@nodeutils/defaults-deep":"^1.1.0","abortable-iterator":"^3.0.0",aegir:"^27.0.0",chai:"^4.2.0","chai-as-promised":"^7.1.1","chai-bytes":"^0.1.2","chai-string":"^1.5.0",cids:"^1.0.0",delay:"^4.3.0","dirty-chai":"^2.0.1","interop-libp2p":"^0.3.0","ipfs-http-client":"^47.0.1","it-concat":"^1.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.12.0","libp2p-delegated-content-routing":"^0.7.0","libp2p-delegated-peer-routing":"^0.7.0","libp2p-floodsub":"^0.23.0","libp2p-gossipsub":"^0.6.0","libp2p-kad-dht":"^0.20.0","libp2p-mdns":"^0.15.0","libp2p-mplex":"^0.10.1","libp2p-noise":"^2.0.0","libp2p-secio":"^0.13.1","libp2p-tcp":"^0.15.1","libp2p-webrtc-star":"^0.20.0","libp2p-websockets":"^0.14.0",multihashes:"^3.0.1",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.1.0","promisify-es6":"^1.0.3",rimraf:"^3.0.2",sinon:"^9.0.2",uint8arrays:"^1.1.0"},ON=["David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Vasco Santos <vasco.santos@moxy.studio>","Alan Shaw <alan@tableflip.io>","Alex Potsides <alex@achingbrain.net>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Volker Mische <volker.mische@gmail.com>","Richard Littauer <richard.littauer@gmail.com>","Elven <mon.samuel@qq.com>","Andrew Nesbitt <andrewnez@gmail.com>","Giovanni T. Parra <fiatjaf@gmail.com>","Ryan Bell <ryan@piing.net>","Thomas Eizinger <thomas@eizinger.io>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Didrik Nordstr\xF6m <didrik@betamos.se>","Henrique Dias <hacdias@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Joel Gustafson <joelg@mit.edu>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","RasmusErik Voel Jensen <github@solsort.com>","Diogo Silva <fsdiogo@gmail.com>","robertkiel <robert.kiel@validitylabs.org>","Soeren <nikorpoulsen@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","Tiago Alves <alvesjtiago@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","ebinks <elizabethjbinks@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","isan_rivkin <isanrivkin@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Felipe Martins <felipebrasil93@gmail.com>"];var BN={name:vN,version:wN,description:EN,leadMaintainer:xN,main:SN,files:AN,scripts:IN,repository:kN,keywords:TN,bugs:CN,homepage:_N,license:RN,engines:NN,dependencies:PN,devDependencies:DN,contributors:ON};const MN=BN.version;var LN="ipfs/0.1.0",UN=`js-libp2p/${MN}`,KN="/ipfs/id/1.0.0",FN="/ipfs/id/push/1.0.0",jN={PROTOCOL_VERSION:LN,AGENT_VERSION:UN,MULTICODEC_IDENTIFY:KN,MULTICODEC_IDENTIFY_PUSH:FN};const hr=J("libp2p:identify");hr.error=J("libp2p:identify:error");const{collect:lb,take:fb,consume:hb}=Bd,{toBuffer:pb}=Fd,{MULTICODEC_IDENTIFY:qd,MULTICODEC_IDENTIFY_PUSH:Lo,AGENT_VERSION:qN,PROTOCOL_VERSION:VN}=jN,{codes:Vd}=Ot;class mb{static getCleanMultiaddr(t){if(t&&t.length>0)try{return De(t)}catch(e){return null}return null}constructor({libp2p:t,protocols:e}){this.peerStore=t.peerStore,this.connectionManager=t.connectionManager,this.connectionManager.on("peer:connect",r=>{const n=r.remotePeer;this.identify(r,n).catch(hr.error)}),this.peerId=t.peerId,this._libp2p=t,this._protocols=e,this.handleMessage=this.handleMessage.bind(this)}async push(t){const e=await this._getSelfPeerRecord(),r=this._libp2p.multiaddrs.map(a=>a.bytes),n=Array.from(this._protocols.keys()),i=t.map(async a=>{try{const{stream:s}=await a.newStream(Lo);await Vt([{listenAddrs:r,signedPeerRecord:e,protocols:n}],yN.encode(hs),s,hb)}catch(s){hr.error("could not push identify update to peer",s)}});return Promise.all(i)}pushToPeerStore(t){const e=[];let r;for(const n of t.peers.values())n.protocols.includes(Lo)&&(r=this.connectionManager.get(n.id))&&e.push(r);this.push(e)}async identify(t){const{stream:e}=await t.newStream(qd),[r]=await Vt([],e,Jr.decode(),fb(1),pb,lb);if(!r)throw K(new Error("No data could be retrieved"),Vd.ERR_CONNECTION_ENDED);let n;try{n=hs.decode(r)}catch(d){throw K(d,Vd.ERR_INVALID_MESSAGE)}let{publicKey:i,listenAddrs:a,protocols:s,observedAddr:o,signedPeerRecord:u}=n;const c=await be.createFromPubKey(i);if(t.remotePeer.toB58String()!==c.toB58String())throw K(new Error("identified peer does not match the expected peer"),Vd.ERR_INVALID_PEER);o=mb.getCleanMultiaddr(o);try{const d=await Po.openAndCertify(u,No.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(d)){this.peerStore.protoBook.set(c,s);return}}catch(d){hr("received invalid envelope, discard it and fallback to listenAddrs is available",d)}try{this.peerStore.addressBook.set(c,a.map(d=>De(d)))}catch(d){hr.error("received invalid addrs",d)}this.peerStore.protoBook.set(c,s),this.peerStore.metadataBook.set(c,"AgentVersion",le(n.agentVersion)),hr("received observed address of %s",o)}handleMessage({connection:t,stream:e,protocol:r}){switch(r){case qd:return this._handleIdentify({connection:t,stream:e});case Lo:return this._handlePush({connection:t,stream:e});default:hr.error("cannot handle unknown protocol %s",r)}}async _handleIdentify({connection:t,stream:e}){let r=new Uint8Array(0);this.peerId.pubKey&&(r=this.peerId.pubKey.bytes);const n=await this._getSelfPeerRecord(),i=hs.encode({protocolVersion:VN,agentVersion:qN,publicKey:r,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:t.remoteAddr.bytes,protocols:Array.from(this._protocols.keys())});try{await Vt([i],Jr.encode(),e,hb)}catch(a){hr.error("could not respond to identify request",a)}}async _handlePush({connection:t,stream:e}){let r;try{const[i]=await Vt([],e,Jr.decode(),fb(1),pb,lb);r=hs.decode(i)}catch(i){return hr.error("received invalid message",i)}const n=t.remotePeer;try{const i=await Po.openAndCertify(r.signedPeerRecord,No.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(i)){this.peerStore.protoBook.set(n,r.protocols);return}}catch(i){hr("received invalid envelope, discard it and fallback to listenAddrs is available",i)}try{this.peerStore.addressBook.set(n,r.listenAddrs.map(i=>De(i)))}catch(i){hr.error("received invalid addrs",i)}this.peerStore.protoBook.set(n,r.protocols)}async _getSelfPeerRecord(){const t=this.peerStore.addressBook.getRawEnvelope(this.peerId);if(t)return t;try{const e=new No({peerId:this.peerId,multiaddrs:this._libp2p.multiaddrs}),r=await Po.seal(e,this.peerId);return this.peerStore.addressBook.consumePeerRecord(r),this.peerStore.addressBook.getRawEnvelope(this.peerId)}catch(e){hr.error("failed to get self peer record")}return null}}var zN=mb,$N={IDENTIFY:qd,IDENTIFY_PUSH:Lo},GN=hs,HN={IdentifyService:zN,multicodecs:$N,Message:GN};const{EventEmitter:WN}=Rr,Jt=J("libp2p");Jt.error=J("libp2p:error");const{validate:YN}=qk,{codes:bb,messages:XN}=Ot,{IdentifyService:QN,multicodecs:JN}=HN;class Uo extends WN{constructor(t){super();if(this._options=YN(t),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new iN({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new ob({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new $k(this._options.addresses),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this._options.connectionManager.minPeers&&(this._options.connectionManager.minConnections=this._options.connectionManager.minPeers),this.connectionManager=new eT(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new J_({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){Jt("creating keychain");const r=Mm.generateOptions();this.keychain=new Mm(this._options.keychain.datastore,{passPhrase:this._options.keychain.pass,...r,...this._options.keychain}),Jt("keychain constructed")}if(this.upgrader=new bR({localPeer:this.peerId,metrics:this.metrics,onConnection:r=>this.connectionManager.onConnect(r),onConnectionEnd:r=>this.connectionManager.onDisconnect(r)}),this.transportManager=new $0({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.registrar=new dN({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw K(new Error(XN.CONN_ENCRYPTION_REQUIRED),bb.CONN_ENCRYPTION_REQUIRED);const e=this._modules.connEncryption;if(e.forEach(r=>{this.upgrader.cryptos.set(r.protocol,r)}),this.dialer=new VC({transportManager:this.transportManager,peerStore:this.peerStore,concurrency:this._options.dialer.maxParallelDials,perPeerLimit:this._options.dialer.maxDialsPerPeer,timeout:this._options.dialer.dialTimeout,resolvers:this._options.dialer.resolvers}),this._modules.transport.forEach(r=>{const n=r.prototype[Symbol.toStringTag],i=this._config.transport[n];this.transportManager.add(n,r,i)}),this._config.relay.enabled&&this.transportManager.add(Tm.prototype[Symbol.toStringTag],Tm),this._modules.streamMuxer){const r=this._modules.streamMuxer;r.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new QN({libp2p:this,protocols:this.upgrader.protocols}),this.handle(Object.values(JN),this.identifyService.handleMessage)}if(this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(mi.process!==void 0&&mi.process.env&&mi.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){const r=this._modules.dht;this._dht=new r({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){const r=this._modules.pubsub;this.pubsub=VR(r,this,this._config.pubsub)}this.peerRouting=_I(this),this.contentRouting=OI(this),Mo.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(t,...e){t==="error"&&!this._events.error?Jt.error(...e):super.emit(t,...e)}async start(){Jt("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),Jt("libp2p has started")}catch(t){throw this.emit("error",t),Jt.error("An error occurred starting libp2p",t),await this.stop(),t}}async stop(){Jt("libp2p is stopping");try{for(const t of this._discovery.values())t.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),t=>t.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.transportManager.close(),Mo.unmount(this),this.dialer.destroy()}catch(t){t&&(Jt.error(t),this.emit("error",t))}this._isStarted=!1,Jt("libp2p has stopped")}async loadKeychain(){try{await this.keychain.findKeyByName("self")}catch(t){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(t,e){return this.dialProtocol(t,null,e)}async dialProtocol(t,e,r){const{id:n,multiaddrs:i}=fo(t);let a=this.connectionManager.get(n);return a?i&&this.peerStore.addressBook.add(n,i):a=await this.dialer.connectToPeer(t,r),e?a.newStream(e):a}get multiaddrs(){const t=this.addressManager.getNoAnnounceAddrs();return this.transportManager.getAddrs().concat(this.addressManager.getAnnounceAddrs()).filter((e,r,n)=>n.findIndex(i=>i.equals(e))!==r?!1:!t.find(i=>i.equals(e)))}async hangUp(t){const{id:e}=fo(t),r=this.connectionManager.connections.get(e.toB58String());if(!r)return;await Promise.all(r.map(n=>n.close()))}ping(t){const{id:e,multiaddrs:r}=fo(t);return r?Mo(this,r[0]):Mo(this,e)}handle(t,e){t=Array.isArray(t)?t:[t],t.forEach(r=>{this.upgrader.protocols.set(r,e)}),this.isStarted()&&this.identifyService&&this.identifyService.pushToPeerStore(this.peerStore)}unhandle(t){t=Array.isArray(t)?t:[t],t.forEach(e=>{this.upgrader.protocols.delete(e)}),this.isStarted()&&this.identifyService&&this.identifyService.pushToPeerStore(this.peerStore)}async _onStarting(){await this.transportManager.listen(),await this.peerStore.start(),this._config.pubsub.enabled&&(this.pubsub&&this.pubsub.start()),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",t=>{this.emit("peer:discovery",t),this._maybeConnect(t)});for(const t of this.peerStore.peers.values())this.emit("peer:discovery",t.id);this.connectionManager.start(),await this._setupPeerDiscovery()}_onDiscoveryPeer(t){if(t.id.toB58String()===this.peerId.toB58String()){Jt.error(new Error(bb.ERR_DISCOVERED_SELF));return}t.multiaddrs&&this.peerStore.addressBook.add(t.id,t.multiaddrs),t.protocols&&this.peerStore.protoBook.set(t.id,t.protocols)}async _maybeConnect(t){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(t)){const e=this._options.connectionManager.minConnections||0;if(e>this.connectionManager.size){Jt("connecting to discovered peer %s",t.toB58String());try{await this.dialer.connectToPeer(t)}catch(r){Jt.error("could not connect to discovered peer",r)}}}}async _setupPeerDiscovery(){const t=e=>{let r={enabled:!0};if(e.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[e.tag]&&(r={...r,...this._config.peerDiscovery[e.tag]}),r.enabled&&!this._discovery.has(e.tag)){let n;typeof e=="function"?n=new e(Object.assign({},r,{peerId:this.peerId,libp2p:this})):n=e,n.on("peer",this._onDiscoveryPeer),this._discovery.set(e.tag,n)}};for(const e of this._modules.peerDiscovery||[])t(e);for(const e of this.transportManager.getTransports())e.discovery&&t(e.discovery);await Promise.all(Array.from(this._discovery.values(),e=>e.start()))}}Uo.create=async function(e={}){if(e.peerId)return new Uo(e);const r=await be.create();return e.peerId=r,new Uo(e)};var ZN=Uo,yb=({peerId:t,repo:e,keychainConfig:r={},libp2pConfig:n})=>{const{datastore:i,keys:a}=e,s={datastore:i,peerId:t,keychain:{datastore:a,...r}},o=ZN;return new o(rs(s,n))};const ps=J("ipfs:components:peer:storage"),{ERR_REPO_NOT_INITIALIZED:e9}=mr,t9=async t=>{const{repoAutoMigrate:e,repo:r,silent:n}=t,i=t.silent?ps:console.log;t.print=i;const a=typeof r=="string"||r==null?Ww({path:r,autoMigrate:e,silent:n}):r,{peerId:s,keychain:o,isNew:u}=await n9(a,t);return{peerId:s,keychain:o,repo:a,print:i,isNew:u}};var r9=t9;const n9=async(t,e)=>{const r=await i9(t);if(r==null)return{...await u9(t,e),isNew:!1};if(r.code===e9){if(e.allowNew===!1)throw new Error("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await a9(t,e),isNew:!0}}else throw r},i9=async t=>{if(t.closed)try{return await t.open(),null}catch(e){return e}else return null},a9=async(t,e)=>{const r=await t.exists();if(ps("repo exists?",r),r===!0)throw new Error("repo already exists");const n=e.privateKey?await s9(e.privateKey):await o9(e),i=c9(n);ps("peer identity: %s",i.PeerID);const a={...e.config,Identity:i};await t.init(a),await t.open(),ps("repo opened");const s=yb({peerId:n,repo:t,keychainConfig:{pass:e.pass},libp2pConfig:e.libp2pConfig});return s.keychain&&s.keychain.opts&&(await s.loadKeychain(),await t.config.set("Keychain",{dek:s.keychain.opts.dek})),{peerId:n,keychain:s.keychain}},s9=t=>(ps("using user-supplied private-key"),typeof t=="object"?t:be.createFromPrivKey(le(t,"base64pad"))),o9=({print:t,algorithm:e="RSA",bits:r=2048})=>(t("generating %s-bit (rsa only) %s keypair...",r,e),be.create({keyType:e,bits:r})),c9=t=>({PeerID:t.toB58String(),PrivKey:se(t.privKey.bytes,"base64pad")}),u9=async(t,{libp2pConfig:e,pass:r})=>{const n=await t.config.getAll();let i;n.Identity&&(i=await be.createFromPrivKey(n.Identity.PrivKey));const a=yb({peerId:i||await be.create(),repo:t,keychainConfig:{pass:r,...n.Keychain},libp2pConfig:e});return a.keychain&&await a.loadKeychain(),{peerId:i,keychain:a.keychain}},d9=Rg,{isNode:gb}=$w,Zr=J("libp2p:repo"),l9=Number.MAX_SAFE_INTEGER,f9="repoAutoMigrate",vb={memory:$f,fs:$f};class h9{constructor(t,e={}){if(typeof t!="string")throw new Error("missing repoPath");this.options=m9(e),this.repoVersion=this.options.repoVersion||9,this.closed=!0,this.path=t,this._locker=this._getLocker(),this.root=hl.create("root",this.path,this.options),this.version=lg(this.root),this.config=d9(this.root),this.spec=Dg(this.root),this.apiAddr=Bg(this.root),this.migrator=this.options.migrator||{revert:async(r,n,i,{ignoreLock:a,onProgress:s,isDryRun:o})=>{this.version.set(i)},migrate:async(r,n,i,{ignoreLock:a,onProgress:s,isDryRun:o})=>{this.version.set(i)}},this._datastores={}}async init(t){Zr("initializing at: %s",this.path),await this._openRoot(),await this.config.set(t.config||{}),await this.spec.set(t.spec||{}),await this.version.set(this.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(t){return!1}}async openDatastore(t,e,r){try{const n=hl.create(t,zb(this.path,t),{storageBackends:{[t]:e},storageBackendOptions:r||{}});return await n.open(),this._datastores[t]=n,this[t]=n,n}catch(n){throw n}}async closeDatastore(t){if(!this._datastores[t])throw new Error("database is not open");try{await this[t].close(),delete this._datastores[t],delete this[t]}catch(e){throw e}}async open(){if(!this.closed)throw K(new Error("repo is already open"),mr.ERR_REPO_ALREADY_OPEN);Zr("opening at: %s",this.path);try{await this._openRoot(),await this._checkInitialized(),this.lockfile=await this._openLock(this.path),Zr("acquired repo.lock");const t=await this.version.check(this.repoVersion);if(!t)if(await this._isAutoMigrationEnabled())await this._migrate(this.repoVersion);else throw new mr.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");await this.openDatastore("keys",Yc,gb?{}:{sharding:!1,prefix:"",version:2}),this.closed=!1,Zr("all opened")}catch(t){if(this.lockfile)try{await this._closeLock(),this.lockfile=null}catch(e){Zr("error removing lock",e)}throw t}}_getLocker(){if(typeof this.options.lock=="string"){if(!vb[this.options.lock])throw new Error("Unknown lock type: "+this.options.lock);return vb[this.options.lock]}if(!this.options.lock)throw new Error("No lock provided");return this.options.lock}async _openRoot(){try{await this.root.open()}catch(t){if(t.message!=="Already open")throw t}}async _openLock(t){const e=await this._locker.lock(t);if(typeof e.close!="function")throw K(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this.lockfile.close()}async _checkInitialized(){Zr("init check");let t;try{[t]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(e){throw e.code==="ERR_NOT_FOUND"?K(new Error("repo is not initialized yet"),mr.ERR_REPO_NOT_INITIALIZED,{path:this.path}):e}if(!t)throw K(new Error("repo is not initialized yet"),mr.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw K(new Error("repo is already closed"),mr.ERR_REPO_ALREADY_CLOSED);Zr("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(t){if(t.code!==mr.ERR_REPO_NOT_INITIALIZED&&!t.message.startsWith("ENOENT"))throw t}await Promise.all([this.root,...Object.values(this._datastores)].map(t=>t.close())),Zr("unlocking"),this.closed=!0,await this._closeLock(),this.lockfile=null}async exists(){return this.version.exists()}async stat(){const[t,e,...r]=await Promise.all([this._storageMaxStat(),this.version.get(),...Object.values(this._datastores).map(i=>p9(i))]),n=new ha(0);return r.forEach(i=>n.plus(i)),{repoPath:this.path,storageMax:t,version:e,repoSize:n}}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let t;try{t=await this.config.get(f9)}catch(e){if(e.code===mr.NotFoundError.code)t=!0;else throw e}return t}async _migrate(t){const e=await this.version.get();return e>t?(Zr("reverting to version "+t),this.migrator.revert(this.path,this.options,t,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Zr("migrating to version "+t),this.migrator.migrate(this.path,this.options,t,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const t=await this.config.get("Datastore.StorageMax");return new ha(oc(t))}catch(t){return new ha(l9)}}}async function p9(t){const e=new ha(0);for await(const r of t.query({}))e.plus(r.value.byteLength).plus(r.key.uint8Array().byteLength);return e}var ms=h9,wb=mr,Eb=r9;function m9(t){const e=Object.assign({},Xc,t);return e.storageBackends=Object.assign({},Xc.storageBackends,e.storageBackends),e.storageBackendOptions=Object.assign({},Xc.storageBackendOptions,e.storageBackendOptions),e}ms.errors=wb,ms.startRepo=Eb;var b9=Object.freeze(Object.assign(Object.create(null),ms,{default:ms,errors:wb,startRepo:Eb}));export{b9 as i};
