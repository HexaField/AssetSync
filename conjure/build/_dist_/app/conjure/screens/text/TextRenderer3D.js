import*as s from"https://cdn.skypack.dev/pin/three@v0.117.1-NetLzdTnw9ga3y6o633U/min/three.js";import h from"./createText.js";import{number as n}from"../../util/number.js";import{POSTPROCESSING as o}from"../../PostProcessing.js";export default class r{constructor(i,e,t={}){this.conjure=i,this.x=n(t.x),this.y=n(t.y),this.scale=n(t.scale)||1,this.alignX=t.alignX||"center",this.alignY=t.alignY||"center",this.renderSide=t.renderSide||s.DoubleSide,this.color=t.color===void 0?16777215:t.color,this.fit=t.fit,this.fitScale=this.scale,this.glow=Boolean(t.glow),this.string=String(t.string||t.text||""),this.group=new s.Group,this.font=i.getFonts().getFont(t.font||"Helvetiker"),this.geometry=h(this.font,{string:this.string,alignX:this.alignX,alignY:this.alignY}),this.material=new s.MeshBasicMaterial({color:this.color,side:this.renderSide}),this.mesh=new s.Mesh(this.geometry,this.material),this.group.add(this.mesh),e.add(this.group),this.glow&&this.mesh.layers.enable(o.BLOOM_SCENE),this.scaleText()}setText(i,e){if(e!==void 0&&(this.font=e),String(i)===this.string)return;this.string=String(i),this.geometry=h(this.font,{string:this.string,alignX:this.alignX,alignY:this.alignY}),this.mesh.geometry=this.geometry,this.scaleText()}scaleText(i){i&&(this.fit=i),this.fit&&(this.geometry.boundingBox.max.x-this.geometry.boundingBox.min.x>this.fit.x&&(this.fitScale=this.fit.x/(this.geometry.boundingBox.max.x-this.geometry.boundingBox.min.x))),this.mesh.scale.set(this.fitScale,this.fitScale,1)}getBounds(){return this.geometry.getBounds()}getText(){return this.string}}
